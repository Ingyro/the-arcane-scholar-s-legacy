(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function e(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=e(i);fetch(i.href,r)}})();/**
* @vue/shared v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function ud(n){const t=Object.create(null);for(const e of n.split(","))t[e]=1;return e=>e in t}const qt={},cr=[],Vn=()=>{},Bx=()=>!1,xc=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&(n.charCodeAt(2)>122||n.charCodeAt(2)<97),hd=n=>n.startsWith("onUpdate:"),Ke=Object.assign,dd=(n,t)=>{const e=n.indexOf(t);e>-1&&n.splice(e,1)},Ux=Object.prototype.hasOwnProperty,$t=(n,t)=>Ux.call(n,t),pt=Array.isArray,ur=n=>da(n)==="[object Map]",Tc=n=>da(n)==="[object Set]",Yp=n=>da(n)==="[object Date]",It=n=>typeof n=="function",pe=n=>typeof n=="string",Hn=n=>typeof n=="symbol",Qt=n=>n!==null&&typeof n=="object",Ry=n=>(Qt(n)||It(n))&&It(n.then)&&It(n.catch),ky=Object.prototype.toString,da=n=>ky.call(n),$x=n=>da(n).slice(8,-1),Dy=n=>da(n)==="[object Object]",fd=n=>pe(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,To=ud(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Ec=n=>{const t=Object.create(null);return e=>t[e]||(t[e]=n(e))},zx=/-(\w)/g,_n=Ec(n=>n.replace(zx,(t,e)=>e?e.toUpperCase():"")),jx=/\B([A-Z])/g,Hi=Ec(n=>n.replace(jx,"-$1").toLowerCase()),Ic=Ec(n=>n.charAt(0).toUpperCase()+n.slice(1)),Pu=Ec(n=>n?`on${Ic(n)}`:""),Ws=(n,t)=>!Object.is(n,t),yl=(n,...t)=>{for(let e=0;e<n.length;e++)n[e](...t)},fh=(n,t,e,s=!1)=>{Object.defineProperty(n,t,{configurable:!0,enumerable:!1,writable:s,value:e})},Fl=n=>{const t=parseFloat(n);return isNaN(t)?n:t};let Xp;const Ac=()=>Xp||(Xp=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function pd(n){if(pt(n)){const t={};for(let e=0;e<n.length;e++){const s=n[e],i=pe(s)?Gx(s):pd(s);if(i)for(const r in i)t[r]=i[r]}return t}else if(pe(n)||Qt(n))return n}const Hx=/;(?![^(]*\))/g,Wx=/:([^]+)/,qx=/\/\*[^]*?\*\//g;function Gx(n){const t={};return n.replace(qx,"").split(Hx).forEach(e=>{if(e){const s=e.split(Wx);s.length>1&&(t[s[0].trim()]=s[1].trim())}}),t}function et(n){let t="";if(pe(n))t=n;else if(pt(n))for(let e=0;e<n.length;e++){const s=et(n[e]);s&&(t+=s+" ")}else if(Qt(n))for(const e in n)n[e]&&(t+=e+" ");return t.trim()}const Kx="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Yx=ud(Kx);function My(n){return!!n||n===""}function Xx(n,t){if(n.length!==t.length)return!1;let e=!0;for(let s=0;e&&s<n.length;s++)e=Sc(n[s],t[s]);return e}function Sc(n,t){if(n===t)return!0;let e=Yp(n),s=Yp(t);if(e||s)return e&&s?n.getTime()===t.getTime():!1;if(e=Hn(n),s=Hn(t),e||s)return n===t;if(e=pt(n),s=pt(t),e||s)return e&&s?Xx(n,t):!1;if(e=Qt(n),s=Qt(t),e||s){if(!e||!s)return!1;const i=Object.keys(n).length,r=Object.keys(t).length;if(i!==r)return!1;for(const o in n){const a=n.hasOwnProperty(o),l=t.hasOwnProperty(o);if(a&&!l||!a&&l||!Sc(n[o],t[o]))return!1}}return String(n)===String(t)}function Qx(n,t){return n.findIndex(e=>Sc(e,t))}const Oy=n=>!!(n&&n.__v_isRef===!0),xt=n=>pe(n)?n:n==null?"":pt(n)||Qt(n)&&(n.toString===ky||!It(n.toString))?Oy(n)?xt(n.value):JSON.stringify(n,Ly,2):String(n),Ly=(n,t)=>Oy(t)?Ly(n,t.value):ur(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((e,[s,i],r)=>(e[Ru(s,r)+" =>"]=i,e),{})}:Tc(t)?{[`Set(${t.size})`]:[...t.values()].map(e=>Ru(e))}:Hn(t)?Ru(t):Qt(t)&&!pt(t)&&!Dy(t)?String(t):t,Ru=(n,t="")=>{var e;return Hn(n)?`Symbol(${(e=n.description)!=null?e:t})`:n};/**
* @vue/reactivity v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Xe;class Jx{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Xe,!t&&Xe&&(this.index=(Xe.scopes||(Xe.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,e;if(this.scopes)for(t=0,e=this.scopes.length;t<e;t++)this.scopes[t].pause();for(t=0,e=this.effects.length;t<e;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,e;if(this.scopes)for(t=0,e=this.scopes.length;t<e;t++)this.scopes[t].resume();for(t=0,e=this.effects.length;t<e;t++)this.effects[t].resume()}}run(t){if(this._active){const e=Xe;try{return Xe=this,t()}finally{Xe=e}}}on(){++this._on===1&&(this.prevScope=Xe,Xe=this)}off(){this._on>0&&--this._on===0&&(Xe=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){this._active=!1;let e,s;for(e=0,s=this.effects.length;e<s;e++)this.effects[e].stop();for(this.effects.length=0,e=0,s=this.cleanups.length;e<s;e++)this.cleanups[e]();if(this.cleanups.length=0,this.scopes){for(e=0,s=this.scopes.length;e<s;e++)this.scopes[e].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0}}}function Zx(){return Xe}let Yt;const ku=new WeakSet;class Vy{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Xe&&Xe.active&&Xe.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,ku.has(this)&&(ku.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Fy(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Qp(this),By(this);const t=Yt,e=En;Yt=this,En=!0;try{return this.fn()}finally{Uy(this),Yt=t,En=e,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)_d(t);this.deps=this.depsTail=void 0,Qp(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?ku.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){ph(this)&&this.run()}get dirty(){return ph(this)}}let Ny=0,Eo,Io;function Fy(n,t=!1){if(n.flags|=8,t){n.next=Io,Io=n;return}n.next=Eo,Eo=n}function gd(){Ny++}function md(){if(--Ny>0)return;if(Io){let t=Io;for(Io=void 0;t;){const e=t.next;t.next=void 0,t.flags&=-9,t=e}}let n;for(;Eo;){let t=Eo;for(Eo=void 0;t;){const e=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(s){n||(n=s)}t=e}}if(n)throw n}function By(n){for(let t=n.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function Uy(n){let t,e=n.depsTail,s=e;for(;s;){const i=s.prevDep;s.version===-1?(s===e&&(e=i),_d(s),tT(s)):t=s,s.dep.activeLink=s.prevActiveLink,s.prevActiveLink=void 0,s=i}n.deps=t,n.depsTail=e}function ph(n){for(let t=n.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&($y(t.dep.computed)||t.dep.version!==t.version))return!0;return!!n._dirty}function $y(n){if(n.flags&4&&!(n.flags&16)||(n.flags&=-17,n.globalVersion===jo)||(n.globalVersion=jo,!n.isSSR&&n.flags&128&&(!n.deps&&!n._dirty||!ph(n))))return;n.flags|=2;const t=n.dep,e=Yt,s=En;Yt=n,En=!0;try{By(n);const i=n.fn(n._value);(t.version===0||Ws(i,n._value))&&(n.flags|=128,n._value=i,t.version++)}catch(i){throw t.version++,i}finally{Yt=e,En=s,Uy(n),n.flags&=-3}}function _d(n,t=!1){const{dep:e,prevSub:s,nextSub:i}=n;if(s&&(s.nextSub=i,n.prevSub=void 0),i&&(i.prevSub=s,n.nextSub=void 0),e.subs===n&&(e.subs=s,!s&&e.computed)){e.computed.flags&=-5;for(let r=e.computed.deps;r;r=r.nextDep)_d(r,!0)}!t&&!--e.sc&&e.map&&e.map.delete(e.key)}function tT(n){const{prevDep:t,nextDep:e}=n;t&&(t.nextDep=e,n.prevDep=void 0),e&&(e.prevDep=t,n.nextDep=void 0)}let En=!0;const zy=[];function ps(){zy.push(En),En=!1}function gs(){const n=zy.pop();En=n===void 0?!0:n}function Qp(n){const{cleanup:t}=n;if(n.cleanup=void 0,t){const e=Yt;Yt=void 0;try{t()}finally{Yt=e}}}let jo=0;class eT{constructor(t,e){this.sub=t,this.dep=e,this.version=e.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class yd{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){if(!Yt||!En||Yt===this.computed)return;let e=this.activeLink;if(e===void 0||e.sub!==Yt)e=this.activeLink=new eT(Yt,this),Yt.deps?(e.prevDep=Yt.depsTail,Yt.depsTail.nextDep=e,Yt.depsTail=e):Yt.deps=Yt.depsTail=e,jy(e);else if(e.version===-1&&(e.version=this.version,e.nextDep)){const s=e.nextDep;s.prevDep=e.prevDep,e.prevDep&&(e.prevDep.nextDep=s),e.prevDep=Yt.depsTail,e.nextDep=void 0,Yt.depsTail.nextDep=e,Yt.depsTail=e,Yt.deps===e&&(Yt.deps=s)}return e}trigger(t){this.version++,jo++,this.notify(t)}notify(t){gd();try{for(let e=this.subs;e;e=e.prevSub)e.sub.notify()&&e.sub.dep.notify()}finally{md()}}}function jy(n){if(n.dep.sc++,n.sub.flags&4){const t=n.dep.computed;if(t&&!n.dep.subs){t.flags|=20;for(let s=t.deps;s;s=s.nextDep)jy(s)}const e=n.dep.subs;e!==n&&(n.prevSub=e,e&&(e.nextSub=n)),n.dep.subs=n}}const gh=new WeakMap,ki=Symbol(""),mh=Symbol(""),Ho=Symbol("");function Ve(n,t,e){if(En&&Yt){let s=gh.get(n);s||gh.set(n,s=new Map);let i=s.get(e);i||(s.set(e,i=new yd),i.map=s,i.key=e),i.track()}}function ss(n,t,e,s,i,r){const o=gh.get(n);if(!o){jo++;return}const a=l=>{l&&l.trigger()};if(gd(),t==="clear")o.forEach(a);else{const l=pt(n),c=l&&fd(e);if(l&&e==="length"){const h=Number(s);o.forEach((d,f)=>{(f==="length"||f===Ho||!Hn(f)&&f>=h)&&a(d)})}else switch((e!==void 0||o.has(void 0))&&a(o.get(e)),c&&a(o.get(Ho)),t){case"add":l?c&&a(o.get("length")):(a(o.get(ki)),ur(n)&&a(o.get(mh)));break;case"delete":l||(a(o.get(ki)),ur(n)&&a(o.get(mh)));break;case"set":ur(n)&&a(o.get(ki));break}}md()}function tr(n){const t=Ut(n);return t===n?t:(Ve(t,"iterate",Ho),gn(n)?t:t.map(Ie))}function Cc(n){return Ve(n=Ut(n),"iterate",Ho),n}const nT={__proto__:null,[Symbol.iterator](){return Du(this,Symbol.iterator,Ie)},concat(...n){return tr(this).concat(...n.map(t=>pt(t)?tr(t):t))},entries(){return Du(this,"entries",n=>(n[1]=Ie(n[1]),n))},every(n,t){return Qn(this,"every",n,t,void 0,arguments)},filter(n,t){return Qn(this,"filter",n,t,e=>e.map(Ie),arguments)},find(n,t){return Qn(this,"find",n,t,Ie,arguments)},findIndex(n,t){return Qn(this,"findIndex",n,t,void 0,arguments)},findLast(n,t){return Qn(this,"findLast",n,t,Ie,arguments)},findLastIndex(n,t){return Qn(this,"findLastIndex",n,t,void 0,arguments)},forEach(n,t){return Qn(this,"forEach",n,t,void 0,arguments)},includes(...n){return Mu(this,"includes",n)},indexOf(...n){return Mu(this,"indexOf",n)},join(n){return tr(this).join(n)},lastIndexOf(...n){return Mu(this,"lastIndexOf",n)},map(n,t){return Qn(this,"map",n,t,void 0,arguments)},pop(){return so(this,"pop")},push(...n){return so(this,"push",n)},reduce(n,...t){return Jp(this,"reduce",n,t)},reduceRight(n,...t){return Jp(this,"reduceRight",n,t)},shift(){return so(this,"shift")},some(n,t){return Qn(this,"some",n,t,void 0,arguments)},splice(...n){return so(this,"splice",n)},toReversed(){return tr(this).toReversed()},toSorted(n){return tr(this).toSorted(n)},toSpliced(...n){return tr(this).toSpliced(...n)},unshift(...n){return so(this,"unshift",n)},values(){return Du(this,"values",Ie)}};function Du(n,t,e){const s=Cc(n),i=s[t]();return s!==n&&!gn(n)&&(i._next=i.next,i.next=()=>{const r=i._next();return r.value&&(r.value=e(r.value)),r}),i}const sT=Array.prototype;function Qn(n,t,e,s,i,r){const o=Cc(n),a=o!==n&&!gn(n),l=o[t];if(l!==sT[t]){const d=l.apply(n,r);return a?Ie(d):d}let c=e;o!==n&&(a?c=function(d,f){return e.call(this,Ie(d),f,n)}:e.length>2&&(c=function(d,f){return e.call(this,d,f,n)}));const h=l.call(o,c,s);return a&&i?i(h):h}function Jp(n,t,e,s){const i=Cc(n);let r=e;return i!==n&&(gn(n)?e.length>3&&(r=function(o,a,l){return e.call(this,o,a,l,n)}):r=function(o,a,l){return e.call(this,o,Ie(a),l,n)}),i[t](r,...s)}function Mu(n,t,e){const s=Ut(n);Ve(s,"iterate",Ho);const i=s[t](...e);return(i===-1||i===!1)&&xd(e[0])?(e[0]=Ut(e[0]),s[t](...e)):i}function so(n,t,e=[]){ps(),gd();const s=Ut(n)[t].apply(n,e);return md(),gs(),s}const iT=ud("__proto__,__v_isRef,__isVue"),Hy=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(Hn));function rT(n){Hn(n)||(n=String(n));const t=Ut(this);return Ve(t,"has",n),t.hasOwnProperty(n)}class Wy{constructor(t=!1,e=!1){this._isReadonly=t,this._isShallow=e}get(t,e,s){if(e==="__v_skip")return t.__v_skip;const i=this._isReadonly,r=this._isShallow;if(e==="__v_isReactive")return!i;if(e==="__v_isReadonly")return i;if(e==="__v_isShallow")return r;if(e==="__v_raw")return s===(i?r?gT:Yy:r?Ky:Gy).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(s)?t:void 0;const o=pt(t);if(!i){let l;if(o&&(l=nT[e]))return l;if(e==="hasOwnProperty")return rT}const a=Reflect.get(t,e,Ue(t)?t:s);return(Hn(e)?Hy.has(e):iT(e))||(i||Ve(t,"get",e),r)?a:Ue(a)?o&&fd(e)?a:a.value:Qt(a)?i?Xy(a):vd(a):a}}class qy extends Wy{constructor(t=!1){super(!1,t)}set(t,e,s,i){let r=t[e];if(!this._isShallow){const l=Zs(r);if(!gn(s)&&!Zs(s)&&(r=Ut(r),s=Ut(s)),!pt(t)&&Ue(r)&&!Ue(s))return l?!1:(r.value=s,!0)}const o=pt(t)&&fd(e)?Number(e)<t.length:$t(t,e),a=Reflect.set(t,e,s,Ue(t)?t:i);return t===Ut(i)&&(o?Ws(s,r)&&ss(t,"set",e,s):ss(t,"add",e,s)),a}deleteProperty(t,e){const s=$t(t,e);t[e];const i=Reflect.deleteProperty(t,e);return i&&s&&ss(t,"delete",e,void 0),i}has(t,e){const s=Reflect.has(t,e);return(!Hn(e)||!Hy.has(e))&&Ve(t,"has",e),s}ownKeys(t){return Ve(t,"iterate",pt(t)?"length":ki),Reflect.ownKeys(t)}}class oT extends Wy{constructor(t=!1){super(!0,t)}set(t,e){return!0}deleteProperty(t,e){return!0}}const aT=new qy,lT=new oT,cT=new qy(!0);const _h=n=>n,Ya=n=>Reflect.getPrototypeOf(n);function uT(n,t,e){return function(...s){const i=this.__v_raw,r=Ut(i),o=ur(r),a=n==="entries"||n===Symbol.iterator&&o,l=n==="keys"&&o,c=i[n](...s),h=e?_h:t?Bl:Ie;return!t&&Ve(r,"iterate",l?mh:ki),{next(){const{value:d,done:f}=c.next();return f?{value:d,done:f}:{value:a?[h(d[0]),h(d[1])]:h(d),done:f}},[Symbol.iterator](){return this}}}}function Xa(n){return function(...t){return n==="delete"?!1:n==="clear"?void 0:this}}function hT(n,t){const e={get(i){const r=this.__v_raw,o=Ut(r),a=Ut(i);n||(Ws(i,a)&&Ve(o,"get",i),Ve(o,"get",a));const{has:l}=Ya(o),c=t?_h:n?Bl:Ie;if(l.call(o,i))return c(r.get(i));if(l.call(o,a))return c(r.get(a));r!==o&&r.get(i)},get size(){const i=this.__v_raw;return!n&&Ve(Ut(i),"iterate",ki),Reflect.get(i,"size",i)},has(i){const r=this.__v_raw,o=Ut(r),a=Ut(i);return n||(Ws(i,a)&&Ve(o,"has",i),Ve(o,"has",a)),i===a?r.has(i):r.has(i)||r.has(a)},forEach(i,r){const o=this,a=o.__v_raw,l=Ut(a),c=t?_h:n?Bl:Ie;return!n&&Ve(l,"iterate",ki),a.forEach((h,d)=>i.call(r,c(h),c(d),o))}};return Ke(e,n?{add:Xa("add"),set:Xa("set"),delete:Xa("delete"),clear:Xa("clear")}:{add(i){!t&&!gn(i)&&!Zs(i)&&(i=Ut(i));const r=Ut(this);return Ya(r).has.call(r,i)||(r.add(i),ss(r,"add",i,i)),this},set(i,r){!t&&!gn(r)&&!Zs(r)&&(r=Ut(r));const o=Ut(this),{has:a,get:l}=Ya(o);let c=a.call(o,i);c||(i=Ut(i),c=a.call(o,i));const h=l.call(o,i);return o.set(i,r),c?Ws(r,h)&&ss(o,"set",i,r):ss(o,"add",i,r),this},delete(i){const r=Ut(this),{has:o,get:a}=Ya(r);let l=o.call(r,i);l||(i=Ut(i),l=o.call(r,i)),a&&a.call(r,i);const c=r.delete(i);return l&&ss(r,"delete",i,void 0),c},clear(){const i=Ut(this),r=i.size!==0,o=i.clear();return r&&ss(i,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(i=>{e[i]=uT(i,n,t)}),e}function bd(n,t){const e=hT(n,t);return(s,i,r)=>i==="__v_isReactive"?!n:i==="__v_isReadonly"?n:i==="__v_raw"?s:Reflect.get($t(e,i)&&i in s?e:s,i,r)}const dT={get:bd(!1,!1)},fT={get:bd(!1,!0)},pT={get:bd(!0,!1)};const Gy=new WeakMap,Ky=new WeakMap,Yy=new WeakMap,gT=new WeakMap;function mT(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function _T(n){return n.__v_skip||!Object.isExtensible(n)?0:mT($x(n))}function vd(n){return Zs(n)?n:wd(n,!1,aT,dT,Gy)}function yT(n){return wd(n,!1,cT,fT,Ky)}function Xy(n){return wd(n,!0,lT,pT,Yy)}function wd(n,t,e,s,i){if(!Qt(n)||n.__v_raw&&!(t&&n.__v_isReactive))return n;const r=_T(n);if(r===0)return n;const o=i.get(n);if(o)return o;const a=new Proxy(n,r===2?s:e);return i.set(n,a),a}function hr(n){return Zs(n)?hr(n.__v_raw):!!(n&&n.__v_isReactive)}function Zs(n){return!!(n&&n.__v_isReadonly)}function gn(n){return!!(n&&n.__v_isShallow)}function xd(n){return n?!!n.__v_raw:!1}function Ut(n){const t=n&&n.__v_raw;return t?Ut(t):n}function bT(n){return!$t(n,"__v_skip")&&Object.isExtensible(n)&&fh(n,"__v_skip",!0),n}const Ie=n=>Qt(n)?vd(n):n,Bl=n=>Qt(n)?Xy(n):n;function Ue(n){return n?n.__v_isRef===!0:!1}function Rt(n){return vT(n,!1)}function vT(n,t){return Ue(n)?n:new wT(n,t)}class wT{constructor(t,e){this.dep=new yd,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=e?t:Ut(t),this._value=e?t:Ie(t),this.__v_isShallow=e}get value(){return this.dep.track(),this._value}set value(t){const e=this._rawValue,s=this.__v_isShallow||gn(t)||Zs(t);t=s?t:Ut(t),Ws(t,e)&&(this._rawValue=t,this._value=s?t:Ie(t),this.dep.trigger())}}function Ht(n){return Ue(n)?n.value:n}const xT={get:(n,t,e)=>t==="__v_raw"?n:Ht(Reflect.get(n,t,e)),set:(n,t,e,s)=>{const i=n[t];return Ue(i)&&!Ue(e)?(i.value=e,!0):Reflect.set(n,t,e,s)}};function Qy(n){return hr(n)?n:new Proxy(n,xT)}class TT{constructor(t,e,s){this.fn=t,this.setter=e,this._value=void 0,this.dep=new yd(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=jo-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!e,this.isSSR=s}notify(){if(this.flags|=16,!(this.flags&8)&&Yt!==this)return Fy(this,!0),!0}get value(){const t=this.dep.track();return $y(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function ET(n,t,e=!1){let s,i;return It(n)?s=n:(s=n.get,i=n.set),new TT(s,i,e)}const Qa={},Ul=new WeakMap;let Ei;function IT(n,t=!1,e=Ei){if(e){let s=Ul.get(e);s||Ul.set(e,s=[]),s.push(n)}}function AT(n,t,e=qt){const{immediate:s,deep:i,once:r,scheduler:o,augmentJob:a,call:l}=e,c=k=>i?k:gn(k)||i===!1||i===0?is(k,1):is(k);let h,d,f,g,_=!1,y=!1;if(Ue(n)?(d=()=>n.value,_=gn(n)):hr(n)?(d=()=>c(n),_=!0):pt(n)?(y=!0,_=n.some(k=>hr(k)||gn(k)),d=()=>n.map(k=>{if(Ue(k))return k.value;if(hr(k))return c(k);if(It(k))return l?l(k,2):k()})):It(n)?t?d=l?()=>l(n,2):n:d=()=>{if(f){ps();try{f()}finally{gs()}}const k=Ei;Ei=h;try{return l?l(n,3,[g]):n(g)}finally{Ei=k}}:d=Vn,t&&i){const k=d,R=i===!0?1/0:i;d=()=>is(k(),R)}const w=Zx(),E=()=>{h.stop(),w&&w.active&&dd(w.effects,h)};if(r&&t){const k=t;t=(...R)=>{k(...R),E()}}let S=y?new Array(n.length).fill(Qa):Qa;const A=k=>{if(!(!(h.flags&1)||!h.dirty&&!k))if(t){const R=h.run();if(i||_||(y?R.some((L,x)=>Ws(L,S[x])):Ws(R,S))){f&&f();const L=Ei;Ei=h;try{const x=[R,S===Qa?void 0:y&&S[0]===Qa?[]:S,g];S=R,l?l(t,3,x):t(...x)}finally{Ei=L}}}else h.run()};return a&&a(A),h=new Vy(d),h.scheduler=o?()=>o(A,!1):A,g=k=>IT(k,!1,h),f=h.onStop=()=>{const k=Ul.get(h);if(k){if(l)l(k,4);else for(const R of k)R();Ul.delete(h)}},t?s?A(!0):S=h.run():o?o(A.bind(null,!0),!0):h.run(),E.pause=h.pause.bind(h),E.resume=h.resume.bind(h),E.stop=E,E}function is(n,t=1/0,e){if(t<=0||!Qt(n)||n.__v_skip||(e=e||new Set,e.has(n)))return n;if(e.add(n),t--,Ue(n))is(n.value,t,e);else if(pt(n))for(let s=0;s<n.length;s++)is(n[s],t,e);else if(Tc(n)||ur(n))n.forEach(s=>{is(s,t,e)});else if(Dy(n)){for(const s in n)is(n[s],t,e);for(const s of Object.getOwnPropertySymbols(n))Object.prototype.propertyIsEnumerable.call(n,s)&&is(n[s],t,e)}return n}/**
* @vue/runtime-core v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function fa(n,t,e,s){try{return s?n(...s):n()}catch(i){Pc(i,t,e)}}function Wn(n,t,e,s){if(It(n)){const i=fa(n,t,e,s);return i&&Ry(i)&&i.catch(r=>{Pc(r,t,e)}),i}if(pt(n)){const i=[];for(let r=0;r<n.length;r++)i.push(Wn(n[r],t,e,s));return i}}function Pc(n,t,e,s=!0){const i=t?t.vnode:null,{errorHandler:r,throwUnhandledErrorInProduction:o}=t&&t.appContext.config||qt;if(t){let a=t.parent;const l=t.proxy,c=`https://vuejs.org/error-reference/#runtime-${e}`;for(;a;){const h=a.ec;if(h){for(let d=0;d<h.length;d++)if(h[d](n,l,c)===!1)return}a=a.parent}if(r){ps(),fa(r,null,10,[n,l,c]),gs();return}}ST(n,e,i,s,o)}function ST(n,t,e,s=!0,i=!1){if(i)throw n;console.error(n)}const We=[];let Rn=-1;const dr=[];let Ls=null,ir=0;const Jy=Promise.resolve();let $l=null;function Zy(n){const t=$l||Jy;return n?t.then(this?n.bind(this):n):t}function CT(n){let t=Rn+1,e=We.length;for(;t<e;){const s=t+e>>>1,i=We[s],r=Wo(i);r<n||r===n&&i.flags&2?t=s+1:e=s}return t}function Td(n){if(!(n.flags&1)){const t=Wo(n),e=We[We.length-1];!e||!(n.flags&2)&&t>=Wo(e)?We.push(n):We.splice(CT(t),0,n),n.flags|=1,tb()}}function tb(){$l||($l=Jy.then(nb))}function PT(n){pt(n)?dr.push(...n):Ls&&n.id===-1?Ls.splice(ir+1,0,n):n.flags&1||(dr.push(n),n.flags|=1),tb()}function Zp(n,t,e=Rn+1){for(;e<We.length;e++){const s=We[e];if(s&&s.flags&2){if(n&&s.id!==n.uid)continue;We.splice(e,1),e--,s.flags&4&&(s.flags&=-2),s(),s.flags&4||(s.flags&=-2)}}}function eb(n){if(dr.length){const t=[...new Set(dr)].sort((e,s)=>Wo(e)-Wo(s));if(dr.length=0,Ls){Ls.push(...t);return}for(Ls=t,ir=0;ir<Ls.length;ir++){const e=Ls[ir];e.flags&4&&(e.flags&=-2),e.flags&8||e(),e.flags&=-2}Ls=null,ir=0}}const Wo=n=>n.id==null?n.flags&2?-1:1/0:n.id;function nb(n){try{for(Rn=0;Rn<We.length;Rn++){const t=We[Rn];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),fa(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;Rn<We.length;Rn++){const t=We[Rn];t&&(t.flags&=-2)}Rn=-1,We.length=0,eb(),$l=null,(We.length||dr.length)&&nb()}}let an=null,sb=null;function zl(n){const t=an;return an=n,sb=n&&n.type.__scopeId||null,t}function RT(n,t=an,e){if(!t||n._n)return n;const s=(...i)=>{s._d&&cg(-1);const r=zl(t);let o;try{o=n(...i)}finally{zl(r),s._d&&cg(1)}return o};return s._n=!0,s._c=!0,s._d=!0,s}function ho(n,t){if(an===null)return n;const e=Lc(an),s=n.dirs||(n.dirs=[]);for(let i=0;i<t.length;i++){let[r,o,a,l=qt]=t[i];r&&(It(r)&&(r={mounted:r,updated:r}),r.deep&&is(o),s.push({dir:r,instance:e,value:o,oldValue:void 0,arg:a,modifiers:l}))}return n}function yi(n,t,e,s){const i=n.dirs,r=t&&t.dirs;for(let o=0;o<i.length;o++){const a=i[o];r&&(a.oldValue=r[o].value);let l=a.dir[s];l&&(ps(),Wn(l,e,8,[n.el,a,n,t]),gs())}}const kT=Symbol("_vte"),DT=n=>n.__isTeleport;function Ed(n,t){n.shapeFlag&6&&n.component?(n.transition=t,Ed(n.component.subTree,t)):n.shapeFlag&128?(n.ssContent.transition=t.clone(n.ssContent),n.ssFallback.transition=t.clone(n.ssFallback)):n.transition=t}function ib(n){n.ids=[n.ids[0]+n.ids[2]+++"-",0,0]}function Ao(n,t,e,s,i=!1){if(pt(n)){n.forEach((_,y)=>Ao(_,t&&(pt(t)?t[y]:t),e,s,i));return}if(So(s)&&!i){s.shapeFlag&512&&s.type.__asyncResolved&&s.component.subTree.component&&Ao(n,t,e,s.component.subTree);return}const r=s.shapeFlag&4?Lc(s.component):s.el,o=i?null:r,{i:a,r:l}=n,c=t&&t.r,h=a.refs===qt?a.refs={}:a.refs,d=a.setupState,f=Ut(d),g=d===qt?()=>!1:_=>$t(f,_);if(c!=null&&c!==l&&(pe(c)?(h[c]=null,g(c)&&(d[c]=null)):Ue(c)&&(c.value=null)),It(l))fa(l,a,12,[o,h]);else{const _=pe(l),y=Ue(l);if(_||y){const w=()=>{if(n.f){const E=_?g(l)?d[l]:h[l]:l.value;i?pt(E)&&dd(E,r):pt(E)?E.includes(r)||E.push(r):_?(h[l]=[r],g(l)&&(d[l]=h[l])):(l.value=[r],n.k&&(h[n.k]=l.value))}else _?(h[l]=o,g(l)&&(d[l]=o)):y&&(l.value=o,n.k&&(h[n.k]=o))};o?(w.id=-1,nn(w,e)):w()}}}Ac().requestIdleCallback;Ac().cancelIdleCallback;const So=n=>!!n.type.__asyncLoader,rb=n=>n.type.__isKeepAlive;function MT(n,t){ob(n,"a",t)}function OT(n,t){ob(n,"da",t)}function ob(n,t,e=Fe){const s=n.__wdc||(n.__wdc=()=>{let i=e;for(;i;){if(i.isDeactivated)return;i=i.parent}return n()});if(Rc(t,s,e),e){let i=e.parent;for(;i&&i.parent;)rb(i.parent.vnode)&&LT(s,t,e,i),i=i.parent}}function LT(n,t,e,s){const i=Rc(t,n,s,!0);kc(()=>{dd(s[t],i)},e)}function Rc(n,t,e=Fe,s=!1){if(e){const i=e[n]||(e[n]=[]),r=t.__weh||(t.__weh=(...o)=>{ps();const a=pa(e),l=Wn(t,e,n,o);return a(),gs(),l});return s?i.unshift(r):i.push(r),r}}const Ts=n=>(t,e=Fe)=>{(!Go||n==="sp")&&Rc(n,(...s)=>t(...s),e)},VT=Ts("bm"),kr=Ts("m"),NT=Ts("bu"),FT=Ts("u"),BT=Ts("bum"),kc=Ts("um"),UT=Ts("sp"),$T=Ts("rtg"),zT=Ts("rtc");function jT(n,t=Fe){Rc("ec",n,t)}const HT="components";function WT(n,t){return GT(HT,n,!0,t)||n}const qT=Symbol.for("v-ndc");function GT(n,t,e=!0,s=!1){const i=an||Fe;if(i){const r=i.type;{const a=LE(r,!1);if(a&&(a===t||a===_n(t)||a===Ic(_n(t))))return r}const o=tg(i[n]||r[n],t)||tg(i.appContext[n],t);return!o&&s?r:o}}function tg(n,t){return n&&(n[t]||n[_n(t)]||n[Ic(_n(t))])}function Dc(n,t,e,s){let i;const r=e,o=pt(n);if(o||pe(n)){const a=o&&hr(n);let l=!1,c=!1;a&&(l=!gn(n),c=Zs(n),n=Cc(n)),i=new Array(n.length);for(let h=0,d=n.length;h<d;h++)i[h]=t(l?c?Bl(Ie(n[h])):Ie(n[h]):n[h],h,void 0,r)}else if(typeof n=="number"){i=new Array(n);for(let a=0;a<n;a++)i[a]=t(a+1,a,void 0,r)}else if(Qt(n))if(n[Symbol.iterator])i=Array.from(n,(a,l)=>t(a,l,void 0,r));else{const a=Object.keys(n);i=new Array(a.length);for(let l=0,c=a.length;l<c;l++){const h=a[l];i[l]=t(n[h],h,l,r)}}else i=[];return i}const yh=n=>n?Ab(n)?Lc(n):yh(n.parent):null,Co=Ke(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>yh(n.parent),$root:n=>yh(n.root),$host:n=>n.ce,$emit:n=>n.emit,$options:n=>lb(n),$forceUpdate:n=>n.f||(n.f=()=>{Td(n.update)}),$nextTick:n=>n.n||(n.n=Zy.bind(n.proxy)),$watch:n=>gE.bind(n)}),Ou=(n,t)=>n!==qt&&!n.__isScriptSetup&&$t(n,t),KT={get({_:n},t){if(t==="__v_skip")return!0;const{ctx:e,setupState:s,data:i,props:r,accessCache:o,type:a,appContext:l}=n;let c;if(t[0]!=="$"){const g=o[t];if(g!==void 0)switch(g){case 1:return s[t];case 2:return i[t];case 4:return e[t];case 3:return r[t]}else{if(Ou(s,t))return o[t]=1,s[t];if(i!==qt&&$t(i,t))return o[t]=2,i[t];if((c=n.propsOptions[0])&&$t(c,t))return o[t]=3,r[t];if(e!==qt&&$t(e,t))return o[t]=4,e[t];bh&&(o[t]=0)}}const h=Co[t];let d,f;if(h)return t==="$attrs"&&Ve(n.attrs,"get",""),h(n);if((d=a.__cssModules)&&(d=d[t]))return d;if(e!==qt&&$t(e,t))return o[t]=4,e[t];if(f=l.config.globalProperties,$t(f,t))return f[t]},set({_:n},t,e){const{data:s,setupState:i,ctx:r}=n;return Ou(i,t)?(i[t]=e,!0):s!==qt&&$t(s,t)?(s[t]=e,!0):$t(n.props,t)||t[0]==="$"&&t.slice(1)in n?!1:(r[t]=e,!0)},has({_:{data:n,setupState:t,accessCache:e,ctx:s,appContext:i,propsOptions:r}},o){let a;return!!e[o]||n!==qt&&$t(n,o)||Ou(t,o)||(a=r[0])&&$t(a,o)||$t(s,o)||$t(Co,o)||$t(i.config.globalProperties,o)},defineProperty(n,t,e){return e.get!=null?n._.accessCache[t]=0:$t(e,"value")&&this.set(n,t,e.value,null),Reflect.defineProperty(n,t,e)}};function eg(n){return pt(n)?n.reduce((t,e)=>(t[e]=null,t),{}):n}let bh=!0;function YT(n){const t=lb(n),e=n.proxy,s=n.ctx;bh=!1,t.beforeCreate&&ng(t.beforeCreate,n,"bc");const{data:i,computed:r,methods:o,watch:a,provide:l,inject:c,created:h,beforeMount:d,mounted:f,beforeUpdate:g,updated:_,activated:y,deactivated:w,beforeDestroy:E,beforeUnmount:S,destroyed:A,unmounted:k,render:R,renderTracked:L,renderTriggered:x,errorCaptured:b,serverPrefetch:T,expose:C,inheritAttrs:P,components:M,directives:I,filters:yt}=t;if(c&&XT(c,s,null),o)for(const ot in o){const at=o[ot];It(at)&&(s[ot]=at.bind(e))}if(i){const ot=i.call(e,e);Qt(ot)&&(n.data=vd(ot))}if(bh=!0,r)for(const ot in r){const at=r[ot],Bt=It(at)?at.bind(e,e):It(at.get)?at.get.bind(e,e):Vn,lt=!It(at)&&It(at.set)?at.set.bind(e):Vn,it=hs({get:Bt,set:lt});Object.defineProperty(s,ot,{enumerable:!0,configurable:!0,get:()=>it.value,set:q=>it.value=q})}if(a)for(const ot in a)ab(a[ot],s,e,ot);if(l){const ot=It(l)?l.call(e):l;Reflect.ownKeys(ot).forEach(at=>{nE(at,ot[at])})}h&&ng(h,n,"c");function mt(ot,at){pt(at)?at.forEach(Bt=>ot(Bt.bind(e))):at&&ot(at.bind(e))}if(mt(VT,d),mt(kr,f),mt(NT,g),mt(FT,_),mt(MT,y),mt(OT,w),mt(jT,b),mt(zT,L),mt($T,x),mt(BT,S),mt(kc,k),mt(UT,T),pt(C))if(C.length){const ot=n.exposed||(n.exposed={});C.forEach(at=>{Object.defineProperty(ot,at,{get:()=>e[at],set:Bt=>e[at]=Bt,enumerable:!0})})}else n.exposed||(n.exposed={});R&&n.render===Vn&&(n.render=R),P!=null&&(n.inheritAttrs=P),M&&(n.components=M),I&&(n.directives=I),T&&ib(n)}function XT(n,t,e=Vn){pt(n)&&(n=vh(n));for(const s in n){const i=n[s];let r;Qt(i)?"default"in i?r=bl(i.from||s,i.default,!0):r=bl(i.from||s):r=bl(i),Ue(r)?Object.defineProperty(t,s,{enumerable:!0,configurable:!0,get:()=>r.value,set:o=>r.value=o}):t[s]=r}}function ng(n,t,e){Wn(pt(n)?n.map(s=>s.bind(t.proxy)):n.bind(t.proxy),t,e)}function ab(n,t,e,s){let i=s.includes(".")?wb(e,s):()=>e[s];if(pe(n)){const r=t[n];It(r)&&Po(i,r)}else if(It(n))Po(i,n.bind(e));else if(Qt(n))if(pt(n))n.forEach(r=>ab(r,t,e,s));else{const r=It(n.handler)?n.handler.bind(e):t[n.handler];It(r)&&Po(i,r,n)}}function lb(n){const t=n.type,{mixins:e,extends:s}=t,{mixins:i,optionsCache:r,config:{optionMergeStrategies:o}}=n.appContext,a=r.get(t);let l;return a?l=a:!i.length&&!e&&!s?l=t:(l={},i.length&&i.forEach(c=>jl(l,c,o,!0)),jl(l,t,o)),Qt(t)&&r.set(t,l),l}function jl(n,t,e,s=!1){const{mixins:i,extends:r}=t;r&&jl(n,r,e,!0),i&&i.forEach(o=>jl(n,o,e,!0));for(const o in t)if(!(s&&o==="expose")){const a=QT[o]||e&&e[o];n[o]=a?a(n[o],t[o]):t[o]}return n}const QT={data:sg,props:ig,emits:ig,methods:fo,computed:fo,beforeCreate:He,created:He,beforeMount:He,mounted:He,beforeUpdate:He,updated:He,beforeDestroy:He,beforeUnmount:He,destroyed:He,unmounted:He,activated:He,deactivated:He,errorCaptured:He,serverPrefetch:He,components:fo,directives:fo,watch:ZT,provide:sg,inject:JT};function sg(n,t){return t?n?function(){return Ke(It(n)?n.call(this,this):n,It(t)?t.call(this,this):t)}:t:n}function JT(n,t){return fo(vh(n),vh(t))}function vh(n){if(pt(n)){const t={};for(let e=0;e<n.length;e++)t[n[e]]=n[e];return t}return n}function He(n,t){return n?[...new Set([].concat(n,t))]:t}function fo(n,t){return n?Ke(Object.create(null),n,t):t}function ig(n,t){return n?pt(n)&&pt(t)?[...new Set([...n,...t])]:Ke(Object.create(null),eg(n),eg(t??{})):t}function ZT(n,t){if(!n)return t;if(!t)return n;const e=Ke(Object.create(null),n);for(const s in t)e[s]=He(n[s],t[s]);return e}function cb(){return{app:null,config:{isNativeTag:Bx,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let tE=0;function eE(n,t){return function(s,i=null){It(s)||(s=Ke({},s)),i!=null&&!Qt(i)&&(i=null);const r=cb(),o=new WeakSet,a=[];let l=!1;const c=r.app={_uid:tE++,_component:s,_props:i,_container:null,_context:r,_instance:null,version:FE,get config(){return r.config},set config(h){},use(h,...d){return o.has(h)||(h&&It(h.install)?(o.add(h),h.install(c,...d)):It(h)&&(o.add(h),h(c,...d))),c},mixin(h){return r.mixins.includes(h)||r.mixins.push(h),c},component(h,d){return d?(r.components[h]=d,c):r.components[h]},directive(h,d){return d?(r.directives[h]=d,c):r.directives[h]},mount(h,d,f){if(!l){const g=c._ceVNode||qe(s,i);return g.appContext=r,f===!0?f="svg":f===!1&&(f=void 0),n(g,h,f),l=!0,c._container=h,h.__vue_app__=c,Lc(g.component)}},onUnmount(h){a.push(h)},unmount(){l&&(Wn(a,c._instance,16),n(null,c._container),delete c._container.__vue_app__)},provide(h,d){return r.provides[h]=d,c},runWithContext(h){const d=fr;fr=c;try{return h()}finally{fr=d}}};return c}}let fr=null;function nE(n,t){if(Fe){let e=Fe.provides;const s=Fe.parent&&Fe.parent.provides;s===e&&(e=Fe.provides=Object.create(s)),e[n]=t}}function bl(n,t,e=!1){const s=RE();if(s||fr){let i=fr?fr._context.provides:s?s.parent==null||s.ce?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides:void 0;if(i&&n in i)return i[n];if(arguments.length>1)return e&&It(t)?t.call(s&&s.proxy):t}}const ub={},hb=()=>Object.create(ub),db=n=>Object.getPrototypeOf(n)===ub;function sE(n,t,e,s=!1){const i={},r=hb();n.propsDefaults=Object.create(null),fb(n,t,i,r);for(const o in n.propsOptions[0])o in i||(i[o]=void 0);e?n.props=s?i:yT(i):n.type.props?n.props=i:n.props=r,n.attrs=r}function iE(n,t,e,s){const{props:i,attrs:r,vnode:{patchFlag:o}}=n,a=Ut(i),[l]=n.propsOptions;let c=!1;if((s||o>0)&&!(o&16)){if(o&8){const h=n.vnode.dynamicProps;for(let d=0;d<h.length;d++){let f=h[d];if(Mc(n.emitsOptions,f))continue;const g=t[f];if(l)if($t(r,f))g!==r[f]&&(r[f]=g,c=!0);else{const _=_n(f);i[_]=wh(l,a,_,g,n,!1)}else g!==r[f]&&(r[f]=g,c=!0)}}}else{fb(n,t,i,r)&&(c=!0);let h;for(const d in a)(!t||!$t(t,d)&&((h=Hi(d))===d||!$t(t,h)))&&(l?e&&(e[d]!==void 0||e[h]!==void 0)&&(i[d]=wh(l,a,d,void 0,n,!0)):delete i[d]);if(r!==a)for(const d in r)(!t||!$t(t,d))&&(delete r[d],c=!0)}c&&ss(n.attrs,"set","")}function fb(n,t,e,s){const[i,r]=n.propsOptions;let o=!1,a;if(t)for(let l in t){if(To(l))continue;const c=t[l];let h;i&&$t(i,h=_n(l))?!r||!r.includes(h)?e[h]=c:(a||(a={}))[h]=c:Mc(n.emitsOptions,l)||(!(l in s)||c!==s[l])&&(s[l]=c,o=!0)}if(r){const l=Ut(e),c=a||qt;for(let h=0;h<r.length;h++){const d=r[h];e[d]=wh(i,l,d,c[d],n,!$t(c,d))}}return o}function wh(n,t,e,s,i,r){const o=n[e];if(o!=null){const a=$t(o,"default");if(a&&s===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&It(l)){const{propsDefaults:c}=i;if(e in c)s=c[e];else{const h=pa(i);s=c[e]=l.call(null,t),h()}}else s=l;i.ce&&i.ce._setProp(e,s)}o[0]&&(r&&!a?s=!1:o[1]&&(s===""||s===Hi(e))&&(s=!0))}return s}const rE=new WeakMap;function pb(n,t,e=!1){const s=e?rE:t.propsCache,i=s.get(n);if(i)return i;const r=n.props,o={},a=[];let l=!1;if(!It(n)){const h=d=>{l=!0;const[f,g]=pb(d,t,!0);Ke(o,f),g&&a.push(...g)};!e&&t.mixins.length&&t.mixins.forEach(h),n.extends&&h(n.extends),n.mixins&&n.mixins.forEach(h)}if(!r&&!l)return Qt(n)&&s.set(n,cr),cr;if(pt(r))for(let h=0;h<r.length;h++){const d=_n(r[h]);rg(d)&&(o[d]=qt)}else if(r)for(const h in r){const d=_n(h);if(rg(d)){const f=r[h],g=o[d]=pt(f)||It(f)?{type:f}:Ke({},f),_=g.type;let y=!1,w=!0;if(pt(_))for(let E=0;E<_.length;++E){const S=_[E],A=It(S)&&S.name;if(A==="Boolean"){y=!0;break}else A==="String"&&(w=!1)}else y=It(_)&&_.name==="Boolean";g[0]=y,g[1]=w,(y||$t(g,"default"))&&a.push(d)}}const c=[o,a];return Qt(n)&&s.set(n,c),c}function rg(n){return n[0]!=="$"&&!To(n)}const Id=n=>n==="_"||n==="__"||n==="_ctx"||n==="$stable",Ad=n=>pt(n)?n.map(Mn):[Mn(n)],oE=(n,t,e)=>{if(t._n)return t;const s=RT((...i)=>Ad(t(...i)),e);return s._c=!1,s},gb=(n,t,e)=>{const s=n._ctx;for(const i in n){if(Id(i))continue;const r=n[i];if(It(r))t[i]=oE(i,r,s);else if(r!=null){const o=Ad(r);t[i]=()=>o}}},mb=(n,t)=>{const e=Ad(t);n.slots.default=()=>e},_b=(n,t,e)=>{for(const s in t)(e||!Id(s))&&(n[s]=t[s])},aE=(n,t,e)=>{const s=n.slots=hb();if(n.vnode.shapeFlag&32){const i=t.__;i&&fh(s,"__",i,!0);const r=t._;r?(_b(s,t,e),e&&fh(s,"_",r,!0)):gb(t,s)}else t&&mb(n,t)},lE=(n,t,e)=>{const{vnode:s,slots:i}=n;let r=!0,o=qt;if(s.shapeFlag&32){const a=t._;a?e&&a===1?r=!1:_b(i,t,e):(r=!t.$stable,gb(t,i)),o=t}else t&&(mb(n,t),o={default:1});if(r)for(const a in i)!Id(a)&&o[a]==null&&delete i[a]},nn=xE;function cE(n){return uE(n)}function uE(n,t){const e=Ac();e.__VUE__=!0;const{insert:s,remove:i,patchProp:r,createElement:o,createText:a,createComment:l,setText:c,setElementText:h,parentNode:d,nextSibling:f,setScopeId:g=Vn,insertStaticContent:_}=n,y=(D,O,B,H=null,z=null,j=null,Q=void 0,K=null,G=!!O.dynamicChildren)=>{if(D===O)return;D&&!io(D,O)&&(H=ue(D),q(D,z,j,!0),D=null),O.patchFlag===-2&&(G=!1,O.dynamicChildren=null);const{type:W,ref:ct,shapeFlag:X}=O;switch(W){case Oc:w(D,O,B,H);break;case ti:E(D,O,B,H);break;case vl:D==null&&S(O,B,H,Q);break;case rn:M(D,O,B,H,z,j,Q,K,G);break;default:X&1?R(D,O,B,H,z,j,Q,K,G):X&6?I(D,O,B,H,z,j,Q,K,G):(X&64||X&128)&&W.process(D,O,B,H,z,j,Q,K,G,Sn)}ct!=null&&z?Ao(ct,D&&D.ref,j,O||D,!O):ct==null&&D&&D.ref!=null&&Ao(D.ref,null,j,D,!0)},w=(D,O,B,H)=>{if(D==null)s(O.el=a(O.children),B,H);else{const z=O.el=D.el;O.children!==D.children&&c(z,O.children)}},E=(D,O,B,H)=>{D==null?s(O.el=l(O.children||""),B,H):O.el=D.el},S=(D,O,B,H)=>{[D.el,D.anchor]=_(D.children,O,B,H,D.el,D.anchor)},A=({el:D,anchor:O},B,H)=>{let z;for(;D&&D!==O;)z=f(D),s(D,B,H),D=z;s(O,B,H)},k=({el:D,anchor:O})=>{let B;for(;D&&D!==O;)B=f(D),i(D),D=B;i(O)},R=(D,O,B,H,z,j,Q,K,G)=>{O.type==="svg"?Q="svg":O.type==="math"&&(Q="mathml"),D==null?L(O,B,H,z,j,Q,K,G):T(D,O,z,j,Q,K,G)},L=(D,O,B,H,z,j,Q,K)=>{let G,W;const{props:ct,shapeFlag:X,transition:rt,dirs:gt}=D;if(G=D.el=o(D.type,j,ct&&ct.is,ct),X&8?h(G,D.children):X&16&&b(D.children,G,null,H,z,Lu(D,j),Q,K),gt&&yi(D,null,H,"created"),x(G,D,D.scopeId,Q,H),ct){for(const Tt in ct)Tt!=="value"&&!To(Tt)&&r(G,Tt,null,ct[Tt],j,H);"value"in ct&&r(G,"value",null,ct.value,j),(W=ct.onVnodeBeforeMount)&&Cn(W,H,D)}gt&&yi(D,null,H,"beforeMount");const dt=hE(z,rt);dt&&rt.beforeEnter(G),s(G,O,B),((W=ct&&ct.onVnodeMounted)||dt||gt)&&nn(()=>{W&&Cn(W,H,D),dt&&rt.enter(G),gt&&yi(D,null,H,"mounted")},z)},x=(D,O,B,H,z)=>{if(B&&g(D,B),H)for(let j=0;j<H.length;j++)g(D,H[j]);if(z){let j=z.subTree;if(O===j||Tb(j.type)&&(j.ssContent===O||j.ssFallback===O)){const Q=z.vnode;x(D,Q,Q.scopeId,Q.slotScopeIds,z.parent)}}},b=(D,O,B,H,z,j,Q,K,G=0)=>{for(let W=G;W<D.length;W++){const ct=D[W]=K?Vs(D[W]):Mn(D[W]);y(null,ct,O,B,H,z,j,Q,K)}},T=(D,O,B,H,z,j,Q)=>{const K=O.el=D.el;let{patchFlag:G,dynamicChildren:W,dirs:ct}=O;G|=D.patchFlag&16;const X=D.props||qt,rt=O.props||qt;let gt;if(B&&bi(B,!1),(gt=rt.onVnodeBeforeUpdate)&&Cn(gt,B,O,D),ct&&yi(O,D,B,"beforeUpdate"),B&&bi(B,!0),(X.innerHTML&&rt.innerHTML==null||X.textContent&&rt.textContent==null)&&h(K,""),W?C(D.dynamicChildren,W,K,B,H,Lu(O,z),j):Q||at(D,O,K,null,B,H,Lu(O,z),j,!1),G>0){if(G&16)P(K,X,rt,B,z);else if(G&2&&X.class!==rt.class&&r(K,"class",null,rt.class,z),G&4&&r(K,"style",X.style,rt.style,z),G&8){const dt=O.dynamicProps;for(let Tt=0;Tt<dt.length;Tt++){const Ot=dt[Tt],ve=X[Ot],we=rt[Ot];(we!==ve||Ot==="value")&&r(K,Ot,ve,we,z,B)}}G&1&&D.children!==O.children&&h(K,O.children)}else!Q&&W==null&&P(K,X,rt,B,z);((gt=rt.onVnodeUpdated)||ct)&&nn(()=>{gt&&Cn(gt,B,O,D),ct&&yi(O,D,B,"updated")},H)},C=(D,O,B,H,z,j,Q)=>{for(let K=0;K<O.length;K++){const G=D[K],W=O[K],ct=G.el&&(G.type===rn||!io(G,W)||G.shapeFlag&198)?d(G.el):B;y(G,W,ct,null,H,z,j,Q,!0)}},P=(D,O,B,H,z)=>{if(O!==B){if(O!==qt)for(const j in O)!To(j)&&!(j in B)&&r(D,j,O[j],null,z,H);for(const j in B){if(To(j))continue;const Q=B[j],K=O[j];Q!==K&&j!=="value"&&r(D,j,K,Q,z,H)}"value"in B&&r(D,"value",O.value,B.value,z)}},M=(D,O,B,H,z,j,Q,K,G)=>{const W=O.el=D?D.el:a(""),ct=O.anchor=D?D.anchor:a("");let{patchFlag:X,dynamicChildren:rt,slotScopeIds:gt}=O;gt&&(K=K?K.concat(gt):gt),D==null?(s(W,B,H),s(ct,B,H),b(O.children||[],B,ct,z,j,Q,K,G)):X>0&&X&64&&rt&&D.dynamicChildren?(C(D.dynamicChildren,rt,B,z,j,Q,K),(O.key!=null||z&&O===z.subTree)&&yb(D,O,!0)):at(D,O,B,ct,z,j,Q,K,G)},I=(D,O,B,H,z,j,Q,K,G)=>{O.slotScopeIds=K,D==null?O.shapeFlag&512?z.ctx.activate(O,B,H,Q,G):yt(O,B,H,z,j,Q,G):st(D,O,G)},yt=(D,O,B,H,z,j,Q)=>{const K=D.component=PE(D,H,z);if(rb(D)&&(K.ctx.renderer=Sn),kE(K,!1,Q),K.asyncDep){if(z&&z.registerDep(K,mt,Q),!D.el){const G=K.subTree=qe(ti);E(null,G,O,B),D.placeholder=G.el}}else mt(K,D,O,B,z,j,Q)},st=(D,O,B)=>{const H=O.component=D.component;if(vE(D,O,B))if(H.asyncDep&&!H.asyncResolved){ot(H,O,B);return}else H.next=O,H.update();else O.el=D.el,H.vnode=O},mt=(D,O,B,H,z,j,Q)=>{const K=()=>{if(D.isMounted){let{next:X,bu:rt,u:gt,parent:dt,vnode:Tt}=D;{const Pe=bb(D);if(Pe){X&&(X.el=Tt.el,ot(D,X,Q)),Pe.asyncDep.then(()=>{D.isUnmounted||K()});return}}let Ot=X,ve;bi(D,!1),X?(X.el=Tt.el,ot(D,X,Q)):X=Tt,rt&&yl(rt),(ve=X.props&&X.props.onVnodeBeforeUpdate)&&Cn(ve,dt,X,Tt),bi(D,!0);const we=ag(D),un=D.subTree;D.subTree=we,y(un,we,d(un.el),ue(un),D,z,j),X.el=we.el,Ot===null&&wE(D,we.el),gt&&nn(gt,z),(ve=X.props&&X.props.onVnodeUpdated)&&nn(()=>Cn(ve,dt,X,Tt),z)}else{let X;const{el:rt,props:gt}=O,{bm:dt,m:Tt,parent:Ot,root:ve,type:we}=D,un=So(O);bi(D,!1),dt&&yl(dt),!un&&(X=gt&&gt.onVnodeBeforeMount)&&Cn(X,Ot,O),bi(D,!0);{ve.ce&&ve.ce._def.shadowRoot!==!1&&ve.ce._injectChildStyle(we);const Pe=D.subTree=ag(D);y(null,Pe,B,H,D,z,j),O.el=Pe.el}if(Tt&&nn(Tt,z),!un&&(X=gt&&gt.onVnodeMounted)){const Pe=O;nn(()=>Cn(X,Ot,Pe),z)}(O.shapeFlag&256||Ot&&So(Ot.vnode)&&Ot.vnode.shapeFlag&256)&&D.a&&nn(D.a,z),D.isMounted=!0,O=B=H=null}};D.scope.on();const G=D.effect=new Vy(K);D.scope.off();const W=D.update=G.run.bind(G),ct=D.job=G.runIfDirty.bind(G);ct.i=D,ct.id=D.uid,G.scheduler=()=>Td(ct),bi(D,!0),W()},ot=(D,O,B)=>{O.component=D;const H=D.vnode.props;D.vnode=O,D.next=null,iE(D,O.props,H,B),lE(D,O.children,B),ps(),Zp(D),gs()},at=(D,O,B,H,z,j,Q,K,G=!1)=>{const W=D&&D.children,ct=D?D.shapeFlag:0,X=O.children,{patchFlag:rt,shapeFlag:gt}=O;if(rt>0){if(rt&128){lt(W,X,B,H,z,j,Q,K,G);return}else if(rt&256){Bt(W,X,B,H,z,j,Q,K,G);return}}gt&8?(ct&16&&At(W,z,j),X!==W&&h(B,X)):ct&16?gt&16?lt(W,X,B,H,z,j,Q,K,G):At(W,z,j,!0):(ct&8&&h(B,""),gt&16&&b(X,B,H,z,j,Q,K,G))},Bt=(D,O,B,H,z,j,Q,K,G)=>{D=D||cr,O=O||cr;const W=D.length,ct=O.length,X=Math.min(W,ct);let rt;for(rt=0;rt<X;rt++){const gt=O[rt]=G?Vs(O[rt]):Mn(O[rt]);y(D[rt],gt,B,null,z,j,Q,K,G)}W>ct?At(D,z,j,!0,!1,X):b(O,B,H,z,j,Q,K,G,X)},lt=(D,O,B,H,z,j,Q,K,G)=>{let W=0;const ct=O.length;let X=D.length-1,rt=ct-1;for(;W<=X&&W<=rt;){const gt=D[W],dt=O[W]=G?Vs(O[W]):Mn(O[W]);if(io(gt,dt))y(gt,dt,B,null,z,j,Q,K,G);else break;W++}for(;W<=X&&W<=rt;){const gt=D[X],dt=O[rt]=G?Vs(O[rt]):Mn(O[rt]);if(io(gt,dt))y(gt,dt,B,null,z,j,Q,K,G);else break;X--,rt--}if(W>X){if(W<=rt){const gt=rt+1,dt=gt<ct?O[gt].el:H;for(;W<=rt;)y(null,O[W]=G?Vs(O[W]):Mn(O[W]),B,dt,z,j,Q,K,G),W++}}else if(W>rt)for(;W<=X;)q(D[W],z,j,!0),W++;else{const gt=W,dt=W,Tt=new Map;for(W=dt;W<=rt;W++){const xe=O[W]=G?Vs(O[W]):Mn(O[W]);xe.key!=null&&Tt.set(xe.key,W)}let Ot,ve=0;const we=rt-dt+1;let un=!1,Pe=0;const Cs=new Array(we);for(W=0;W<we;W++)Cs[W]=0;for(W=gt;W<=X;W++){const xe=D[W];if(ve>=we){q(xe,z,j,!0);continue}let hn;if(xe.key!=null)hn=Tt.get(xe.key);else for(Ot=dt;Ot<=rt;Ot++)if(Cs[Ot-dt]===0&&io(xe,O[Ot])){hn=Ot;break}hn===void 0?q(xe,z,j,!0):(Cs[hn-dt]=W+1,hn>=Pe?Pe=hn:un=!0,y(xe,O[hn],B,null,z,j,Q,K,G),ve++)}const Hr=un?dE(Cs):cr;for(Ot=Hr.length-1,W=we-1;W>=0;W--){const xe=dt+W,hn=O[xe],Ma=O[xe+1],Yi=xe+1<ct?Ma.el||Ma.placeholder:H;Cs[W]===0?y(null,hn,B,Yi,z,j,Q,K,G):un&&(Ot<0||W!==Hr[Ot]?it(hn,B,Yi,2):Ot--)}}},it=(D,O,B,H,z=null)=>{const{el:j,type:Q,transition:K,children:G,shapeFlag:W}=D;if(W&6){it(D.component.subTree,O,B,H);return}if(W&128){D.suspense.move(O,B,H);return}if(W&64){Q.move(D,O,B,Sn);return}if(Q===rn){s(j,O,B);for(let X=0;X<G.length;X++)it(G[X],O,B,H);s(D.anchor,O,B);return}if(Q===vl){A(D,O,B);return}if(H!==2&&W&1&&K)if(H===0)K.beforeEnter(j),s(j,O,B),nn(()=>K.enter(j),z);else{const{leave:X,delayLeave:rt,afterLeave:gt}=K,dt=()=>{D.ctx.isUnmounted?i(j):s(j,O,B)},Tt=()=>{X(j,()=>{dt(),gt&&gt()})};rt?rt(j,dt,Tt):Tt()}else s(j,O,B)},q=(D,O,B,H=!1,z=!1)=>{const{type:j,props:Q,ref:K,children:G,dynamicChildren:W,shapeFlag:ct,patchFlag:X,dirs:rt,cacheIndex:gt}=D;if(X===-2&&(z=!1),K!=null&&(ps(),Ao(K,null,B,D,!0),gs()),gt!=null&&(O.renderCache[gt]=void 0),ct&256){O.ctx.deactivate(D);return}const dt=ct&1&&rt,Tt=!So(D);let Ot;if(Tt&&(Ot=Q&&Q.onVnodeBeforeUnmount)&&Cn(Ot,O,D),ct&6)St(D.component,B,H);else{if(ct&128){D.suspense.unmount(B,H);return}dt&&yi(D,null,O,"beforeUnmount"),ct&64?D.type.remove(D,O,B,Sn,H):W&&!W.hasOnce&&(j!==rn||X>0&&X&64)?At(W,O,B,!1,!0):(j===rn&&X&384||!z&&ct&16)&&At(G,O,B),H&&Z(D)}(Tt&&(Ot=Q&&Q.onVnodeUnmounted)||dt)&&nn(()=>{Ot&&Cn(Ot,O,D),dt&&yi(D,null,O,"unmounted")},B)},Z=D=>{const{type:O,el:B,anchor:H,transition:z}=D;if(O===rn){Ft(B,H);return}if(O===vl){k(D);return}const j=()=>{i(B),z&&!z.persisted&&z.afterLeave&&z.afterLeave()};if(D.shapeFlag&1&&z&&!z.persisted){const{leave:Q,delayLeave:K}=z,G=()=>Q(B,j);K?K(D.el,j,G):G()}else j()},Ft=(D,O)=>{let B;for(;D!==O;)B=f(D),i(D),D=B;i(O)},St=(D,O,B)=>{const{bum:H,scope:z,job:j,subTree:Q,um:K,m:G,a:W,parent:ct,slots:{__:X}}=D;og(G),og(W),H&&yl(H),ct&&pt(X)&&X.forEach(rt=>{ct.renderCache[rt]=void 0}),z.stop(),j&&(j.flags|=8,q(Q,D,O,B)),K&&nn(K,O),nn(()=>{D.isUnmounted=!0},O),O&&O.pendingBranch&&!O.isUnmounted&&D.asyncDep&&!D.asyncResolved&&D.suspenseId===O.pendingId&&(O.deps--,O.deps===0&&O.resolve())},At=(D,O,B,H=!1,z=!1,j=0)=>{for(let Q=j;Q<D.length;Q++)q(D[Q],O,B,H,z)},ue=D=>{if(D.shapeFlag&6)return ue(D.component.subTree);if(D.shapeFlag&128)return D.suspense.next();const O=f(D.anchor||D.el),B=O&&O[kT];return B?f(B):O};let yn=!1;const Da=(D,O,B)=>{D==null?O._vnode&&q(O._vnode,null,null,!0):y(O._vnode||null,D,O,null,null,null,B),O._vnode=D,yn||(yn=!0,Zp(),eb(),yn=!1)},Sn={p:y,um:q,m:it,r:Z,mt:yt,mc:b,pc:at,pbc:C,n:ue,o:n};return{render:Da,hydrate:void 0,createApp:eE(Da)}}function Lu({type:n,props:t},e){return e==="svg"&&n==="foreignObject"||e==="mathml"&&n==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:e}function bi({effect:n,job:t},e){e?(n.flags|=32,t.flags|=4):(n.flags&=-33,t.flags&=-5)}function hE(n,t){return(!n||n&&!n.pendingBranch)&&t&&!t.persisted}function yb(n,t,e=!1){const s=n.children,i=t.children;if(pt(s)&&pt(i))for(let r=0;r<s.length;r++){const o=s[r];let a=i[r];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=i[r]=Vs(i[r]),a.el=o.el),!e&&a.patchFlag!==-2&&yb(o,a)),a.type===Oc&&(a.el=o.el),a.type===ti&&!a.el&&(a.el=o.el)}}function dE(n){const t=n.slice(),e=[0];let s,i,r,o,a;const l=n.length;for(s=0;s<l;s++){const c=n[s];if(c!==0){if(i=e[e.length-1],n[i]<c){t[s]=i,e.push(s);continue}for(r=0,o=e.length-1;r<o;)a=r+o>>1,n[e[a]]<c?r=a+1:o=a;c<n[e[r]]&&(r>0&&(t[s]=e[r-1]),e[r]=s)}}for(r=e.length,o=e[r-1];r-- >0;)e[r]=o,o=t[o];return e}function bb(n){const t=n.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:bb(t)}function og(n){if(n)for(let t=0;t<n.length;t++)n[t].flags|=8}const fE=Symbol.for("v-scx"),pE=()=>bl(fE);function Po(n,t,e){return vb(n,t,e)}function vb(n,t,e=qt){const{immediate:s,deep:i,flush:r,once:o}=e,a=Ke({},e),l=t&&s||!t&&r!=="post";let c;if(Go){if(r==="sync"){const g=pE();c=g.__watcherHandles||(g.__watcherHandles=[])}else if(!l){const g=()=>{};return g.stop=Vn,g.resume=Vn,g.pause=Vn,g}}const h=Fe;a.call=(g,_,y)=>Wn(g,h,_,y);let d=!1;r==="post"?a.scheduler=g=>{nn(g,h&&h.suspense)}:r!=="sync"&&(d=!0,a.scheduler=(g,_)=>{_?g():Td(g)}),a.augmentJob=g=>{t&&(g.flags|=4),d&&(g.flags|=2,h&&(g.id=h.uid,g.i=h))};const f=AT(n,t,a);return Go&&(c?c.push(f):l&&f()),f}function gE(n,t,e){const s=this.proxy,i=pe(n)?n.includes(".")?wb(s,n):()=>s[n]:n.bind(s,s);let r;It(t)?r=t:(r=t.handler,e=t);const o=pa(this),a=vb(i,r.bind(s),e);return o(),a}function wb(n,t){const e=t.split(".");return()=>{let s=n;for(let i=0;i<e.length&&s;i++)s=s[e[i]];return s}}const mE=(n,t)=>t==="modelValue"||t==="model-value"?n.modelModifiers:n[`${t}Modifiers`]||n[`${_n(t)}Modifiers`]||n[`${Hi(t)}Modifiers`];function _E(n,t,...e){if(n.isUnmounted)return;const s=n.vnode.props||qt;let i=e;const r=t.startsWith("update:"),o=r&&mE(s,t.slice(7));o&&(o.trim&&(i=e.map(h=>pe(h)?h.trim():h)),o.number&&(i=e.map(Fl)));let a,l=s[a=Pu(t)]||s[a=Pu(_n(t))];!l&&r&&(l=s[a=Pu(Hi(t))]),l&&Wn(l,n,6,i);const c=s[a+"Once"];if(c){if(!n.emitted)n.emitted={};else if(n.emitted[a])return;n.emitted[a]=!0,Wn(c,n,6,i)}}function xb(n,t,e=!1){const s=t.emitsCache,i=s.get(n);if(i!==void 0)return i;const r=n.emits;let o={},a=!1;if(!It(n)){const l=c=>{const h=xb(c,t,!0);h&&(a=!0,Ke(o,h))};!e&&t.mixins.length&&t.mixins.forEach(l),n.extends&&l(n.extends),n.mixins&&n.mixins.forEach(l)}return!r&&!a?(Qt(n)&&s.set(n,null),null):(pt(r)?r.forEach(l=>o[l]=null):Ke(o,r),Qt(n)&&s.set(n,o),o)}function Mc(n,t){return!n||!xc(t)?!1:(t=t.slice(2).replace(/Once$/,""),$t(n,t[0].toLowerCase()+t.slice(1))||$t(n,Hi(t))||$t(n,t))}function ag(n){const{type:t,vnode:e,proxy:s,withProxy:i,propsOptions:[r],slots:o,attrs:a,emit:l,render:c,renderCache:h,props:d,data:f,setupState:g,ctx:_,inheritAttrs:y}=n,w=zl(n);let E,S;try{if(e.shapeFlag&4){const k=i||s,R=k;E=Mn(c.call(R,k,h,d,g,f,_)),S=a}else{const k=t;E=Mn(k.length>1?k(d,{attrs:a,slots:o,emit:l}):k(d,null)),S=t.props?a:yE(a)}}catch(k){Ro.length=0,Pc(k,n,1),E=qe(ti)}let A=E;if(S&&y!==!1){const k=Object.keys(S),{shapeFlag:R}=A;k.length&&R&7&&(r&&k.some(hd)&&(S=bE(S,r)),A=vr(A,S,!1,!0))}return e.dirs&&(A=vr(A,null,!1,!0),A.dirs=A.dirs?A.dirs.concat(e.dirs):e.dirs),e.transition&&Ed(A,e.transition),E=A,zl(w),E}const yE=n=>{let t;for(const e in n)(e==="class"||e==="style"||xc(e))&&((t||(t={}))[e]=n[e]);return t},bE=(n,t)=>{const e={};for(const s in n)(!hd(s)||!(s.slice(9)in t))&&(e[s]=n[s]);return e};function vE(n,t,e){const{props:s,children:i,component:r}=n,{props:o,children:a,patchFlag:l}=t,c=r.emitsOptions;if(t.dirs||t.transition)return!0;if(e&&l>=0){if(l&1024)return!0;if(l&16)return s?lg(s,o,c):!!o;if(l&8){const h=t.dynamicProps;for(let d=0;d<h.length;d++){const f=h[d];if(o[f]!==s[f]&&!Mc(c,f))return!0}}}else return(i||a)&&(!a||!a.$stable)?!0:s===o?!1:s?o?lg(s,o,c):!0:!!o;return!1}function lg(n,t,e){const s=Object.keys(t);if(s.length!==Object.keys(n).length)return!0;for(let i=0;i<s.length;i++){const r=s[i];if(t[r]!==n[r]&&!Mc(e,r))return!0}return!1}function wE({vnode:n,parent:t},e){for(;t;){const s=t.subTree;if(s.suspense&&s.suspense.activeBranch===n&&(s.el=n.el),s===n)(n=t.vnode).el=e,t=t.parent;else break}}const Tb=n=>n.__isSuspense;function xE(n,t){t&&t.pendingBranch?pt(n)?t.effects.push(...n):t.effects.push(n):PT(n)}const rn=Symbol.for("v-fgt"),Oc=Symbol.for("v-txt"),ti=Symbol.for("v-cmt"),vl=Symbol.for("v-stc"),Ro=[];let ln=null;function nt(n=!1){Ro.push(ln=n?null:[])}function TE(){Ro.pop(),ln=Ro[Ro.length-1]||null}let qo=1;function cg(n,t=!1){qo+=n,n<0&&ln&&t&&(ln.hasOnce=!0)}function Eb(n){return n.dynamicChildren=qo>0?ln||cr:null,TE(),qo>0&&ln&&ln.push(n),n}function ht(n,t,e,s,i,r){return Eb(N(n,t,e,s,i,r,!0))}function wn(n,t,e,s,i){return Eb(qe(n,t,e,s,i,!0))}function Hl(n){return n?n.__v_isVNode===!0:!1}function io(n,t){return n.type===t.type&&n.key===t.key}const Ib=({key:n})=>n??null,wl=({ref:n,ref_key:t,ref_for:e})=>(typeof n=="number"&&(n=""+n),n!=null?pe(n)||Ue(n)||It(n)?{i:an,r:n,k:t,f:!!e}:n:null);function N(n,t=null,e=null,s=0,i=null,r=n===rn?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:n,props:t,key:t&&Ib(t),ref:t&&wl(t),scopeId:sb,slotScopeIds:null,children:e,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:s,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:an};return a?(Sd(l,e),r&128&&n.normalize(l)):e&&(l.shapeFlag|=pe(e)?8:16),qo>0&&!o&&ln&&(l.patchFlag>0||r&6)&&l.patchFlag!==32&&ln.push(l),l}const qe=EE;function EE(n,t=null,e=null,s=0,i=null,r=!1){if((!n||n===qT)&&(n=ti),Hl(n)){const a=vr(n,t,!0);return e&&Sd(a,e),qo>0&&!r&&ln&&(a.shapeFlag&6?ln[ln.indexOf(n)]=a:ln.push(a)),a.patchFlag=-2,a}if(VE(n)&&(n=n.__vccOpts),t){t=IE(t);let{class:a,style:l}=t;a&&!pe(a)&&(t.class=et(a)),Qt(l)&&(xd(l)&&!pt(l)&&(l=Ke({},l)),t.style=pd(l))}const o=pe(n)?1:Tb(n)?128:DT(n)?64:Qt(n)?4:It(n)?2:0;return N(n,t,e,s,i,o,r,!0)}function IE(n){return n?xd(n)||db(n)?Ke({},n):n:null}function vr(n,t,e=!1,s=!1){const{props:i,ref:r,patchFlag:o,children:a,transition:l}=n,c=t?AE(i||{},t):i,h={__v_isVNode:!0,__v_skip:!0,type:n.type,props:c,key:c&&Ib(c),ref:t&&t.ref?e&&r?pt(r)?r.concat(wl(t)):[r,wl(t)]:wl(t):r,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:a,target:n.target,targetStart:n.targetStart,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:t&&n.type!==rn?o===-1?16:o|16:o,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:l,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&vr(n.ssContent),ssFallback:n.ssFallback&&vr(n.ssFallback),placeholder:n.placeholder,el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce};return l&&s&&Ed(h,l.clone(h)),h}function Ln(n=" ",t=0){return qe(Oc,null,n,t)}function ug(n,t){const e=qe(vl,null,n);return e.staticCount=t,e}function ye(n="",t=!1){return t?(nt(),wn(ti,null,n)):qe(ti,null,n)}function Mn(n){return n==null||typeof n=="boolean"?qe(ti):pt(n)?qe(rn,null,n.slice()):Hl(n)?Vs(n):qe(Oc,null,String(n))}function Vs(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:vr(n)}function Sd(n,t){let e=0;const{shapeFlag:s}=n;if(t==null)t=null;else if(pt(t))e=16;else if(typeof t=="object")if(s&65){const i=t.default;i&&(i._c&&(i._d=!1),Sd(n,i()),i._c&&(i._d=!0));return}else{e=32;const i=t._;!i&&!db(t)?t._ctx=an:i===3&&an&&(an.slots._===1?t._=1:(t._=2,n.patchFlag|=1024))}else It(t)?(t={default:t,_ctx:an},e=32):(t=String(t),s&64?(e=16,t=[Ln(t)]):e=8);n.children=t,n.shapeFlag|=e}function AE(...n){const t={};for(let e=0;e<n.length;e++){const s=n[e];for(const i in s)if(i==="class")t.class!==s.class&&(t.class=et([t.class,s.class]));else if(i==="style")t.style=pd([t.style,s.style]);else if(xc(i)){const r=t[i],o=s[i];o&&r!==o&&!(pt(r)&&r.includes(o))&&(t[i]=r?[].concat(r,o):o)}else i!==""&&(t[i]=s[i])}return t}function Cn(n,t,e,s=null){Wn(n,t,7,[e,s])}const SE=cb();let CE=0;function PE(n,t,e){const s=n.type,i=(t?t.appContext:n.appContext)||SE,r={uid:CE++,vnode:n,type:s,parent:t,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Jx(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(i.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:pb(s,i),emitsOptions:xb(s,i),emit:null,emitted:null,propsDefaults:qt,inheritAttrs:s.inheritAttrs,ctx:qt,data:qt,props:qt,attrs:qt,slots:qt,refs:qt,setupState:qt,setupContext:null,suspense:e,suspenseId:e?e.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=t?t.root:r,r.emit=_E.bind(null,r),n.ce&&n.ce(r),r}let Fe=null;const RE=()=>Fe||an;let Wl,xh;{const n=Ac(),t=(e,s)=>{let i;return(i=n[e])||(i=n[e]=[]),i.push(s),r=>{i.length>1?i.forEach(o=>o(r)):i[0](r)}};Wl=t("__VUE_INSTANCE_SETTERS__",e=>Fe=e),xh=t("__VUE_SSR_SETTERS__",e=>Go=e)}const pa=n=>{const t=Fe;return Wl(n),n.scope.on(),()=>{n.scope.off(),Wl(t)}},hg=()=>{Fe&&Fe.scope.off(),Wl(null)};function Ab(n){return n.vnode.shapeFlag&4}let Go=!1;function kE(n,t=!1,e=!1){t&&xh(t);const{props:s,children:i}=n.vnode,r=Ab(n);sE(n,s,r,t),aE(n,i,e||t);const o=r?DE(n,t):void 0;return t&&xh(!1),o}function DE(n,t){const e=n.type;n.accessCache=Object.create(null),n.proxy=new Proxy(n.ctx,KT);const{setup:s}=e;if(s){ps();const i=n.setupContext=s.length>1?OE(n):null,r=pa(n),o=fa(s,n,0,[n.props,i]),a=Ry(o);if(gs(),r(),(a||n.sp)&&!So(n)&&ib(n),a){if(o.then(hg,hg),t)return o.then(l=>{dg(n,l)}).catch(l=>{Pc(l,n,0)});n.asyncDep=o}else dg(n,o)}else Sb(n)}function dg(n,t,e){It(t)?n.type.__ssrInlineRender?n.ssrRender=t:n.render=t:Qt(t)&&(n.setupState=Qy(t)),Sb(n)}function Sb(n,t,e){const s=n.type;n.render||(n.render=s.render||Vn);{const i=pa(n);ps();try{YT(n)}finally{gs(),i()}}}const ME={get(n,t){return Ve(n,"get",""),n[t]}};function OE(n){const t=e=>{n.exposed=e||{}};return{attrs:new Proxy(n.attrs,ME),slots:n.slots,emit:n.emit,expose:t}}function Lc(n){return n.exposed?n.exposeProxy||(n.exposeProxy=new Proxy(Qy(bT(n.exposed)),{get(t,e){if(e in t)return t[e];if(e in Co)return Co[e](n)},has(t,e){return e in t||e in Co}})):n.proxy}function LE(n,t=!0){return It(n)?n.displayName||n.name:n.name||t&&n.__name}function VE(n){return It(n)&&"__vccOpts"in n}const hs=(n,t)=>ET(n,t,Go);function NE(n,t,e){const s=arguments.length;return s===2?Qt(t)&&!pt(t)?Hl(t)?qe(n,null,[t]):qe(n,t):qe(n,null,t):(s>3?e=Array.prototype.slice.call(arguments,2):s===3&&Hl(e)&&(e=[e]),qe(n,t,e))}const FE="3.5.18";/**
* @vue/runtime-dom v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Th;const fg=typeof window<"u"&&window.trustedTypes;if(fg)try{Th=fg.createPolicy("vue",{createHTML:n=>n})}catch{}const Cb=Th?n=>Th.createHTML(n):n=>n,BE="http://www.w3.org/2000/svg",UE="http://www.w3.org/1998/Math/MathML",es=typeof document<"u"?document:null,pg=es&&es.createElement("template"),$E={insert:(n,t,e)=>{t.insertBefore(n,e||null)},remove:n=>{const t=n.parentNode;t&&t.removeChild(n)},createElement:(n,t,e,s)=>{const i=t==="svg"?es.createElementNS(BE,n):t==="mathml"?es.createElementNS(UE,n):e?es.createElement(n,{is:e}):es.createElement(n);return n==="select"&&s&&s.multiple!=null&&i.setAttribute("multiple",s.multiple),i},createText:n=>es.createTextNode(n),createComment:n=>es.createComment(n),setText:(n,t)=>{n.nodeValue=t},setElementText:(n,t)=>{n.textContent=t},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>es.querySelector(n),setScopeId(n,t){n.setAttribute(t,"")},insertStaticContent(n,t,e,s,i,r){const o=e?e.previousSibling:t.lastChild;if(i&&(i===r||i.nextSibling))for(;t.insertBefore(i.cloneNode(!0),e),!(i===r||!(i=i.nextSibling)););else{pg.innerHTML=Cb(s==="svg"?`<svg>${n}</svg>`:s==="mathml"?`<math>${n}</math>`:n);const a=pg.content;if(s==="svg"||s==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}t.insertBefore(a,e)}return[o?o.nextSibling:t.firstChild,e?e.previousSibling:t.lastChild]}},zE=Symbol("_vtc");function jE(n,t,e){const s=n[zE];s&&(t=(t?[t,...s]:[...s]).join(" ")),t==null?n.removeAttribute("class"):e?n.setAttribute("class",t):n.className=t}const gg=Symbol("_vod"),HE=Symbol("_vsh"),WE=Symbol(""),qE=/(^|;)\s*display\s*:/;function GE(n,t,e){const s=n.style,i=pe(e);let r=!1;if(e&&!i){if(t)if(pe(t))for(const o of t.split(";")){const a=o.slice(0,o.indexOf(":")).trim();e[a]==null&&xl(s,a,"")}else for(const o in t)e[o]==null&&xl(s,o,"");for(const o in e)o==="display"&&(r=!0),xl(s,o,e[o])}else if(i){if(t!==e){const o=s[WE];o&&(e+=";"+o),s.cssText=e,r=qE.test(e)}}else t&&n.removeAttribute("style");gg in n&&(n[gg]=r?s.display:"",n[HE]&&(s.display="none"))}const mg=/\s*!important$/;function xl(n,t,e){if(pt(e))e.forEach(s=>xl(n,t,s));else if(e==null&&(e=""),t.startsWith("--"))n.setProperty(t,e);else{const s=KE(n,t);mg.test(e)?n.setProperty(Hi(s),e.replace(mg,""),"important"):n[s]=e}}const _g=["Webkit","Moz","ms"],Vu={};function KE(n,t){const e=Vu[t];if(e)return e;let s=_n(t);if(s!=="filter"&&s in n)return Vu[t]=s;s=Ic(s);for(let i=0;i<_g.length;i++){const r=_g[i]+s;if(r in n)return Vu[t]=r}return t}const yg="http://www.w3.org/1999/xlink";function bg(n,t,e,s,i,r=Yx(t)){s&&t.startsWith("xlink:")?e==null?n.removeAttributeNS(yg,t.slice(6,t.length)):n.setAttributeNS(yg,t,e):e==null||r&&!My(e)?n.removeAttribute(t):n.setAttribute(t,r?"":Hn(e)?String(e):e)}function vg(n,t,e,s,i){if(t==="innerHTML"||t==="textContent"){e!=null&&(n[t]=t==="innerHTML"?Cb(e):e);return}const r=n.tagName;if(t==="value"&&r!=="PROGRESS"&&!r.includes("-")){const a=r==="OPTION"?n.getAttribute("value")||"":n.value,l=e==null?n.type==="checkbox"?"on":"":String(e);(a!==l||!("_value"in n))&&(n.value=l),e==null&&n.removeAttribute(t),n._value=e;return}let o=!1;if(e===""||e==null){const a=typeof n[t];a==="boolean"?e=My(e):e==null&&a==="string"?(e="",o=!0):a==="number"&&(e=0,o=!0)}try{n[t]=e}catch{}o&&n.removeAttribute(i||t)}function Ci(n,t,e,s){n.addEventListener(t,e,s)}function YE(n,t,e,s){n.removeEventListener(t,e,s)}const wg=Symbol("_vei");function XE(n,t,e,s,i=null){const r=n[wg]||(n[wg]={}),o=r[t];if(s&&o)o.value=s;else{const[a,l]=QE(t);if(s){const c=r[t]=tI(s,i);Ci(n,a,c,l)}else o&&(YE(n,a,o,l),r[t]=void 0)}}const xg=/(?:Once|Passive|Capture)$/;function QE(n){let t;if(xg.test(n)){t={};let s;for(;s=n.match(xg);)n=n.slice(0,n.length-s[0].length),t[s[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):Hi(n.slice(2)),t]}let Nu=0;const JE=Promise.resolve(),ZE=()=>Nu||(JE.then(()=>Nu=0),Nu=Date.now());function tI(n,t){const e=s=>{if(!s._vts)s._vts=Date.now();else if(s._vts<=e.attached)return;Wn(eI(s,e.value),t,5,[s])};return e.value=n,e.attached=ZE(),e}function eI(n,t){if(pt(t)){const e=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{e.call(n),n._stopped=!0},t.map(s=>i=>!i._stopped&&s&&s(i))}else return t}const Tg=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)>96&&n.charCodeAt(2)<123,nI=(n,t,e,s,i,r)=>{const o=i==="svg";t==="class"?jE(n,s,o):t==="style"?GE(n,e,s):xc(t)?hd(t)||XE(n,t,e,s,r):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):sI(n,t,s,o))?(vg(n,t,s),!n.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&bg(n,t,s,o,r,t!=="value")):n._isVueCE&&(/[A-Z]/.test(t)||!pe(s))?vg(n,_n(t),s,r,t):(t==="true-value"?n._trueValue=s:t==="false-value"&&(n._falseValue=s),bg(n,t,s,o))};function sI(n,t,e,s){if(s)return!!(t==="innerHTML"||t==="textContent"||t in n&&Tg(t)&&It(e));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="autocorrect"||t==="form"||t==="list"&&n.tagName==="INPUT"||t==="type"&&n.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const i=n.tagName;if(i==="IMG"||i==="VIDEO"||i==="CANVAS"||i==="SOURCE")return!1}return Tg(t)&&pe(e)?!1:t in n}const ql=n=>{const t=n.props["onUpdate:modelValue"]||!1;return pt(t)?e=>yl(t,e):t};function iI(n){n.target.composing=!0}function Eg(n){const t=n.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const pr=Symbol("_assign"),rI={created(n,{modifiers:{lazy:t,trim:e,number:s}},i){n[pr]=ql(i);const r=s||i.props&&i.props.type==="number";Ci(n,t?"change":"input",o=>{if(o.target.composing)return;let a=n.value;e&&(a=a.trim()),r&&(a=Fl(a)),n[pr](a)}),e&&Ci(n,"change",()=>{n.value=n.value.trim()}),t||(Ci(n,"compositionstart",iI),Ci(n,"compositionend",Eg),Ci(n,"change",Eg))},mounted(n,{value:t}){n.value=t??""},beforeUpdate(n,{value:t,oldValue:e,modifiers:{lazy:s,trim:i,number:r}},o){if(n[pr]=ql(o),n.composing)return;const a=(r||n.type==="number")&&!/^0\d/.test(n.value)?Fl(n.value):n.value,l=t??"";a!==l&&(document.activeElement===n&&n.type!=="range"&&(s&&t===e||i&&n.value.trim()===l)||(n.value=l))}},Ja={deep:!0,created(n,{value:t,modifiers:{number:e}},s){const i=Tc(t);Ci(n,"change",()=>{const r=Array.prototype.filter.call(n.options,o=>o.selected).map(o=>e?Fl(Gl(o)):Gl(o));n[pr](n.multiple?i?new Set(r):r:r[0]),n._assigning=!0,Zy(()=>{n._assigning=!1})}),n[pr]=ql(s)},mounted(n,{value:t}){Ig(n,t)},beforeUpdate(n,t,e){n[pr]=ql(e)},updated(n,{value:t}){n._assigning||Ig(n,t)}};function Ig(n,t){const e=n.multiple,s=pt(t);if(!(e&&!s&&!Tc(t))){for(let i=0,r=n.options.length;i<r;i++){const o=n.options[i],a=Gl(o);if(e)if(s){const l=typeof a;l==="string"||l==="number"?o.selected=t.some(c=>String(c)===String(a)):o.selected=Qx(t,a)>-1}else o.selected=t.has(a);else if(Sc(Gl(o),t)){n.selectedIndex!==i&&(n.selectedIndex=i);return}}!e&&n.selectedIndex!==-1&&(n.selectedIndex=-1)}}function Gl(n){return"_value"in n?n._value:n.value}const oI=["ctrl","shift","alt","meta"],aI={stop:n=>n.stopPropagation(),prevent:n=>n.preventDefault(),self:n=>n.target!==n.currentTarget,ctrl:n=>!n.ctrlKey,shift:n=>!n.shiftKey,alt:n=>!n.altKey,meta:n=>!n.metaKey,left:n=>"button"in n&&n.button!==0,middle:n=>"button"in n&&n.button!==1,right:n=>"button"in n&&n.button!==2,exact:(n,t)=>oI.some(e=>n[`${e}Key`]&&!t.includes(e))},Pb=(n,t)=>{const e=n._withMods||(n._withMods={}),s=t.join(".");return e[s]||(e[s]=(i,...r)=>{for(let o=0;o<t.length;o++){const a=aI[t[o]];if(a&&a(i,t))return}return n(i,...r)})},lI=Ke({patchProp:nI},$E);let Ag;function cI(){return Ag||(Ag=cE(lI))}const uI=(...n)=>{const t=cI().createApp(...n),{mount:e}=t;return t.mount=s=>{const i=dI(s);if(!i)return;const r=t._component;!It(r)&&!r.render&&!r.template&&(r.template=i.innerHTML),i.nodeType===1&&(i.textContent="");const o=e(i,!1,hI(i));return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),o},t};function hI(n){if(n instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&n instanceof MathMLElement)return"mathml"}function dI(n){return pe(n)?document.querySelector(n):n}const fI=()=>{};var Sg={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rb=function(n){const t=[];let e=0;for(let s=0;s<n.length;s++){let i=n.charCodeAt(s);i<128?t[e++]=i:i<2048?(t[e++]=i>>6|192,t[e++]=i&63|128):(i&64512)===55296&&s+1<n.length&&(n.charCodeAt(s+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++s)&1023),t[e++]=i>>18|240,t[e++]=i>>12&63|128,t[e++]=i>>6&63|128,t[e++]=i&63|128):(t[e++]=i>>12|224,t[e++]=i>>6&63|128,t[e++]=i&63|128)}return t},pI=function(n){const t=[];let e=0,s=0;for(;e<n.length;){const i=n[e++];if(i<128)t[s++]=String.fromCharCode(i);else if(i>191&&i<224){const r=n[e++];t[s++]=String.fromCharCode((i&31)<<6|r&63)}else if(i>239&&i<365){const r=n[e++],o=n[e++],a=n[e++],l=((i&7)<<18|(r&63)<<12|(o&63)<<6|a&63)-65536;t[s++]=String.fromCharCode(55296+(l>>10)),t[s++]=String.fromCharCode(56320+(l&1023))}else{const r=n[e++],o=n[e++];t[s++]=String.fromCharCode((i&15)<<12|(r&63)<<6|o&63)}}return t.join("")},kb={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,t){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const e=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let i=0;i<n.length;i+=3){const r=n[i],o=i+1<n.length,a=o?n[i+1]:0,l=i+2<n.length,c=l?n[i+2]:0,h=r>>2,d=(r&3)<<4|a>>4;let f=(a&15)<<2|c>>6,g=c&63;l||(g=64,o||(f=64)),s.push(e[h],e[d],e[f],e[g])}return s.join("")},encodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(n):this.encodeByteArray(Rb(n),t)},decodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(n):pI(this.decodeStringToByteArray(n,t))},decodeStringToByteArray(n,t){this.init_();const e=t?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let i=0;i<n.length;){const r=e[n.charAt(i++)],a=i<n.length?e[n.charAt(i)]:0;++i;const c=i<n.length?e[n.charAt(i)]:64;++i;const d=i<n.length?e[n.charAt(i)]:64;if(++i,r==null||a==null||c==null||d==null)throw new gI;const f=r<<2|a>>4;if(s.push(f),c!==64){const g=a<<4&240|c>>2;if(s.push(g),d!==64){const _=c<<6&192|d;s.push(_)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class gI extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const mI=function(n){const t=Rb(n);return kb.encodeByteArray(t,!0)},Kl=function(n){return mI(n).replace(/\./g,"")},Db=function(n){try{return kb.decodeString(n,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _I(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yI=()=>_I().__FIREBASE_DEFAULTS__,bI=()=>{if(typeof process>"u"||typeof Sg>"u")return;const n=Sg.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},vI=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=n&&Db(n[1]);return t&&JSON.parse(t)},Vc=()=>{try{return fI()||yI()||bI()||vI()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Mb=n=>Vc()?.emulatorHosts?.[n],wI=n=>{const t=Mb(n);if(!t)return;const e=t.lastIndexOf(":");if(e<=0||e+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const s=parseInt(t.substring(e+1),10);return t[0]==="["?[t.substring(1,e-1),s]:[t.substring(0,e),s]},Ob=()=>Vc()?.config,Lb=n=>Vc()?.[`_${n}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xI{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,s)=>{e?this.reject(e):this.resolve(s),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(e):t(e,s))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dr(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Vb(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TI(n,t){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const e={alg:"none",type:"JWT"},s=t||"demo-project",i=n.iat||0,r=n.sub||n.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${s}`,aud:s,iat:i,exp:i+3600,auth_time:i,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Kl(JSON.stringify(e)),Kl(JSON.stringify(o)),""].join(".")}const ko={};function EI(){const n={prod:[],emulator:[]};for(const t of Object.keys(ko))ko[t]?n.emulator.push(t):n.prod.push(t);return n}function II(n){let t=document.getElementById(n),e=!1;return t||(t=document.createElement("div"),t.setAttribute("id",n),e=!0),{created:e,element:t}}let Cg=!1;function Nb(n,t){if(typeof window>"u"||typeof document>"u"||!Dr(window.location.host)||ko[n]===t||ko[n]||Cg)return;ko[n]=t;function e(f){return`__firebase__banner__${f}`}const s="__firebase__banner",r=EI().prod.length>0;function o(){const f=document.getElementById(s);f&&f.remove()}function a(f){f.style.display="flex",f.style.background="#7faaf0",f.style.position="fixed",f.style.bottom="5px",f.style.left="5px",f.style.padding=".5em",f.style.borderRadius="5px",f.style.alignItems="center"}function l(f,g){f.setAttribute("width","24"),f.setAttribute("id",g),f.setAttribute("height","24"),f.setAttribute("viewBox","0 0 24 24"),f.setAttribute("fill","none"),f.style.marginLeft="-6px"}function c(){const f=document.createElement("span");return f.style.cursor="pointer",f.style.marginLeft="16px",f.style.fontSize="24px",f.innerHTML=" &times;",f.onclick=()=>{Cg=!0,o()},f}function h(f,g){f.setAttribute("id",g),f.innerText="Learn more",f.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",f.setAttribute("target","__blank"),f.style.paddingLeft="5px",f.style.textDecoration="underline"}function d(){const f=II(s),g=e("text"),_=document.getElementById(g)||document.createElement("span"),y=e("learnmore"),w=document.getElementById(y)||document.createElement("a"),E=e("preprendIcon"),S=document.getElementById(E)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(f.created){const A=f.element;a(A),h(w,y);const k=c();l(S,E),A.append(S,_,w,k),document.body.appendChild(A)}r?(_.innerText="Preview backend disconnected.",S.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(S.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,_.innerText="Preview backend running in this workspace."),_.setAttribute("id",g)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",d):d()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $e(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function AI(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test($e())}function SI(){const n=Vc()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function CI(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function PI(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function RI(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function kI(){const n=$e();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function DI(){return!SI()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function MI(){try{return typeof indexedDB=="object"}catch{return!1}}function OI(){return new Promise((n,t)=>{try{let e=!0;const s="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(s);i.onsuccess=()=>{i.result.close(),e||self.indexedDB.deleteDatabase(s),n(!0)},i.onupgradeneeded=()=>{e=!1},i.onerror=()=>{t(i.error?.message||"")}}catch(e){t(e)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LI="FirebaseError";class Es extends Error{constructor(t,e,s){super(e),this.code=t,this.customData=s,this.name=LI,Object.setPrototypeOf(this,Es.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ga.prototype.create)}}class ga{constructor(t,e,s){this.service=t,this.serviceName=e,this.errors=s}create(t,...e){const s=e[0]||{},i=`${this.service}/${t}`,r=this.errors[t],o=r?VI(r,s):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new Es(i,a,s)}}function VI(n,t){return n.replace(NI,(e,s)=>{const i=t[s];return i!=null?String(i):`<${s}?>`})}const NI=/\{\$([^}]+)}/g;function FI(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}function Ni(n,t){if(n===t)return!0;const e=Object.keys(n),s=Object.keys(t);for(const i of e){if(!s.includes(i))return!1;const r=n[i],o=t[i];if(Pg(r)&&Pg(o)){if(!Ni(r,o))return!1}else if(r!==o)return!1}for(const i of s)if(!e.includes(i))return!1;return!0}function Pg(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ma(n){const t=[];for(const[e,s]of Object.entries(n))Array.isArray(s)?s.forEach(i=>{t.push(encodeURIComponent(e)+"="+encodeURIComponent(i))}):t.push(encodeURIComponent(e)+"="+encodeURIComponent(s));return t.length?"&"+t.join("&"):""}function BI(n,t){const e=new UI(n,t);return e.subscribe.bind(e)}class UI{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(()=>{t(this)}).catch(s=>{this.error(s)})}next(t){this.forEachObserver(e=>{e.next(t)})}error(t){this.forEachObserver(e=>{e.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,e,s){let i;if(t===void 0&&e===void 0&&s===void 0)throw new Error("Missing Observer.");$I(t,["next","error","complete"])?i=t:i={next:t,error:e,complete:s},i.next===void 0&&(i.next=Fu),i.error===void 0&&(i.error=Fu),i.complete===void 0&&(i.complete=Fu);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),r}unsubscribeOne(t){this.observers===void 0||this.observers[t]===void 0||(delete this.observers[t],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then(()=>{if(this.observers!==void 0&&this.observers[t]!==void 0)try{e(this.observers[t])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(t){this.finalized||(this.finalized=!0,t!==void 0&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function $I(n,t){if(typeof n!="object"||n===null)return!1;for(const e of t)if(e in n&&typeof n[e]=="function")return!0;return!1}function Fu(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Se(n){return n&&n._delegate?n._delegate:n}class Fi{constructor(t,e,s){this.name=t,this.instanceFactory=e,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ii="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zI{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const s=new xI;if(this.instancesDeferred.set(e,s),this.isInitialized(e)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:e});i&&s.resolve(i)}catch{}}return this.instancesDeferred.get(e).promise}getImmediate(t){const e=this.normalizeInstanceIdentifier(t?.identifier),s=t?.optional??!1;if(this.isInitialized(e)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:e})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(HI(t))try{this.getOrInitializeService({instanceIdentifier:Ii})}catch{}for(const[e,s]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(e);try{const r=this.getOrInitializeService({instanceIdentifier:i});s.resolve(r)}catch{}}}}clearInstance(t=Ii){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...t.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=Ii){return this.instances.has(t)}getOptions(t=Ii){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,s=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:s,options:e});for(const[r,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);s===a&&o.resolve(i)}return i}onInit(t,e){const s=this.normalizeInstanceIdentifier(e),i=this.onInitCallbacks.get(s)??new Set;i.add(t),this.onInitCallbacks.set(s,i);const r=this.instances.get(s);return r&&t(r,s),()=>{i.delete(t)}}invokeOnInitCallbacks(t,e){const s=this.onInitCallbacks.get(e);if(s)for(const i of s)try{i(t,e)}catch{}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let s=this.instances.get(t);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:jI(t),options:e}),this.instances.set(t,s),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(s,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,s)}catch{}return s||null}normalizeInstanceIdentifier(t=Ii){return this.component?this.component.multipleInstances?t:Ii:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function jI(n){return n===Ii?void 0:n}function HI(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WI{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new zI(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Pt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Pt||(Pt={}));const qI={debug:Pt.DEBUG,verbose:Pt.VERBOSE,info:Pt.INFO,warn:Pt.WARN,error:Pt.ERROR,silent:Pt.SILENT},GI=Pt.INFO,KI={[Pt.DEBUG]:"log",[Pt.VERBOSE]:"log",[Pt.INFO]:"info",[Pt.WARN]:"warn",[Pt.ERROR]:"error"},YI=(n,t,...e)=>{if(t<n.logLevel)return;const s=new Date().toISOString(),i=KI[t];if(i)console[i](`[${s}]  ${n.name}:`,...e);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class Cd{constructor(t){this.name=t,this._logLevel=GI,this._logHandler=YI,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Pt))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?qI[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,Pt.DEBUG,...t),this._logHandler(this,Pt.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,Pt.VERBOSE,...t),this._logHandler(this,Pt.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,Pt.INFO,...t),this._logHandler(this,Pt.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,Pt.WARN,...t),this._logHandler(this,Pt.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,Pt.ERROR,...t),this._logHandler(this,Pt.ERROR,...t)}}const XI=(n,t)=>t.some(e=>n instanceof e);let Rg,kg;function QI(){return Rg||(Rg=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function JI(){return kg||(kg=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Fb=new WeakMap,Eh=new WeakMap,Bb=new WeakMap,Bu=new WeakMap,Pd=new WeakMap;function ZI(n){const t=new Promise((e,s)=>{const i=()=>{n.removeEventListener("success",r),n.removeEventListener("error",o)},r=()=>{e(qs(n.result)),i()},o=()=>{s(n.error),i()};n.addEventListener("success",r),n.addEventListener("error",o)});return t.then(e=>{e instanceof IDBCursor&&Fb.set(e,n)}).catch(()=>{}),Pd.set(t,n),t}function tA(n){if(Eh.has(n))return;const t=new Promise((e,s)=>{const i=()=>{n.removeEventListener("complete",r),n.removeEventListener("error",o),n.removeEventListener("abort",o)},r=()=>{e(),i()},o=()=>{s(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",r),n.addEventListener("error",o),n.addEventListener("abort",o)});Eh.set(n,t)}let Ih={get(n,t,e){if(n instanceof IDBTransaction){if(t==="done")return Eh.get(n);if(t==="objectStoreNames")return n.objectStoreNames||Bb.get(n);if(t==="store")return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return qs(n[t])},set(n,t,e){return n[t]=e,!0},has(n,t){return n instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in n}};function eA(n){Ih=n(Ih)}function nA(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...e){const s=n.call(Uu(this),t,...e);return Bb.set(s,t.sort?t.sort():[t]),qs(s)}:JI().includes(n)?function(...t){return n.apply(Uu(this),t),qs(Fb.get(this))}:function(...t){return qs(n.apply(Uu(this),t))}}function sA(n){return typeof n=="function"?nA(n):(n instanceof IDBTransaction&&tA(n),XI(n,QI())?new Proxy(n,Ih):n)}function qs(n){if(n instanceof IDBRequest)return ZI(n);if(Bu.has(n))return Bu.get(n);const t=sA(n);return t!==n&&(Bu.set(n,t),Pd.set(t,n)),t}const Uu=n=>Pd.get(n);function iA(n,t,{blocked:e,upgrade:s,blocking:i,terminated:r}={}){const o=indexedDB.open(n,t),a=qs(o);return s&&o.addEventListener("upgradeneeded",l=>{s(qs(o.result),l.oldVersion,l.newVersion,qs(o.transaction),l)}),e&&o.addEventListener("blocked",l=>e(l.oldVersion,l.newVersion,l)),a.then(l=>{r&&l.addEventListener("close",()=>r()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const rA=["get","getKey","getAll","getAllKeys","count"],oA=["put","add","delete","clear"],$u=new Map;function Dg(n,t){if(!(n instanceof IDBDatabase&&!(t in n)&&typeof t=="string"))return;if($u.get(t))return $u.get(t);const e=t.replace(/FromIndex$/,""),s=t!==e,i=oA.includes(e);if(!(e in(s?IDBIndex:IDBObjectStore).prototype)||!(i||rA.includes(e)))return;const r=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let c=l.store;return s&&(c=c.index(a.shift())),(await Promise.all([c[e](...a),i&&l.done]))[0]};return $u.set(t,r),r}eA(n=>({...n,get:(t,e,s)=>Dg(t,e)||n.get(t,e,s),has:(t,e)=>!!Dg(t,e)||n.has(t,e)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aA{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(lA(e)){const s=e.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(e=>e).join(" ")}}function lA(n){return n.getComponent()?.type==="VERSION"}const Ah="@firebase/app",Mg="0.14.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ms=new Cd("@firebase/app"),cA="@firebase/app-compat",uA="@firebase/analytics-compat",hA="@firebase/analytics",dA="@firebase/app-check-compat",fA="@firebase/app-check",pA="@firebase/auth",gA="@firebase/auth-compat",mA="@firebase/database",_A="@firebase/data-connect",yA="@firebase/database-compat",bA="@firebase/functions",vA="@firebase/functions-compat",wA="@firebase/installations",xA="@firebase/installations-compat",TA="@firebase/messaging",EA="@firebase/messaging-compat",IA="@firebase/performance",AA="@firebase/performance-compat",SA="@firebase/remote-config",CA="@firebase/remote-config-compat",PA="@firebase/storage",RA="@firebase/storage-compat",kA="@firebase/firestore",DA="@firebase/ai",MA="@firebase/firestore-compat",OA="firebase",LA="12.0.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sh="[DEFAULT]",VA={[Ah]:"fire-core",[cA]:"fire-core-compat",[hA]:"fire-analytics",[uA]:"fire-analytics-compat",[fA]:"fire-app-check",[dA]:"fire-app-check-compat",[pA]:"fire-auth",[gA]:"fire-auth-compat",[mA]:"fire-rtdb",[_A]:"fire-data-connect",[yA]:"fire-rtdb-compat",[bA]:"fire-fn",[vA]:"fire-fn-compat",[wA]:"fire-iid",[xA]:"fire-iid-compat",[TA]:"fire-fcm",[EA]:"fire-fcm-compat",[IA]:"fire-perf",[AA]:"fire-perf-compat",[SA]:"fire-rc",[CA]:"fire-rc-compat",[PA]:"fire-gcs",[RA]:"fire-gcs-compat",[kA]:"fire-fst",[MA]:"fire-fst-compat",[DA]:"fire-vertex","fire-js":"fire-js",[OA]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yl=new Map,NA=new Map,Ch=new Map;function Og(n,t){try{n.container.addComponent(t)}catch(e){ms.debug(`Component ${t.name} failed to register with FirebaseApp ${n.name}`,e)}}function wr(n){const t=n.name;if(Ch.has(t))return ms.debug(`There were multiple attempts to register component ${t}.`),!1;Ch.set(t,n);for(const e of Yl.values())Og(e,n);for(const e of NA.values())Og(e,n);return!0}function Rd(n,t){const e=n.container.getProvider("heartbeat").getImmediate({optional:!0});return e&&e.triggerHeartbeat(),n.container.getProvider(t)}function on(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FA={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Gs=new ga("app","Firebase",FA);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BA{constructor(t,e,s){this._isDeleted=!1,this._options={...t},this._config={...e},this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new Fi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw Gs.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mr=LA;function Ub(n,t={}){let e=n;typeof t!="object"&&(t={name:t});const s={name:Sh,automaticDataCollectionEnabled:!0,...t},i=s.name;if(typeof i!="string"||!i)throw Gs.create("bad-app-name",{appName:String(i)});if(e||(e=Ob()),!e)throw Gs.create("no-options");const r=Yl.get(i);if(r){if(Ni(e,r.options)&&Ni(s,r.config))return r;throw Gs.create("duplicate-app",{appName:i})}const o=new WI(i);for(const l of Ch.values())o.addComponent(l);const a=new BA(e,s,o);return Yl.set(i,a),a}function $b(n=Sh){const t=Yl.get(n);if(!t&&n===Sh&&Ob())return Ub();if(!t)throw Gs.create("no-app",{appName:n});return t}function Ks(n,t,e){let s=VA[n]??n;e&&(s+=`-${e}`);const i=s.match(/\s|\//),r=t.match(/\s|\//);if(i||r){const o=[`Unable to register library "${s}" with version "${t}":`];i&&o.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&r&&o.push("and"),r&&o.push(`version name "${t}" contains illegal characters (whitespace or "/")`),ms.warn(o.join(" "));return}wr(new Fi(`${s}-version`,()=>({library:s,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UA="firebase-heartbeat-database",$A=1,Ko="firebase-heartbeat-store";let zu=null;function zb(){return zu||(zu=iA(UA,$A,{upgrade:(n,t)=>{switch(t){case 0:try{n.createObjectStore(Ko)}catch(e){console.warn(e)}}}}).catch(n=>{throw Gs.create("idb-open",{originalErrorMessage:n.message})})),zu}async function zA(n){try{const e=(await zb()).transaction(Ko),s=await e.objectStore(Ko).get(jb(n));return await e.done,s}catch(t){if(t instanceof Es)ms.warn(t.message);else{const e=Gs.create("idb-get",{originalErrorMessage:t?.message});ms.warn(e.message)}}}async function Lg(n,t){try{const s=(await zb()).transaction(Ko,"readwrite");await s.objectStore(Ko).put(t,jb(n)),await s.done}catch(e){if(e instanceof Es)ms.warn(e.message);else{const s=Gs.create("idb-set",{originalErrorMessage:e?.message});ms.warn(s.message)}}}function jb(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jA=1024,HA=30;class WA{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new GA(e),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){try{const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Vg();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(i=>i.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:e}),this._heartbeatsCache.heartbeats.length>HA){const i=KA(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(t){ms.warn(t)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Vg(),{heartbeatsToSend:e,unsentEntries:s}=qA(this._heartbeatsCache.heartbeats),i=Kl(JSON.stringify({version:2,heartbeats:e}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return ms.warn(t),""}}}function Vg(){return new Date().toISOString().substring(0,10)}function qA(n,t=jA){const e=[];let s=n.slice();for(const i of n){const r=e.find(o=>o.agent===i.agent);if(r){if(r.dates.push(i.date),Ng(e)>t){r.dates.pop();break}}else if(e.push({agent:i.agent,dates:[i.date]}),Ng(e)>t){e.pop();break}s=s.slice(1)}return{heartbeatsToSend:e,unsentEntries:s}}class GA{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return MI()?OI().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const e=await zA(this.app);return e?.heartbeats?e:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){if(await this._canUseIndexedDBPromise){const s=await this.read();return Lg(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){if(await this._canUseIndexedDBPromise){const s=await this.read();return Lg(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...t.heartbeats]})}else return}}function Ng(n){return Kl(JSON.stringify({version:2,heartbeats:n})).length}function KA(n){if(n.length===0)return-1;let t=0,e=n[0].date;for(let s=1;s<n.length;s++)n[s].date<e&&(e=n[s].date,t=s);return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YA(n){wr(new Fi("platform-logger",t=>new aA(t),"PRIVATE")),wr(new Fi("heartbeat",t=>new WA(t),"PRIVATE")),Ks(Ah,Mg,n),Ks(Ah,Mg,"esm2020"),Ks("fire-js","")}YA("");function Hb(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const XA=Hb,Wb=new ga("auth","Firebase",Hb());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xl=new Cd("@firebase/auth");function QA(n,...t){Xl.logLevel<=Pt.WARN&&Xl.warn(`Auth (${Mr}): ${n}`,...t)}function Tl(n,...t){Xl.logLevel<=Pt.ERROR&&Xl.error(`Auth (${Mr}): ${n}`,...t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qn(n,...t){throw Dd(n,...t)}function In(n,...t){return Dd(n,...t)}function kd(n,t,e){const s={...XA(),[t]:e};return new ga("auth","Firebase",s).create(t,{appName:n.name})}function ds(n){return kd(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function JA(n,t,e){const s=e;if(!(t instanceof s))throw s.name!==t.constructor.name&&qn(n,"argument-error"),kd(n,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Dd(n,...t){if(typeof n!="string"){const e=t[0],s=[...t.slice(1)];return s[0]&&(s[0].appName=n.name),n._errorFactory.create(e,...s)}return Wb.create(n,...t)}function _t(n,t,...e){if(!n)throw Dd(t,...e)}function os(n){const t="INTERNAL ASSERTION FAILED: "+n;throw Tl(t),new Error(t)}function _s(n,t){n||os(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ph(){return typeof self<"u"&&self.location?.href||""}function ZA(){return Fg()==="http:"||Fg()==="https:"}function Fg(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tS(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(ZA()||PI()||"connection"in navigator)?navigator.onLine:!0}function eS(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _a{constructor(t,e){this.shortDelay=t,this.longDelay=e,_s(e>t,"Short delay should be less than long delay!"),this.isMobile=AI()||RI()}get(){return tS()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Md(n,t){_s(n.emulator,"Emulator should always be set here");const{url:e}=n.emulator;return t?`${e}${t.startsWith("/")?t.slice(1):t}`:e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qb{static initialize(t,e,s){this.fetchImpl=t,e&&(this.headersImpl=e),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;os("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;os("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;os("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nS={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sS=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],iS=new _a(3e4,6e4);function ya(n,t){return n.tenantId&&!t.tenantId?{...t,tenantId:n.tenantId}:t}async function Or(n,t,e,s,i={}){return Gb(n,i,async()=>{let r={},o={};s&&(t==="GET"?o=s:r={body:JSON.stringify(s)});const a=ma({key:n.config.apiKey,...o}).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const c={method:t,headers:l,...r};return CI()||(c.referrerPolicy="no-referrer"),n.emulatorConfig&&Dr(n.emulatorConfig.host)&&(c.credentials="include"),qb.fetch()(await Kb(n,n.config.apiHost,e,a),c)})}async function Gb(n,t,e){n._canInitEmulator=!1;const s={...nS,...t};try{const i=new rS(n),r=await Promise.race([e(),i.promise]);i.clearNetworkTimeout();const o=await r.json();if("needConfirmation"in o)throw Za(n,"account-exists-with-different-credential",o);if(r.ok&&!("errorMessage"in o))return o;{const a=r.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Za(n,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Za(n,"email-already-in-use",o);if(l==="USER_DISABLED")throw Za(n,"user-disabled",o);const h=s[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw kd(n,h,c);qn(n,h)}}catch(i){if(i instanceof Es)throw i;qn(n,"network-request-failed",{message:String(i)})}}async function Od(n,t,e,s,i={}){const r=await Or(n,t,e,s,i);return"mfaPendingCredential"in r&&qn(n,"multi-factor-auth-required",{_serverResponse:r}),r}async function Kb(n,t,e,s){const i=`${t}${e}?${s}`,r=n,o=r.config.emulator?Md(n.config,i):`${n.config.apiScheme}://${i}`;return sS.includes(e)&&(await r._persistenceManagerAvailable,r._getPersistenceType()==="COOKIE")?r._getPersistence()._getFinalTarget(o).toString():o}class rS{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((e,s)=>{this.timer=setTimeout(()=>s(In(this.auth,"network-request-failed")),iS.get())})}}function Za(n,t,e){const s={appName:n.name};e.email&&(s.email=e.email),e.phoneNumber&&(s.phoneNumber=e.phoneNumber);const i=In(n,t,s);return i.customData._tokenResponse=e,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oS(n,t){return Or(n,"POST","/v1/accounts:delete",t)}async function Ql(n,t){return Or(n,"POST","/v1/accounts:lookup",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Do(n){if(n)try{const t=new Date(Number(n));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}async function aS(n,t=!1){const e=Se(n),s=await e.getIdToken(t),i=Ld(s);_t(i&&i.exp&&i.auth_time&&i.iat,e.auth,"internal-error");const r=typeof i.firebase=="object"?i.firebase:void 0,o=r?.sign_in_provider;return{claims:i,token:s,authTime:Do(ju(i.auth_time)),issuedAtTime:Do(ju(i.iat)),expirationTime:Do(ju(i.exp)),signInProvider:o||null,signInSecondFactor:r?.sign_in_second_factor||null}}function ju(n){return Number(n)*1e3}function Ld(n){const[t,e,s]=n.split(".");if(t===void 0||e===void 0||s===void 0)return Tl("JWT malformed, contained fewer than 3 sections"),null;try{const i=Db(e);return i?JSON.parse(i):(Tl("Failed to decode base64 JWT payload"),null)}catch(i){return Tl("Caught error parsing JWT payload as JSON",i?.toString()),null}}function Bg(n){const t=Ld(n);return _t(t,"internal-error"),_t(typeof t.exp<"u","internal-error"),_t(typeof t.iat<"u","internal-error"),Number(t.exp)-Number(t.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yo(n,t,e=!1){if(e)return t;try{return await t}catch(s){throw s instanceof Es&&lS(s)&&n.auth.currentUser===n&&await n.auth.signOut(),s}}function lS({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cS{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(t){if(t){const e=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),e}else{this.errorBackoff=3e4;const s=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,s)}}schedule(t=!1){if(!this.isRunning)return;const e=this.getInterval(t);this.timerId=setTimeout(async()=>{await this.iteration()},e)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){t?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rh{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=Do(this.lastLoginAt),this.creationTime=Do(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jl(n){const t=n.auth,e=await n.getIdToken(),s=await Yo(n,Ql(t,{idToken:e}));_t(s?.users.length,t,"internal-error");const i=s.users[0];n._notifyReloadListener(i);const r=i.providerUserInfo?.length?Yb(i.providerUserInfo):[],o=hS(n.providerData,r),a=n.isAnonymous,l=!(n.email&&i.passwordHash)&&!o?.length,c=a?l:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Rh(i.createdAt,i.lastLoginAt),isAnonymous:c};Object.assign(n,h)}async function uS(n){const t=Se(n);await Jl(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function hS(n,t){return[...n.filter(s=>!t.some(i=>i.providerId===s.providerId)),...t]}function Yb(n){return n.map(({providerId:t,...e})=>({providerId:t,uid:e.rawId||"",displayName:e.displayName||null,email:e.email||null,phoneNumber:e.phoneNumber||null,photoURL:e.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dS(n,t){const e=await Gb(n,{},async()=>{const s=ma({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:i,apiKey:r}=n.config,o=await Kb(n,i,"/v1/token",`key=${r}`),a=await n._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:s};return n.emulatorConfig&&Dr(n.emulatorConfig.host)&&(l.credentials="include"),qb.fetch()(o,l)});return{accessToken:e.access_token,expiresIn:e.expires_in,refreshToken:e.refresh_token}}async function fS(n,t){return Or(n,"POST","/v2/accounts:revokeToken",ya(n,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gr{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){_t(t.idToken,"internal-error"),_t(typeof t.idToken<"u","internal-error"),_t(typeof t.refreshToken<"u","internal-error");const e="expiresIn"in t&&typeof t.expiresIn<"u"?Number(t.expiresIn):Bg(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}updateFromIdToken(t){_t(t.length!==0,"internal-error");const e=Bg(t);this.updateTokensAndExpiration(t,null,e)}async getToken(t,e=!1){return!e&&this.accessToken&&!this.isExpired?this.accessToken:(_t(this.refreshToken,t,"user-token-expired"),this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(t,e){const{accessToken:s,refreshToken:i,expiresIn:r}=await dS(t,e);this.updateTokensAndExpiration(s,i,Number(r))}updateTokensAndExpiration(t,e,s){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(t,e){const{refreshToken:s,accessToken:i,expirationTime:r}=e,o=new gr;return s&&(_t(typeof s=="string","internal-error",{appName:t}),o.refreshToken=s),i&&(_t(typeof i=="string","internal-error",{appName:t}),o.accessToken=i),r&&(_t(typeof r=="number","internal-error",{appName:t}),o.expirationTime=r),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new gr,this.toJSON())}_performRefresh(){return os("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ds(n,t){_t(typeof n=="string"||typeof n>"u","internal-error",{appName:t})}class xn{constructor({uid:t,auth:e,stsTokenManager:s,...i}){this.providerId="firebase",this.proactiveRefresh=new cS(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=e,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Rh(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(t){const e=await Yo(this,this.stsTokenManager.getToken(this.auth,t));return _t(e,this.auth,"internal-error"),this.accessToken!==e&&(this.accessToken=e,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),e}getIdTokenResult(t){return aS(this,t)}reload(){return uS(this)}_assign(t){this!==t&&(_t(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(e=>({...e})),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const e=new xn({...this,auth:t,stsTokenManager:this.stsTokenManager._clone()});return e.metadata._copy(this.metadata),e}_onReload(t){_t(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,e=!1){let s=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),s=!0),e&&await Jl(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(on(this.auth.app))return Promise.reject(ds(this.auth));const t=await this.getIdToken();return await Yo(this,oS(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>({...t})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){const s=e.displayName??void 0,i=e.email??void 0,r=e.phoneNumber??void 0,o=e.photoURL??void 0,a=e.tenantId??void 0,l=e._redirectEventId??void 0,c=e.createdAt??void 0,h=e.lastLoginAt??void 0,{uid:d,emailVerified:f,isAnonymous:g,providerData:_,stsTokenManager:y}=e;_t(d&&y,t,"internal-error");const w=gr.fromJSON(this.name,y);_t(typeof d=="string",t,"internal-error"),Ds(s,t.name),Ds(i,t.name),_t(typeof f=="boolean",t,"internal-error"),_t(typeof g=="boolean",t,"internal-error"),Ds(r,t.name),Ds(o,t.name),Ds(a,t.name),Ds(l,t.name),Ds(c,t.name),Ds(h,t.name);const E=new xn({uid:d,auth:t,email:i,emailVerified:f,displayName:s,isAnonymous:g,photoURL:o,phoneNumber:r,tenantId:a,stsTokenManager:w,createdAt:c,lastLoginAt:h});return _&&Array.isArray(_)&&(E.providerData=_.map(S=>({...S}))),l&&(E._redirectEventId=l),E}static async _fromIdTokenResponse(t,e,s=!1){const i=new gr;i.updateFromServerResponse(e);const r=new xn({uid:e.localId,auth:t,stsTokenManager:i,isAnonymous:s});return await Jl(r),r}static async _fromGetAccountInfoResponse(t,e,s){const i=e.users[0];_t(i.localId!==void 0,"internal-error");const r=i.providerUserInfo!==void 0?Yb(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!r?.length,a=new gr;a.updateFromIdToken(s);const l=new xn({uid:i.localId,auth:t,stsTokenManager:a,isAnonymous:o}),c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:r,metadata:new Rh(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!r?.length};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ug=new Map;function as(n){_s(n instanceof Function,"Expected a class definition");let t=Ug.get(n);return t?(_s(t instanceof n,"Instance stored in cache mismatched with class"),t):(t=new n,Ug.set(n,t),t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xb{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,e){this.storage[t]=e}async _get(t){const e=this.storage[t];return e===void 0?null:e}async _remove(t){delete this.storage[t]}_addListener(t,e){}_removeListener(t,e){}}Xb.type="NONE";const $g=Xb;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function El(n,t,e){return`firebase:${n}:${t}:${e}`}class mr{constructor(t,e,s){this.persistence=t,this.auth=e,this.userKey=s;const{config:i,name:r}=this.auth;this.fullUserKey=El(this.userKey,i.apiKey,r),this.fullPersistenceKey=El("persistence",i.apiKey,r),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);if(!t)return null;if(typeof t=="string"){const e=await Ql(this.auth,{idToken:t}).catch(()=>{});return e?xn._fromGetAccountInfoResponse(this.auth,e,t):null}return xn._fromJSON(this.auth,t)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const e=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=t,e)return this.setCurrentUser(e)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,e,s="authUser"){if(!e.length)return new mr(as($g),t,s);const i=(await Promise.all(e.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let r=i[0]||as($g);const o=El(s,t.config.apiKey,t.name);let a=null;for(const c of e)try{const h=await c._get(o);if(h){let d;if(typeof h=="string"){const f=await Ql(t,{idToken:h}).catch(()=>{});if(!f)break;d=await xn._fromGetAccountInfoResponse(t,f,h)}else d=xn._fromJSON(t,h);c!==r&&(a=d),r=c;break}}catch{}const l=i.filter(c=>c._shouldAllowMigration);return!r._shouldAllowMigration||!l.length?new mr(r,t,s):(r=l[0],a&&await r._set(o,a.toJSON()),await Promise.all(e.map(async c=>{if(c!==r)try{await c._remove(o)}catch{}})),new mr(r,t,s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zg(n){const t=n.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(tv(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Qb(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(nv(t))return"Blackberry";if(sv(t))return"Webos";if(Jb(t))return"Safari";if((t.includes("chrome/")||Zb(t))&&!t.includes("edge/"))return"Chrome";if(ev(t))return"Android";{const e=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=n.match(e);if(s?.length===2)return s[1]}return"Other"}function Qb(n=$e()){return/firefox\//i.test(n)}function Jb(n=$e()){const t=n.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function Zb(n=$e()){return/crios\//i.test(n)}function tv(n=$e()){return/iemobile/i.test(n)}function ev(n=$e()){return/android/i.test(n)}function nv(n=$e()){return/blackberry/i.test(n)}function sv(n=$e()){return/webos/i.test(n)}function Vd(n=$e()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function pS(n=$e()){return Vd(n)&&!!window.navigator?.standalone}function gS(){return kI()&&document.documentMode===10}function iv(n=$e()){return Vd(n)||ev(n)||sv(n)||nv(n)||/windows phone/i.test(n)||tv(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rv(n,t=[]){let e;switch(n){case"Browser":e=zg($e());break;case"Worker":e=`${zg($e())}-${n}`;break;default:e=n}const s=t.length?t.join(","):"FirebaseCore-web";return`${e}/JsCore/${Mr}/${s}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mS{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,e){const s=r=>new Promise((o,a)=>{try{const l=t(r);o(l)}catch(l){a(l)}});s.onAbort=e,this.queue.push(s);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const e=[];try{for(const s of this.queue)await s(t),s.onAbort&&e.push(s.onAbort)}catch(s){e.reverse();for(const i of e)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _S(n,t={}){return Or(n,"GET","/v2/passwordPolicy",ya(n,t))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yS=6;class bS{constructor(t){const e=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=e.minPasswordLength??yS,e.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=e.maxPasswordLength),e.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=e.containsLowercaseCharacter),e.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=e.containsUppercaseCharacter),e.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=e.containsNumericCharacter),e.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=e.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=t.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=t.forceUpgradeOnSignin??!1,this.schemaVersion=t.schemaVersion}validatePassword(t){const e={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,e),this.validatePasswordCharacterOptions(t,e),e.isValid&&(e.isValid=e.meetsMinPasswordLength??!0),e.isValid&&(e.isValid=e.meetsMaxPasswordLength??!0),e.isValid&&(e.isValid=e.containsLowercaseLetter??!0),e.isValid&&(e.isValid=e.containsUppercaseLetter??!0),e.isValid&&(e.isValid=e.containsNumericCharacter??!0),e.isValid&&(e.isValid=e.containsNonAlphanumericCharacter??!0),e}validatePasswordLengthOptions(t,e){const s=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;s&&(e.meetsMinPasswordLength=t.length>=s),i&&(e.meetsMaxPasswordLength=t.length<=i)}validatePasswordCharacterOptions(t,e){this.updatePasswordCharacterOptionsStatuses(e,!1,!1,!1,!1);let s;for(let i=0;i<t.length;i++)s=t.charAt(i),this.updatePasswordCharacterOptionsStatuses(e,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(t,e,s,i,r){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=e)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vS{constructor(t,e,s,i){this.app=t,this.heartbeatServiceProvider=e,this.appCheckServiceProvider=s,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new jg(this),this.idTokenSubscription=new jg(this),this.beforeStateQueue=new mS(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Wb,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(r=>this._resolvePersistenceManagerAvailable=r)}_initializeWithPersistence(t,e){return e&&(this._popupRedirectResolver=as(e)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await mr.create(this,t),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(e),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!t)){if(this.currentUser&&t&&this.currentUser.uid===t.uid){this._currentUser._assign(t),await this.currentUser.getIdToken();return}await this._updateCurrentUser(t,!0)}}async initializeCurrentUserFromIdToken(t){try{const e=await Ql(this,{idToken:t}),s=await xn._fromGetAccountInfoResponse(this,e,t);await this.directlySetCurrentUser(s)}catch(e){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",e),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(t){if(on(this.app)){const r=this.app.settings.authIdToken;return r?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(r).then(o,o))}):this.directlySetCurrentUser(null)}const e=await this.assertedPersistence.getCurrentUser();let s=e,i=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const r=this.redirectUser?._redirectEventId,o=s?._redirectEventId,a=await this.tryRedirectSignIn(t);(!r||r===o)&&a?.user&&(s=a.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(r){s=e,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(r))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return _t(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(t){let e=null;try{e=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch{await this._setRedirectUser(null)}return e}async reloadAndSetCurrentUserOrClear(t){try{await Jl(t)}catch(e){if(e?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=eS()}async _delete(){this._deleted=!0}async updateCurrentUser(t){if(on(this.app))return Promise.reject(ds(this));const e=t?Se(t):null;return e&&_t(e.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(e&&e._clone(this))}async _updateCurrentUser(t,e=!1){if(!this._deleted)return t&&_t(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),e||await this.beforeStateQueue.runMiddleware(t),this.queue(async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()})}async signOut(){return on(this.app)?Promise.reject(ds(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(t){return on(this.app)?Promise.reject(ds(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(as(t))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const e=this._getPasswordPolicyInternal();return e.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):e.validatePassword(t)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await _S(this),e=new bS(t);this.tenantId===null?this._projectPasswordPolicy=e:this._tenantPasswordPolicies[this.tenantId]=e}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(t){this._errorFactory=new ga("auth","Firebase",t())}onAuthStateChanged(t,e,s){return this.registerStateListener(this.authStateSubscription,t,e,s)}beforeAuthStateChanged(t,e){return this.beforeStateQueue.pushCallback(t,e)}onIdTokenChanged(t,e,s){return this.registerStateListener(this.idTokenSubscription,t,e,s)}authStateReady(){return new Promise((t,e)=>{if(this.currentUser)t();else{const s=this.onAuthStateChanged(()=>{s(),t()},e)}})}async revokeAccessToken(t){if(this.currentUser){const e=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:e};this.tenantId!=null&&(s.tenantId=this.tenantId),await fS(this,s)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(t,e){const s=await this.getOrInitRedirectPersistenceManager(e);return t===null?s.removeCurrentUser():s.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const e=t&&as(t)||this._popupRedirectResolver;_t(e,this,"argument-error"),this.redirectPersistenceManager=await mr.create(this,[as(e._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===t?this._currentUser:this.redirectUser?._redirectEventId===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(t))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const t=this.currentUser?.uid??null;this.lastNotifiedUid!==t&&(this.lastNotifiedUid=t,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,s,i){if(this._deleted)return()=>{};const r=typeof e=="function"?e:e.next.bind(e);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(_t(a,this,"internal-error"),a.then(()=>{o||r(this.currentUser)}),typeof e=="function"){const l=t.addObserver(e,s,i);return()=>{o=!0,l()}}else{const l=t.addObserver(e);return()=>{o=!0,l()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return _t(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){!t||this.frameworks.includes(t)||(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=rv(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const e=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();e&&(t["X-Firebase-Client"]=e);const s=await this._getAppCheckToken();return s&&(t["X-Firebase-AppCheck"]=s),t}async _getAppCheckToken(){if(on(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return t?.error&&QA(`Error while retrieving App Check token: ${t.error}`),t?.token}}function Lr(n){return Se(n)}class jg{constructor(t){this.auth=t,this.observer=null,this.addObserver=BI(e=>this.observer=e)}get next(){return _t(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Nd={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function wS(n){Nd=n}function xS(n){return Nd.loadJS(n)}function TS(){return Nd.gapiScript}function ES(n){return`__${n}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IS(n,t){const e=Rd(n,"auth");if(e.isInitialized()){const i=e.getImmediate(),r=e.getOptions();if(Ni(r,t??{}))return i;qn(i,"already-initialized")}return e.initialize({options:t})}function AS(n,t){const e=t?.persistence||[],s=(Array.isArray(e)?e:[e]).map(as);t?.errorMap&&n._updateErrorMap(t.errorMap),n._initializeWithPersistence(s,t?.popupRedirectResolver)}function SS(n,t,e){const s=Lr(n);_t(/^https?:\/\//.test(t),s,"invalid-emulator-scheme");const i=!1,r=ov(t),{host:o,port:a}=CS(t),l=a===null?"":`:${a}`,c={url:`${r}//${o}${l}/`},h=Object.freeze({host:o,port:a,protocol:r.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!s._canInitEmulator){_t(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),_t(Ni(c,s.config.emulator)&&Ni(h,s.emulatorConfig),s,"emulator-config-failed");return}s.config.emulator=c,s.emulatorConfig=h,s.settings.appVerificationDisabledForTesting=!0,Dr(o)?(Vb(`${r}//${o}${l}`),Nb("Auth",!0)):PS()}function ov(n){const t=n.indexOf(":");return t<0?"":n.substr(0,t+1)}function CS(n){const t=ov(n),e=/(\/\/)?([^?#/]+)/.exec(n.substr(t.length));if(!e)return{host:"",port:null};const s=e[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(s);if(i){const r=i[1];return{host:r,port:Hg(s.substr(r.length+1))}}else{const[r,o]=s.split(":");return{host:r,port:Hg(o)}}}function Hg(n){if(!n)return null;const t=Number(n);return isNaN(t)?null:t}function PS(){function n(){const t=document.createElement("p"),e=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#b50000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class av{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return os("not implemented")}_getIdTokenResponse(t){return os("not implemented")}_linkToIdToken(t,e){return os("not implemented")}_getReauthenticationResolver(t){return os("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _r(n,t){return Od(n,"POST","/v1/accounts:signInWithIdp",ya(n,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RS="http://localhost";class Bi extends av{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new Bi(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):qn("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e=typeof t=="string"?JSON.parse(t):t,{providerId:s,signInMethod:i,...r}=e;if(!s||!i)return null;const o=new Bi(s,i);return o.idToken=r.idToken||void 0,o.accessToken=r.accessToken||void 0,o.secret=r.secret,o.nonce=r.nonce,o.pendingToken=r.pendingToken||null,o}_getIdTokenResponse(t){const e=this.buildRequest();return _r(t,e)}_linkToIdToken(t,e){const s=this.buildRequest();return s.idToken=e,_r(t,s)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,_r(t,e)}buildRequest(){const t={requestUri:RS,returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=ma(e)}return t}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fd{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ba extends Fd{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ns extends ba{constructor(){super("facebook.com")}static credential(t){return Bi._fromParams({providerId:Ns.PROVIDER_ID,signInMethod:Ns.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return Ns.credentialFromTaggedObject(t)}static credentialFromError(t){return Ns.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return Ns.credential(t.oauthAccessToken)}catch{return null}}}Ns.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ns.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rs extends ba{constructor(){super("google.com"),this.addScope("profile")}static credential(t,e){return Bi._fromParams({providerId:rs.PROVIDER_ID,signInMethod:rs.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:e})}static credentialFromResult(t){return rs.credentialFromTaggedObject(t)}static credentialFromError(t){return rs.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:e,oauthAccessToken:s}=t;if(!e&&!s)return null;try{return rs.credential(e,s)}catch{return null}}}rs.GOOGLE_SIGN_IN_METHOD="google.com";rs.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fs extends ba{constructor(){super("github.com")}static credential(t){return Bi._fromParams({providerId:Fs.PROVIDER_ID,signInMethod:Fs.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return Fs.credentialFromTaggedObject(t)}static credentialFromError(t){return Fs.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return Fs.credential(t.oauthAccessToken)}catch{return null}}}Fs.GITHUB_SIGN_IN_METHOD="github.com";Fs.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bs extends ba{constructor(){super("twitter.com")}static credential(t,e){return Bi._fromParams({providerId:Bs.PROVIDER_ID,signInMethod:Bs.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:e})}static credentialFromResult(t){return Bs.credentialFromTaggedObject(t)}static credentialFromError(t){return Bs.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:e,oauthTokenSecret:s}=t;if(!e||!s)return null;try{return Bs.credential(e,s)}catch{return null}}}Bs.TWITTER_SIGN_IN_METHOD="twitter.com";Bs.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kS(n,t){return Od(n,"POST","/v1/accounts:signUp",ya(n,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ys{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,e,s,i=!1){const r=await xn._fromIdTokenResponse(t,s,i),o=Wg(s);return new ys({user:r,providerId:o,_tokenResponse:s,operationType:e})}static async _forOperation(t,e,s){await t._updateTokensIfNecessary(s,!0);const i=Wg(s);return new ys({user:t,providerId:i,_tokenResponse:s,operationType:e})}}function Wg(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DS(n){if(on(n.app))return Promise.reject(ds(n));const t=Lr(n);if(await t._initializationPromise,t.currentUser?.isAnonymous)return new ys({user:t.currentUser,providerId:null,operationType:"signIn"});const e=await kS(t,{returnSecureToken:!0}),s=await ys._fromIdTokenResponse(t,"signIn",e,!0);return await t._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zl extends Es{constructor(t,e,s,i){super(e.code,e.message),this.operationType=s,this.user=i,Object.setPrototypeOf(this,Zl.prototype),this.customData={appName:t.name,tenantId:t.tenantId??void 0,_serverResponse:e.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(t,e,s,i){return new Zl(t,e,s,i)}}function lv(n,t,e,s){return(t==="reauthenticate"?e._getReauthenticationResolver(n):e._getIdTokenResponse(n)).catch(r=>{throw r.code==="auth/multi-factor-auth-required"?Zl._fromErrorAndOperation(n,r,t,s):r})}async function MS(n,t,e=!1){const s=await Yo(n,t._linkToIdToken(n.auth,await n.getIdToken()),e);return ys._forOperation(n,"link",s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OS(n,t,e=!1){const{auth:s}=n;if(on(s.app))return Promise.reject(ds(s));const i="reauthenticate";try{const r=await Yo(n,lv(s,i,t,n),e);_t(r.idToken,s,"internal-error");const o=Ld(r.idToken);_t(o,s,"internal-error");const{sub:a}=o;return _t(n.uid===a,s,"user-mismatch"),ys._forOperation(n,i,r)}catch(r){throw r?.code==="auth/user-not-found"&&qn(s,"user-mismatch"),r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LS(n,t,e=!1){if(on(n.app))return Promise.reject(ds(n));const s="signIn",i=await lv(n,s,t),r=await ys._fromIdTokenResponse(n,s,i);return e||await n._updateCurrentUser(r.user),r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VS(n,t){return Od(n,"POST","/v1/accounts:signInWithCustomToken",ya(n,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NS(n,t){if(on(n.app))return Promise.reject(ds(n));const e=Lr(n),s=await VS(e,{token:t,returnSecureToken:!0}),i=await ys._fromIdTokenResponse(e,"signIn",s);return await e._updateCurrentUser(i.user),i}function FS(n,t,e,s){return Se(n).onIdTokenChanged(t,e,s)}function BS(n,t,e){return Se(n).beforeAuthStateChanged(t,e)}function cv(n,t,e,s){return Se(n).onAuthStateChanged(t,e,s)}const tc="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uv{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(tc,"1"),this.storage.removeItem(tc),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const US=1e3,$S=10;class hv extends uv{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,e)=>this.onStorageEvent(t,e),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=iv(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const e of Object.keys(this.listeners)){const s=this.storage.getItem(e),i=this.localCache[e];s!==i&&t(e,i,s)}}onStorageEvent(t,e=!1){if(!t.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const s=t.key;e?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(s);!e&&this.localCache[s]===o||this.notifyListeners(s,o)},r=this.storage.getItem(s);gS()&&r!==t.newValue&&t.newValue!==t.oldValue?setTimeout(i,$S):i()}notifyListeners(t,e){this.localCache[t]=e;const s=this.listeners[t];if(s)for(const i of Array.from(s))i(e&&JSON.parse(e))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,e,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:e,newValue:s}),!0)})},US)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,e){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,e){await super._set(t,e),this.localCache[t]=JSON.stringify(e)}async _get(t){const e=await super._get(t);return this.localCache[t]=JSON.stringify(e),e}async _remove(t){await super._remove(t),delete this.localCache[t]}}hv.type="LOCAL";const zS=hv;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dv extends uv{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,e){}_removeListener(t,e){}}dv.type="SESSION";const fv=dv;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jS(n){return Promise.all(n.map(async t=>{try{return{fulfilled:!0,value:await t}}catch(e){return{fulfilled:!1,reason:e}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nc{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const e=this.receivers.find(i=>i.isListeningto(t));if(e)return e;const s=new Nc(t);return this.receivers.push(s),s}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const e=t,{eventId:s,eventType:i,data:r}=e.data,o=this.handlersMap[i];if(!o?.size)return;e.ports[0].postMessage({status:"ack",eventId:s,eventType:i});const a=Array.from(o).map(async c=>c(e.origin,r)),l=await jS(a);e.ports[0].postMessage({status:"done",eventId:s,eventType:i,response:l})}_subscribe(t,e){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(e)}_unsubscribe(t,e){this.handlersMap[t]&&e&&this.handlersMap[t].delete(e),(!e||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Nc.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bd(n="",t=10){let e="";for(let s=0;s<t;s++)e+=Math.floor(Math.random()*10);return n+e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HS{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,e,s=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let r,o;return new Promise((a,l)=>{const c=Bd("",20);i.port1.start();const h=setTimeout(()=>{l(new Error("unsupported_event"))},s);o={messageChannel:i,onMessage(d){const f=d;if(f.data.eventId===c)switch(f.data.status){case"ack":clearTimeout(h),r=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(r),a(f.data.response);break;default:clearTimeout(h),clearTimeout(r),l(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:t,eventId:c,data:e},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nn(){return window}function WS(n){Nn().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pv(){return typeof Nn().WorkerGlobalScope<"u"&&typeof Nn().importScripts=="function"}async function qS(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function GS(){return navigator?.serviceWorker?.controller||null}function KS(){return pv()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gv="firebaseLocalStorageDb",YS=1,ec="firebaseLocalStorage",mv="fbase_key";class va{constructor(t){this.request=t}toPromise(){return new Promise((t,e)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{e(this.request.error)})})}}function Fc(n,t){return n.transaction([ec],t?"readwrite":"readonly").objectStore(ec)}function XS(){const n=indexedDB.deleteDatabase(gv);return new va(n).toPromise()}function kh(){const n=indexedDB.open(gv,YS);return new Promise((t,e)=>{n.addEventListener("error",()=>{e(n.error)}),n.addEventListener("upgradeneeded",()=>{const s=n.result;try{s.createObjectStore(ec,{keyPath:mv})}catch(i){e(i)}}),n.addEventListener("success",async()=>{const s=n.result;s.objectStoreNames.contains(ec)?t(s):(s.close(),await XS(),t(await kh()))})})}async function qg(n,t,e){const s=Fc(n,!0).put({[mv]:t,value:e});return new va(s).toPromise()}async function QS(n,t){const e=Fc(n,!1).get(t),s=await new va(e).toPromise();return s===void 0?null:s.value}function Gg(n,t){const e=Fc(n,!0).delete(t);return new va(e).toPromise()}const JS=800,ZS=3;class _v{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await kh(),this.db)}async _withRetries(t){let e=0;for(;;)try{const s=await this._openDb();return await t(s)}catch(s){if(e++>ZS)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return pv()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Nc._getInstance(KS()),this.receiver._subscribe("keyChanged",async(t,e)=>({keyProcessed:(await this._poll()).includes(e.key)})),this.receiver._subscribe("ping",async(t,e)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await qS(),!this.activeServiceWorker)return;this.sender=new HS(this.activeServiceWorker);const t=await this.sender._send("ping",{},800);t&&t[0]?.fulfilled&&t[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||GS()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await kh();return await qg(t,tc,"1"),await Gg(t,tc),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,e){return this._withPendingWrite(async()=>(await this._withRetries(s=>qg(s,t,e)),this.localCache[t]=e,this.notifyServiceWorker(t)))}async _get(t){const e=await this._withRetries(s=>QS(s,t));return this.localCache[t]=e,e}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(e=>Gg(e,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){const t=await this._withRetries(i=>{const r=Fc(i,!1).getAll();return new va(r).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];const e=[],s=new Set;if(t.length!==0)for(const{fbase_key:i,value:r}of t)s.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(r)&&(this.notifyListeners(i,r),e.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!s.has(i)&&(this.notifyListeners(i,null),e.push(i));return e}notifyListeners(t,e){this.localCache[t]=e;const s=this.listeners[t];if(s)for(const i of Array.from(s))i(e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),JS)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,e){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}_v.type="LOCAL";const tC=_v;new _a(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yv(n,t){return t?as(t):(_t(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ud extends av{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return _r(t,this._buildIdpRequest())}_linkToIdToken(t,e){return _r(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return _r(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function eC(n){return LS(n.auth,new Ud(n),n.bypassAuthState)}function nC(n){const{auth:t,user:e}=n;return _t(e,t,"internal-error"),OS(e,new Ud(n),n.bypassAuthState)}async function sC(n){const{auth:t,user:e}=n;return _t(e,t,"internal-error"),MS(e,new Ud(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bv{constructor(t,e,s,i,r=!1){this.auth=t,this.resolver=s,this.user=i,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){return new Promise(async(t,e)=>{this.pendingPromise={resolve:t,reject:e};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(t){const{urlResponse:e,sessionId:s,postBody:i,tenantId:r,error:o,type:a}=t;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:e,sessionId:s,tenantId:r||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return eC;case"linkViaPopup":case"linkViaRedirect":return sC;case"reauthViaPopup":case"reauthViaRedirect":return nC;default:qn(this.auth,"internal-error")}}resolve(t){_s(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){_s(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iC=new _a(2e3,1e4);async function rC(n,t,e){if(on(n.app))return Promise.reject(In(n,"operation-not-supported-in-this-environment"));const s=Lr(n);JA(n,t,Fd);const i=yv(s,e);return new Pi(s,"signInViaPopup",t,i).executeNotNull()}class Pi extends bv{constructor(t,e,s,i,r){super(t,e,i,r),this.provider=s,this.authWindow=null,this.pollId=null,Pi.currentPopupAction&&Pi.currentPopupAction.cancel(),Pi.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return _t(t,this.auth,"internal-error"),t}async onExecution(){_s(this.filter.length===1,"Popup operations only handle one event");const t=Bd();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(In(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(In(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Pi.currentPopupAction=null}pollUserCancellation(){const t=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(In(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,iC.get())};t()}}Pi.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oC="pendingRedirect",Il=new Map;class aC extends bv{constructor(t,e,s=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,s),this.eventId=null}async execute(){let t=Il.get(this.auth._key());if(!t){try{const s=await lC(this.resolver,this.auth)?await super.execute():null;t=()=>Promise.resolve(s)}catch(e){t=()=>Promise.reject(e)}Il.set(this.auth._key(),t)}return this.bypassAuthState||Il.set(this.auth._key(),()=>Promise.resolve(null)),t()}async onAuthEvent(t){if(t.type==="signInViaRedirect")return super.onAuthEvent(t);if(t.type==="unknown"){this.resolve(null);return}if(t.eventId){const e=await this.auth._redirectUserForId(t.eventId);if(e)return this.user=e,super.onAuthEvent(t);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function lC(n,t){const e=hC(t),s=uC(n);if(!await s._isAvailable())return!1;const i=await s._get(e)==="true";return await s._remove(e),i}function cC(n,t){Il.set(n._key(),t)}function uC(n){return as(n._redirectPersistence)}function hC(n){return El(oC,n.config.apiKey,n.name)}async function dC(n,t,e=!1){if(on(n.app))return Promise.reject(ds(n));const s=Lr(n),i=yv(s,t),o=await new aC(s,i,e).execute();return o&&!e&&(delete o.user._redirectEventId,await s._persistUserIfCurrent(o.user),await s._setRedirectUser(null,t)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fC=600*1e3;class pC{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(t,s)&&(e=!0,this.sendToConsumer(t,s),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!gC(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){if(t.error&&!vv(t)){const s=t.error.code?.split("auth/")[1]||"internal-error";e.onError(In(this.auth,s))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const s=e.eventId===null||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&s}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=fC&&this.cachedEventUids.clear(),this.cachedEventUids.has(Kg(t))}saveEventToCache(t){this.cachedEventUids.add(Kg(t)),this.lastProcessedEventTime=Date.now()}}function Kg(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(t=>t).join("-")}function vv({type:n,error:t}){return n==="unknown"&&t?.code==="auth/no-auth-event"}function gC(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return vv(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mC(n,t={}){return Or(n,"GET","/v1/projects",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _C=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,yC=/^https?/;async function bC(n){if(n.config.emulator)return;const{authorizedDomains:t}=await mC(n);for(const e of t)try{if(vC(e))return}catch{}qn(n,"unauthorized-domain")}function vC(n){const t=Ph(),{protocol:e,hostname:s}=new URL(t);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&s===""?e==="chrome-extension:"&&n.replace("chrome-extension://","")===t.replace("chrome-extension://",""):e==="chrome-extension:"&&o.hostname===s}if(!yC.test(e))return!1;if(_C.test(n))return s===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(s)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wC=new _a(3e4,6e4);function Yg(){const n=Nn().___jsl;if(n?.H){for(const t of Object.keys(n.H))if(n.H[t].r=n.H[t].r||[],n.H[t].L=n.H[t].L||[],n.H[t].r=[...n.H[t].L],n.CP)for(let e=0;e<n.CP.length;e++)n.CP[e]=null}}function xC(n){return new Promise((t,e)=>{function s(){Yg(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Yg(),e(In(n,"network-request-failed"))},timeout:wC.get()})}if(Nn().gapi?.iframes?.Iframe)t(gapi.iframes.getContext());else if(Nn().gapi?.load)s();else{const i=ES("iframefcb");return Nn()[i]=()=>{gapi.load?s():e(In(n,"network-request-failed"))},xS(`${TS()}?onload=${i}`).catch(r=>e(r))}}).catch(t=>{throw Al=null,t})}let Al=null;function TC(n){return Al=Al||xC(n),Al}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EC=new _a(5e3,15e3),IC="__/auth/iframe",AC="emulator/auth/iframe",SC={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},CC=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function PC(n){const t=n.config;_t(t.authDomain,n,"auth-domain-config-required");const e=t.emulator?Md(t,AC):`https://${n.config.authDomain}/${IC}`,s={apiKey:t.apiKey,appName:n.name,v:Mr},i=CC.get(n.config.apiHost);i&&(s.eid=i);const r=n._getFrameworks();return r.length&&(s.fw=r.join(",")),`${e}?${ma(s).slice(1)}`}async function RC(n){const t=await TC(n),e=Nn().gapi;return _t(e,n,"internal-error"),t.open({where:document.body,url:PC(n),messageHandlersFilter:e.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:SC,dontclear:!0},s=>new Promise(async(i,r)=>{await s.restyle({setHideOnLeave:!1});const o=In(n,"network-request-failed"),a=Nn().setTimeout(()=>{r(o)},EC.get());function l(){Nn().clearTimeout(a),i(s)}s.ping(l).then(l,()=>{r(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kC={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},DC=500,MC=600,OC="_blank",LC="http://localhost";class Xg{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function VC(n,t,e,s=DC,i=MC){const r=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-s)/2,0).toString();let a="";const l={...kC,width:s.toString(),height:i.toString(),top:r,left:o},c=$e().toLowerCase();e&&(a=Zb(c)?OC:e),Qb(c)&&(t=t||LC,l.scrollbars="yes");const h=Object.entries(l).reduce((f,[g,_])=>`${f}${g}=${_},`,"");if(pS(c)&&a!=="_self")return NC(t||"",a),new Xg(null);const d=window.open(t||"",a,h);_t(d,n,"popup-blocked");try{d.focus()}catch{}return new Xg(d)}function NC(n,t){const e=document.createElement("a");e.href=n,e.target=t;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),e.dispatchEvent(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FC="__/auth/handler",BC="emulator/auth/handler",UC=encodeURIComponent("fac");async function Qg(n,t,e,s,i,r){_t(n.config.authDomain,n,"auth-domain-config-required"),_t(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:e,redirectUrl:s,v:Mr,eventId:i};if(t instanceof Fd){t.setDefaultLanguage(n.languageCode),o.providerId=t.providerId||"",FI(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[h,d]of Object.entries({}))o[h]=d}if(t instanceof ba){const h=t.getScopes().filter(d=>d!=="");h.length>0&&(o.scopes=h.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const h of Object.keys(a))a[h]===void 0&&delete a[h];const l=await n._getAppCheckToken(),c=l?`#${UC}=${encodeURIComponent(l)}`:"";return`${$C(n)}?${ma(a).slice(1)}${c}`}function $C({config:n}){return n.emulator?Md(n,BC):`https://${n.authDomain}/${FC}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hu="webStorageSupport";class zC{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=fv,this._completeRedirectFn=dC,this._overrideRedirectResult=cC}async _openPopup(t,e,s,i){_s(this.eventManagers[t._key()]?.manager,"_initialize() not called before _openPopup()");const r=await Qg(t,e,s,Ph(),i);return VC(t,r,Bd())}async _openRedirect(t,e,s,i){await this._originValidation(t);const r=await Qg(t,e,s,Ph(),i);return WS(r),new Promise(()=>{})}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:i,promise:r}=this.eventManagers[e];return i?Promise.resolve(i):(_s(r,"If manager is not set, promise should be"),r)}const s=this.initAndGetManager(t);return this.eventManagers[e]={promise:s},s.catch(()=>{delete this.eventManagers[e]}),s}async initAndGetManager(t){const e=await RC(t),s=new pC(t);return e.register("authEvent",i=>(_t(i?.authEvent,t,"invalid-auth-event"),{status:s.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:s},this.iframes[t._key()]=e,s}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(Hu,{type:Hu},i=>{const r=i?.[0]?.[Hu];r!==void 0&&e(!!r),qn(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=bC(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return iv()||Jb()||Vd()}}const jC=zC;var Jg="@firebase/auth",Zg="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HC{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged(s=>{t(s?.stsTokenManager.accessToken||null)});this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);e&&(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){_t(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WC(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function qC(n){wr(new Fi("auth",(t,{options:e})=>{const s=t.getProvider("app").getImmediate(),i=t.getProvider("heartbeat"),r=t.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=s.options;_t(o&&!o.includes(":"),"invalid-api-key",{appName:s.name});const l={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:rv(n)},c=new vS(s,i,r,l);return AS(c,e),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,s)=>{t.getProvider("auth-internal").initialize()})),wr(new Fi("auth-internal",t=>{const e=Lr(t.getProvider("auth").getImmediate());return(s=>new HC(s))(e)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ks(Jg,Zg,WC(n)),Ks(Jg,Zg,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GC=300,KC=Lb("authIdTokenMaxAge")||GC;let tm=null;const YC=n=>async t=>{const e=t&&await t.getIdTokenResult(),s=e&&(new Date().getTime()-Date.parse(e.issuedAtTime))/1e3;if(s&&s>KC)return;const i=e?.token;tm!==i&&(tm=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function Wi(n=$b()){const t=Rd(n,"auth");if(t.isInitialized())return t.getImmediate();const e=IS(n,{popupRedirectResolver:jC,persistence:[tC,zS,fv]}),s=Lb("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const r=new URL(s,location.origin);if(location.origin===r.origin){const o=YC(r.toString());BS(e,o,()=>o(e.currentUser)),FS(e,a=>o(a))}}const i=Mb("auth");return i&&SS(e,`http://${i}`),e}function XC(){return document.getElementsByTagName("head")?.[0]??document}wS({loadJS(n){return new Promise((t,e)=>{const s=document.createElement("script");s.setAttribute("src",n),s.onload=t,s.onerror=i=>{const r=In("internal-error");r.customData=i,e(r)},s.type="text/javascript",s.charset="UTF-8",XC().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});qC("Browser");var em=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ys,wv;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function t(x,b){function T(){}T.prototype=b.prototype,x.D=b.prototype,x.prototype=new T,x.prototype.constructor=x,x.C=function(C,P,M){for(var I=Array(arguments.length-2),yt=2;yt<arguments.length;yt++)I[yt-2]=arguments[yt];return b.prototype[P].apply(C,I)}}function e(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}t(s,e),s.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(x,b,T){T||(T=0);var C=Array(16);if(typeof b=="string")for(var P=0;16>P;++P)C[P]=b.charCodeAt(T++)|b.charCodeAt(T++)<<8|b.charCodeAt(T++)<<16|b.charCodeAt(T++)<<24;else for(P=0;16>P;++P)C[P]=b[T++]|b[T++]<<8|b[T++]<<16|b[T++]<<24;b=x.g[0],T=x.g[1],P=x.g[2];var M=x.g[3],I=b+(M^T&(P^M))+C[0]+3614090360&4294967295;b=T+(I<<7&4294967295|I>>>25),I=M+(P^b&(T^P))+C[1]+3905402710&4294967295,M=b+(I<<12&4294967295|I>>>20),I=P+(T^M&(b^T))+C[2]+606105819&4294967295,P=M+(I<<17&4294967295|I>>>15),I=T+(b^P&(M^b))+C[3]+3250441966&4294967295,T=P+(I<<22&4294967295|I>>>10),I=b+(M^T&(P^M))+C[4]+4118548399&4294967295,b=T+(I<<7&4294967295|I>>>25),I=M+(P^b&(T^P))+C[5]+1200080426&4294967295,M=b+(I<<12&4294967295|I>>>20),I=P+(T^M&(b^T))+C[6]+2821735955&4294967295,P=M+(I<<17&4294967295|I>>>15),I=T+(b^P&(M^b))+C[7]+4249261313&4294967295,T=P+(I<<22&4294967295|I>>>10),I=b+(M^T&(P^M))+C[8]+1770035416&4294967295,b=T+(I<<7&4294967295|I>>>25),I=M+(P^b&(T^P))+C[9]+2336552879&4294967295,M=b+(I<<12&4294967295|I>>>20),I=P+(T^M&(b^T))+C[10]+4294925233&4294967295,P=M+(I<<17&4294967295|I>>>15),I=T+(b^P&(M^b))+C[11]+2304563134&4294967295,T=P+(I<<22&4294967295|I>>>10),I=b+(M^T&(P^M))+C[12]+1804603682&4294967295,b=T+(I<<7&4294967295|I>>>25),I=M+(P^b&(T^P))+C[13]+4254626195&4294967295,M=b+(I<<12&4294967295|I>>>20),I=P+(T^M&(b^T))+C[14]+2792965006&4294967295,P=M+(I<<17&4294967295|I>>>15),I=T+(b^P&(M^b))+C[15]+1236535329&4294967295,T=P+(I<<22&4294967295|I>>>10),I=b+(P^M&(T^P))+C[1]+4129170786&4294967295,b=T+(I<<5&4294967295|I>>>27),I=M+(T^P&(b^T))+C[6]+3225465664&4294967295,M=b+(I<<9&4294967295|I>>>23),I=P+(b^T&(M^b))+C[11]+643717713&4294967295,P=M+(I<<14&4294967295|I>>>18),I=T+(M^b&(P^M))+C[0]+3921069994&4294967295,T=P+(I<<20&4294967295|I>>>12),I=b+(P^M&(T^P))+C[5]+3593408605&4294967295,b=T+(I<<5&4294967295|I>>>27),I=M+(T^P&(b^T))+C[10]+38016083&4294967295,M=b+(I<<9&4294967295|I>>>23),I=P+(b^T&(M^b))+C[15]+3634488961&4294967295,P=M+(I<<14&4294967295|I>>>18),I=T+(M^b&(P^M))+C[4]+3889429448&4294967295,T=P+(I<<20&4294967295|I>>>12),I=b+(P^M&(T^P))+C[9]+568446438&4294967295,b=T+(I<<5&4294967295|I>>>27),I=M+(T^P&(b^T))+C[14]+3275163606&4294967295,M=b+(I<<9&4294967295|I>>>23),I=P+(b^T&(M^b))+C[3]+4107603335&4294967295,P=M+(I<<14&4294967295|I>>>18),I=T+(M^b&(P^M))+C[8]+1163531501&4294967295,T=P+(I<<20&4294967295|I>>>12),I=b+(P^M&(T^P))+C[13]+2850285829&4294967295,b=T+(I<<5&4294967295|I>>>27),I=M+(T^P&(b^T))+C[2]+4243563512&4294967295,M=b+(I<<9&4294967295|I>>>23),I=P+(b^T&(M^b))+C[7]+1735328473&4294967295,P=M+(I<<14&4294967295|I>>>18),I=T+(M^b&(P^M))+C[12]+2368359562&4294967295,T=P+(I<<20&4294967295|I>>>12),I=b+(T^P^M)+C[5]+4294588738&4294967295,b=T+(I<<4&4294967295|I>>>28),I=M+(b^T^P)+C[8]+2272392833&4294967295,M=b+(I<<11&4294967295|I>>>21),I=P+(M^b^T)+C[11]+1839030562&4294967295,P=M+(I<<16&4294967295|I>>>16),I=T+(P^M^b)+C[14]+4259657740&4294967295,T=P+(I<<23&4294967295|I>>>9),I=b+(T^P^M)+C[1]+2763975236&4294967295,b=T+(I<<4&4294967295|I>>>28),I=M+(b^T^P)+C[4]+1272893353&4294967295,M=b+(I<<11&4294967295|I>>>21),I=P+(M^b^T)+C[7]+4139469664&4294967295,P=M+(I<<16&4294967295|I>>>16),I=T+(P^M^b)+C[10]+3200236656&4294967295,T=P+(I<<23&4294967295|I>>>9),I=b+(T^P^M)+C[13]+681279174&4294967295,b=T+(I<<4&4294967295|I>>>28),I=M+(b^T^P)+C[0]+3936430074&4294967295,M=b+(I<<11&4294967295|I>>>21),I=P+(M^b^T)+C[3]+3572445317&4294967295,P=M+(I<<16&4294967295|I>>>16),I=T+(P^M^b)+C[6]+76029189&4294967295,T=P+(I<<23&4294967295|I>>>9),I=b+(T^P^M)+C[9]+3654602809&4294967295,b=T+(I<<4&4294967295|I>>>28),I=M+(b^T^P)+C[12]+3873151461&4294967295,M=b+(I<<11&4294967295|I>>>21),I=P+(M^b^T)+C[15]+530742520&4294967295,P=M+(I<<16&4294967295|I>>>16),I=T+(P^M^b)+C[2]+3299628645&4294967295,T=P+(I<<23&4294967295|I>>>9),I=b+(P^(T|~M))+C[0]+4096336452&4294967295,b=T+(I<<6&4294967295|I>>>26),I=M+(T^(b|~P))+C[7]+1126891415&4294967295,M=b+(I<<10&4294967295|I>>>22),I=P+(b^(M|~T))+C[14]+2878612391&4294967295,P=M+(I<<15&4294967295|I>>>17),I=T+(M^(P|~b))+C[5]+4237533241&4294967295,T=P+(I<<21&4294967295|I>>>11),I=b+(P^(T|~M))+C[12]+1700485571&4294967295,b=T+(I<<6&4294967295|I>>>26),I=M+(T^(b|~P))+C[3]+2399980690&4294967295,M=b+(I<<10&4294967295|I>>>22),I=P+(b^(M|~T))+C[10]+4293915773&4294967295,P=M+(I<<15&4294967295|I>>>17),I=T+(M^(P|~b))+C[1]+2240044497&4294967295,T=P+(I<<21&4294967295|I>>>11),I=b+(P^(T|~M))+C[8]+1873313359&4294967295,b=T+(I<<6&4294967295|I>>>26),I=M+(T^(b|~P))+C[15]+4264355552&4294967295,M=b+(I<<10&4294967295|I>>>22),I=P+(b^(M|~T))+C[6]+2734768916&4294967295,P=M+(I<<15&4294967295|I>>>17),I=T+(M^(P|~b))+C[13]+1309151649&4294967295,T=P+(I<<21&4294967295|I>>>11),I=b+(P^(T|~M))+C[4]+4149444226&4294967295,b=T+(I<<6&4294967295|I>>>26),I=M+(T^(b|~P))+C[11]+3174756917&4294967295,M=b+(I<<10&4294967295|I>>>22),I=P+(b^(M|~T))+C[2]+718787259&4294967295,P=M+(I<<15&4294967295|I>>>17),I=T+(M^(P|~b))+C[9]+3951481745&4294967295,x.g[0]=x.g[0]+b&4294967295,x.g[1]=x.g[1]+(P+(I<<21&4294967295|I>>>11))&4294967295,x.g[2]=x.g[2]+P&4294967295,x.g[3]=x.g[3]+M&4294967295}s.prototype.u=function(x,b){b===void 0&&(b=x.length);for(var T=b-this.blockSize,C=this.B,P=this.h,M=0;M<b;){if(P==0)for(;M<=T;)i(this,x,M),M+=this.blockSize;if(typeof x=="string"){for(;M<b;)if(C[P++]=x.charCodeAt(M++),P==this.blockSize){i(this,C),P=0;break}}else for(;M<b;)if(C[P++]=x[M++],P==this.blockSize){i(this,C),P=0;break}}this.h=P,this.o+=b},s.prototype.v=function(){var x=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);x[0]=128;for(var b=1;b<x.length-8;++b)x[b]=0;var T=8*this.o;for(b=x.length-8;b<x.length;++b)x[b]=T&255,T/=256;for(this.u(x),x=Array(16),b=T=0;4>b;++b)for(var C=0;32>C;C+=8)x[T++]=this.g[b]>>>C&255;return x};function r(x,b){var T=a;return Object.prototype.hasOwnProperty.call(T,x)?T[x]:T[x]=b(x)}function o(x,b){this.h=b;for(var T=[],C=!0,P=x.length-1;0<=P;P--){var M=x[P]|0;C&&M==b||(T[P]=M,C=!1)}this.g=T}var a={};function l(x){return-128<=x&&128>x?r(x,function(b){return new o([b|0],0>b?-1:0)}):new o([x|0],0>x?-1:0)}function c(x){if(isNaN(x)||!isFinite(x))return d;if(0>x)return w(c(-x));for(var b=[],T=1,C=0;x>=T;C++)b[C]=x/T|0,T*=4294967296;return new o(b,0)}function h(x,b){if(x.length==0)throw Error("number format error: empty string");if(b=b||10,2>b||36<b)throw Error("radix out of range: "+b);if(x.charAt(0)=="-")return w(h(x.substring(1),b));if(0<=x.indexOf("-"))throw Error('number format error: interior "-" character');for(var T=c(Math.pow(b,8)),C=d,P=0;P<x.length;P+=8){var M=Math.min(8,x.length-P),I=parseInt(x.substring(P,P+M),b);8>M?(M=c(Math.pow(b,M)),C=C.j(M).add(c(I))):(C=C.j(T),C=C.add(c(I)))}return C}var d=l(0),f=l(1),g=l(16777216);n=o.prototype,n.m=function(){if(y(this))return-w(this).m();for(var x=0,b=1,T=0;T<this.g.length;T++){var C=this.i(T);x+=(0<=C?C:4294967296+C)*b,b*=4294967296}return x},n.toString=function(x){if(x=x||10,2>x||36<x)throw Error("radix out of range: "+x);if(_(this))return"0";if(y(this))return"-"+w(this).toString(x);for(var b=c(Math.pow(x,6)),T=this,C="";;){var P=k(T,b).g;T=E(T,P.j(b));var M=((0<T.g.length?T.g[0]:T.h)>>>0).toString(x);if(T=P,_(T))return M+C;for(;6>M.length;)M="0"+M;C=M+C}},n.i=function(x){return 0>x?0:x<this.g.length?this.g[x]:this.h};function _(x){if(x.h!=0)return!1;for(var b=0;b<x.g.length;b++)if(x.g[b]!=0)return!1;return!0}function y(x){return x.h==-1}n.l=function(x){return x=E(this,x),y(x)?-1:_(x)?0:1};function w(x){for(var b=x.g.length,T=[],C=0;C<b;C++)T[C]=~x.g[C];return new o(T,~x.h).add(f)}n.abs=function(){return y(this)?w(this):this},n.add=function(x){for(var b=Math.max(this.g.length,x.g.length),T=[],C=0,P=0;P<=b;P++){var M=C+(this.i(P)&65535)+(x.i(P)&65535),I=(M>>>16)+(this.i(P)>>>16)+(x.i(P)>>>16);C=I>>>16,M&=65535,I&=65535,T[P]=I<<16|M}return new o(T,T[T.length-1]&-2147483648?-1:0)};function E(x,b){return x.add(w(b))}n.j=function(x){if(_(this)||_(x))return d;if(y(this))return y(x)?w(this).j(w(x)):w(w(this).j(x));if(y(x))return w(this.j(w(x)));if(0>this.l(g)&&0>x.l(g))return c(this.m()*x.m());for(var b=this.g.length+x.g.length,T=[],C=0;C<2*b;C++)T[C]=0;for(C=0;C<this.g.length;C++)for(var P=0;P<x.g.length;P++){var M=this.i(C)>>>16,I=this.i(C)&65535,yt=x.i(P)>>>16,st=x.i(P)&65535;T[2*C+2*P]+=I*st,S(T,2*C+2*P),T[2*C+2*P+1]+=M*st,S(T,2*C+2*P+1),T[2*C+2*P+1]+=I*yt,S(T,2*C+2*P+1),T[2*C+2*P+2]+=M*yt,S(T,2*C+2*P+2)}for(C=0;C<b;C++)T[C]=T[2*C+1]<<16|T[2*C];for(C=b;C<2*b;C++)T[C]=0;return new o(T,0)};function S(x,b){for(;(x[b]&65535)!=x[b];)x[b+1]+=x[b]>>>16,x[b]&=65535,b++}function A(x,b){this.g=x,this.h=b}function k(x,b){if(_(b))throw Error("division by zero");if(_(x))return new A(d,d);if(y(x))return b=k(w(x),b),new A(w(b.g),w(b.h));if(y(b))return b=k(x,w(b)),new A(w(b.g),b.h);if(30<x.g.length){if(y(x)||y(b))throw Error("slowDivide_ only works with positive integers.");for(var T=f,C=b;0>=C.l(x);)T=R(T),C=R(C);var P=L(T,1),M=L(C,1);for(C=L(C,2),T=L(T,2);!_(C);){var I=M.add(C);0>=I.l(x)&&(P=P.add(T),M=I),C=L(C,1),T=L(T,1)}return b=E(x,P.j(b)),new A(P,b)}for(P=d;0<=x.l(b);){for(T=Math.max(1,Math.floor(x.m()/b.m())),C=Math.ceil(Math.log(T)/Math.LN2),C=48>=C?1:Math.pow(2,C-48),M=c(T),I=M.j(b);y(I)||0<I.l(x);)T-=C,M=c(T),I=M.j(b);_(M)&&(M=f),P=P.add(M),x=E(x,I)}return new A(P,x)}n.A=function(x){return k(this,x).h},n.and=function(x){for(var b=Math.max(this.g.length,x.g.length),T=[],C=0;C<b;C++)T[C]=this.i(C)&x.i(C);return new o(T,this.h&x.h)},n.or=function(x){for(var b=Math.max(this.g.length,x.g.length),T=[],C=0;C<b;C++)T[C]=this.i(C)|x.i(C);return new o(T,this.h|x.h)},n.xor=function(x){for(var b=Math.max(this.g.length,x.g.length),T=[],C=0;C<b;C++)T[C]=this.i(C)^x.i(C);return new o(T,this.h^x.h)};function R(x){for(var b=x.g.length+1,T=[],C=0;C<b;C++)T[C]=x.i(C)<<1|x.i(C-1)>>>31;return new o(T,x.h)}function L(x,b){var T=b>>5;b%=32;for(var C=x.g.length-T,P=[],M=0;M<C;M++)P[M]=0<b?x.i(M+T)>>>b|x.i(M+T+1)<<32-b:x.i(M+T);return new o(P,x.h)}s.prototype.digest=s.prototype.v,s.prototype.reset=s.prototype.s,s.prototype.update=s.prototype.u,wv=s,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=h,Ys=o}).apply(typeof em<"u"?em:typeof self<"u"?self:typeof window<"u"?window:{});var tl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var xv,po,Tv,Sl,Dh,Ev,Iv,Av;(function(){var n,t=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,p,m){return u==Array.prototype||u==Object.prototype||(u[p]=m.value),u};function e(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof tl=="object"&&tl];for(var p=0;p<u.length;++p){var m=u[p];if(m&&m.Math==Math)return m}throw Error("Cannot find global object")}var s=e(this);function i(u,p){if(p)t:{var m=s;u=u.split(".");for(var v=0;v<u.length-1;v++){var V=u[v];if(!(V in m))break t;m=m[V]}u=u[u.length-1],v=m[u],p=p(v),p!=v&&p!=null&&t(m,u,{configurable:!0,writable:!0,value:p})}}function r(u,p){u instanceof String&&(u+="");var m=0,v=!1,V={next:function(){if(!v&&m<u.length){var F=m++;return{value:p(F,u[F]),done:!1}}return v=!0,{done:!0,value:void 0}}};return V[Symbol.iterator]=function(){return V},V}i("Array.prototype.values",function(u){return u||function(){return r(this,function(p,m){return m})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(u){var p=typeof u;return p=p!="object"?p:u?Array.isArray(u)?"array":p:"null",p=="array"||p=="object"&&typeof u.length=="number"}function c(u){var p=typeof u;return p=="object"&&u!=null||p=="function"}function h(u,p,m){return u.call.apply(u.bind,arguments)}function d(u,p,m){if(!u)throw Error();if(2<arguments.length){var v=Array.prototype.slice.call(arguments,2);return function(){var V=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(V,v),u.apply(p,V)}}return function(){return u.apply(p,arguments)}}function f(u,p,m){return f=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:d,f.apply(null,arguments)}function g(u,p){var m=Array.prototype.slice.call(arguments,1);return function(){var v=m.slice();return v.push.apply(v,arguments),u.apply(this,v)}}function _(u,p){function m(){}m.prototype=p.prototype,u.aa=p.prototype,u.prototype=new m,u.prototype.constructor=u,u.Qb=function(v,V,F){for(var Y=Array(arguments.length-2),Wt=2;Wt<arguments.length;Wt++)Y[Wt-2]=arguments[Wt];return p.prototype[V].apply(v,Y)}}function y(u){const p=u.length;if(0<p){const m=Array(p);for(let v=0;v<p;v++)m[v]=u[v];return m}return[]}function w(u,p){for(let m=1;m<arguments.length;m++){const v=arguments[m];if(l(v)){const V=u.length||0,F=v.length||0;u.length=V+F;for(let Y=0;Y<F;Y++)u[V+Y]=v[Y]}else u.push(v)}}class E{constructor(p,m){this.i=p,this.j=m,this.h=0,this.g=null}get(){let p;return 0<this.h?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function S(u){return/^[\s\xa0]*$/.test(u)}function A(){var u=a.navigator;return u&&(u=u.userAgent)?u:""}function k(u){return k[" "](u),u}k[" "]=function(){};var R=A().indexOf("Gecko")!=-1&&!(A().toLowerCase().indexOf("webkit")!=-1&&A().indexOf("Edge")==-1)&&!(A().indexOf("Trident")!=-1||A().indexOf("MSIE")!=-1)&&A().indexOf("Edge")==-1;function L(u,p,m){for(const v in u)p.call(m,u[v],v,u)}function x(u,p){for(const m in u)p.call(void 0,u[m],m,u)}function b(u){const p={};for(const m in u)p[m]=u[m];return p}const T="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(u,p){let m,v;for(let V=1;V<arguments.length;V++){v=arguments[V];for(m in v)u[m]=v[m];for(let F=0;F<T.length;F++)m=T[F],Object.prototype.hasOwnProperty.call(v,m)&&(u[m]=v[m])}}function P(u){var p=1;u=u.split(":");const m=[];for(;0<p&&u.length;)m.push(u.shift()),p--;return u.length&&m.push(u.join(":")),m}function M(u){a.setTimeout(()=>{throw u},0)}function I(){var u=Bt;let p=null;return u.g&&(p=u.g,u.g=u.g.next,u.g||(u.h=null),p.next=null),p}class yt{constructor(){this.h=this.g=null}add(p,m){const v=st.get();v.set(p,m),this.h?this.h.next=v:this.g=v,this.h=v}}var st=new E(()=>new mt,u=>u.reset());class mt{constructor(){this.next=this.g=this.h=null}set(p,m){this.h=p,this.g=m,this.next=null}reset(){this.next=this.g=this.h=null}}let ot,at=!1,Bt=new yt,lt=()=>{const u=a.Promise.resolve(void 0);ot=()=>{u.then(it)}};var it=()=>{for(var u;u=I();){try{u.h.call(u.g)}catch(m){M(m)}var p=st;p.j(u),100>p.h&&(p.h++,u.next=p.g,p.g=u)}at=!1};function q(){this.s=this.s,this.C=this.C}q.prototype.s=!1,q.prototype.ma=function(){this.s||(this.s=!0,this.N())},q.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Z(u,p){this.type=u,this.g=this.target=p,this.defaultPrevented=!1}Z.prototype.h=function(){this.defaultPrevented=!0};var Ft=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var u=!1,p=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const m=()=>{};a.addEventListener("test",m,p),a.removeEventListener("test",m,p)}catch{}return u}();function St(u,p){if(Z.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var m=this.type=u.type,v=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=p,p=u.relatedTarget){if(R){t:{try{k(p.nodeName);var V=!0;break t}catch{}V=!1}V||(p=null)}}else m=="mouseover"?p=u.fromElement:m=="mouseout"&&(p=u.toElement);this.relatedTarget=p,v?(this.clientX=v.clientX!==void 0?v.clientX:v.pageX,this.clientY=v.clientY!==void 0?v.clientY:v.pageY,this.screenX=v.screenX||0,this.screenY=v.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:At[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&St.aa.h.call(this)}}_(St,Z);var At={2:"touch",3:"pen",4:"mouse"};St.prototype.h=function(){St.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var ue="closure_listenable_"+(1e6*Math.random()|0),yn=0;function Da(u,p,m,v,V){this.listener=u,this.proxy=null,this.src=p,this.type=m,this.capture=!!v,this.ha=V,this.key=++yn,this.da=this.fa=!1}function Sn(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function jr(u){this.src=u,this.g={},this.h=0}jr.prototype.add=function(u,p,m,v,V){var F=u.toString();u=this.g[F],u||(u=this.g[F]=[],this.h++);var Y=O(u,p,v,V);return-1<Y?(p=u[Y],m||(p.fa=!1)):(p=new Da(p,this.src,F,!!v,V),p.fa=m,u.push(p)),p};function D(u,p){var m=p.type;if(m in u.g){var v=u.g[m],V=Array.prototype.indexOf.call(v,p,void 0),F;(F=0<=V)&&Array.prototype.splice.call(v,V,1),F&&(Sn(p),u.g[m].length==0&&(delete u.g[m],u.h--))}}function O(u,p,m,v){for(var V=0;V<u.length;++V){var F=u[V];if(!F.da&&F.listener==p&&F.capture==!!m&&F.ha==v)return V}return-1}var B="closure_lm_"+(1e6*Math.random()|0),H={};function z(u,p,m,v,V){if(Array.isArray(p)){for(var F=0;F<p.length;F++)z(u,p[F],m,v,V);return null}return m=gt(m),u&&u[ue]?u.K(p,m,c(v)?!!v.capture:!1,V):j(u,p,m,!1,v,V)}function j(u,p,m,v,V,F){if(!p)throw Error("Invalid event type");var Y=c(V)?!!V.capture:!!V,Wt=X(u);if(Wt||(u[B]=Wt=new jr(u)),m=Wt.add(p,m,v,Y,F),m.proxy)return m;if(v=Q(),m.proxy=v,v.src=u,v.listener=m,u.addEventListener)Ft||(V=Y),V===void 0&&(V=!1),u.addEventListener(p.toString(),v,V);else if(u.attachEvent)u.attachEvent(W(p.toString()),v);else if(u.addListener&&u.removeListener)u.addListener(v);else throw Error("addEventListener and attachEvent are unavailable.");return m}function Q(){function u(m){return p.call(u.src,u.listener,m)}const p=ct;return u}function K(u,p,m,v,V){if(Array.isArray(p))for(var F=0;F<p.length;F++)K(u,p[F],m,v,V);else v=c(v)?!!v.capture:!!v,m=gt(m),u&&u[ue]?(u=u.i,p=String(p).toString(),p in u.g&&(F=u.g[p],m=O(F,m,v,V),-1<m&&(Sn(F[m]),Array.prototype.splice.call(F,m,1),F.length==0&&(delete u.g[p],u.h--)))):u&&(u=X(u))&&(p=u.g[p.toString()],u=-1,p&&(u=O(p,m,v,V)),(m=-1<u?p[u]:null)&&G(m))}function G(u){if(typeof u!="number"&&u&&!u.da){var p=u.src;if(p&&p[ue])D(p.i,u);else{var m=u.type,v=u.proxy;p.removeEventListener?p.removeEventListener(m,v,u.capture):p.detachEvent?p.detachEvent(W(m),v):p.addListener&&p.removeListener&&p.removeListener(v),(m=X(p))?(D(m,u),m.h==0&&(m.src=null,p[B]=null)):Sn(u)}}}function W(u){return u in H?H[u]:H[u]="on"+u}function ct(u,p){if(u.da)u=!0;else{p=new St(p,this);var m=u.listener,v=u.ha||u.src;u.fa&&G(u),u=m.call(v,p)}return u}function X(u){return u=u[B],u instanceof jr?u:null}var rt="__closure_events_fn_"+(1e9*Math.random()>>>0);function gt(u){return typeof u=="function"?u:(u[rt]||(u[rt]=function(p){return u.handleEvent(p)}),u[rt])}function dt(){q.call(this),this.i=new jr(this),this.M=this,this.F=null}_(dt,q),dt.prototype[ue]=!0,dt.prototype.removeEventListener=function(u,p,m,v){K(this,u,p,m,v)};function Tt(u,p){var m,v=u.F;if(v)for(m=[];v;v=v.F)m.push(v);if(u=u.M,v=p.type||p,typeof p=="string")p=new Z(p,u);else if(p instanceof Z)p.target=p.target||u;else{var V=p;p=new Z(v,u),C(p,V)}if(V=!0,m)for(var F=m.length-1;0<=F;F--){var Y=p.g=m[F];V=Ot(Y,v,!0,p)&&V}if(Y=p.g=u,V=Ot(Y,v,!0,p)&&V,V=Ot(Y,v,!1,p)&&V,m)for(F=0;F<m.length;F++)Y=p.g=m[F],V=Ot(Y,v,!1,p)&&V}dt.prototype.N=function(){if(dt.aa.N.call(this),this.i){var u=this.i,p;for(p in u.g){for(var m=u.g[p],v=0;v<m.length;v++)Sn(m[v]);delete u.g[p],u.h--}}this.F=null},dt.prototype.K=function(u,p,m,v){return this.i.add(String(u),p,!1,m,v)},dt.prototype.L=function(u,p,m,v){return this.i.add(String(u),p,!0,m,v)};function Ot(u,p,m,v){if(p=u.i.g[String(p)],!p)return!0;p=p.concat();for(var V=!0,F=0;F<p.length;++F){var Y=p[F];if(Y&&!Y.da&&Y.capture==m){var Wt=Y.listener,Te=Y.ha||Y.src;Y.fa&&D(u.i,Y),V=Wt.call(Te,v)!==!1&&V}}return V&&!v.defaultPrevented}function ve(u,p,m){if(typeof u=="function")m&&(u=f(u,m));else if(u&&typeof u.handleEvent=="function")u=f(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(p)?-1:a.setTimeout(u,p||0)}function we(u){u.g=ve(()=>{u.g=null,u.i&&(u.i=!1,we(u))},u.l);const p=u.h;u.h=null,u.m.apply(null,p)}class un extends q{constructor(p,m){super(),this.m=p,this.l=m,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:we(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Pe(u){q.call(this),this.h=u,this.g={}}_(Pe,q);var Cs=[];function Hr(u){L(u.g,function(p,m){this.g.hasOwnProperty(m)&&G(p)},u),u.g={}}Pe.prototype.N=function(){Pe.aa.N.call(this),Hr(this)},Pe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var xe=a.JSON.stringify,hn=a.JSON.parse,Ma=class{stringify(u){return a.JSON.stringify(u,void 0)}parse(u){return a.JSON.parse(u,void 0)}};function Yi(){}Yi.prototype.h=null;function ip(u){return u.h||(u.h=u.i())}function rp(){}var Wr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function gu(){Z.call(this,"d")}_(gu,Z);function mu(){Z.call(this,"c")}_(mu,Z);var pi={},op=null;function Oa(){return op=op||new dt}pi.La="serverreachability";function ap(u){Z.call(this,pi.La,u)}_(ap,Z);function qr(u){const p=Oa();Tt(p,new ap(p))}pi.STAT_EVENT="statevent";function lp(u,p){Z.call(this,pi.STAT_EVENT,u),this.stat=p}_(lp,Z);function je(u){const p=Oa();Tt(p,new lp(p,u))}pi.Ma="timingevent";function cp(u,p){Z.call(this,pi.Ma,u),this.size=p}_(cp,Z);function Gr(u,p){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){u()},p)}function Kr(){this.g=!0}Kr.prototype.xa=function(){this.g=!1};function mx(u,p,m,v,V,F){u.info(function(){if(u.g)if(F)for(var Y="",Wt=F.split("&"),Te=0;Te<Wt.length;Te++){var Vt=Wt[Te].split("=");if(1<Vt.length){var Re=Vt[0];Vt=Vt[1];var ke=Re.split("_");Y=2<=ke.length&&ke[1]=="type"?Y+(Re+"="+Vt+"&"):Y+(Re+"=redacted&")}}else Y=null;else Y=F;return"XMLHTTP REQ ("+v+") [attempt "+V+"]: "+p+`
`+m+`
`+Y})}function _x(u,p,m,v,V,F,Y){u.info(function(){return"XMLHTTP RESP ("+v+") [ attempt "+V+"]: "+p+`
`+m+`
`+F+" "+Y})}function Xi(u,p,m,v){u.info(function(){return"XMLHTTP TEXT ("+p+"): "+bx(u,m)+(v?" "+v:"")})}function yx(u,p){u.info(function(){return"TIMEOUT: "+p})}Kr.prototype.info=function(){};function bx(u,p){if(!u.g)return p;if(!p)return null;try{var m=JSON.parse(p);if(m){for(u=0;u<m.length;u++)if(Array.isArray(m[u])){var v=m[u];if(!(2>v.length)){var V=v[1];if(Array.isArray(V)&&!(1>V.length)){var F=V[0];if(F!="noop"&&F!="stop"&&F!="close")for(var Y=1;Y<V.length;Y++)V[Y]=""}}}}return xe(m)}catch{return p}}var La={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},up={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},_u;function Va(){}_(Va,Yi),Va.prototype.g=function(){return new XMLHttpRequest},Va.prototype.i=function(){return{}},_u=new Va;function Ps(u,p,m,v){this.j=u,this.i=p,this.l=m,this.R=v||1,this.U=new Pe(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new hp}function hp(){this.i=null,this.g="",this.h=!1}var dp={},yu={};function bu(u,p,m){u.L=1,u.v=Ua(Yn(p)),u.m=m,u.P=!0,fp(u,null)}function fp(u,p){u.F=Date.now(),Na(u),u.A=Yn(u.v);var m=u.A,v=u.R;Array.isArray(v)||(v=[String(v)]),Sp(m.i,"t",v),u.C=0,m=u.j.J,u.h=new hp,u.g=Wp(u.j,m?p:null,!u.m),0<u.O&&(u.M=new un(f(u.Y,u,u.g),u.O)),p=u.U,m=u.g,v=u.ca;var V="readystatechange";Array.isArray(V)||(V&&(Cs[0]=V.toString()),V=Cs);for(var F=0;F<V.length;F++){var Y=z(m,V[F],v||p.handleEvent,!1,p.h||p);if(!Y)break;p.g[Y.key]=Y}p=u.H?b(u.H):{},u.m?(u.u||(u.u="POST"),p["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,p)):(u.u="GET",u.g.ea(u.A,u.u,null,p)),qr(),mx(u.i,u.u,u.A,u.l,u.R,u.m)}Ps.prototype.ca=function(u){u=u.target;const p=this.M;p&&Xn(u)==3?p.j():this.Y(u)},Ps.prototype.Y=function(u){try{if(u==this.g)t:{const ke=Xn(this.g);var p=this.g.Ba();const Zi=this.g.Z();if(!(3>ke)&&(ke!=3||this.g&&(this.h.h||this.g.oa()||Op(this.g)))){this.J||ke!=4||p==7||(p==8||0>=Zi?qr(3):qr(2)),vu(this);var m=this.g.Z();this.X=m;e:if(pp(this)){var v=Op(this.g);u="";var V=v.length,F=Xn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){gi(this),Yr(this);var Y="";break e}this.h.i=new a.TextDecoder}for(p=0;p<V;p++)this.h.h=!0,u+=this.h.i.decode(v[p],{stream:!(F&&p==V-1)});v.length=0,this.h.g+=u,this.C=0,Y=this.h.g}else Y=this.g.oa();if(this.o=m==200,_x(this.i,this.u,this.A,this.l,this.R,ke,m),this.o){if(this.T&&!this.K){e:{if(this.g){var Wt,Te=this.g;if((Wt=Te.g?Te.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!S(Wt)){var Vt=Wt;break e}}Vt=null}if(m=Vt)Xi(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,wu(this,m);else{this.o=!1,this.s=3,je(12),gi(this),Yr(this);break t}}if(this.P){m=!0;let bn;for(;!this.J&&this.C<Y.length;)if(bn=vx(this,Y),bn==yu){ke==4&&(this.s=4,je(14),m=!1),Xi(this.i,this.l,null,"[Incomplete Response]");break}else if(bn==dp){this.s=4,je(15),Xi(this.i,this.l,Y,"[Invalid Chunk]"),m=!1;break}else Xi(this.i,this.l,bn,null),wu(this,bn);if(pp(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ke!=4||Y.length!=0||this.h.h||(this.s=1,je(16),m=!1),this.o=this.o&&m,!m)Xi(this.i,this.l,Y,"[Invalid Chunked Response]"),gi(this),Yr(this);else if(0<Y.length&&!this.W){this.W=!0;var Re=this.j;Re.g==this&&Re.ba&&!Re.M&&(Re.j.info("Great, no buffering proxy detected. Bytes received: "+Y.length),Su(Re),Re.M=!0,je(11))}}else Xi(this.i,this.l,Y,null),wu(this,Y);ke==4&&gi(this),this.o&&!this.J&&(ke==4?$p(this.j,this):(this.o=!1,Na(this)))}else Nx(this.g),m==400&&0<Y.indexOf("Unknown SID")?(this.s=3,je(12)):(this.s=0,je(13)),gi(this),Yr(this)}}}catch{}finally{}};function pp(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function vx(u,p){var m=u.C,v=p.indexOf(`
`,m);return v==-1?yu:(m=Number(p.substring(m,v)),isNaN(m)?dp:(v+=1,v+m>p.length?yu:(p=p.slice(v,v+m),u.C=v+m,p)))}Ps.prototype.cancel=function(){this.J=!0,gi(this)};function Na(u){u.S=Date.now()+u.I,gp(u,u.I)}function gp(u,p){if(u.B!=null)throw Error("WatchDog timer not null");u.B=Gr(f(u.ba,u),p)}function vu(u){u.B&&(a.clearTimeout(u.B),u.B=null)}Ps.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(yx(this.i,this.A),this.L!=2&&(qr(),je(17)),gi(this),this.s=2,Yr(this)):gp(this,this.S-u)};function Yr(u){u.j.G==0||u.J||$p(u.j,u)}function gi(u){vu(u);var p=u.M;p&&typeof p.ma=="function"&&p.ma(),u.M=null,Hr(u.U),u.g&&(p=u.g,u.g=null,p.abort(),p.ma())}function wu(u,p){try{var m=u.j;if(m.G!=0&&(m.g==u||xu(m.h,u))){if(!u.K&&xu(m.h,u)&&m.G==3){try{var v=m.Da.g.parse(p)}catch{v=null}if(Array.isArray(v)&&v.length==3){var V=v;if(V[0]==0){t:if(!m.u){if(m.g)if(m.g.F+3e3<u.F)qa(m),Ha(m);else break t;Au(m),je(18)}}else m.za=V[1],0<m.za-m.T&&37500>V[2]&&m.F&&m.v==0&&!m.C&&(m.C=Gr(f(m.Za,m),6e3));if(1>=yp(m.h)&&m.ca){try{m.ca()}catch{}m.ca=void 0}}else _i(m,11)}else if((u.K||m.g==u)&&qa(m),!S(p))for(V=m.Da.g.parse(p),p=0;p<V.length;p++){let Vt=V[p];if(m.T=Vt[0],Vt=Vt[1],m.G==2)if(Vt[0]=="c"){m.K=Vt[1],m.ia=Vt[2];const Re=Vt[3];Re!=null&&(m.la=Re,m.j.info("VER="+m.la));const ke=Vt[4];ke!=null&&(m.Aa=ke,m.j.info("SVER="+m.Aa));const Zi=Vt[5];Zi!=null&&typeof Zi=="number"&&0<Zi&&(v=1.5*Zi,m.L=v,m.j.info("backChannelRequestTimeoutMs_="+v)),v=m;const bn=u.g;if(bn){const Ka=bn.g?bn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ka){var F=v.h;F.g||Ka.indexOf("spdy")==-1&&Ka.indexOf("quic")==-1&&Ka.indexOf("h2")==-1||(F.j=F.l,F.g=new Set,F.h&&(Tu(F,F.h),F.h=null))}if(v.D){const Cu=bn.g?bn.g.getResponseHeader("X-HTTP-Session-Id"):null;Cu&&(v.ya=Cu,Zt(v.I,v.D,Cu))}}m.G=3,m.l&&m.l.ua(),m.ba&&(m.R=Date.now()-u.F,m.j.info("Handshake RTT: "+m.R+"ms")),v=m;var Y=u;if(v.qa=Hp(v,v.J?v.ia:null,v.W),Y.K){bp(v.h,Y);var Wt=Y,Te=v.L;Te&&(Wt.I=Te),Wt.B&&(vu(Wt),Na(Wt)),v.g=Y}else Bp(v);0<m.i.length&&Wa(m)}else Vt[0]!="stop"&&Vt[0]!="close"||_i(m,7);else m.G==3&&(Vt[0]=="stop"||Vt[0]=="close"?Vt[0]=="stop"?_i(m,7):Iu(m):Vt[0]!="noop"&&m.l&&m.l.ta(Vt),m.v=0)}}qr(4)}catch{}}var wx=class{constructor(u,p){this.g=u,this.map=p}};function mp(u){this.l=u||10,a.PerformanceNavigationTiming?(u=a.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function _p(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function yp(u){return u.h?1:u.g?u.g.size:0}function xu(u,p){return u.h?u.h==p:u.g?u.g.has(p):!1}function Tu(u,p){u.g?u.g.add(p):u.h=p}function bp(u,p){u.h&&u.h==p?u.h=null:u.g&&u.g.has(p)&&u.g.delete(p)}mp.prototype.cancel=function(){if(this.i=vp(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function vp(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let p=u.i;for(const m of u.g.values())p=p.concat(m.D);return p}return y(u.i)}function xx(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(l(u)){for(var p=[],m=u.length,v=0;v<m;v++)p.push(u[v]);return p}p=[],m=0;for(v in u)p[m++]=u[v];return p}function Tx(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(l(u)||typeof u=="string"){var p=[];u=u.length;for(var m=0;m<u;m++)p.push(m);return p}p=[],m=0;for(const v in u)p[m++]=v;return p}}}function wp(u,p){if(u.forEach&&typeof u.forEach=="function")u.forEach(p,void 0);else if(l(u)||typeof u=="string")Array.prototype.forEach.call(u,p,void 0);else for(var m=Tx(u),v=xx(u),V=v.length,F=0;F<V;F++)p.call(void 0,v[F],m&&m[F],u)}var xp=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ex(u,p){if(u){u=u.split("&");for(var m=0;m<u.length;m++){var v=u[m].indexOf("="),V=null;if(0<=v){var F=u[m].substring(0,v);V=u[m].substring(v+1)}else F=u[m];p(F,V?decodeURIComponent(V.replace(/\+/g," ")):"")}}}function mi(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof mi){this.h=u.h,Fa(this,u.j),this.o=u.o,this.g=u.g,Ba(this,u.s),this.l=u.l;var p=u.i,m=new Jr;m.i=p.i,p.g&&(m.g=new Map(p.g),m.h=p.h),Tp(this,m),this.m=u.m}else u&&(p=String(u).match(xp))?(this.h=!1,Fa(this,p[1]||"",!0),this.o=Xr(p[2]||""),this.g=Xr(p[3]||"",!0),Ba(this,p[4]),this.l=Xr(p[5]||"",!0),Tp(this,p[6]||"",!0),this.m=Xr(p[7]||"")):(this.h=!1,this.i=new Jr(null,this.h))}mi.prototype.toString=function(){var u=[],p=this.j;p&&u.push(Qr(p,Ep,!0),":");var m=this.g;return(m||p=="file")&&(u.push("//"),(p=this.o)&&u.push(Qr(p,Ep,!0),"@"),u.push(encodeURIComponent(String(m)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m=this.s,m!=null&&u.push(":",String(m))),(m=this.l)&&(this.g&&m.charAt(0)!="/"&&u.push("/"),u.push(Qr(m,m.charAt(0)=="/"?Sx:Ax,!0))),(m=this.i.toString())&&u.push("?",m),(m=this.m)&&u.push("#",Qr(m,Px)),u.join("")};function Yn(u){return new mi(u)}function Fa(u,p,m){u.j=m?Xr(p,!0):p,u.j&&(u.j=u.j.replace(/:$/,""))}function Ba(u,p){if(p){if(p=Number(p),isNaN(p)||0>p)throw Error("Bad port number "+p);u.s=p}else u.s=null}function Tp(u,p,m){p instanceof Jr?(u.i=p,Rx(u.i,u.h)):(m||(p=Qr(p,Cx)),u.i=new Jr(p,u.h))}function Zt(u,p,m){u.i.set(p,m)}function Ua(u){return Zt(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function Xr(u,p){return u?p?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function Qr(u,p,m){return typeof u=="string"?(u=encodeURI(u).replace(p,Ix),m&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function Ix(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var Ep=/[#\/\?@]/g,Ax=/[#\?:]/g,Sx=/[#\?]/g,Cx=/[#\?@]/g,Px=/#/g;function Jr(u,p){this.h=this.g=null,this.i=u||null,this.j=!!p}function Rs(u){u.g||(u.g=new Map,u.h=0,u.i&&Ex(u.i,function(p,m){u.add(decodeURIComponent(p.replace(/\+/g," ")),m)}))}n=Jr.prototype,n.add=function(u,p){Rs(this),this.i=null,u=Qi(this,u);var m=this.g.get(u);return m||this.g.set(u,m=[]),m.push(p),this.h+=1,this};function Ip(u,p){Rs(u),p=Qi(u,p),u.g.has(p)&&(u.i=null,u.h-=u.g.get(p).length,u.g.delete(p))}function Ap(u,p){return Rs(u),p=Qi(u,p),u.g.has(p)}n.forEach=function(u,p){Rs(this),this.g.forEach(function(m,v){m.forEach(function(V){u.call(p,V,v,this)},this)},this)},n.na=function(){Rs(this);const u=Array.from(this.g.values()),p=Array.from(this.g.keys()),m=[];for(let v=0;v<p.length;v++){const V=u[v];for(let F=0;F<V.length;F++)m.push(p[v])}return m},n.V=function(u){Rs(this);let p=[];if(typeof u=="string")Ap(this,u)&&(p=p.concat(this.g.get(Qi(this,u))));else{u=Array.from(this.g.values());for(let m=0;m<u.length;m++)p=p.concat(u[m])}return p},n.set=function(u,p){return Rs(this),this.i=null,u=Qi(this,u),Ap(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[p]),this.h+=1,this},n.get=function(u,p){return u?(u=this.V(u),0<u.length?String(u[0]):p):p};function Sp(u,p,m){Ip(u,p),0<m.length&&(u.i=null,u.g.set(Qi(u,p),y(m)),u.h+=m.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],p=Array.from(this.g.keys());for(var m=0;m<p.length;m++){var v=p[m];const F=encodeURIComponent(String(v)),Y=this.V(v);for(v=0;v<Y.length;v++){var V=F;Y[v]!==""&&(V+="="+encodeURIComponent(String(Y[v]))),u.push(V)}}return this.i=u.join("&")};function Qi(u,p){return p=String(p),u.j&&(p=p.toLowerCase()),p}function Rx(u,p){p&&!u.j&&(Rs(u),u.i=null,u.g.forEach(function(m,v){var V=v.toLowerCase();v!=V&&(Ip(this,v),Sp(this,V,m))},u)),u.j=p}function kx(u,p){const m=new Kr;if(a.Image){const v=new Image;v.onload=g(ks,m,"TestLoadImage: loaded",!0,p,v),v.onerror=g(ks,m,"TestLoadImage: error",!1,p,v),v.onabort=g(ks,m,"TestLoadImage: abort",!1,p,v),v.ontimeout=g(ks,m,"TestLoadImage: timeout",!1,p,v),a.setTimeout(function(){v.ontimeout&&v.ontimeout()},1e4),v.src=u}else p(!1)}function Dx(u,p){const m=new Kr,v=new AbortController,V=setTimeout(()=>{v.abort(),ks(m,"TestPingServer: timeout",!1,p)},1e4);fetch(u,{signal:v.signal}).then(F=>{clearTimeout(V),F.ok?ks(m,"TestPingServer: ok",!0,p):ks(m,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(V),ks(m,"TestPingServer: error",!1,p)})}function ks(u,p,m,v,V){try{V&&(V.onload=null,V.onerror=null,V.onabort=null,V.ontimeout=null),v(m)}catch{}}function Mx(){this.g=new Ma}function Ox(u,p,m){const v=m||"";try{wp(u,function(V,F){let Y=V;c(V)&&(Y=xe(V)),p.push(v+F+"="+encodeURIComponent(Y))})}catch(V){throw p.push(v+"type="+encodeURIComponent("_badmap")),V}}function $a(u){this.l=u.Ub||null,this.j=u.eb||!1}_($a,Yi),$a.prototype.g=function(){return new za(this.l,this.j)},$a.prototype.i=function(u){return function(){return u}}({});function za(u,p){dt.call(this),this.D=u,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}_(za,dt),n=za.prototype,n.open=function(u,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=p,this.readyState=1,to(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const p={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(p.body=u),(this.D||a).fetch(new Request(this.A,p)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Zr(this)),this.readyState=0},n.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,to(this)),this.g&&(this.readyState=3,to(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Cp(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function Cp(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}n.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var p=u.value?u.value:new Uint8Array(0);(p=this.v.decode(p,{stream:!u.done}))&&(this.response=this.responseText+=p)}u.done?Zr(this):to(this),this.readyState==3&&Cp(this)}},n.Ra=function(u){this.g&&(this.response=this.responseText=u,Zr(this))},n.Qa=function(u){this.g&&(this.response=u,Zr(this))},n.ga=function(){this.g&&Zr(this)};function Zr(u){u.readyState=4,u.l=null,u.j=null,u.v=null,to(u)}n.setRequestHeader=function(u,p){this.u.append(u,p)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],p=this.h.entries();for(var m=p.next();!m.done;)m=m.value,u.push(m[0]+": "+m[1]),m=p.next();return u.join(`\r
`)};function to(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(za.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function Pp(u){let p="";return L(u,function(m,v){p+=v,p+=":",p+=m,p+=`\r
`}),p}function Eu(u,p,m){t:{for(v in m){var v=!1;break t}v=!0}v||(m=Pp(m),typeof u=="string"?m!=null&&encodeURIComponent(String(m)):Zt(u,p,m))}function re(u){dt.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}_(re,dt);var Lx=/^https?$/i,Vx=["POST","PUT"];n=re.prototype,n.Ha=function(u){this.J=u},n.ea=function(u,p,m,v){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);p=p?p.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():_u.g(),this.v=this.o?ip(this.o):ip(_u),this.g.onreadystatechange=f(this.Ea,this);try{this.B=!0,this.g.open(p,String(u),!0),this.B=!1}catch(F){Rp(this,F);return}if(u=m||"",m=new Map(this.headers),v)if(Object.getPrototypeOf(v)===Object.prototype)for(var V in v)m.set(V,v[V]);else if(typeof v.keys=="function"&&typeof v.get=="function")for(const F of v.keys())m.set(F,v.get(F));else throw Error("Unknown input type for opt_headers: "+String(v));v=Array.from(m.keys()).find(F=>F.toLowerCase()=="content-type"),V=a.FormData&&u instanceof a.FormData,!(0<=Array.prototype.indexOf.call(Vx,p,void 0))||v||V||m.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[F,Y]of m)this.g.setRequestHeader(F,Y);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Mp(this),this.u=!0,this.g.send(u),this.u=!1}catch(F){Rp(this,F)}};function Rp(u,p){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=p,u.m=5,kp(u),ja(u)}function kp(u){u.A||(u.A=!0,Tt(u,"complete"),Tt(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,Tt(this,"complete"),Tt(this,"abort"),ja(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ja(this,!0)),re.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Dp(this):this.bb())},n.bb=function(){Dp(this)};function Dp(u){if(u.h&&typeof o<"u"&&(!u.v[1]||Xn(u)!=4||u.Z()!=2)){if(u.u&&Xn(u)==4)ve(u.Ea,0,u);else if(Tt(u,"readystatechange"),Xn(u)==4){u.h=!1;try{const Y=u.Z();t:switch(Y){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break t;default:p=!1}var m;if(!(m=p)){var v;if(v=Y===0){var V=String(u.D).match(xp)[1]||null;!V&&a.self&&a.self.location&&(V=a.self.location.protocol.slice(0,-1)),v=!Lx.test(V?V.toLowerCase():"")}m=v}if(m)Tt(u,"complete"),Tt(u,"success");else{u.m=6;try{var F=2<Xn(u)?u.g.statusText:""}catch{F=""}u.l=F+" ["+u.Z()+"]",kp(u)}}finally{ja(u)}}}}function ja(u,p){if(u.g){Mp(u);const m=u.g,v=u.v[0]?()=>{}:null;u.g=null,u.v=null,p||Tt(u,"ready");try{m.onreadystatechange=v}catch{}}}function Mp(u){u.I&&(a.clearTimeout(u.I),u.I=null)}n.isActive=function(){return!!this.g};function Xn(u){return u.g?u.g.readyState:0}n.Z=function(){try{return 2<Xn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(u){if(this.g){var p=this.g.responseText;return u&&p.indexOf(u)==0&&(p=p.substring(u.length)),hn(p)}};function Op(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function Nx(u){const p={};u=(u.g&&2<=Xn(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let v=0;v<u.length;v++){if(S(u[v]))continue;var m=P(u[v]);const V=m[0];if(m=m[1],typeof m!="string")continue;m=m.trim();const F=p[V]||[];p[V]=F,F.push(m)}x(p,function(v){return v.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function eo(u,p,m){return m&&m.internalChannelParams&&m.internalChannelParams[u]||p}function Lp(u){this.Aa=0,this.i=[],this.j=new Kr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=eo("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=eo("baseRetryDelayMs",5e3,u),this.cb=eo("retryDelaySeedMs",1e4,u),this.Wa=eo("forwardChannelMaxRetries",2,u),this.wa=eo("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new mp(u&&u.concurrentRequestLimit),this.Da=new Mx,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Lp.prototype,n.la=8,n.G=1,n.connect=function(u,p,m,v){je(0),this.W=u,this.H=p||{},m&&v!==void 0&&(this.H.OSID=m,this.H.OAID=v),this.F=this.X,this.I=Hp(this,null,this.W),Wa(this)};function Iu(u){if(Vp(u),u.G==3){var p=u.U++,m=Yn(u.I);if(Zt(m,"SID",u.K),Zt(m,"RID",p),Zt(m,"TYPE","terminate"),no(u,m),p=new Ps(u,u.j,p),p.L=2,p.v=Ua(Yn(m)),m=!1,a.navigator&&a.navigator.sendBeacon)try{m=a.navigator.sendBeacon(p.v.toString(),"")}catch{}!m&&a.Image&&(new Image().src=p.v,m=!0),m||(p.g=Wp(p.j,null),p.g.ea(p.v)),p.F=Date.now(),Na(p)}jp(u)}function Ha(u){u.g&&(Su(u),u.g.cancel(),u.g=null)}function Vp(u){Ha(u),u.u&&(a.clearTimeout(u.u),u.u=null),qa(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&a.clearTimeout(u.s),u.s=null)}function Wa(u){if(!_p(u.h)&&!u.s){u.s=!0;var p=u.Ga;ot||lt(),at||(ot(),at=!0),Bt.add(p,u),u.B=0}}function Fx(u,p){return yp(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=p.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=Gr(f(u.Ga,u,p),zp(u,u.B)),u.B++,!0)}n.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const V=new Ps(this,this.j,u);let F=this.o;if(this.S&&(F?(F=b(F),C(F,this.S)):F=this.S),this.m!==null||this.O||(V.H=F,F=null),this.P)t:{for(var p=0,m=0;m<this.i.length;m++){e:{var v=this.i[m];if("__data__"in v.map&&(v=v.map.__data__,typeof v=="string")){v=v.length;break e}v=void 0}if(v===void 0)break;if(p+=v,4096<p){p=m;break t}if(p===4096||m===this.i.length-1){p=m+1;break t}}p=1e3}else p=1e3;p=Fp(this,V,p),m=Yn(this.I),Zt(m,"RID",u),Zt(m,"CVER",22),this.D&&Zt(m,"X-HTTP-Session-Id",this.D),no(this,m),F&&(this.O?p="headers="+encodeURIComponent(String(Pp(F)))+"&"+p:this.m&&Eu(m,this.m,F)),Tu(this.h,V),this.Ua&&Zt(m,"TYPE","init"),this.P?(Zt(m,"$req",p),Zt(m,"SID","null"),V.T=!0,bu(V,m,null)):bu(V,m,p),this.G=2}}else this.G==3&&(u?Np(this,u):this.i.length==0||_p(this.h)||Np(this))};function Np(u,p){var m;p?m=p.l:m=u.U++;const v=Yn(u.I);Zt(v,"SID",u.K),Zt(v,"RID",m),Zt(v,"AID",u.T),no(u,v),u.m&&u.o&&Eu(v,u.m,u.o),m=new Ps(u,u.j,m,u.B+1),u.m===null&&(m.H=u.o),p&&(u.i=p.D.concat(u.i)),p=Fp(u,m,1e3),m.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),Tu(u.h,m),bu(m,v,p)}function no(u,p){u.H&&L(u.H,function(m,v){Zt(p,v,m)}),u.l&&wp({},function(m,v){Zt(p,v,m)})}function Fp(u,p,m){m=Math.min(u.i.length,m);var v=u.l?f(u.l.Na,u.l,u):null;t:{var V=u.i;let F=-1;for(;;){const Y=["count="+m];F==-1?0<m?(F=V[0].g,Y.push("ofs="+F)):F=0:Y.push("ofs="+F);let Wt=!0;for(let Te=0;Te<m;Te++){let Vt=V[Te].g;const Re=V[Te].map;if(Vt-=F,0>Vt)F=Math.max(0,V[Te].g-100),Wt=!1;else try{Ox(Re,Y,"req"+Vt+"_")}catch{v&&v(Re)}}if(Wt){v=Y.join("&");break t}}}return u=u.i.splice(0,m),p.D=u,v}function Bp(u){if(!u.g&&!u.u){u.Y=1;var p=u.Fa;ot||lt(),at||(ot(),at=!0),Bt.add(p,u),u.v=0}}function Au(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=Gr(f(u.Fa,u),zp(u,u.v)),u.v++,!0)}n.Fa=function(){if(this.u=null,Up(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=Gr(f(this.ab,this),u)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,je(10),Ha(this),Up(this))};function Su(u){u.A!=null&&(a.clearTimeout(u.A),u.A=null)}function Up(u){u.g=new Ps(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var p=Yn(u.qa);Zt(p,"RID","rpc"),Zt(p,"SID",u.K),Zt(p,"AID",u.T),Zt(p,"CI",u.F?"0":"1"),!u.F&&u.ja&&Zt(p,"TO",u.ja),Zt(p,"TYPE","xmlhttp"),no(u,p),u.m&&u.o&&Eu(p,u.m,u.o),u.L&&(u.g.I=u.L);var m=u.g;u=u.ia,m.L=1,m.v=Ua(Yn(p)),m.m=null,m.P=!0,fp(m,u)}n.Za=function(){this.C!=null&&(this.C=null,Ha(this),Au(this),je(19))};function qa(u){u.C!=null&&(a.clearTimeout(u.C),u.C=null)}function $p(u,p){var m=null;if(u.g==p){qa(u),Su(u),u.g=null;var v=2}else if(xu(u.h,p))m=p.D,bp(u.h,p),v=1;else return;if(u.G!=0){if(p.o)if(v==1){m=p.m?p.m.length:0,p=Date.now()-p.F;var V=u.B;v=Oa(),Tt(v,new cp(v,m)),Wa(u)}else Bp(u);else if(V=p.s,V==3||V==0&&0<p.X||!(v==1&&Fx(u,p)||v==2&&Au(u)))switch(m&&0<m.length&&(p=u.h,p.i=p.i.concat(m)),V){case 1:_i(u,5);break;case 4:_i(u,10);break;case 3:_i(u,6);break;default:_i(u,2)}}}function zp(u,p){let m=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(m*=2),m*p}function _i(u,p){if(u.j.info("Error code "+p),p==2){var m=f(u.fb,u),v=u.Xa;const V=!v;v=new mi(v||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Fa(v,"https"),Ua(v),V?kx(v.toString(),m):Dx(v.toString(),m)}else je(2);u.G=0,u.l&&u.l.sa(p),jp(u),Vp(u)}n.fb=function(u){u?(this.j.info("Successfully pinged google.com"),je(2)):(this.j.info("Failed to ping google.com"),je(1))};function jp(u){if(u.G=0,u.ka=[],u.l){const p=vp(u.h);(p.length!=0||u.i.length!=0)&&(w(u.ka,p),w(u.ka,u.i),u.h.i.length=0,y(u.i),u.i.length=0),u.l.ra()}}function Hp(u,p,m){var v=m instanceof mi?Yn(m):new mi(m);if(v.g!="")p&&(v.g=p+"."+v.g),Ba(v,v.s);else{var V=a.location;v=V.protocol,p=p?p+"."+V.hostname:V.hostname,V=+V.port;var F=new mi(null);v&&Fa(F,v),p&&(F.g=p),V&&Ba(F,V),m&&(F.l=m),v=F}return m=u.D,p=u.ya,m&&p&&Zt(v,m,p),Zt(v,"VER",u.la),no(u,v),v}function Wp(u,p,m){if(p&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return p=u.Ca&&!u.pa?new re(new $a({eb:m})):new re(u.pa),p.Ha(u.J),p}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function qp(){}n=qp.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Ga(){}Ga.prototype.g=function(u,p){return new en(u,p)};function en(u,p){dt.call(this),this.g=new Lp(p),this.l=u,this.h=p&&p.messageUrlParams||null,u=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(u?u["X-WebChannel-Content-Type"]=p.messageContentType:u={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.va&&(u?u["X-WebChannel-Client-Profile"]=p.va:u={"X-WebChannel-Client-Profile":p.va}),this.g.S=u,(u=p&&p.Sb)&&!S(u)&&(this.g.m=u),this.v=p&&p.supportsCrossDomainXhr||!1,this.u=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!S(p)&&(this.g.D=p,u=this.h,u!==null&&p in u&&(u=this.h,p in u&&delete u[p])),this.j=new Ji(this)}_(en,dt),en.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},en.prototype.close=function(){Iu(this.g)},en.prototype.o=function(u){var p=this.g;if(typeof u=="string"){var m={};m.__data__=u,u=m}else this.u&&(m={},m.__data__=xe(u),u=m);p.i.push(new wx(p.Ya++,u)),p.G==3&&Wa(p)},en.prototype.N=function(){this.g.l=null,delete this.j,Iu(this.g),delete this.g,en.aa.N.call(this)};function Gp(u){gu.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var p=u.__sm__;if(p){t:{for(const m in p){u=m;break t}u=void 0}(this.i=u)&&(u=this.i,p=p!==null&&u in p?p[u]:void 0),this.data=p}else this.data=u}_(Gp,gu);function Kp(){mu.call(this),this.status=1}_(Kp,mu);function Ji(u){this.g=u}_(Ji,qp),Ji.prototype.ua=function(){Tt(this.g,"a")},Ji.prototype.ta=function(u){Tt(this.g,new Gp(u))},Ji.prototype.sa=function(u){Tt(this.g,new Kp)},Ji.prototype.ra=function(){Tt(this.g,"b")},Ga.prototype.createWebChannel=Ga.prototype.g,en.prototype.send=en.prototype.o,en.prototype.open=en.prototype.m,en.prototype.close=en.prototype.close,Av=function(){return new Ga},Iv=function(){return Oa()},Ev=pi,Dh={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},La.NO_ERROR=0,La.TIMEOUT=8,La.HTTP_ERROR=6,Sl=La,up.COMPLETE="complete",Tv=up,rp.EventType=Wr,Wr.OPEN="a",Wr.CLOSE="b",Wr.ERROR="c",Wr.MESSAGE="d",dt.prototype.listen=dt.prototype.K,po=rp,re.prototype.listenOnce=re.prototype.L,re.prototype.getLastError=re.prototype.Ka,re.prototype.getLastErrorCode=re.prototype.Ba,re.prototype.getStatus=re.prototype.Z,re.prototype.getResponseJson=re.prototype.Oa,re.prototype.getResponseText=re.prototype.oa,re.prototype.send=re.prototype.ea,re.prototype.setWithCredentials=re.prototype.Ha,xv=re}).apply(typeof tl<"u"?tl:typeof self<"u"?self:typeof window<"u"?window:{});const nm="@firebase/firestore",sm="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oe{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Oe.UNAUTHENTICATED=new Oe(null),Oe.GOOGLE_CREDENTIALS=new Oe("google-credentials-uid"),Oe.FIRST_PARTY=new Oe("first-party-uid"),Oe.MOCK_USER=new Oe("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Vr="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ui=new Cd("@firebase/firestore");function rr(){return Ui.logLevel}function tt(n,...t){if(Ui.logLevel<=Pt.DEBUG){const e=t.map($d);Ui.debug(`Firestore (${Vr}): ${n}`,...e)}}function bs(n,...t){if(Ui.logLevel<=Pt.ERROR){const e=t.map($d);Ui.error(`Firestore (${Vr}): ${n}`,...e)}}function xr(n,...t){if(Ui.logLevel<=Pt.WARN){const e=t.map($d);Ui.warn(`Firestore (${Vr}): ${n}`,...e)}}function $d(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(e){return JSON.stringify(e)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ft(n,t,e){let s="Unexpected state";typeof t=="string"?s=t:e=t,Sv(n,s,e)}function Sv(n,t,e){let s=`FIRESTORE (${Vr}) INTERNAL ASSERTION FAILED: ${t} (ID: ${n.toString(16)})`;if(e!==void 0)try{s+=" CONTEXT: "+JSON.stringify(e)}catch{s+=" CONTEXT: "+e}throw bs(s),new Error(s)}function zt(n,t,e,s){let i="Unexpected state";typeof e=="string"?i=e:s=e,n||Sv(t,i,s)}function wt(n,t){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class J extends Es{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fs{constructor(){this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cv{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class QC{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable(()=>e(Oe.UNAUTHENTICATED))}shutdown(){}}class JC{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable(()=>e(this.token.user))}shutdown(){this.changeListener=null}}class ZC{constructor(t){this.t=t,this.currentUser=Oe.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){zt(this.o===void 0,42304);let s=this.i;const i=l=>this.i!==s?(s=this.i,e(l)):Promise.resolve();let r=new fs;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new fs,t.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=r;t.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},a=l=>{tt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(tt("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new fs)}},0),o()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then(s=>this.i!==t?(tt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(zt(typeof s.accessToken=="string",31837,{l:s}),new Cv(s.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return zt(t===null||typeof t=="string",2055,{h:t}),new Oe(t)}}class t1{constructor(t,e,s){this.P=t,this.T=e,this.I=s,this.type="FirstParty",this.user=Oe.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const t=this.R();return t&&this.A.set("Authorization",t),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class e1{constructor(t,e,s){this.P=t,this.T=e,this.I=s}getToken(){return Promise.resolve(new t1(this.P,this.T,this.I))}start(t,e){t.enqueueRetryable(()=>e(Oe.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class im{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class n1{constructor(t,e){this.V=e,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,on(t)&&t.settings.appCheckToken&&(this.p=t.settings.appCheckToken)}start(t,e){zt(this.o===void 0,3512);const s=r=>{r.error!=null&&tt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${r.error.message}`);const o=r.token!==this.m;return this.m=r.token,tt("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?e(r.token):Promise.resolve()};this.o=r=>{t.enqueueRetryable(()=>s(r))};const i=r=>{tt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=r,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(r=>i(r)),setTimeout(()=>{if(!this.appCheck){const r=this.V.getImmediate({optional:!0});r?i(r):tt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new im(this.p));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(e=>e?(zt(typeof e.token=="string",44558,{tokenResult:e}),this.m=e.token,new im(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s1(n){const t=typeof self<"u"&&(self.crypto||self.msCrypto),e=new Uint8Array(n);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(e);else for(let s=0;s<n;s++)e[s]=Math.floor(256*Math.random());return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zd{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const i=s1(40);for(let r=0;r<i.length;++r)s.length<20&&i[r]<e&&(s+=t.charAt(i[r]%62))}return s}}function kt(n,t){return n<t?-1:n>t?1:0}function Mh(n,t){const e=Math.min(n.length,t.length);for(let s=0;s<e;s++){const i=n.charAt(s),r=t.charAt(s);if(i!==r)return Wu(i)===Wu(r)?kt(i,r):Wu(i)?1:-1}return kt(n.length,t.length)}const i1=55296,r1=57343;function Wu(n){const t=n.charCodeAt(0);return t>=i1&&t<=r1}function Tr(n,t,e){return n.length===t.length&&n.every((s,i)=>e(s,t[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rm="__name__";class Dn{constructor(t,e,s){e===void 0?e=0:e>t.length&&ft(637,{offset:e,range:t.length}),s===void 0?s=t.length-e:s>t.length-e&&ft(1746,{length:s,range:t.length-e}),this.segments=t,this.offset=e,this.len=s}get length(){return this.len}isEqual(t){return Dn.comparator(this,t)===0}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof Dn?t.forEach(s=>{e.push(s)}):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,s=this.limit();e<s;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const s=Math.min(t.length,e.length);for(let i=0;i<s;i++){const r=Dn.compareSegments(t.get(i),e.get(i));if(r!==0)return r}return kt(t.length,e.length)}static compareSegments(t,e){const s=Dn.isNumericId(t),i=Dn.isNumericId(e);return s&&!i?-1:!s&&i?1:s&&i?Dn.extractNumericId(t).compare(Dn.extractNumericId(e)):Mh(t,e)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return Ys.fromString(t.substring(4,t.length-2))}}class Gt extends Dn{construct(t,e,s){return new Gt(t,e,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const e=[];for(const s of t){if(s.indexOf("//")>=0)throw new J(U.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);e.push(...s.split("/").filter(i=>i.length>0))}return new Gt(e)}static emptyPath(){return new Gt([])}}const o1=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ae extends Dn{construct(t,e,s){return new Ae(t,e,s)}static isValidIdentifier(t){return o1.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ae.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===rm}static keyField(){return new Ae([rm])}static fromServerFormat(t){const e=[];let s="",i=0;const r=()=>{if(s.length===0)throw new J(U.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(s),s=""};let o=!1;for(;i<t.length;){const a=t[i];if(a==="\\"){if(i+1===t.length)throw new J(U.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const l=t[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new J(U.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);s+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(s+=a,i++):(r(),i++)}if(r(),o)throw new J(U.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Ae(e)}static emptyPath(){return new Ae([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ut{constructor(t){this.path=t}static fromPath(t){return new ut(Gt.fromString(t))}static fromName(t){return new ut(Gt.fromString(t).popFirst(5))}static empty(){return new ut(Gt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&Gt.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,e){return Gt.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new ut(new Gt(t.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jd(n,t,e){if(!e)throw new J(U.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${t}.`)}function a1(n,t,e,s){if(t===!0&&s===!0)throw new J(U.INVALID_ARGUMENT,`${n} and ${e} cannot be used together.`)}function om(n){if(!ut.isDocumentKey(n))throw new J(U.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function am(n){if(ut.isDocumentKey(n))throw new J(U.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Pv(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Bc(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const t=function(s){return s.constructor?s.constructor.name:null}(n);return t?`a custom ${t} object`:"an object"}}return typeof n=="function"?"a function":ft(12329,{type:typeof n})}function Ge(n,t){if("_delegate"in n&&(n=n._delegate),!(n instanceof t)){if(t.name===n.constructor.name)throw new J(U.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const e=Bc(n);throw new J(U.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${e}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fe(n,t){const e={typeString:n};return t&&(e.value=t),e}function wa(n,t){if(!Pv(n))throw new J(U.INVALID_ARGUMENT,"JSON must be an object");let e;for(const s in t)if(t[s]){const i=t[s].typeString,r="value"in t[s]?{value:t[s].value}:void 0;if(!(s in n)){e=`JSON missing required field: '${s}'`;break}const o=n[s];if(i&&typeof o!==i){e=`JSON field '${s}' must be a ${i}.`;break}if(r!==void 0&&o!==r.value){e=`Expected '${s}' field to equal '${r.value}'`;break}}if(e)throw new J(U.INVALID_ARGUMENT,e);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lm=-62135596800,cm=1e6;class Kt{static now(){return Kt.fromMillis(Date.now())}static fromDate(t){return Kt.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),s=Math.floor((t-1e3*e)*cm);return new Kt(e,s)}constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new J(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new J(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<lm)throw new J(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new J(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/cm}_compareTo(t){return this.seconds===t.seconds?kt(this.nanoseconds,t.nanoseconds):kt(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Kt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(t){if(wa(t,Kt._jsonSchema))return new Kt(t.seconds,t.nanoseconds)}valueOf(){const t=this.seconds-lm;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Kt._jsonSchemaVersion="firestore/timestamp/1.0",Kt._jsonSchema={type:fe("string",Kt._jsonSchemaVersion),seconds:fe("number"),nanoseconds:fe("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bt{static fromTimestamp(t){return new bt(t)}static min(){return new bt(new Kt(0,0))}static max(){return new bt(new Kt(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xo=-1;function l1(n,t){const e=n.toTimestamp().seconds,s=n.toTimestamp().nanoseconds+1,i=bt.fromTimestamp(s===1e9?new Kt(e+1,0):new Kt(e,s));return new ei(i,ut.empty(),t)}function c1(n){return new ei(n.readTime,n.key,Xo)}class ei{constructor(t,e,s){this.readTime=t,this.documentKey=e,this.largestBatchId=s}static min(){return new ei(bt.min(),ut.empty(),Xo)}static max(){return new ei(bt.max(),ut.empty(),Xo)}}function u1(n,t){let e=n.readTime.compareTo(t.readTime);return e!==0?e:(e=ut.comparator(n.documentKey,t.documentKey),e!==0?e:kt(n.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h1="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class d1{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nr(n){if(n.code!==U.FAILED_PRECONDITION||n.message!==h1)throw n;tt("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ${constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&ft(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new $((s,i)=>{this.nextCallback=r=>{this.wrapSuccess(t,r).next(s,i)},this.catchCallback=r=>{this.wrapFailure(e,r).next(s,i)}})}toPromise(){return new Promise((t,e)=>{this.next(t,e)})}wrapUserFunction(t){try{const e=t();return e instanceof $?e:$.resolve(e)}catch(e){return $.reject(e)}}wrapSuccess(t,e){return t?this.wrapUserFunction(()=>t(e)):$.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction(()=>t(e)):$.reject(e)}static resolve(t){return new $((e,s)=>{e(t)})}static reject(t){return new $((e,s)=>{s(t)})}static waitFor(t){return new $((e,s)=>{let i=0,r=0,o=!1;t.forEach(a=>{++i,a.next(()=>{++r,o&&r===i&&e()},l=>s(l))}),o=!0,r===i&&e()})}static or(t){let e=$.resolve(!1);for(const s of t)e=e.next(i=>i?$.resolve(i):s());return e}static forEach(t,e){const s=[];return t.forEach((i,r)=>{s.push(e.call(this,i,r))}),this.waitFor(s)}static mapArray(t,e){return new $((s,i)=>{const r=t.length,o=new Array(r);let a=0;for(let l=0;l<r;l++){const c=l;e(t[c]).next(h=>{o[c]=h,++a,a===r&&s(o)},h=>i(h))}})}static doWhile(t,e){return new $((s,i)=>{const r=()=>{t()===!0?e().next(()=>{r()},i):s()};r()})}}function f1(n){const t=n.match(/Android ([\d.]+)/i),e=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(e)}function Fr(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uc{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=s=>this.ae(s),this.ue=s=>e.writeSequenceNumber(s))}ae(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ue&&this.ue(t),t}}Uc.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hd=-1;function $c(n){return n==null}function nc(n){return n===0&&1/n==-1/0}function p1(n){return typeof n=="number"&&Number.isInteger(n)&&!nc(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rv="";function g1(n){let t="";for(let e=0;e<n.length;e++)t.length>0&&(t=um(t)),t=m1(n.get(e),t);return um(t)}function m1(n,t){let e=t;const s=n.length;for(let i=0;i<s;i++){const r=n.charAt(i);switch(r){case"\0":e+="";break;case Rv:e+="";break;default:e+=r}}return e}function um(n){return n+Rv+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hm(n){let t=0;for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t++;return t}function ci(n,t){for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t(e,n[e])}function kv(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ie{constructor(t,e){this.comparator=t,this.root=e||Ee.EMPTY}insert(t,e){return new ie(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,Ee.BLACK,null,null))}remove(t){return new ie(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Ee.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const s=this.comparator(t,e.key);if(s===0)return e.value;s<0?e=e.left:s>0&&(e=e.right)}return null}indexOf(t){let e=0,s=this.root;for(;!s.isEmpty();){const i=this.comparator(t,s.key);if(i===0)return e+s.left.size;i<0?s=s.left:(e+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((e,s)=>(t(e,s),!1))}toString(){const t=[];return this.inorderTraversal((e,s)=>(t.push(`${e}:${s}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new el(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new el(this.root,t,this.comparator,!1)}getReverseIterator(){return new el(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new el(this.root,t,this.comparator,!0)}}class el{constructor(t,e,s,i){this.isReverse=i,this.nodeStack=[];let r=1;for(;!t.isEmpty();)if(r=e?s(t.key,e):1,e&&i&&(r*=-1),r<0)t=this.isReverse?t.left:t.right;else{if(r===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class Ee{constructor(t,e,s,i,r){this.key=t,this.value=e,this.color=s??Ee.RED,this.left=i??Ee.EMPTY,this.right=r??Ee.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,s,i,r){return new Ee(t??this.key,e??this.value,s??this.color,i??this.left,r??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,s){let i=this;const r=s(t,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(t,e,s),null):r===0?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,s)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Ee.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let s,i=this;if(e(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),e(t,i.key)===0){if(i.right.isEmpty())return Ee.EMPTY;s=i.right.min(),i=i.copy(s.key,s.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,Ee.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,Ee.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ft(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ft(14113,{key:this.key,value:this.value});const t=this.left.check();if(t!==this.right.check())throw ft(27949);return t+(this.isRed()?0:1)}}Ee.EMPTY=null,Ee.RED=!0,Ee.BLACK=!1;Ee.EMPTY=new class{constructor(){this.size=0}get key(){throw ft(57766)}get value(){throw ft(16141)}get color(){throw ft(16727)}get left(){throw ft(29726)}get right(){throw ft(36894)}copy(t,e,s,i,r){return this}insert(t,e,s){return new Ee(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class me{constructor(t){this.comparator=t,this.data=new ie(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((e,s)=>(t(e),!1))}forEachInRange(t,e){const s=this.data.getIteratorFrom(t[0]);for(;s.hasNext();){const i=s.getNext();if(this.comparator(i.key,t[1])>=0)return;e(i.key)}}forEachWhile(t,e){let s;for(s=e!==void 0?this.data.getIteratorFrom(e):this.data.getIterator();s.hasNext();)if(!t(s.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new dm(this.data.getIterator())}getIteratorFrom(t){return new dm(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach(s=>{e=e.add(s)}),e}isEqual(t){if(!(t instanceof me)||this.size!==t.size)return!1;const e=this.data.getIterator(),s=t.data.getIterator();for(;e.hasNext();){const i=e.getNext().key,r=s.getNext().key;if(this.comparator(i,r)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(e=>{t.push(e)}),t}toString(){const t=[];return this.forEach(e=>t.push(e)),"SortedSet("+t.toString()+")"}copy(t){const e=new me(this.comparator);return e.data=t,e}}class dm{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cn{constructor(t){this.fields=t,t.sort(Ae.comparator)}static empty(){return new cn([])}unionWith(t){let e=new me(Ae.comparator);for(const s of this.fields)e=e.add(s);for(const s of t)e=e.add(s);return new cn(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return Tr(this.fields,t.fields,(e,s)=>e.isEqual(s))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dv extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ce{constructor(t){this.binaryString=t}static fromBase64String(t){const e=function(i){try{return atob(i)}catch(r){throw typeof DOMException<"u"&&r instanceof DOMException?new Dv("Invalid base64 string: "+r):r}}(t);return new Ce(e)}static fromUint8Array(t){const e=function(i){let r="";for(let o=0;o<i.length;++o)r+=String.fromCharCode(i[o]);return r}(t);return new Ce(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(e){return btoa(e)}(this.binaryString)}toUint8Array(){return function(e){const s=new Uint8Array(e.length);for(let i=0;i<e.length;i++)s[i]=e.charCodeAt(i);return s}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return kt(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Ce.EMPTY_BYTE_STRING=new Ce("");const _1=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ni(n){if(zt(!!n,39018),typeof n=="string"){let t=0;const e=_1.exec(n);if(zt(!!e,46558,{timestamp:n}),e[1]){let i=e[1];i=(i+"000000000").substr(0,9),t=Number(i)}const s=new Date(n);return{seconds:Math.floor(s.getTime()/1e3),nanos:t}}return{seconds:le(n.seconds),nanos:le(n.nanos)}}function le(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function si(n){return typeof n=="string"?Ce.fromBase64String(n):Ce.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mv="server_timestamp",Ov="__type__",Lv="__previous_value__",Vv="__local_write_time__";function Wd(n){return(n?.mapValue?.fields||{})[Ov]?.stringValue===Mv}function zc(n){const t=n.mapValue.fields[Lv];return Wd(t)?zc(t):t}function Qo(n){const t=ni(n.mapValue.fields[Vv].timestampValue);return new Kt(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y1{constructor(t,e,s,i,r,o,a,l,c,h){this.databaseId=t,this.appId=e,this.persistenceKey=s,this.host=i,this.ssl=r,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=h}}const sc="(default)";class Jo{constructor(t,e){this.projectId=t,this.database=e||sc}static empty(){return new Jo("","")}get isDefaultDatabase(){return this.database===sc}isEqual(t){return t instanceof Jo&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nv="__type__",b1="__max__",nl={mapValue:{}},Fv="__vector__",ic="value";function ii(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Wd(n)?4:w1(n)?9007199254740991:v1(n)?10:11:ft(28295,{value:n})}function Gn(n,t){if(n===t)return!0;const e=ii(n);if(e!==ii(t))return!1;switch(e){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===t.booleanValue;case 4:return Qo(n).isEqual(Qo(t));case 3:return function(i,r){if(typeof i.timestampValue=="string"&&typeof r.timestampValue=="string"&&i.timestampValue.length===r.timestampValue.length)return i.timestampValue===r.timestampValue;const o=ni(i.timestampValue),a=ni(r.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,t);case 5:return n.stringValue===t.stringValue;case 6:return function(i,r){return si(i.bytesValue).isEqual(si(r.bytesValue))}(n,t);case 7:return n.referenceValue===t.referenceValue;case 8:return function(i,r){return le(i.geoPointValue.latitude)===le(r.geoPointValue.latitude)&&le(i.geoPointValue.longitude)===le(r.geoPointValue.longitude)}(n,t);case 2:return function(i,r){if("integerValue"in i&&"integerValue"in r)return le(i.integerValue)===le(r.integerValue);if("doubleValue"in i&&"doubleValue"in r){const o=le(i.doubleValue),a=le(r.doubleValue);return o===a?nc(o)===nc(a):isNaN(o)&&isNaN(a)}return!1}(n,t);case 9:return Tr(n.arrayValue.values||[],t.arrayValue.values||[],Gn);case 10:case 11:return function(i,r){const o=i.mapValue.fields||{},a=r.mapValue.fields||{};if(hm(o)!==hm(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Gn(o[l],a[l])))return!1;return!0}(n,t);default:return ft(52216,{left:n})}}function Zo(n,t){return(n.values||[]).find(e=>Gn(e,t))!==void 0}function Er(n,t){if(n===t)return 0;const e=ii(n),s=ii(t);if(e!==s)return kt(e,s);switch(e){case 0:case 9007199254740991:return 0;case 1:return kt(n.booleanValue,t.booleanValue);case 2:return function(r,o){const a=le(r.integerValue||r.doubleValue),l=le(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(n,t);case 3:return fm(n.timestampValue,t.timestampValue);case 4:return fm(Qo(n),Qo(t));case 5:return Mh(n.stringValue,t.stringValue);case 6:return function(r,o){const a=si(r),l=si(o);return a.compareTo(l)}(n.bytesValue,t.bytesValue);case 7:return function(r,o){const a=r.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){const h=kt(a[c],l[c]);if(h!==0)return h}return kt(a.length,l.length)}(n.referenceValue,t.referenceValue);case 8:return function(r,o){const a=kt(le(r.latitude),le(o.latitude));return a!==0?a:kt(le(r.longitude),le(o.longitude))}(n.geoPointValue,t.geoPointValue);case 9:return pm(n.arrayValue,t.arrayValue);case 10:return function(r,o){const a=r.fields||{},l=o.fields||{},c=a[ic]?.arrayValue,h=l[ic]?.arrayValue,d=kt(c?.values?.length||0,h?.values?.length||0);return d!==0?d:pm(c,h)}(n.mapValue,t.mapValue);case 11:return function(r,o){if(r===nl.mapValue&&o===nl.mapValue)return 0;if(r===nl.mapValue)return 1;if(o===nl.mapValue)return-1;const a=r.fields||{},l=Object.keys(a),c=o.fields||{},h=Object.keys(c);l.sort(),h.sort();for(let d=0;d<l.length&&d<h.length;++d){const f=Mh(l[d],h[d]);if(f!==0)return f;const g=Er(a[l[d]],c[h[d]]);if(g!==0)return g}return kt(l.length,h.length)}(n.mapValue,t.mapValue);default:throw ft(23264,{he:e})}}function fm(n,t){if(typeof n=="string"&&typeof t=="string"&&n.length===t.length)return kt(n,t);const e=ni(n),s=ni(t),i=kt(e.seconds,s.seconds);return i!==0?i:kt(e.nanos,s.nanos)}function pm(n,t){const e=n.values||[],s=t.values||[];for(let i=0;i<e.length&&i<s.length;++i){const r=Er(e[i],s[i]);if(r)return r}return kt(e.length,s.length)}function Ir(n){return Oh(n)}function Oh(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(e){const s=ni(e);return`time(${s.seconds},${s.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(e){return si(e).toBase64()}(n.bytesValue):"referenceValue"in n?function(e){return ut.fromName(e).toString()}(n.referenceValue):"geoPointValue"in n?function(e){return`geo(${e.latitude},${e.longitude})`}(n.geoPointValue):"arrayValue"in n?function(e){let s="[",i=!0;for(const r of e.values||[])i?i=!1:s+=",",s+=Oh(r);return s+"]"}(n.arrayValue):"mapValue"in n?function(e){const s=Object.keys(e.fields||{}).sort();let i="{",r=!0;for(const o of s)r?r=!1:i+=",",i+=`${o}:${Oh(e.fields[o])}`;return i+"}"}(n.mapValue):ft(61005,{value:n})}function Cl(n){switch(ii(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=zc(n);return t?16+Cl(t):16;case 5:return 2*n.stringValue.length;case 6:return si(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(s){return(s.values||[]).reduce((i,r)=>i+Cl(r),0)}(n.arrayValue);case 10:case 11:return function(s){let i=0;return ci(s.fields,(r,o)=>{i+=r.length+Cl(o)}),i}(n.mapValue);default:throw ft(13486,{value:n})}}function gm(n,t){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${t.path.canonicalString()}`}}function Lh(n){return!!n&&"integerValue"in n}function qd(n){return!!n&&"arrayValue"in n}function mm(n){return!!n&&"nullValue"in n}function _m(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Pl(n){return!!n&&"mapValue"in n}function v1(n){return(n?.mapValue?.fields||{})[Nv]?.stringValue===Fv}function Mo(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const t={mapValue:{fields:{}}};return ci(n.mapValue.fields,(e,s)=>t.mapValue.fields[e]=Mo(s)),t}if(n.arrayValue){const t={arrayValue:{values:[]}};for(let e=0;e<(n.arrayValue.values||[]).length;++e)t.arrayValue.values[e]=Mo(n.arrayValue.values[e]);return t}return{...n}}function w1(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===b1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Je{constructor(t){this.value=t}static empty(){return new Je({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let s=0;s<t.length-1;++s)if(e=(e.mapValue.fields||{})[t.get(s)],!Pl(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Mo(e)}setAll(t){let e=Ae.emptyPath(),s={},i=[];t.forEach((o,a)=>{if(!e.isImmediateParentOf(a)){const l=this.getFieldsMap(e);this.applyChanges(l,s,i),s={},i=[],e=a.popLast()}o?s[a.lastSegment()]=Mo(o):i.push(a.lastSegment())});const r=this.getFieldsMap(e);this.applyChanges(r,s,i)}delete(t){const e=this.field(t.popLast());Pl(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return Gn(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let s=0;s<t.length;++s){let i=e.mapValue.fields[t.get(s)];Pl(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},e.mapValue.fields[t.get(s)]=i),e=i}return e.mapValue.fields}applyChanges(t,e,s){ci(e,(i,r)=>t[i]=r);for(const i of s)delete t[i]}clone(){return new Je(Mo(this.value))}}function Bv(n){const t=[];return ci(n.fields,(e,s)=>{const i=new Ae([e]);if(Pl(s)){const r=Bv(s.mapValue).fields;if(r.length===0)t.push(i);else for(const o of r)t.push(i.child(o))}else t.push(i)}),new cn(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ne{constructor(t,e,s,i,r,o,a){this.key=t,this.documentType=e,this.version=s,this.readTime=i,this.createTime=r,this.data=o,this.documentState=a}static newInvalidDocument(t){return new Ne(t,0,bt.min(),bt.min(),bt.min(),Je.empty(),0)}static newFoundDocument(t,e,s,i){return new Ne(t,1,e,bt.min(),s,i,0)}static newNoDocument(t,e){return new Ne(t,2,e,bt.min(),bt.min(),Je.empty(),0)}static newUnknownDocument(t,e){return new Ne(t,3,e,bt.min(),bt.min(),Je.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(bt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Je.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Je.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=bt.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof Ne&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Ne(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rc{constructor(t,e){this.position=t,this.inclusive=e}}function ym(n,t,e){let s=0;for(let i=0;i<n.position.length;i++){const r=t[i],o=n.position[i];if(r.field.isKeyField()?s=ut.comparator(ut.fromName(o.referenceValue),e.key):s=Er(o,e.data.field(r.field)),r.dir==="desc"&&(s*=-1),s!==0)break}return s}function bm(n,t){if(n===null)return t===null;if(t===null||n.inclusive!==t.inclusive||n.position.length!==t.position.length)return!1;for(let e=0;e<n.position.length;e++)if(!Gn(n.position[e],t.position[e]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oc{constructor(t,e="asc"){this.field=t,this.dir=e}}function x1(n,t){return n.dir===t.dir&&n.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uv{}class de extends Uv{constructor(t,e,s){super(),this.field=t,this.op=e,this.value=s}static create(t,e,s){return t.isKeyField()?e==="in"||e==="not-in"?this.createKeyFieldInFilter(t,e,s):new E1(t,e,s):e==="array-contains"?new S1(t,s):e==="in"?new C1(t,s):e==="not-in"?new P1(t,s):e==="array-contains-any"?new R1(t,s):new de(t,e,s)}static createKeyFieldInFilter(t,e,s){return e==="in"?new I1(t,s):new A1(t,s)}matches(t){const e=t.data.field(this.field);return this.op==="!="?e!==null&&e.nullValue===void 0&&this.matchesComparison(Er(e,this.value)):e!==null&&ii(this.value)===ii(e)&&this.matchesComparison(Er(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return ft(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class An extends Uv{constructor(t,e){super(),this.filters=t,this.op=e,this.Pe=null}static create(t,e){return new An(t,e)}matches(t){return $v(this)?this.filters.find(e=>!e.matches(t))===void 0:this.filters.find(e=>e.matches(t))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((t,e)=>t.concat(e.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function $v(n){return n.op==="and"}function zv(n){return T1(n)&&$v(n)}function T1(n){for(const t of n.filters)if(t instanceof An)return!1;return!0}function Vh(n){if(n instanceof de)return n.field.canonicalString()+n.op.toString()+Ir(n.value);if(zv(n))return n.filters.map(t=>Vh(t)).join(",");{const t=n.filters.map(e=>Vh(e)).join(",");return`${n.op}(${t})`}}function jv(n,t){return n instanceof de?function(s,i){return i instanceof de&&s.op===i.op&&s.field.isEqual(i.field)&&Gn(s.value,i.value)}(n,t):n instanceof An?function(s,i){return i instanceof An&&s.op===i.op&&s.filters.length===i.filters.length?s.filters.reduce((r,o,a)=>r&&jv(o,i.filters[a]),!0):!1}(n,t):void ft(19439)}function Hv(n){return n instanceof de?function(e){return`${e.field.canonicalString()} ${e.op} ${Ir(e.value)}`}(n):n instanceof An?function(e){return e.op.toString()+" {"+e.getFilters().map(Hv).join(" ,")+"}"}(n):"Filter"}class E1 extends de{constructor(t,e,s){super(t,e,s),this.key=ut.fromName(s.referenceValue)}matches(t){const e=ut.comparator(t.key,this.key);return this.matchesComparison(e)}}class I1 extends de{constructor(t,e){super(t,"in",e),this.keys=Wv("in",e)}matches(t){return this.keys.some(e=>e.isEqual(t.key))}}class A1 extends de{constructor(t,e){super(t,"not-in",e),this.keys=Wv("not-in",e)}matches(t){return!this.keys.some(e=>e.isEqual(t.key))}}function Wv(n,t){return(t.arrayValue?.values||[]).map(e=>ut.fromName(e.referenceValue))}class S1 extends de{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return qd(e)&&Zo(e.arrayValue,this.value)}}class C1 extends de{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return e!==null&&Zo(this.value.arrayValue,e)}}class P1 extends de{constructor(t,e){super(t,"not-in",e)}matches(t){if(Zo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return e!==null&&e.nullValue===void 0&&!Zo(this.value.arrayValue,e)}}class R1 extends de{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!qd(e)||!e.arrayValue.values)&&e.arrayValue.values.some(s=>Zo(this.value.arrayValue,s))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k1{constructor(t,e=null,s=[],i=[],r=null,o=null,a=null){this.path=t,this.collectionGroup=e,this.orderBy=s,this.filters=i,this.limit=r,this.startAt=o,this.endAt=a,this.Te=null}}function vm(n,t=null,e=[],s=[],i=null,r=null,o=null){return new k1(n,t,e,s,i,r,o)}function Gd(n){const t=wt(n);if(t.Te===null){let e=t.path.canonicalString();t.collectionGroup!==null&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(s=>Vh(s)).join(","),e+="|ob:",e+=t.orderBy.map(s=>function(r){return r.field.canonicalString()+r.dir}(s)).join(","),$c(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(s=>Ir(s)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(s=>Ir(s)).join(",")),t.Te=e}return t.Te}function Kd(n,t){if(n.limit!==t.limit||n.orderBy.length!==t.orderBy.length)return!1;for(let e=0;e<n.orderBy.length;e++)if(!x1(n.orderBy[e],t.orderBy[e]))return!1;if(n.filters.length!==t.filters.length)return!1;for(let e=0;e<n.filters.length;e++)if(!jv(n.filters[e],t.filters[e]))return!1;return n.collectionGroup===t.collectionGroup&&!!n.path.isEqual(t.path)&&!!bm(n.startAt,t.startAt)&&bm(n.endAt,t.endAt)}function Nh(n){return ut.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Br{constructor(t,e=null,s=[],i=[],r=null,o="F",a=null,l=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=s,this.filters=i,this.limit=r,this.limitType=o,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function D1(n,t,e,s,i,r,o,a){return new Br(n,t,e,s,i,r,o,a)}function jc(n){return new Br(n)}function wm(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function qv(n){return n.collectionGroup!==null}function Oo(n){const t=wt(n);if(t.Ie===null){t.Ie=[];const e=new Set;for(const r of t.explicitOrderBy)t.Ie.push(r),e.add(r.field.canonicalString());const s=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new me(Ae.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(t).forEach(r=>{e.has(r.canonicalString())||r.isKeyField()||t.Ie.push(new oc(r,s))}),e.has(Ae.keyField().canonicalString())||t.Ie.push(new oc(Ae.keyField(),s))}return t.Ie}function Fn(n){const t=wt(n);return t.Ee||(t.Ee=M1(t,Oo(n))),t.Ee}function M1(n,t){if(n.limitType==="F")return vm(n.path,n.collectionGroup,t,n.filters,n.limit,n.startAt,n.endAt);{t=t.map(i=>{const r=i.dir==="desc"?"asc":"desc";return new oc(i.field,r)});const e=n.endAt?new rc(n.endAt.position,n.endAt.inclusive):null,s=n.startAt?new rc(n.startAt.position,n.startAt.inclusive):null;return vm(n.path,n.collectionGroup,t,n.filters,n.limit,e,s)}}function Fh(n,t){const e=n.filters.concat([t]);return new Br(n.path,n.collectionGroup,n.explicitOrderBy.slice(),e,n.limit,n.limitType,n.startAt,n.endAt)}function Bh(n,t,e){return new Br(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),t,e,n.startAt,n.endAt)}function Hc(n,t){return Kd(Fn(n),Fn(t))&&n.limitType===t.limitType}function Gv(n){return`${Gd(Fn(n))}|lt:${n.limitType}`}function or(n){return`Query(target=${function(e){let s=e.path.canonicalString();return e.collectionGroup!==null&&(s+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(s+=`, filters: [${e.filters.map(i=>Hv(i)).join(", ")}]`),$c(e.limit)||(s+=", limit: "+e.limit),e.orderBy.length>0&&(s+=`, orderBy: [${e.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),e.startAt&&(s+=", startAt: ",s+=e.startAt.inclusive?"b:":"a:",s+=e.startAt.position.map(i=>Ir(i)).join(",")),e.endAt&&(s+=", endAt: ",s+=e.endAt.inclusive?"a:":"b:",s+=e.endAt.position.map(i=>Ir(i)).join(",")),`Target(${s})`}(Fn(n))}; limitType=${n.limitType})`}function Wc(n,t){return t.isFoundDocument()&&function(s,i){const r=i.key.path;return s.collectionGroup!==null?i.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(r):ut.isDocumentKey(s.path)?s.path.isEqual(r):s.path.isImmediateParentOf(r)}(n,t)&&function(s,i){for(const r of Oo(s))if(!r.field.isKeyField()&&i.data.field(r.field)===null)return!1;return!0}(n,t)&&function(s,i){for(const r of s.filters)if(!r.matches(i))return!1;return!0}(n,t)&&function(s,i){return!(s.startAt&&!function(o,a,l){const c=ym(o,a,l);return o.inclusive?c<=0:c<0}(s.startAt,Oo(s),i)||s.endAt&&!function(o,a,l){const c=ym(o,a,l);return o.inclusive?c>=0:c>0}(s.endAt,Oo(s),i))}(n,t)}function O1(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Kv(n){return(t,e)=>{let s=!1;for(const i of Oo(n)){const r=L1(i,t,e);if(r!==0)return r;s=s||i.field.isKeyField()}return 0}}function L1(n,t,e){const s=n.field.isKeyField()?ut.comparator(t.key,e.key):function(r,o,a){const l=o.data.field(r),c=a.data.field(r);return l!==null&&c!==null?Er(l,c):ft(42886)}(n.field,t,e);switch(n.dir){case"asc":return s;case"desc":return-1*s;default:return ft(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qi{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),s=this.inner[e];if(s!==void 0){for(const[i,r]of s)if(this.equalsFn(i,t))return r}}has(t){return this.get(t)!==void 0}set(t,e){const s=this.mapKeyFn(t),i=this.inner[s];if(i===void 0)return this.inner[s]=[[t,e]],void this.innerSize++;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],t))return void(i[r]=[t,e]);i.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),s=this.inner[e];if(s===void 0)return!1;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],t))return s.length===1?delete this.inner[e]:s.splice(i,1),this.innerSize--,!0;return!1}forEach(t){ci(this.inner,(e,s)=>{for(const[i,r]of s)t(i,r)})}isEmpty(){return kv(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V1=new ie(ut.comparator);function vs(){return V1}const Yv=new ie(ut.comparator);function go(...n){let t=Yv;for(const e of n)t=t.insert(e.key,e);return t}function Xv(n){let t=Yv;return n.forEach((e,s)=>t=t.insert(e,s.overlayedDocument)),t}function Ri(){return Lo()}function Qv(){return Lo()}function Lo(){return new qi(n=>n.toString(),(n,t)=>n.isEqual(t))}const N1=new ie(ut.comparator),F1=new me(ut.comparator);function Dt(...n){let t=F1;for(const e of n)t=t.add(e);return t}const B1=new me(kt);function U1(){return B1}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yd(n,t){if(n.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:nc(t)?"-0":t}}function Jv(n){return{integerValue:""+n}}function Zv(n,t){return p1(t)?Jv(t):Yd(n,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qc{constructor(){this._=void 0}}function $1(n,t,e){return n instanceof ac?function(i,r){const o={fields:{[Ov]:{stringValue:Mv},[Vv]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return r&&Wd(r)&&(r=zc(r)),r&&(o.fields[Lv]=r),{mapValue:o}}(e,t):n instanceof ta?e0(n,t):n instanceof ea?n0(n,t):function(i,r){const o=t0(i,r),a=xm(o)+xm(i.Ae);return Lh(o)&&Lh(i.Ae)?Jv(a):Yd(i.serializer,a)}(n,t)}function z1(n,t,e){return n instanceof ta?e0(n,t):n instanceof ea?n0(n,t):e}function t0(n,t){return n instanceof na?function(s){return Lh(s)||function(r){return!!r&&"doubleValue"in r}(s)}(t)?t:{integerValue:0}:null}class ac extends qc{}class ta extends qc{constructor(t){super(),this.elements=t}}function e0(n,t){const e=s0(t);for(const s of n.elements)e.some(i=>Gn(i,s))||e.push(s);return{arrayValue:{values:e}}}class ea extends qc{constructor(t){super(),this.elements=t}}function n0(n,t){let e=s0(t);for(const s of n.elements)e=e.filter(i=>!Gn(i,s));return{arrayValue:{values:e}}}class na extends qc{constructor(t,e){super(),this.serializer=t,this.Ae=e}}function xm(n){return le(n.integerValue||n.doubleValue)}function s0(n){return qd(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j1{constructor(t,e){this.field=t,this.transform=e}}function H1(n,t){return n.field.isEqual(t.field)&&function(s,i){return s instanceof ta&&i instanceof ta||s instanceof ea&&i instanceof ea?Tr(s.elements,i.elements,Gn):s instanceof na&&i instanceof na?Gn(s.Ae,i.Ae):s instanceof ac&&i instanceof ac}(n.transform,t.transform)}class W1{constructor(t,e){this.version=t,this.transformResults=e}}class mn{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new mn}static exists(t){return new mn(void 0,t)}static updateTime(t){return new mn(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function Rl(n,t){return n.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(n.updateTime):n.exists===void 0||n.exists===t.isFoundDocument()}class Gc{}function i0(n,t){if(!n.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return n.isNoDocument()?new Xd(n.key,mn.none()):new xa(n.key,n.data,mn.none());{const e=n.data,s=Je.empty();let i=new me(Ae.comparator);for(let r of t.fields)if(!i.has(r)){let o=e.field(r);o===null&&r.length>1&&(r=r.popLast(),o=e.field(r)),o===null?s.delete(r):s.set(r,o),i=i.add(r)}return new ui(n.key,s,new cn(i.toArray()),mn.none())}}function q1(n,t,e){n instanceof xa?function(i,r,o){const a=i.value.clone(),l=Em(i.fieldTransforms,r,o.transformResults);a.setAll(l),r.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,t,e):n instanceof ui?function(i,r,o){if(!Rl(i.precondition,r))return void r.convertToUnknownDocument(o.version);const a=Em(i.fieldTransforms,r,o.transformResults),l=r.data;l.setAll(r0(i)),l.setAll(a),r.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(n,t,e):function(i,r,o){r.convertToNoDocument(o.version).setHasCommittedMutations()}(0,t,e)}function Vo(n,t,e,s){return n instanceof xa?function(r,o,a,l){if(!Rl(r.precondition,o))return a;const c=r.value.clone(),h=Im(r.fieldTransforms,l,o);return c.setAll(h),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(n,t,e,s):n instanceof ui?function(r,o,a,l){if(!Rl(r.precondition,o))return a;const c=Im(r.fieldTransforms,l,o),h=o.data;return h.setAll(r0(r)),h.setAll(c),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(r.fieldMask.fields).unionWith(r.fieldTransforms.map(d=>d.field))}(n,t,e,s):function(r,o,a){return Rl(r.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,t,e)}function G1(n,t){let e=null;for(const s of n.fieldTransforms){const i=t.data.field(s.field),r=t0(s.transform,i||null);r!=null&&(e===null&&(e=Je.empty()),e.set(s.field,r))}return e||null}function Tm(n,t){return n.type===t.type&&!!n.key.isEqual(t.key)&&!!n.precondition.isEqual(t.precondition)&&!!function(s,i){return s===void 0&&i===void 0||!(!s||!i)&&Tr(s,i,(r,o)=>H1(r,o))}(n.fieldTransforms,t.fieldTransforms)&&(n.type===0?n.value.isEqual(t.value):n.type!==1||n.data.isEqual(t.data)&&n.fieldMask.isEqual(t.fieldMask))}class xa extends Gc{constructor(t,e,s,i=[]){super(),this.key=t,this.value=e,this.precondition=s,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class ui extends Gc{constructor(t,e,s,i,r=[]){super(),this.key=t,this.data=e,this.fieldMask=s,this.precondition=i,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function r0(n){const t=new Map;return n.fieldMask.fields.forEach(e=>{if(!e.isEmpty()){const s=n.data.field(e);t.set(e,s)}}),t}function Em(n,t,e){const s=new Map;zt(n.length===e.length,32656,{Re:e.length,Ve:n.length});for(let i=0;i<e.length;i++){const r=n[i],o=r.transform,a=t.data.field(r.field);s.set(r.field,z1(o,a,e[i]))}return s}function Im(n,t,e){const s=new Map;for(const i of n){const r=i.transform,o=e.data.field(i.field);s.set(i.field,$1(r,o,t))}return s}class Xd extends Gc{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class K1 extends Gc{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y1{constructor(t,e,s,i){this.batchId=t,this.localWriteTime=e,this.baseMutations=s,this.mutations=i}applyToRemoteDocument(t,e){const s=e.mutationResults;for(let i=0;i<this.mutations.length;i++){const r=this.mutations[i];r.key.isEqual(t.key)&&q1(r,t,s[i])}}applyToLocalView(t,e){for(const s of this.baseMutations)s.key.isEqual(t.key)&&(e=Vo(s,t,e,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(t.key)&&(e=Vo(s,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const s=Qv();return this.mutations.forEach(i=>{const r=t.get(i.key),o=r.overlayedDocument;let a=this.applyToLocalView(o,r.mutatedFields);a=e.has(i.key)?null:a;const l=i0(o,a);l!==null&&s.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(bt.min())}),s}keys(){return this.mutations.reduce((t,e)=>t.add(e.key),Dt())}isEqual(t){return this.batchId===t.batchId&&Tr(this.mutations,t.mutations,(e,s)=>Tm(e,s))&&Tr(this.baseMutations,t.baseMutations,(e,s)=>Tm(e,s))}}class Qd{constructor(t,e,s,i){this.batch=t,this.commitVersion=e,this.mutationResults=s,this.docVersions=i}static from(t,e,s){zt(t.mutations.length===s.length,58842,{me:t.mutations.length,fe:s.length});let i=function(){return N1}();const r=t.mutations;for(let o=0;o<r.length;o++)i=i.insert(r[o].key,s[o].version);return new Qd(t,e,s,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X1{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q1{constructor(t,e){this.count=t,this.unchangedNames=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var he,Lt;function J1(n){switch(n){case U.OK:return ft(64938);case U.CANCELLED:case U.UNKNOWN:case U.DEADLINE_EXCEEDED:case U.RESOURCE_EXHAUSTED:case U.INTERNAL:case U.UNAVAILABLE:case U.UNAUTHENTICATED:return!1;case U.INVALID_ARGUMENT:case U.NOT_FOUND:case U.ALREADY_EXISTS:case U.PERMISSION_DENIED:case U.FAILED_PRECONDITION:case U.ABORTED:case U.OUT_OF_RANGE:case U.UNIMPLEMENTED:case U.DATA_LOSS:return!0;default:return ft(15467,{code:n})}}function o0(n){if(n===void 0)return bs("GRPC error has no .code"),U.UNKNOWN;switch(n){case he.OK:return U.OK;case he.CANCELLED:return U.CANCELLED;case he.UNKNOWN:return U.UNKNOWN;case he.DEADLINE_EXCEEDED:return U.DEADLINE_EXCEEDED;case he.RESOURCE_EXHAUSTED:return U.RESOURCE_EXHAUSTED;case he.INTERNAL:return U.INTERNAL;case he.UNAVAILABLE:return U.UNAVAILABLE;case he.UNAUTHENTICATED:return U.UNAUTHENTICATED;case he.INVALID_ARGUMENT:return U.INVALID_ARGUMENT;case he.NOT_FOUND:return U.NOT_FOUND;case he.ALREADY_EXISTS:return U.ALREADY_EXISTS;case he.PERMISSION_DENIED:return U.PERMISSION_DENIED;case he.FAILED_PRECONDITION:return U.FAILED_PRECONDITION;case he.ABORTED:return U.ABORTED;case he.OUT_OF_RANGE:return U.OUT_OF_RANGE;case he.UNIMPLEMENTED:return U.UNIMPLEMENTED;case he.DATA_LOSS:return U.DATA_LOSS;default:return ft(39323,{code:n})}}(Lt=he||(he={}))[Lt.OK=0]="OK",Lt[Lt.CANCELLED=1]="CANCELLED",Lt[Lt.UNKNOWN=2]="UNKNOWN",Lt[Lt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Lt[Lt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Lt[Lt.NOT_FOUND=5]="NOT_FOUND",Lt[Lt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Lt[Lt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Lt[Lt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Lt[Lt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Lt[Lt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Lt[Lt.ABORTED=10]="ABORTED",Lt[Lt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Lt[Lt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Lt[Lt.INTERNAL=13]="INTERNAL",Lt[Lt.UNAVAILABLE=14]="UNAVAILABLE",Lt[Lt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z1(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tP=new Ys([4294967295,4294967295],0);function Am(n){const t=Z1().encode(n),e=new wv;return e.update(t),new Uint8Array(e.digest())}function Sm(n){const t=new DataView(n.buffer),e=t.getUint32(0,!0),s=t.getUint32(4,!0),i=t.getUint32(8,!0),r=t.getUint32(12,!0);return[new Ys([e,s],0),new Ys([i,r],0)]}class Jd{constructor(t,e,s){if(this.bitmap=t,this.padding=e,this.hashCount=s,e<0||e>=8)throw new mo(`Invalid padding: ${e}`);if(s<0)throw new mo(`Invalid hash count: ${s}`);if(t.length>0&&this.hashCount===0)throw new mo(`Invalid hash count: ${s}`);if(t.length===0&&e!==0)throw new mo(`Invalid padding when bitmap length is 0: ${e}`);this.ge=8*t.length-e,this.pe=Ys.fromNumber(this.ge)}ye(t,e,s){let i=t.add(e.multiply(Ys.fromNumber(s)));return i.compare(tP)===1&&(i=new Ys([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(this.ge===0)return!1;const e=Am(t),[s,i]=Sm(e);for(let r=0;r<this.hashCount;r++){const o=this.ye(s,i,r);if(!this.we(o))return!1}return!0}static create(t,e,s){const i=t%8==0?0:8-t%8,r=new Uint8Array(Math.ceil(t/8)),o=new Jd(r,i,e);return s.forEach(a=>o.insert(a)),o}insert(t){if(this.ge===0)return;const e=Am(t),[s,i]=Sm(e);for(let r=0;r<this.hashCount;r++){const o=this.ye(s,i,r);this.Se(o)}}Se(t){const e=Math.floor(t/8),s=t%8;this.bitmap[e]|=1<<s}}class mo extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kc{constructor(t,e,s,i,r){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=s,this.documentUpdates=i,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(t,e,s){const i=new Map;return i.set(t,Ta.createSynthesizedTargetChangeForCurrentChange(t,e,s)),new Kc(bt.min(),i,new ie(kt),vs(),Dt())}}class Ta{constructor(t,e,s,i,r){this.resumeToken=t,this.current=e,this.addedDocuments=s,this.modifiedDocuments=i,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(t,e,s){return new Ta(s,e,Dt(),Dt(),Dt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kl{constructor(t,e,s,i){this.be=t,this.removedTargetIds=e,this.key=s,this.De=i}}class a0{constructor(t,e){this.targetId=t,this.Ce=e}}class l0{constructor(t,e,s=Ce.EMPTY_BYTE_STRING,i=null){this.state=t,this.targetIds=e,this.resumeToken=s,this.cause=i}}class Cm{constructor(){this.ve=0,this.Fe=Pm(),this.Me=Ce.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(t){t.approximateByteSize()>0&&(this.Oe=!0,this.Me=t)}ke(){let t=Dt(),e=Dt(),s=Dt();return this.Fe.forEach((i,r)=>{switch(r){case 0:t=t.add(i);break;case 2:e=e.add(i);break;case 1:s=s.add(i);break;default:ft(38017,{changeType:r})}}),new Ta(this.Me,this.xe,t,e,s)}qe(){this.Oe=!1,this.Fe=Pm()}Qe(t,e){this.Oe=!0,this.Fe=this.Fe.insert(t,e)}$e(t){this.Oe=!0,this.Fe=this.Fe.remove(t)}Ue(){this.ve+=1}Ke(){this.ve-=1,zt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class eP{constructor(t){this.Ge=t,this.ze=new Map,this.je=vs(),this.Je=sl(),this.He=sl(),this.Ye=new ie(kt)}Ze(t){for(const e of t.be)t.De&&t.De.isFoundDocument()?this.Xe(e,t.De):this.et(e,t.key,t.De);for(const e of t.removedTargetIds)this.et(e,t.key,t.De)}tt(t){this.forEachTarget(t,e=>{const s=this.nt(e);switch(t.state){case 0:this.rt(e)&&s.Le(t.resumeToken);break;case 1:s.Ke(),s.Ne||s.qe(),s.Le(t.resumeToken);break;case 2:s.Ke(),s.Ne||this.removeTarget(e);break;case 3:this.rt(e)&&(s.We(),s.Le(t.resumeToken));break;case 4:this.rt(e)&&(this.it(e),s.Le(t.resumeToken));break;default:ft(56790,{state:t.state})}})}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.ze.forEach((s,i)=>{this.rt(i)&&e(i)})}st(t){const e=t.targetId,s=t.Ce.count,i=this.ot(e);if(i){const r=i.target;if(Nh(r))if(s===0){const o=new ut(r.path);this.et(e,o,Ne.newNoDocument(o,bt.min()))}else zt(s===1,20013,{expectedCount:s});else{const o=this._t(e);if(o!==s){const a=this.ut(t),l=a?this.ct(a,t,o):1;if(l!==0){this.it(e);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(e,c)}}}}}ut(t){const e=t.Ce.unchangedNames;if(!e||!e.bits)return null;const{bits:{bitmap:s="",padding:i=0},hashCount:r=0}=e;let o,a;try{o=si(s).toUint8Array()}catch(l){if(l instanceof Dv)return xr("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new Jd(o,i,r)}catch(l){return xr(l instanceof mo?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(t,e,s){return e.Ce.count===s-this.Pt(t,e.targetId)?0:2}Pt(t,e){const s=this.Ge.getRemoteKeysForTarget(e);let i=0;return s.forEach(r=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${r.path.canonicalString()}`;t.mightContain(a)||(this.et(e,r,null),i++)}),i}Tt(t){const e=new Map;this.ze.forEach((r,o)=>{const a=this.ot(o);if(a){if(r.current&&Nh(a.target)){const l=new ut(a.target.path);this.It(l).has(o)||this.Et(o,l)||this.et(o,l,Ne.newNoDocument(l,t))}r.Be&&(e.set(o,r.ke()),r.qe())}});let s=Dt();this.He.forEach((r,o)=>{let a=!0;o.forEachWhile(l=>{const c=this.ot(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(s=s.add(r))}),this.je.forEach((r,o)=>o.setReadTime(t));const i=new Kc(t,e,this.Ye,this.je,s);return this.je=vs(),this.Je=sl(),this.He=sl(),this.Ye=new ie(kt),i}Xe(t,e){if(!this.rt(t))return;const s=this.Et(t,e.key)?2:0;this.nt(t).Qe(e.key,s),this.je=this.je.insert(e.key,e),this.Je=this.Je.insert(e.key,this.It(e.key).add(t)),this.He=this.He.insert(e.key,this.dt(e.key).add(t))}et(t,e,s){if(!this.rt(t))return;const i=this.nt(t);this.Et(t,e)?i.Qe(e,1):i.$e(e),this.He=this.He.insert(e,this.dt(e).delete(t)),this.He=this.He.insert(e,this.dt(e).add(t)),s&&(this.je=this.je.insert(e,s))}removeTarget(t){this.ze.delete(t)}_t(t){const e=this.nt(t).ke();return this.Ge.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}Ue(t){this.nt(t).Ue()}nt(t){let e=this.ze.get(t);return e||(e=new Cm,this.ze.set(t,e)),e}dt(t){let e=this.He.get(t);return e||(e=new me(kt),this.He=this.He.insert(t,e)),e}It(t){let e=this.Je.get(t);return e||(e=new me(kt),this.Je=this.Je.insert(t,e)),e}rt(t){const e=this.ot(t)!==null;return e||tt("WatchChangeAggregator","Detected inactive target",t),e}ot(t){const e=this.ze.get(t);return e&&e.Ne?null:this.Ge.At(t)}it(t){this.ze.set(t,new Cm),this.Ge.getRemoteKeysForTarget(t).forEach(e=>{this.et(t,e,null)})}Et(t,e){return this.Ge.getRemoteKeysForTarget(t).has(e)}}function sl(){return new ie(ut.comparator)}function Pm(){return new ie(ut.comparator)}const nP={asc:"ASCENDING",desc:"DESCENDING"},sP={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},iP={and:"AND",or:"OR"};class rP{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function Uh(n,t){return n.useProto3Json||$c(t)?t:{value:t}}function lc(n,t){return n.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function c0(n,t){return n.useProto3Json?t.toBase64():t.toUint8Array()}function oP(n,t){return lc(n,t.toTimestamp())}function Bn(n){return zt(!!n,49232),bt.fromTimestamp(function(e){const s=ni(e);return new Kt(s.seconds,s.nanos)}(n))}function Zd(n,t){return $h(n,t).canonicalString()}function $h(n,t){const e=function(i){return new Gt(["projects",i.projectId,"databases",i.database])}(n).child("documents");return t===void 0?e:e.child(t)}function u0(n){const t=Gt.fromString(n);return zt(g0(t),10190,{key:t.toString()}),t}function zh(n,t){return Zd(n.databaseId,t.path)}function qu(n,t){const e=u0(t);if(e.get(1)!==n.databaseId.projectId)throw new J(U.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+n.databaseId.projectId);if(e.get(3)!==n.databaseId.database)throw new J(U.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+n.databaseId.database);return new ut(d0(e))}function h0(n,t){return Zd(n.databaseId,t)}function aP(n){const t=u0(n);return t.length===4?Gt.emptyPath():d0(t)}function jh(n){return new Gt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function d0(n){return zt(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Rm(n,t,e){return{name:zh(n,t),fields:e.value.mapValue.fields}}function lP(n,t){let e;if("targetChange"in t){t.targetChange;const s=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:ft(39313,{state:c})}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],r=function(c,h){return c.useProto3Json?(zt(h===void 0||typeof h=="string",58123),Ce.fromBase64String(h||"")):(zt(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),Ce.fromUint8Array(h||new Uint8Array))}(n,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(c){const h=c.code===void 0?U.UNKNOWN:o0(c.code);return new J(h,c.message||"")}(o);e=new l0(s,i,r,a||null)}else if("documentChange"in t){t.documentChange;const s=t.documentChange;s.document,s.document.name,s.document.updateTime;const i=qu(n,s.document.name),r=Bn(s.document.updateTime),o=s.document.createTime?Bn(s.document.createTime):bt.min(),a=new Je({mapValue:{fields:s.document.fields}}),l=Ne.newFoundDocument(i,r,o,a),c=s.targetIds||[],h=s.removedTargetIds||[];e=new kl(c,h,l.key,l)}else if("documentDelete"in t){t.documentDelete;const s=t.documentDelete;s.document;const i=qu(n,s.document),r=s.readTime?Bn(s.readTime):bt.min(),o=Ne.newNoDocument(i,r),a=s.removedTargetIds||[];e=new kl([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const s=t.documentRemove;s.document;const i=qu(n,s.document),r=s.removedTargetIds||[];e=new kl([],r,i,null)}else{if(!("filter"in t))return ft(11601,{Rt:t});{t.filter;const s=t.filter;s.targetId;const{count:i=0,unchangedNames:r}=s,o=new Q1(i,r),a=s.targetId;e=new a0(a,o)}}return e}function cP(n,t){let e;if(t instanceof xa)e={update:Rm(n,t.key,t.value)};else if(t instanceof Xd)e={delete:zh(n,t.key)};else if(t instanceof ui)e={update:Rm(n,t.key,t.data),updateMask:yP(t.fieldMask)};else{if(!(t instanceof K1))return ft(16599,{Vt:t.type});e={verify:zh(n,t.key)}}return t.fieldTransforms.length>0&&(e.updateTransforms=t.fieldTransforms.map(s=>function(r,o){const a=o.transform;if(a instanceof ac)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof ta)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof ea)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof na)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw ft(20930,{transform:o.transform})}(0,s))),t.precondition.isNone||(e.currentDocument=function(i,r){return r.updateTime!==void 0?{updateTime:oP(i,r.updateTime)}:r.exists!==void 0?{exists:r.exists}:ft(27497)}(n,t.precondition)),e}function uP(n,t){return n&&n.length>0?(zt(t!==void 0,14353),n.map(e=>function(i,r){let o=i.updateTime?Bn(i.updateTime):Bn(r);return o.isEqual(bt.min())&&(o=Bn(r)),new W1(o,i.transformResults||[])}(e,t))):[]}function hP(n,t){return{documents:[h0(n,t.path)]}}function dP(n,t){const e={structuredQuery:{}},s=t.path;let i;t.collectionGroup!==null?(i=s,e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=s.popLast(),e.structuredQuery.from=[{collectionId:s.lastSegment()}]),e.parent=h0(n,i);const r=function(c){if(c.length!==0)return p0(An.create(c,"and"))}(t.filters);r&&(e.structuredQuery.where=r);const o=function(c){if(c.length!==0)return c.map(h=>function(f){return{field:ar(f.field),direction:gP(f.dir)}}(h))}(t.orderBy);o&&(e.structuredQuery.orderBy=o);const a=Uh(n,t.limit);return a!==null&&(e.structuredQuery.limit=a),t.startAt&&(e.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(t.startAt)),t.endAt&&(e.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(t.endAt)),{ft:e,parent:i}}function fP(n){let t=aP(n.parent);const e=n.structuredQuery,s=e.from?e.from.length:0;let i=null;if(s>0){zt(s===1,65062);const h=e.from[0];h.allDescendants?i=h.collectionId:t=t.child(h.collectionId)}let r=[];e.where&&(r=function(d){const f=f0(d);return f instanceof An&&zv(f)?f.getFilters():[f]}(e.where));let o=[];e.orderBy&&(o=function(d){return d.map(f=>function(_){return new oc(lr(_.field),function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(_.direction))}(f))}(e.orderBy));let a=null;e.limit&&(a=function(d){let f;return f=typeof d=="object"?d.value:d,$c(f)?null:f}(e.limit));let l=null;e.startAt&&(l=function(d){const f=!!d.before,g=d.values||[];return new rc(g,f)}(e.startAt));let c=null;return e.endAt&&(c=function(d){const f=!d.before,g=d.values||[];return new rc(g,f)}(e.endAt)),D1(t,i,o,r,a,"F",l,c)}function pP(n,t){const e=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ft(28987,{purpose:i})}}(t.purpose);return e==null?null:{"goog-listen-tags":e}}function f0(n){return n.unaryFilter!==void 0?function(e){switch(e.unaryFilter.op){case"IS_NAN":const s=lr(e.unaryFilter.field);return de.create(s,"==",{doubleValue:NaN});case"IS_NULL":const i=lr(e.unaryFilter.field);return de.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=lr(e.unaryFilter.field);return de.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=lr(e.unaryFilter.field);return de.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ft(61313);default:return ft(60726)}}(n):n.fieldFilter!==void 0?function(e){return de.create(lr(e.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ft(58110);default:return ft(50506)}}(e.fieldFilter.op),e.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(e){return An.create(e.compositeFilter.filters.map(s=>f0(s)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ft(1026)}}(e.compositeFilter.op))}(n):ft(30097,{filter:n})}function gP(n){return nP[n]}function mP(n){return sP[n]}function _P(n){return iP[n]}function ar(n){return{fieldPath:n.canonicalString()}}function lr(n){return Ae.fromServerFormat(n.fieldPath)}function p0(n){return n instanceof de?function(e){if(e.op==="=="){if(_m(e.value))return{unaryFilter:{field:ar(e.field),op:"IS_NAN"}};if(mm(e.value))return{unaryFilter:{field:ar(e.field),op:"IS_NULL"}}}else if(e.op==="!="){if(_m(e.value))return{unaryFilter:{field:ar(e.field),op:"IS_NOT_NAN"}};if(mm(e.value))return{unaryFilter:{field:ar(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ar(e.field),op:mP(e.op),value:e.value}}}(n):n instanceof An?function(e){const s=e.getFilters().map(i=>p0(i));return s.length===1?s[0]:{compositeFilter:{op:_P(e.op),filters:s}}}(n):ft(54877,{filter:n})}function yP(n){const t=[];return n.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function g0(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Us{constructor(t,e,s,i,r=bt.min(),o=bt.min(),a=Ce.EMPTY_BYTE_STRING,l=null){this.target=t,this.targetId=e,this.purpose=s,this.sequenceNumber=i,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(t){return new Us(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,e){return new Us(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new Us(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new Us(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bP{constructor(t){this.yt=t}}function vP(n){const t=fP({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Bh(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wP{constructor(){this.Cn=new xP}addToCollectionParentIndex(t,e){return this.Cn.add(e),$.resolve()}getCollectionParents(t,e){return $.resolve(this.Cn.getEntries(e))}addFieldIndex(t,e){return $.resolve()}deleteFieldIndex(t,e){return $.resolve()}deleteAllFieldIndexes(t){return $.resolve()}createTargetIndexes(t,e){return $.resolve()}getDocumentsMatchingTarget(t,e){return $.resolve(null)}getIndexType(t,e){return $.resolve(0)}getFieldIndexes(t,e){return $.resolve([])}getNextCollectionGroupToUpdate(t){return $.resolve(null)}getMinOffset(t,e){return $.resolve(ei.min())}getMinOffsetFromCollectionGroup(t,e){return $.resolve(ei.min())}updateCollectionGroup(t,e,s){return $.resolve()}updateIndexEntries(t,e){return $.resolve()}}class xP{constructor(){this.index={}}add(t){const e=t.lastSegment(),s=t.popLast(),i=this.index[e]||new me(Gt.comparator),r=!i.has(s);return this.index[e]=i.add(s),r}has(t){const e=t.lastSegment(),s=t.popLast(),i=this.index[e];return i&&i.has(s)}getEntries(t){return(this.index[t]||new me(Gt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const km={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},m0=41943040;class Qe{static withCacheSize(t){return new Qe(t,Qe.DEFAULT_COLLECTION_PERCENTILE,Qe.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,e,s){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Qe.DEFAULT_COLLECTION_PERCENTILE=10,Qe.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Qe.DEFAULT=new Qe(m0,Qe.DEFAULT_COLLECTION_PERCENTILE,Qe.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Qe.DISABLED=new Qe(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ar{constructor(t){this.ar=t}next(){return this.ar+=2,this.ar}static ur(){return new Ar(0)}static cr(){return new Ar(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dm="LruGarbageCollector",TP=1048576;function Mm([n,t],[e,s]){const i=kt(n,e);return i===0?kt(t,s):i}class EP{constructor(t){this.Ir=t,this.buffer=new me(Mm),this.Er=0}dr(){return++this.Er}Ar(t){const e=[t,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(e);else{const s=this.buffer.last();Mm(e,s)<0&&(this.buffer=this.buffer.delete(s).add(e))}}get maxValue(){return this.buffer.last()[0]}}class IP{constructor(t,e,s){this.garbageCollector=t,this.asyncQueue=e,this.localStore=s,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(t){tt(Dm,`Garbage collection scheduled in ${t}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){Fr(e)?tt(Dm,"Ignoring IndexedDB error during garbage collection: ",e):await Nr(e)}await this.Vr(3e5)})}}class AP{constructor(t,e){this.mr=t,this.params=e}calculateTargetCount(t,e){return this.mr.gr(t).next(s=>Math.floor(e/100*s))}nthSequenceNumber(t,e){if(e===0)return $.resolve(Uc.ce);const s=new EP(e);return this.mr.forEachTarget(t,i=>s.Ar(i.sequenceNumber)).next(()=>this.mr.pr(t,i=>s.Ar(i))).next(()=>s.maxValue)}removeTargets(t,e,s){return this.mr.removeTargets(t,e,s)}removeOrphanedDocuments(t,e){return this.mr.removeOrphanedDocuments(t,e)}collect(t,e){return this.params.cacheSizeCollectionThreshold===-1?(tt("LruGarbageCollector","Garbage collection skipped; disabled"),$.resolve(km)):this.getCacheSize(t).next(s=>s<this.params.cacheSizeCollectionThreshold?(tt("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),km):this.yr(t,e))}getCacheSize(t){return this.mr.getCacheSize(t)}yr(t,e){let s,i,r,o,a,l,c;const h=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(tt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),i=this.params.maximumSequenceNumbersToCollect):i=d,o=Date.now(),this.nthSequenceNumber(t,i))).next(d=>(s=d,a=Date.now(),this.removeTargets(t,s,e))).next(d=>(r=d,l=Date.now(),this.removeOrphanedDocuments(t,s))).next(d=>(c=Date.now(),rr()<=Pt.DEBUG&&tt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${r} targets in `+(l-a)+`ms
	Removed ${d} documents in `+(c-l)+`ms
Total Duration: ${c-h}ms`),$.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:r,documentsRemoved:d})))}}function SP(n,t){return new AP(n,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CP{constructor(){this.changes=new qi(t=>t.toString(),(t,e)=>t.isEqual(e)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,Ne.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const s=this.changes.get(e);return s!==void 0?$.resolve(s):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PP{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RP{constructor(t,e,s,i){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=s,this.indexManager=i}getDocument(t,e){let s=null;return this.documentOverlayCache.getOverlay(t,e).next(i=>(s=i,this.remoteDocumentCache.getEntry(t,e))).next(i=>(s!==null&&Vo(s.mutation,i,cn.empty(),Kt.now()),i))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next(s=>this.getLocalViewOfDocuments(t,s,Dt()).next(()=>s))}getLocalViewOfDocuments(t,e,s=Dt()){const i=Ri();return this.populateOverlays(t,i,e).next(()=>this.computeViews(t,e,i,s).next(r=>{let o=go();return r.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(t,e){const s=Ri();return this.populateOverlays(t,s,e).next(()=>this.computeViews(t,e,s,Dt()))}populateOverlays(t,e,s){const i=[];return s.forEach(r=>{e.has(r)||i.push(r)}),this.documentOverlayCache.getOverlays(t,i).next(r=>{r.forEach((o,a)=>{e.set(o,a)})})}computeViews(t,e,s,i){let r=vs();const o=Lo(),a=function(){return Lo()}();return e.forEach((l,c)=>{const h=s.get(c.key);i.has(c.key)&&(h===void 0||h.mutation instanceof ui)?r=r.insert(c.key,c):h!==void 0?(o.set(c.key,h.mutation.getFieldMask()),Vo(h.mutation,c,h.mutation.getFieldMask(),Kt.now())):o.set(c.key,cn.empty())}),this.recalculateAndSaveOverlays(t,r).next(l=>(l.forEach((c,h)=>o.set(c,h)),e.forEach((c,h)=>a.set(c,new PP(h,o.get(c)??null))),a))}recalculateAndSaveOverlays(t,e){const s=Lo();let i=new ie((o,a)=>o-a),r=Dt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=e.get(l);if(c===null)return;let h=s.get(l)||cn.empty();h=a.applyToLocalView(c,h),s.set(l,h);const d=(i.get(a.batchId)||Dt()).add(l);i=i.insert(a.batchId,d)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,h=l.value,d=Qv();h.forEach(f=>{if(!r.has(f)){const g=i0(e.get(f),s.get(f));g!==null&&d.set(f,g),r=r.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(t,c,d))}return $.waitFor(o)}).next(()=>s)}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next(s=>this.recalculateAndSaveOverlays(t,s))}getDocumentsMatchingQuery(t,e,s,i){return function(o){return ut.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):qv(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,s,i):this.getDocumentsMatchingCollectionQuery(t,e,s,i)}getNextDocuments(t,e,s,i){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,s,i).next(r=>{const o=i-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,s.largestBatchId,i-r.size):$.resolve(Ri());let a=Xo,l=r;return o.next(c=>$.forEach(c,(h,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),r.get(h)?$.resolve():this.remoteDocumentCache.getEntry(t,h).next(f=>{l=l.insert(h,f)}))).next(()=>this.populateOverlays(t,c,r)).next(()=>this.computeViews(t,l,c,Dt())).next(h=>({batchId:a,changes:Xv(h)})))})}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new ut(e)).next(s=>{let i=go();return s.isFoundDocument()&&(i=i.insert(s.key,s)),i})}getDocumentsMatchingCollectionGroupQuery(t,e,s,i){const r=e.collectionGroup;let o=go();return this.indexManager.getCollectionParents(t,r).next(a=>$.forEach(a,l=>{const c=function(d,f){return new Br(f,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(e,l.child(r));return this.getDocumentsMatchingCollectionQuery(t,c,s,i).next(h=>{h.forEach((d,f)=>{o=o.insert(d,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(t,e,s,i){let r;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,s.largestBatchId).next(o=>(r=o,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,s,r,i))).next(o=>{r.forEach((l,c)=>{const h=c.getKey();o.get(h)===null&&(o=o.insert(h,Ne.newInvalidDocument(h)))});let a=go();return o.forEach((l,c)=>{const h=r.get(l);h!==void 0&&Vo(h.mutation,c,cn.empty(),Kt.now()),Wc(e,c)&&(a=a.insert(l,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kP{constructor(t){this.serializer=t,this.Lr=new Map,this.kr=new Map}getBundleMetadata(t,e){return $.resolve(this.Lr.get(e))}saveBundleMetadata(t,e){return this.Lr.set(e.id,function(i){return{id:i.id,version:i.version,createTime:Bn(i.createTime)}}(e)),$.resolve()}getNamedQuery(t,e){return $.resolve(this.kr.get(e))}saveNamedQuery(t,e){return this.kr.set(e.name,function(i){return{name:i.name,query:vP(i.bundledQuery),readTime:Bn(i.readTime)}}(e)),$.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DP{constructor(){this.overlays=new ie(ut.comparator),this.qr=new Map}getOverlay(t,e){return $.resolve(this.overlays.get(e))}getOverlays(t,e){const s=Ri();return $.forEach(e,i=>this.getOverlay(t,i).next(r=>{r!==null&&s.set(i,r)})).next(()=>s)}saveOverlays(t,e,s){return s.forEach((i,r)=>{this.St(t,e,r)}),$.resolve()}removeOverlaysForBatchId(t,e,s){const i=this.qr.get(s);return i!==void 0&&(i.forEach(r=>this.overlays=this.overlays.remove(r)),this.qr.delete(s)),$.resolve()}getOverlaysForCollection(t,e,s){const i=Ri(),r=e.length+1,o=new ut(e.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!e.isPrefixOf(c.path))break;c.path.length===r&&l.largestBatchId>s&&i.set(l.getKey(),l)}return $.resolve(i)}getOverlaysForCollectionGroup(t,e,s,i){let r=new ie((c,h)=>c-h);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===e&&c.largestBatchId>s){let h=r.get(c.largestBatchId);h===null&&(h=Ri(),r=r.insert(c.largestBatchId,h)),h.set(c.getKey(),c)}}const a=Ri(),l=r.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,h)=>a.set(c,h)),!(a.size()>=i)););return $.resolve(a)}St(t,e,s){const i=this.overlays.get(s.key);if(i!==null){const o=this.qr.get(i.largestBatchId).delete(s.key);this.qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(s.key,new X1(e,s));let r=this.qr.get(e);r===void 0&&(r=Dt(),this.qr.set(e,r)),this.qr.set(e,r.add(s.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MP{constructor(){this.sessionToken=Ce.EMPTY_BYTE_STRING}getSessionToken(t){return $.resolve(this.sessionToken)}setSessionToken(t,e){return this.sessionToken=e,$.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tf{constructor(){this.Qr=new me(_e.$r),this.Ur=new me(_e.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(t,e){const s=new _e(t,e);this.Qr=this.Qr.add(s),this.Ur=this.Ur.add(s)}Wr(t,e){t.forEach(s=>this.addReference(s,e))}removeReference(t,e){this.Gr(new _e(t,e))}zr(t,e){t.forEach(s=>this.removeReference(s,e))}jr(t){const e=new ut(new Gt([])),s=new _e(e,t),i=new _e(e,t+1),r=[];return this.Ur.forEachInRange([s,i],o=>{this.Gr(o),r.push(o.key)}),r}Jr(){this.Qr.forEach(t=>this.Gr(t))}Gr(t){this.Qr=this.Qr.delete(t),this.Ur=this.Ur.delete(t)}Hr(t){const e=new ut(new Gt([])),s=new _e(e,t),i=new _e(e,t+1);let r=Dt();return this.Ur.forEachInRange([s,i],o=>{r=r.add(o.key)}),r}containsKey(t){const e=new _e(t,0),s=this.Qr.firstAfterOrEqual(e);return s!==null&&t.isEqual(s.key)}}class _e{constructor(t,e){this.key=t,this.Yr=e}static $r(t,e){return ut.comparator(t.key,e.key)||kt(t.Yr,e.Yr)}static Kr(t,e){return kt(t.Yr,e.Yr)||ut.comparator(t.key,e.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OP{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.tr=1,this.Zr=new me(_e.$r)}checkEmpty(t){return $.resolve(this.mutationQueue.length===0)}addMutationBatch(t,e,s,i){const r=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Y1(r,e,s,i);this.mutationQueue.push(o);for(const a of i)this.Zr=this.Zr.add(new _e(a.key,r)),this.indexManager.addToCollectionParentIndex(t,a.key.path.popLast());return $.resolve(o)}lookupMutationBatch(t,e){return $.resolve(this.Xr(e))}getNextMutationBatchAfterBatchId(t,e){const s=e+1,i=this.ei(s),r=i<0?0:i;return $.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return $.resolve(this.mutationQueue.length===0?Hd:this.tr-1)}getAllMutationBatches(t){return $.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const s=new _e(e,0),i=new _e(e,Number.POSITIVE_INFINITY),r=[];return this.Zr.forEachInRange([s,i],o=>{const a=this.Xr(o.Yr);r.push(a)}),$.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(t,e){let s=new me(kt);return e.forEach(i=>{const r=new _e(i,0),o=new _e(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([r,o],a=>{s=s.add(a.Yr)})}),$.resolve(this.ti(s))}getAllMutationBatchesAffectingQuery(t,e){const s=e.path,i=s.length+1;let r=s;ut.isDocumentKey(r)||(r=r.child(""));const o=new _e(new ut(r),0);let a=new me(kt);return this.Zr.forEachWhile(l=>{const c=l.key.path;return!!s.isPrefixOf(c)&&(c.length===i&&(a=a.add(l.Yr)),!0)},o),$.resolve(this.ti(a))}ti(t){const e=[];return t.forEach(s=>{const i=this.Xr(s);i!==null&&e.push(i)}),e}removeMutationBatch(t,e){zt(this.ni(e.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Zr;return $.forEach(e.mutations,i=>{const r=new _e(i.key,e.batchId);return s=s.delete(r),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)}).next(()=>{this.Zr=s})}ir(t){}containsKey(t,e){const s=new _e(e,0),i=this.Zr.firstAfterOrEqual(s);return $.resolve(e.isEqual(i&&i.key))}performConsistencyCheck(t){return this.mutationQueue.length,$.resolve()}ni(t,e){return this.ei(t)}ei(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Xr(t){const e=this.ei(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LP{constructor(t){this.ri=t,this.docs=function(){return new ie(ut.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const s=e.key,i=this.docs.get(s),r=i?i.size:0,o=this.ri(e);return this.docs=this.docs.insert(s,{document:e.mutableCopy(),size:o}),this.size+=o-r,this.indexManager.addToCollectionParentIndex(t,s.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const s=this.docs.get(e);return $.resolve(s?s.document.mutableCopy():Ne.newInvalidDocument(e))}getEntries(t,e){let s=vs();return e.forEach(i=>{const r=this.docs.get(i);s=s.insert(i,r?r.document.mutableCopy():Ne.newInvalidDocument(i))}),$.resolve(s)}getDocumentsMatchingQuery(t,e,s,i){let r=vs();const o=e.path,a=new ut(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:h}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||u1(c1(h),s)<=0||(i.has(h.key)||Wc(e,h))&&(r=r.insert(h.key,h.mutableCopy()))}return $.resolve(r)}getAllFromCollectionGroup(t,e,s,i){ft(9500)}ii(t,e){return $.forEach(this.docs,s=>e(s))}newChangeBuffer(t){return new VP(this)}getSize(t){return $.resolve(this.size)}}class VP extends CP{constructor(t){super(),this.Nr=t}applyChanges(t){const e=[];return this.changes.forEach((s,i)=>{i.isValidDocument()?e.push(this.Nr.addEntry(t,i)):this.Nr.removeEntry(s)}),$.waitFor(e)}getFromCache(t,e){return this.Nr.getEntry(t,e)}getAllFromCache(t,e){return this.Nr.getEntries(t,e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NP{constructor(t){this.persistence=t,this.si=new qi(e=>Gd(e),Kd),this.lastRemoteSnapshotVersion=bt.min(),this.highestTargetId=0,this.oi=0,this._i=new tf,this.targetCount=0,this.ai=Ar.ur()}forEachTarget(t,e){return this.si.forEach((s,i)=>e(i)),$.resolve()}getLastRemoteSnapshotVersion(t){return $.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return $.resolve(this.oi)}allocateTargetId(t){return this.highestTargetId=this.ai.next(),$.resolve(this.highestTargetId)}setTargetsMetadata(t,e,s){return s&&(this.lastRemoteSnapshotVersion=s),e>this.oi&&(this.oi=e),$.resolve()}Pr(t){this.si.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.ai=new Ar(e),this.highestTargetId=e),t.sequenceNumber>this.oi&&(this.oi=t.sequenceNumber)}addTargetData(t,e){return this.Pr(e),this.targetCount+=1,$.resolve()}updateTargetData(t,e){return this.Pr(e),$.resolve()}removeTargetData(t,e){return this.si.delete(e.target),this._i.jr(e.targetId),this.targetCount-=1,$.resolve()}removeTargets(t,e,s){let i=0;const r=[];return this.si.forEach((o,a)=>{a.sequenceNumber<=e&&s.get(a.targetId)===null&&(this.si.delete(o),r.push(this.removeMatchingKeysForTargetId(t,a.targetId)),i++)}),$.waitFor(r).next(()=>i)}getTargetCount(t){return $.resolve(this.targetCount)}getTargetData(t,e){const s=this.si.get(e)||null;return $.resolve(s)}addMatchingKeys(t,e,s){return this._i.Wr(e,s),$.resolve()}removeMatchingKeys(t,e,s){this._i.zr(e,s);const i=this.persistence.referenceDelegate,r=[];return i&&e.forEach(o=>{r.push(i.markPotentiallyOrphaned(t,o))}),$.waitFor(r)}removeMatchingKeysForTargetId(t,e){return this._i.jr(e),$.resolve()}getMatchingKeysForTargetId(t,e){const s=this._i.Hr(e);return $.resolve(s)}containsKey(t,e){return $.resolve(this._i.containsKey(e))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _0{constructor(t,e){this.ui={},this.overlays={},this.ci=new Uc(0),this.li=!1,this.li=!0,this.hi=new MP,this.referenceDelegate=t(this),this.Pi=new NP(this),this.indexManager=new wP,this.remoteDocumentCache=function(i){return new LP(i)}(s=>this.referenceDelegate.Ti(s)),this.serializer=new bP(e),this.Ii=new kP(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new DP,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let s=this.ui[t.toKey()];return s||(s=new OP(e,this.referenceDelegate),this.ui[t.toKey()]=s),s}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(t,e,s){tt("MemoryPersistence","Starting transaction:",t);const i=new FP(this.ci.next());return this.referenceDelegate.Ei(),s(i).next(r=>this.referenceDelegate.di(i).next(()=>r)).toPromise().then(r=>(i.raiseOnCommittedEvent(),r))}Ai(t,e){return $.or(Object.values(this.ui).map(s=>()=>s.containsKey(t,e)))}}class FP extends d1{constructor(t){super(),this.currentSequenceNumber=t}}class ef{constructor(t){this.persistence=t,this.Ri=new tf,this.Vi=null}static mi(t){return new ef(t)}get fi(){if(this.Vi)return this.Vi;throw ft(60996)}addReference(t,e,s){return this.Ri.addReference(s,e),this.fi.delete(s.toString()),$.resolve()}removeReference(t,e,s){return this.Ri.removeReference(s,e),this.fi.add(s.toString()),$.resolve()}markPotentiallyOrphaned(t,e){return this.fi.add(e.toString()),$.resolve()}removeTarget(t,e){this.Ri.jr(e.targetId).forEach(i=>this.fi.add(i.toString()));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(t,e.targetId).next(i=>{i.forEach(r=>this.fi.add(r.toString()))}).next(()=>s.removeTargetData(t,e))}Ei(){this.Vi=new Set}di(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return $.forEach(this.fi,s=>{const i=ut.fromPath(s);return this.gi(t,i).next(r=>{r||e.removeEntry(i,bt.min())})}).next(()=>(this.Vi=null,e.apply(t)))}updateLimboDocument(t,e){return this.gi(t,e).next(s=>{s?this.fi.delete(e.toString()):this.fi.add(e.toString())})}Ti(t){return 0}gi(t,e){return $.or([()=>$.resolve(this.Ri.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ai(t,e)])}}class cc{constructor(t,e){this.persistence=t,this.pi=new qi(s=>g1(s.path),(s,i)=>s.isEqual(i)),this.garbageCollector=SP(this,e)}static mi(t,e){return new cc(t,e)}Ei(){}di(t){return $.resolve()}forEachTarget(t,e){return this.persistence.getTargetCache().forEachTarget(t,e)}gr(t){const e=this.wr(t);return this.persistence.getTargetCache().getTargetCount(t).next(s=>e.next(i=>s+i))}wr(t){let e=0;return this.pr(t,s=>{e++}).next(()=>e)}pr(t,e){return $.forEach(this.pi,(s,i)=>this.br(t,s,i).next(r=>r?$.resolve():e(i)))}removeTargets(t,e,s){return this.persistence.getTargetCache().removeTargets(t,e,s)}removeOrphanedDocuments(t,e){let s=0;const i=this.persistence.getRemoteDocumentCache(),r=i.newChangeBuffer();return i.ii(t,o=>this.br(t,o,e).next(a=>{a||(s++,r.removeEntry(o,bt.min()))})).next(()=>r.apply(t)).next(()=>s)}markPotentiallyOrphaned(t,e){return this.pi.set(e,t.currentSequenceNumber),$.resolve()}removeTarget(t,e){const s=e.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,s)}addReference(t,e,s){return this.pi.set(s,t.currentSequenceNumber),$.resolve()}removeReference(t,e,s){return this.pi.set(s,t.currentSequenceNumber),$.resolve()}updateLimboDocument(t,e){return this.pi.set(e,t.currentSequenceNumber),$.resolve()}Ti(t){let e=t.key.toString().length;return t.isFoundDocument()&&(e+=Cl(t.data.value)),e}br(t,e,s){return $.or([()=>this.persistence.Ai(t,e),()=>this.persistence.getTargetCache().containsKey(t,e),()=>{const i=this.pi.get(e);return $.resolve(i!==void 0&&i>s)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nf{constructor(t,e,s,i){this.targetId=t,this.fromCache=e,this.Es=s,this.ds=i}static As(t,e){let s=Dt(),i=Dt();for(const r of e.docChanges)switch(r.type){case 0:s=s.add(r.doc.key);break;case 1:i=i.add(r.doc.key)}return new nf(t,e.fromCache,s,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BP{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UP{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return DI()?8:f1($e())>0?6:4}()}initialize(t,e){this.ps=t,this.indexManager=e,this.Rs=!0}getDocumentsMatchingQuery(t,e,s,i){const r={result:null};return this.ys(t,e).next(o=>{r.result=o}).next(()=>{if(!r.result)return this.ws(t,e,i,s).next(o=>{r.result=o})}).next(()=>{if(r.result)return;const o=new BP;return this.Ss(t,e,o).next(a=>{if(r.result=a,this.Vs)return this.bs(t,e,o,a.size)})}).next(()=>r.result)}bs(t,e,s,i){return s.documentReadCount<this.fs?(rr()<=Pt.DEBUG&&tt("QueryEngine","SDK will not create cache indexes for query:",or(e),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),$.resolve()):(rr()<=Pt.DEBUG&&tt("QueryEngine","Query:",or(e),"scans",s.documentReadCount,"local documents and returns",i,"documents as results."),s.documentReadCount>this.gs*i?(rr()<=Pt.DEBUG&&tt("QueryEngine","The SDK decides to create cache indexes for query:",or(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,Fn(e))):$.resolve())}ys(t,e){if(wm(e))return $.resolve(null);let s=Fn(e);return this.indexManager.getIndexType(t,s).next(i=>i===0?null:(e.limit!==null&&i===1&&(e=Bh(e,null,"F"),s=Fn(e)),this.indexManager.getDocumentsMatchingTarget(t,s).next(r=>{const o=Dt(...r);return this.ps.getDocuments(t,o).next(a=>this.indexManager.getMinOffset(t,s).next(l=>{const c=this.Ds(e,a);return this.Cs(e,c,o,l.readTime)?this.ys(t,Bh(e,null,"F")):this.vs(t,c,e,l)}))})))}ws(t,e,s,i){return wm(e)||i.isEqual(bt.min())?$.resolve(null):this.ps.getDocuments(t,s).next(r=>{const o=this.Ds(e,r);return this.Cs(e,o,s,i)?$.resolve(null):(rr()<=Pt.DEBUG&&tt("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),or(e)),this.vs(t,o,e,l1(i,Xo)).next(a=>a))})}Ds(t,e){let s=new me(Kv(t));return e.forEach((i,r)=>{Wc(t,r)&&(s=s.add(r))}),s}Cs(t,e,s,i){if(t.limit===null)return!1;if(s.size!==e.size)return!0;const r=t.limitType==="F"?e.last():e.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(i)>0)}Ss(t,e,s){return rr()<=Pt.DEBUG&&tt("QueryEngine","Using full collection scan to execute query:",or(e)),this.ps.getDocumentsMatchingQuery(t,e,ei.min(),s)}vs(t,e,s,i){return this.ps.getDocumentsMatchingQuery(t,s,i).next(r=>(e.forEach(o=>{r=r.insert(o.key,o)}),r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sf="LocalStore",$P=3e8;class zP{constructor(t,e,s,i){this.persistence=t,this.Fs=e,this.serializer=i,this.Ms=new ie(kt),this.xs=new qi(r=>Gd(r),Kd),this.Os=new Map,this.Ns=t.getRemoteDocumentCache(),this.Pi=t.getTargetCache(),this.Ii=t.getBundleCache(),this.Bs(s)}Bs(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new RP(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",e=>t.collect(e,this.Ms))}}function jP(n,t,e,s){return new zP(n,t,e,s)}async function y0(n,t){const e=wt(n);return await e.persistence.runTransaction("Handle user change","readonly",s=>{let i;return e.mutationQueue.getAllMutationBatches(s).next(r=>(i=r,e.Bs(t),e.mutationQueue.getAllMutationBatches(s))).next(r=>{const o=[],a=[];let l=Dt();for(const c of i){o.push(c.batchId);for(const h of c.mutations)l=l.add(h.key)}for(const c of r){a.push(c.batchId);for(const h of c.mutations)l=l.add(h.key)}return e.localDocuments.getDocuments(s,l).next(c=>({Ls:c,removedBatchIds:o,addedBatchIds:a}))})})}function HP(n,t){const e=wt(n);return e.persistence.runTransaction("Acknowledge batch","readwrite-primary",s=>{const i=t.batch.keys(),r=e.Ns.newChangeBuffer({trackRemovals:!0});return function(a,l,c,h){const d=c.batch,f=d.keys();let g=$.resolve();return f.forEach(_=>{g=g.next(()=>h.getEntry(l,_)).next(y=>{const w=c.docVersions.get(_);zt(w!==null,48541),y.version.compareTo(w)<0&&(d.applyToRemoteDocument(y,c),y.isValidDocument()&&(y.setReadTime(c.commitVersion),h.addEntry(y)))})}),g.next(()=>a.mutationQueue.removeMutationBatch(l,d))}(e,s,t,r).next(()=>r.apply(s)).next(()=>e.mutationQueue.performConsistencyCheck(s)).next(()=>e.documentOverlayCache.removeOverlaysForBatchId(s,i,t.batch.batchId)).next(()=>e.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,function(a){let l=Dt();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l}(t))).next(()=>e.localDocuments.getDocuments(s,i))})}function b0(n){const t=wt(n);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Pi.getLastRemoteSnapshotVersion(e))}function WP(n,t){const e=wt(n),s=t.snapshotVersion;let i=e.Ms;return e.persistence.runTransaction("Apply remote event","readwrite-primary",r=>{const o=e.Ns.newChangeBuffer({trackRemovals:!0});i=e.Ms;const a=[];t.targetChanges.forEach((h,d)=>{const f=i.get(d);if(!f)return;a.push(e.Pi.removeMatchingKeys(r,h.removedDocuments,d).next(()=>e.Pi.addMatchingKeys(r,h.addedDocuments,d)));let g=f.withSequenceNumber(r.currentSequenceNumber);t.targetMismatches.get(d)!==null?g=g.withResumeToken(Ce.EMPTY_BYTE_STRING,bt.min()).withLastLimboFreeSnapshotVersion(bt.min()):h.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(h.resumeToken,s)),i=i.insert(d,g),function(y,w,E){return y.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-y.snapshotVersion.toMicroseconds()>=$P?!0:E.addedDocuments.size+E.modifiedDocuments.size+E.removedDocuments.size>0}(f,g,h)&&a.push(e.Pi.updateTargetData(r,g))});let l=vs(),c=Dt();if(t.documentUpdates.forEach(h=>{t.resolvedLimboDocuments.has(h)&&a.push(e.persistence.referenceDelegate.updateLimboDocument(r,h))}),a.push(qP(r,o,t.documentUpdates).next(h=>{l=h.ks,c=h.qs})),!s.isEqual(bt.min())){const h=e.Pi.getLastRemoteSnapshotVersion(r).next(d=>e.Pi.setTargetsMetadata(r,r.currentSequenceNumber,s));a.push(h)}return $.waitFor(a).next(()=>o.apply(r)).next(()=>e.localDocuments.getLocalViewOfDocuments(r,l,c)).next(()=>l)}).then(r=>(e.Ms=i,r))}function qP(n,t,e){let s=Dt(),i=Dt();return e.forEach(r=>s=s.add(r)),t.getEntries(n,s).next(r=>{let o=vs();return e.forEach((a,l)=>{const c=r.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(bt.min())?(t.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(t.addEntry(l),o=o.insert(a,l)):tt(sf,"Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{ks:o,qs:i}})}function GP(n,t){const e=wt(n);return e.persistence.runTransaction("Get next mutation batch","readonly",s=>(t===void 0&&(t=Hd),e.mutationQueue.getNextMutationBatchAfterBatchId(s,t)))}function KP(n,t){const e=wt(n);return e.persistence.runTransaction("Allocate target","readwrite",s=>{let i;return e.Pi.getTargetData(s,t).next(r=>r?(i=r,$.resolve(i)):e.Pi.allocateTargetId(s).next(o=>(i=new Us(t,o,"TargetPurposeListen",s.currentSequenceNumber),e.Pi.addTargetData(s,i).next(()=>i))))}).then(s=>{const i=e.Ms.get(s.targetId);return(i===null||s.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(e.Ms=e.Ms.insert(s.targetId,s),e.xs.set(t,s.targetId)),s})}async function Hh(n,t,e){const s=wt(n),i=s.Ms.get(t),r=e?"readwrite":"readwrite-primary";try{e||await s.persistence.runTransaction("Release target",r,o=>s.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!Fr(o))throw o;tt(sf,`Failed to update sequence numbers for target ${t}: ${o}`)}s.Ms=s.Ms.remove(t),s.xs.delete(i.target)}function Om(n,t,e){const s=wt(n);let i=bt.min(),r=Dt();return s.persistence.runTransaction("Execute query","readwrite",o=>function(l,c,h){const d=wt(l),f=d.xs.get(h);return f!==void 0?$.resolve(d.Ms.get(f)):d.Pi.getTargetData(c,h)}(s,o,Fn(t)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,s.Pi.getMatchingKeysForTargetId(o,a.targetId).next(l=>{r=l})}).next(()=>s.Fs.getDocumentsMatchingQuery(o,t,e?i:bt.min(),e?r:Dt())).next(a=>(YP(s,O1(t),a),{documents:a,Qs:r})))}function YP(n,t,e){let s=n.Os.get(t)||bt.min();e.forEach((i,r)=>{r.readTime.compareTo(s)>0&&(s=r.readTime)}),n.Os.set(t,s)}class Lm{constructor(){this.activeTargetIds=U1()}zs(t){this.activeTargetIds=this.activeTargetIds.add(t)}js(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Gs(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class XP{constructor(){this.Mo=new Lm,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,s){}addLocalQueryTarget(t,e=!0){return e&&this.Mo.zs(t),this.xo[t]||"not-current"}updateQueryState(t,e,s){this.xo[t]=e}removeLocalQueryTarget(t){this.Mo.js(t)}isLocalQueryTarget(t){return this.Mo.activeTargetIds.has(t)}clearQueryState(t){delete this.xo[t]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(t){return this.Mo.activeTargetIds.has(t)}start(){return this.Mo=new Lm,Promise.resolve()}handleUserChange(t,e,s){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QP{Oo(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vm="ConnectivityMonitor";class Nm{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(t){this.qo.push(t)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){tt(Vm,"Network connectivity changed: AVAILABLE");for(const t of this.qo)t(0)}ko(){tt(Vm,"Network connectivity changed: UNAVAILABLE");for(const t of this.qo)t(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let il=null;function Wh(){return il===null?il=function(){return 268435456+Math.round(2147483648*Math.random())}():il++,"0x"+il.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gu="RestConnection",JP={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class ZP{get $o(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=e+"://"+t.host,this.Ko=`projects/${s}/databases/${i}`,this.Wo=this.databaseId.database===sc?`project_id=${s}`:`project_id=${s}&database_id=${i}`}Go(t,e,s,i,r){const o=Wh(),a=this.zo(t,e.toUriEncodedString());tt(Gu,`Sending RPC '${t}' ${o}:`,a,s);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,i,r);const{host:c}=new URL(a),h=Dr(c);return this.Jo(t,a,l,s,h).then(d=>(tt(Gu,`Received RPC '${t}' ${o}: `,d),d),d=>{throw xr(Gu,`RPC '${t}' ${o} failed with error: `,d,"url: ",a,"request:",s),d})}Ho(t,e,s,i,r,o){return this.Go(t,e,s,i,r)}jo(t,e,s){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Vr}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach((i,r)=>t[r]=i),s&&s.headers.forEach((i,r)=>t[r]=i)}zo(t,e){const s=JP[t];return`${this.Uo}/v1/${e}:${s}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tR{constructor(t){this.Yo=t.Yo,this.Zo=t.Zo}Xo(t){this.e_=t}t_(t){this.n_=t}r_(t){this.i_=t}onMessage(t){this.s_=t}close(){this.Zo()}send(t){this.Yo(t)}o_(){this.e_()}__(){this.n_()}a_(t){this.i_(t)}u_(t){this.s_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const De="WebChannelConnection";class eR extends ZP{constructor(t){super(t),this.c_=[],this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Jo(t,e,s,i,r){const o=Wh();return new Promise((a,l)=>{const c=new xv;c.setWithCredentials(!0),c.listenOnce(Tv.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Sl.NO_ERROR:const d=c.getResponseJson();tt(De,`XHR for RPC '${t}' ${o} received:`,JSON.stringify(d)),a(d);break;case Sl.TIMEOUT:tt(De,`RPC '${t}' ${o} timed out`),l(new J(U.DEADLINE_EXCEEDED,"Request time out"));break;case Sl.HTTP_ERROR:const f=c.getStatus();if(tt(De,`RPC '${t}' ${o} failed with status:`,f,"response text:",c.getResponseText()),f>0){let g=c.getResponseJson();Array.isArray(g)&&(g=g[0]);const _=g?.error;if(_&&_.status&&_.message){const y=function(E){const S=E.toLowerCase().replace(/_/g,"-");return Object.values(U).indexOf(S)>=0?S:U.UNKNOWN}(_.status);l(new J(y,_.message))}else l(new J(U.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new J(U.UNAVAILABLE,"Connection failed."));break;default:ft(9055,{l_:t,streamId:o,h_:c.getLastErrorCode(),P_:c.getLastError()})}}finally{tt(De,`RPC '${t}' ${o} completed.`)}});const h=JSON.stringify(i);tt(De,`RPC '${t}' ${o} sending request:`,i),c.send(e,"POST",h,s,15)})}T_(t,e,s){const i=Wh(),r=[this.Uo,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=Av(),a=Iv(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,e,s),l.encodeInitMessageHeaders=!0;const h=r.join("");tt(De,`Creating RPC '${t}' stream ${i}: ${h}`,l);const d=o.createWebChannel(h,l);this.I_(d);let f=!1,g=!1;const _=new tR({Yo:w=>{g?tt(De,`Not sending because RPC '${t}' stream ${i} is closed:`,w):(f||(tt(De,`Opening RPC '${t}' stream ${i} transport.`),d.open(),f=!0),tt(De,`RPC '${t}' stream ${i} sending:`,w),d.send(w))},Zo:()=>d.close()}),y=(w,E,S)=>{w.listen(E,A=>{try{S(A)}catch(k){setTimeout(()=>{throw k},0)}})};return y(d,po.EventType.OPEN,()=>{g||(tt(De,`RPC '${t}' stream ${i} transport opened.`),_.o_())}),y(d,po.EventType.CLOSE,()=>{g||(g=!0,tt(De,`RPC '${t}' stream ${i} transport closed`),_.a_(),this.E_(d))}),y(d,po.EventType.ERROR,w=>{g||(g=!0,xr(De,`RPC '${t}' stream ${i} transport errored. Name:`,w.name,"Message:",w.message),_.a_(new J(U.UNAVAILABLE,"The operation could not be completed")))}),y(d,po.EventType.MESSAGE,w=>{if(!g){const E=w.data[0];zt(!!E,16349);const S=E,A=S?.error||S[0]?.error;if(A){tt(De,`RPC '${t}' stream ${i} received error:`,A);const k=A.status;let R=function(b){const T=he[b];if(T!==void 0)return o0(T)}(k),L=A.message;R===void 0&&(R=U.INTERNAL,L="Unknown error status: "+k+" with message "+A.message),g=!0,_.a_(new J(R,L)),d.close()}else tt(De,`RPC '${t}' stream ${i} received:`,E),_.u_(E)}}),y(a,Ev.STAT_EVENT,w=>{w.stat===Dh.PROXY?tt(De,`RPC '${t}' stream ${i} detected buffering proxy`):w.stat===Dh.NOPROXY&&tt(De,`RPC '${t}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{_.__()},0),_}terminate(){this.c_.forEach(t=>t.close()),this.c_=[]}I_(t){this.c_.push(t)}E_(t){this.c_=this.c_.filter(e=>e===t)}}function Ku(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yc(n){return new rP(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v0{constructor(t,e,s=1e3,i=1.5,r=6e4){this.Mi=t,this.timerId=e,this.d_=s,this.A_=i,this.R_=r,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(t){this.cancel();const e=Math.floor(this.V_+this.y_()),s=Math.max(0,Date.now()-this.f_),i=Math.max(0,e-s);i>0&&tt("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${e} ms, last attempt: ${s} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),t())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fm="PersistentStream";class w0{constructor(t,e,s,i,r,o,a,l){this.Mi=t,this.S_=s,this.b_=i,this.connection=r,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new v0(t,e)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(t){this.Q_(),this.stream.send(t)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(t,e){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,t!==4?this.M_.reset():e&&e.code===U.RESOURCE_EXHAUSTED?(bs(e.toString()),bs("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):e&&e.code===U.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.r_(e)}K_(){}auth(){this.state=1;const t=this.W_(this.D_),e=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([s,i])=>{this.D_===e&&this.G_(s,i)},s=>{t(()=>{const i=new J(U.UNKNOWN,"Fetching auth token failed: "+s.message);return this.z_(i)})})}G_(t,e){const s=this.W_(this.D_);this.stream=this.j_(t,e),this.stream.Xo(()=>{s(()=>this.listener.Xo())}),this.stream.t_(()=>{s(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{s(()=>this.z_(i))}),this.stream.onMessage(i=>{s(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(t){return tt(Fm,`close with error: ${t}`),this.stream=null,this.close(4,t)}W_(t){return e=>{this.Mi.enqueueAndForget(()=>this.D_===t?e():(tt(Fm,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class nR extends w0{constructor(t,e,s,i,r,o){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,s,i,o),this.serializer=r}j_(t,e){return this.connection.T_("Listen",t,e)}J_(t){return this.onNext(t)}onNext(t){this.M_.reset();const e=lP(this.serializer,t),s=function(r){if(!("targetChange"in r))return bt.min();const o=r.targetChange;return o.targetIds&&o.targetIds.length?bt.min():o.readTime?Bn(o.readTime):bt.min()}(t);return this.listener.H_(e,s)}Y_(t){const e={};e.database=jh(this.serializer),e.addTarget=function(r,o){let a;const l=o.target;if(a=Nh(l)?{documents:hP(r,l)}:{query:dP(r,l).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=c0(r,o.resumeToken);const c=Uh(r,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(bt.min())>0){a.readTime=lc(r,o.snapshotVersion.toTimestamp());const c=Uh(r,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,t);const s=pP(this.serializer,t);s&&(e.labels=s),this.q_(e)}Z_(t){const e={};e.database=jh(this.serializer),e.removeTarget=t,this.q_(e)}}class sR extends w0{constructor(t,e,s,i,r,o){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,s,i,o),this.serializer=r}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(t,e){return this.connection.T_("Write",t,e)}J_(t){return zt(!!t.streamToken,31322),this.lastStreamToken=t.streamToken,zt(!t.writeResults||t.writeResults.length===0,55816),this.listener.ta()}onNext(t){zt(!!t.streamToken,12678),this.lastStreamToken=t.streamToken,this.M_.reset();const e=uP(t.writeResults,t.commitTime),s=Bn(t.commitTime);return this.listener.na(s,e)}ra(){const t={};t.database=jh(this.serializer),this.q_(t)}ea(t){const e={streamToken:this.lastStreamToken,writes:t.map(s=>cP(this.serializer,s))};this.q_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iR{}class rR extends iR{constructor(t,e,s,i){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=s,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new J(U.FAILED_PRECONDITION,"The client has already been terminated.")}Go(t,e,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,o])=>this.connection.Go(t,$h(e,s),i,r,o)).catch(r=>{throw r.name==="FirebaseError"?(r.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new J(U.UNKNOWN,r.toString())})}Ho(t,e,s,i,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Ho(t,$h(e,s),i,o,a,r)).catch(o=>{throw o.name==="FirebaseError"?(o.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new J(U.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class oR{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(t){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.ca("Offline")))}set(t){this.Pa(),this.oa=0,t==="Online"&&(this.aa=!1),this.ca(t)}ca(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}la(t){const e=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(bs(e),this.aa=!1):tt("OnlineStateTracker",e)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $i="RemoteStore";class aR{constructor(t,e,s,i,r){this.localStore=t,this.datastore=e,this.asyncQueue=s,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=r,this.Aa.Oo(o=>{s.enqueueAndForget(async()=>{Gi(this)&&(tt($i,"Restarting streams for network reachability change."),await async function(l){const c=wt(l);c.Ea.add(4),await Ea(c),c.Ra.set("Unknown"),c.Ea.delete(4),await Xc(c)}(this))})}),this.Ra=new oR(s,i)}}async function Xc(n){if(Gi(n))for(const t of n.da)await t(!0)}async function Ea(n){for(const t of n.da)await t(!1)}function x0(n,t){const e=wt(n);e.Ia.has(t.targetId)||(e.Ia.set(t.targetId,t),lf(e)?af(e):Ur(e).O_()&&of(e,t))}function rf(n,t){const e=wt(n),s=Ur(e);e.Ia.delete(t),s.O_()&&T0(e,t),e.Ia.size===0&&(s.O_()?s.L_():Gi(e)&&e.Ra.set("Unknown"))}function of(n,t){if(n.Va.Ue(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(bt.min())>0){const e=n.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(e)}Ur(n).Y_(t)}function T0(n,t){n.Va.Ue(t),Ur(n).Z_(t)}function af(n){n.Va=new eP({getRemoteKeysForTarget:t=>n.remoteSyncer.getRemoteKeysForTarget(t),At:t=>n.Ia.get(t)||null,ht:()=>n.datastore.serializer.databaseId}),Ur(n).start(),n.Ra.ua()}function lf(n){return Gi(n)&&!Ur(n).x_()&&n.Ia.size>0}function Gi(n){return wt(n).Ea.size===0}function E0(n){n.Va=void 0}async function lR(n){n.Ra.set("Online")}async function cR(n){n.Ia.forEach((t,e)=>{of(n,t)})}async function uR(n,t){E0(n),lf(n)?(n.Ra.ha(t),af(n)):n.Ra.set("Unknown")}async function hR(n,t,e){if(n.Ra.set("Online"),t instanceof l0&&t.state===2&&t.cause)try{await async function(i,r){const o=r.cause;for(const a of r.targetIds)i.Ia.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.Ia.delete(a),i.Va.removeTarget(a))}(n,t)}catch(s){tt($i,"Failed to remove targets %s: %s ",t.targetIds.join(","),s),await uc(n,s)}else if(t instanceof kl?n.Va.Ze(t):t instanceof a0?n.Va.st(t):n.Va.tt(t),!e.isEqual(bt.min()))try{const s=await b0(n.localStore);e.compareTo(s)>=0&&await function(r,o){const a=r.Va.Tt(o);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const h=r.Ia.get(c);h&&r.Ia.set(c,h.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,c)=>{const h=r.Ia.get(l);if(!h)return;r.Ia.set(l,h.withResumeToken(Ce.EMPTY_BYTE_STRING,h.snapshotVersion)),T0(r,l);const d=new Us(h.target,l,c,h.sequenceNumber);of(r,d)}),r.remoteSyncer.applyRemoteEvent(a)}(n,e)}catch(s){tt($i,"Failed to raise snapshot:",s),await uc(n,s)}}async function uc(n,t,e){if(!Fr(t))throw t;n.Ea.add(1),await Ea(n),n.Ra.set("Offline"),e||(e=()=>b0(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{tt($i,"Retrying IndexedDB access"),await e(),n.Ea.delete(1),await Xc(n)})}function I0(n,t){return t().catch(e=>uc(n,e,t))}async function Qc(n){const t=wt(n),e=ri(t);let s=t.Ta.length>0?t.Ta[t.Ta.length-1].batchId:Hd;for(;dR(t);)try{const i=await GP(t.localStore,s);if(i===null){t.Ta.length===0&&e.L_();break}s=i.batchId,fR(t,i)}catch(i){await uc(t,i)}A0(t)&&S0(t)}function dR(n){return Gi(n)&&n.Ta.length<10}function fR(n,t){n.Ta.push(t);const e=ri(n);e.O_()&&e.X_&&e.ea(t.mutations)}function A0(n){return Gi(n)&&!ri(n).x_()&&n.Ta.length>0}function S0(n){ri(n).start()}async function pR(n){ri(n).ra()}async function gR(n){const t=ri(n);for(const e of n.Ta)t.ea(e.mutations)}async function mR(n,t,e){const s=n.Ta.shift(),i=Qd.from(s,t,e);await I0(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),await Qc(n)}async function _R(n,t){t&&ri(n).X_&&await async function(s,i){if(function(o){return J1(o)&&o!==U.ABORTED}(i.code)){const r=s.Ta.shift();ri(s).B_(),await I0(s,()=>s.remoteSyncer.rejectFailedWrite(r.batchId,i)),await Qc(s)}}(n,t),A0(n)&&S0(n)}async function Bm(n,t){const e=wt(n);e.asyncQueue.verifyOperationInProgress(),tt($i,"RemoteStore received new credentials");const s=Gi(e);e.Ea.add(3),await Ea(e),s&&e.Ra.set("Unknown"),await e.remoteSyncer.handleCredentialChange(t),e.Ea.delete(3),await Xc(e)}async function yR(n,t){const e=wt(n);t?(e.Ea.delete(2),await Xc(e)):t||(e.Ea.add(2),await Ea(e),e.Ra.set("Unknown"))}function Ur(n){return n.ma||(n.ma=function(e,s,i){const r=wt(e);return r.sa(),new nR(s,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,i)}(n.datastore,n.asyncQueue,{Xo:lR.bind(null,n),t_:cR.bind(null,n),r_:uR.bind(null,n),H_:hR.bind(null,n)}),n.da.push(async t=>{t?(n.ma.B_(),lf(n)?af(n):n.Ra.set("Unknown")):(await n.ma.stop(),E0(n))})),n.ma}function ri(n){return n.fa||(n.fa=function(e,s,i){const r=wt(e);return r.sa(),new sR(s,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,i)}(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:pR.bind(null,n),r_:_R.bind(null,n),ta:gR.bind(null,n),na:mR.bind(null,n)}),n.da.push(async t=>{t?(n.fa.B_(),await Qc(n)):(await n.fa.stop(),n.Ta.length>0&&(tt($i,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))})),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cf{constructor(t,e,s,i,r){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=s,this.op=i,this.removalCallback=r,this.deferred=new fs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,e,s,i,r){const o=Date.now()+s,a=new cf(t,e,o,i,r);return a.start(s),a}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new J(U.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function uf(n,t){if(bs("AsyncQueue",`${t}: ${n}`),Fr(n))return new J(U.UNAVAILABLE,`${t}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yr{static emptySet(t){return new yr(t.comparator)}constructor(t){this.comparator=t?(e,s)=>t(e,s)||ut.comparator(e.key,s.key):(e,s)=>ut.comparator(e.key,s.key),this.keyedMap=go(),this.sortedSet=new ie(this.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((e,s)=>(t(e),!1))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof yr)||this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),s=t.sortedSet.getIterator();for(;e.hasNext();){const i=e.getNext().key,r=s.getNext().key;if(!i.isEqual(r))return!1}return!0}toString(){const t=[];return this.forEach(e=>{t.push(e.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,e){const s=new yr;return s.comparator=this.comparator,s.keyedMap=t,s.sortedSet=e,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Um{constructor(){this.ga=new ie(ut.comparator)}track(t){const e=t.doc.key,s=this.ga.get(e);s?t.type!==0&&s.type===3?this.ga=this.ga.insert(e,t):t.type===3&&s.type!==1?this.ga=this.ga.insert(e,{type:s.type,doc:t.doc}):t.type===2&&s.type===2?this.ga=this.ga.insert(e,{type:2,doc:t.doc}):t.type===2&&s.type===0?this.ga=this.ga.insert(e,{type:0,doc:t.doc}):t.type===1&&s.type===0?this.ga=this.ga.remove(e):t.type===1&&s.type===2?this.ga=this.ga.insert(e,{type:1,doc:s.doc}):t.type===0&&s.type===1?this.ga=this.ga.insert(e,{type:2,doc:t.doc}):ft(63341,{Rt:t,pa:s}):this.ga=this.ga.insert(e,t)}ya(){const t=[];return this.ga.inorderTraversal((e,s)=>{t.push(s)}),t}}class Sr{constructor(t,e,s,i,r,o,a,l,c){this.query=t,this.docs=e,this.oldDocs=s,this.docChanges=i,this.mutatedKeys=r,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(t,e,s,i,r){const o=[];return e.forEach(a=>{o.push({type:0,doc:a})}),new Sr(t,e,yr.emptySet(e),o,s,i,!0,!1,r)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Hc(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,s=t.docChanges;if(e.length!==s.length)return!1;for(let i=0;i<e.length;i++)if(e[i].type!==s[i].type||!e[i].doc.isEqual(s[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bR{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(t=>t.Da())}}class vR{constructor(){this.queries=$m(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(e,s){const i=wt(e),r=i.queries;i.queries=$m(),r.forEach((o,a)=>{for(const l of a.Sa)l.onError(s)})})(this,new J(U.ABORTED,"Firestore shutting down"))}}function $m(){return new qi(n=>Gv(n),Hc)}async function hf(n,t){const e=wt(n);let s=3;const i=t.query;let r=e.queries.get(i);r?!r.ba()&&t.Da()&&(s=2):(r=new bR,s=t.Da()?0:1);try{switch(s){case 0:r.wa=await e.onListen(i,!0);break;case 1:r.wa=await e.onListen(i,!1);break;case 2:await e.onFirstRemoteStoreListen(i)}}catch(o){const a=uf(o,`Initialization of query '${or(t.query)}' failed`);return void t.onError(a)}e.queries.set(i,r),r.Sa.push(t),t.va(e.onlineState),r.wa&&t.Fa(r.wa)&&ff(e)}async function df(n,t){const e=wt(n),s=t.query;let i=3;const r=e.queries.get(s);if(r){const o=r.Sa.indexOf(t);o>=0&&(r.Sa.splice(o,1),r.Sa.length===0?i=t.Da()?0:1:!r.ba()&&t.Da()&&(i=2))}switch(i){case 0:return e.queries.delete(s),e.onUnlisten(s,!0);case 1:return e.queries.delete(s),e.onUnlisten(s,!1);case 2:return e.onLastRemoteStoreUnlisten(s);default:return}}function wR(n,t){const e=wt(n);let s=!1;for(const i of t){const r=i.query,o=e.queries.get(r);if(o){for(const a of o.Sa)a.Fa(i)&&(s=!0);o.wa=i}}s&&ff(e)}function xR(n,t,e){const s=wt(n),i=s.queries.get(t);if(i)for(const r of i.Sa)r.onError(e);s.queries.delete(t)}function ff(n){n.Ca.forEach(t=>{t.next()})}var qh,zm;(zm=qh||(qh={})).Ma="default",zm.Cache="cache";class pf{constructor(t,e,s){this.query=t,this.xa=e,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=s||{}}Fa(t){if(!this.options.includeMetadataChanges){const s=[];for(const i of t.docChanges)i.type!==3&&s.push(i);t=new Sr(t.query,t.docs,t.oldDocs,s,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.Oa?this.Ba(t)&&(this.xa.next(t),e=!0):this.La(t,this.onlineState)&&(this.ka(t),e=!0),this.Na=t,e}onError(t){this.xa.error(t)}va(t){this.onlineState=t;let e=!1;return this.Na&&!this.Oa&&this.La(this.Na,t)&&(this.ka(this.Na),e=!0),e}La(t,e){if(!t.fromCache||!this.Da())return!0;const s=e!=="Offline";return(!this.options.qa||!s)&&(!t.docs.isEmpty()||t.hasCachedResults||e==="Offline")}Ba(t){if(t.docChanges.length>0)return!0;const e=this.Na&&this.Na.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&this.options.includeMetadataChanges===!0}ka(t){t=Sr.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.Oa=!0,this.xa.next(t)}Da(){return this.options.source!==qh.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C0{constructor(t){this.key=t}}class P0{constructor(t){this.key=t}}class TR{constructor(t,e){this.query=t,this.Ya=e,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Dt(),this.mutatedKeys=Dt(),this.eu=Kv(t),this.tu=new yr(this.eu)}get nu(){return this.Ya}ru(t,e){const s=e?e.iu:new Um,i=e?e.tu:this.tu;let r=e?e.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((h,d)=>{const f=i.get(h),g=Wc(this.query,d)?d:null,_=!!f&&this.mutatedKeys.has(f.key),y=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let w=!1;f&&g?f.data.isEqual(g.data)?_!==y&&(s.track({type:3,doc:g}),w=!0):this.su(f,g)||(s.track({type:2,doc:g}),w=!0,(l&&this.eu(g,l)>0||c&&this.eu(g,c)<0)&&(a=!0)):!f&&g?(s.track({type:0,doc:g}),w=!0):f&&!g&&(s.track({type:1,doc:f}),w=!0,(l||c)&&(a=!0)),w&&(g?(o=o.add(g),r=y?r.add(h):r.delete(h)):(o=o.delete(h),r=r.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),r=r.delete(h.key),s.track({type:1,doc:h})}return{tu:o,iu:s,Cs:a,mutatedKeys:r}}su(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,s,i){const r=this.tu;this.tu=t.tu,this.mutatedKeys=t.mutatedKeys;const o=t.iu.ya();o.sort((h,d)=>function(g,_){const y=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ft(20277,{Rt:w})}};return y(g)-y(_)}(h.type,d.type)||this.eu(h.doc,d.doc)),this.ou(s),i=i??!1;const a=e&&!i?this._u():[],l=this.Xa.size===0&&this.current&&!i?1:0,c=l!==this.Za;return this.Za=l,o.length!==0||c?{snapshot:new Sr(this.query,t.tu,r,o,t.mutatedKeys,l===0,c,!1,!!s&&s.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Um,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(t){return!this.Ya.has(t)&&!!this.tu.has(t)&&!this.tu.get(t).hasLocalMutations}ou(t){t&&(t.addedDocuments.forEach(e=>this.Ya=this.Ya.add(e)),t.modifiedDocuments.forEach(e=>{}),t.removedDocuments.forEach(e=>this.Ya=this.Ya.delete(e)),this.current=t.current)}_u(){if(!this.current)return[];const t=this.Xa;this.Xa=Dt(),this.tu.forEach(s=>{this.uu(s.key)&&(this.Xa=this.Xa.add(s.key))});const e=[];return t.forEach(s=>{this.Xa.has(s)||e.push(new P0(s))}),this.Xa.forEach(s=>{t.has(s)||e.push(new C0(s))}),e}cu(t){this.Ya=t.Qs,this.Xa=Dt();const e=this.ru(t.documents);return this.applyChanges(e,!0)}lu(){return Sr.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const gf="SyncEngine";class ER{constructor(t,e,s){this.query=t,this.targetId=e,this.view=s}}class IR{constructor(t){this.key=t,this.hu=!1}}class AR{constructor(t,e,s,i,r,o){this.localStore=t,this.remoteStore=e,this.eventManager=s,this.sharedClientState=i,this.currentUser=r,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new qi(a=>Gv(a),Hc),this.Iu=new Map,this.Eu=new Set,this.du=new ie(ut.comparator),this.Au=new Map,this.Ru=new tf,this.Vu={},this.mu=new Map,this.fu=Ar.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function SR(n,t,e=!0){const s=L0(n);let i;const r=s.Tu.get(t);return r?(s.sharedClientState.addLocalQueryTarget(r.targetId),i=r.view.lu()):i=await R0(s,t,e,!0),i}async function CR(n,t){const e=L0(n);await R0(e,t,!0,!1)}async function R0(n,t,e,s){const i=await KP(n.localStore,Fn(t)),r=i.targetId,o=n.sharedClientState.addLocalQueryTarget(r,e);let a;return s&&(a=await PR(n,t,r,o==="current",i.resumeToken)),n.isPrimaryClient&&e&&x0(n.remoteStore,i),a}async function PR(n,t,e,s,i){n.pu=(d,f,g)=>async function(y,w,E,S){let A=w.view.ru(E);A.Cs&&(A=await Om(y.localStore,w.query,!1).then(({documents:x})=>w.view.ru(x,A)));const k=S&&S.targetChanges.get(w.targetId),R=S&&S.targetMismatches.get(w.targetId)!=null,L=w.view.applyChanges(A,y.isPrimaryClient,k,R);return Hm(y,w.targetId,L.au),L.snapshot}(n,d,f,g);const r=await Om(n.localStore,t,!0),o=new TR(t,r.Qs),a=o.ru(r.documents),l=Ta.createSynthesizedTargetChangeForCurrentChange(e,s&&n.onlineState!=="Offline",i),c=o.applyChanges(a,n.isPrimaryClient,l);Hm(n,e,c.au);const h=new ER(t,e,o);return n.Tu.set(t,h),n.Iu.has(e)?n.Iu.get(e).push(t):n.Iu.set(e,[t]),c.snapshot}async function RR(n,t,e){const s=wt(n),i=s.Tu.get(t),r=s.Iu.get(i.targetId);if(r.length>1)return s.Iu.set(i.targetId,r.filter(o=>!Hc(o,t))),void s.Tu.delete(t);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(i.targetId),s.sharedClientState.isActiveQueryTarget(i.targetId)||await Hh(s.localStore,i.targetId,!1).then(()=>{s.sharedClientState.clearQueryState(i.targetId),e&&rf(s.remoteStore,i.targetId),Gh(s,i.targetId)}).catch(Nr)):(Gh(s,i.targetId),await Hh(s.localStore,i.targetId,!0))}async function kR(n,t){const e=wt(n),s=e.Tu.get(t),i=e.Iu.get(s.targetId);e.isPrimaryClient&&i.length===1&&(e.sharedClientState.removeLocalQueryTarget(s.targetId),rf(e.remoteStore,s.targetId))}async function DR(n,t,e){const s=BR(n);try{const i=await function(o,a){const l=wt(o),c=Kt.now(),h=a.reduce((g,_)=>g.add(_.key),Dt());let d,f;return l.persistence.runTransaction("Locally write mutations","readwrite",g=>{let _=vs(),y=Dt();return l.Ns.getEntries(g,h).next(w=>{_=w,_.forEach((E,S)=>{S.isValidDocument()||(y=y.add(E))})}).next(()=>l.localDocuments.getOverlayedDocuments(g,_)).next(w=>{d=w;const E=[];for(const S of a){const A=G1(S,d.get(S.key).overlayedDocument);A!=null&&E.push(new ui(S.key,A,Bv(A.value.mapValue),mn.exists(!0)))}return l.mutationQueue.addMutationBatch(g,c,E,a)}).next(w=>{f=w;const E=w.applyToLocalDocumentSet(d,y);return l.documentOverlayCache.saveOverlays(g,w.batchId,E)})}).then(()=>({batchId:f.batchId,changes:Xv(d)}))}(s.localStore,t);s.sharedClientState.addPendingMutation(i.batchId),function(o,a,l){let c=o.Vu[o.currentUser.toKey()];c||(c=new ie(kt)),c=c.insert(a,l),o.Vu[o.currentUser.toKey()]=c}(s,i.batchId,e),await Ia(s,i.changes),await Qc(s.remoteStore)}catch(i){const r=uf(i,"Failed to persist write");e.reject(r)}}async function k0(n,t){const e=wt(n);try{const s=await WP(e.localStore,t);t.targetChanges.forEach((i,r)=>{const o=e.Au.get(r);o&&(zt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.hu=!0:i.modifiedDocuments.size>0?zt(o.hu,14607):i.removedDocuments.size>0&&(zt(o.hu,42227),o.hu=!1))}),await Ia(e,s,t)}catch(s){await Nr(s)}}function jm(n,t,e){const s=wt(n);if(s.isPrimaryClient&&e===0||!s.isPrimaryClient&&e===1){const i=[];s.Tu.forEach((r,o)=>{const a=o.view.va(t);a.snapshot&&i.push(a.snapshot)}),function(o,a){const l=wt(o);l.onlineState=a;let c=!1;l.queries.forEach((h,d)=>{for(const f of d.Sa)f.va(a)&&(c=!0)}),c&&ff(l)}(s.eventManager,t),i.length&&s.Pu.H_(i),s.onlineState=t,s.isPrimaryClient&&s.sharedClientState.setOnlineState(t)}}async function MR(n,t,e){const s=wt(n);s.sharedClientState.updateQueryState(t,"rejected",e);const i=s.Au.get(t),r=i&&i.key;if(r){let o=new ie(ut.comparator);o=o.insert(r,Ne.newNoDocument(r,bt.min()));const a=Dt().add(r),l=new Kc(bt.min(),new Map,new ie(kt),o,a);await k0(s,l),s.du=s.du.remove(r),s.Au.delete(t),mf(s)}else await Hh(s.localStore,t,!1).then(()=>Gh(s,t,e)).catch(Nr)}async function OR(n,t){const e=wt(n),s=t.batch.batchId;try{const i=await HP(e.localStore,t);M0(e,s,null),D0(e,s),e.sharedClientState.updateMutationState(s,"acknowledged"),await Ia(e,i)}catch(i){await Nr(i)}}async function LR(n,t,e){const s=wt(n);try{const i=await function(o,a){const l=wt(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let h;return l.mutationQueue.lookupMutationBatch(c,a).next(d=>(zt(d!==null,37113),h=d.keys(),l.mutationQueue.removeMutationBatch(c,d))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,h,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,h)).next(()=>l.localDocuments.getDocuments(c,h))})}(s.localStore,t);M0(s,t,e),D0(s,t),s.sharedClientState.updateMutationState(t,"rejected",e),await Ia(s,i)}catch(i){await Nr(i)}}function D0(n,t){(n.mu.get(t)||[]).forEach(e=>{e.resolve()}),n.mu.delete(t)}function M0(n,t,e){const s=wt(n);let i=s.Vu[s.currentUser.toKey()];if(i){const r=i.get(t);r&&(e?r.reject(e):r.resolve(),i=i.remove(t)),s.Vu[s.currentUser.toKey()]=i}}function Gh(n,t,e=null){n.sharedClientState.removeLocalQueryTarget(t);for(const s of n.Iu.get(t))n.Tu.delete(s),e&&n.Pu.yu(s,e);n.Iu.delete(t),n.isPrimaryClient&&n.Ru.jr(t).forEach(s=>{n.Ru.containsKey(s)||O0(n,s)})}function O0(n,t){n.Eu.delete(t.path.canonicalString());const e=n.du.get(t);e!==null&&(rf(n.remoteStore,e),n.du=n.du.remove(t),n.Au.delete(e),mf(n))}function Hm(n,t,e){for(const s of e)s instanceof C0?(n.Ru.addReference(s.key,t),VR(n,s)):s instanceof P0?(tt(gf,"Document no longer in limbo: "+s.key),n.Ru.removeReference(s.key,t),n.Ru.containsKey(s.key)||O0(n,s.key)):ft(19791,{wu:s})}function VR(n,t){const e=t.key,s=e.path.canonicalString();n.du.get(e)||n.Eu.has(s)||(tt(gf,"New document in limbo: "+e),n.Eu.add(s),mf(n))}function mf(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const t=n.Eu.values().next().value;n.Eu.delete(t);const e=new ut(Gt.fromString(t)),s=n.fu.next();n.Au.set(s,new IR(e)),n.du=n.du.insert(e,s),x0(n.remoteStore,new Us(Fn(jc(e.path)),s,"TargetPurposeLimboResolution",Uc.ce))}}async function Ia(n,t,e){const s=wt(n),i=[],r=[],o=[];s.Tu.isEmpty()||(s.Tu.forEach((a,l)=>{o.push(s.pu(l,t,e).then(c=>{if((c||e)&&s.isPrimaryClient){const h=c?!c.fromCache:e?.targetChanges.get(l.targetId)?.current;s.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(c){i.push(c);const h=nf.As(l.targetId,c);r.push(h)}}))}),await Promise.all(o),s.Pu.H_(i),await async function(l,c){const h=wt(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>$.forEach(c,f=>$.forEach(f.Es,g=>h.persistence.referenceDelegate.addReference(d,f.targetId,g)).next(()=>$.forEach(f.ds,g=>h.persistence.referenceDelegate.removeReference(d,f.targetId,g)))))}catch(d){if(!Fr(d))throw d;tt(sf,"Failed to update sequence numbers: "+d)}for(const d of c){const f=d.targetId;if(!d.fromCache){const g=h.Ms.get(f),_=g.snapshotVersion,y=g.withLastLimboFreeSnapshotVersion(_);h.Ms=h.Ms.insert(f,y)}}}(s.localStore,r))}async function NR(n,t){const e=wt(n);if(!e.currentUser.isEqual(t)){tt(gf,"User change. New user:",t.toKey());const s=await y0(e.localStore,t);e.currentUser=t,function(r,o){r.mu.forEach(a=>{a.forEach(l=>{l.reject(new J(U.CANCELLED,o))})}),r.mu.clear()}(e,"'waitForPendingWrites' promise is rejected due to a user change."),e.sharedClientState.handleUserChange(t,s.removedBatchIds,s.addedBatchIds),await Ia(e,s.Ls)}}function FR(n,t){const e=wt(n),s=e.Au.get(t);if(s&&s.hu)return Dt().add(s.key);{let i=Dt();const r=e.Iu.get(t);if(!r)return i;for(const o of r){const a=e.Tu.get(o);i=i.unionWith(a.view.nu)}return i}}function L0(n){const t=wt(n);return t.remoteStore.remoteSyncer.applyRemoteEvent=k0.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=FR.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=MR.bind(null,t),t.Pu.H_=wR.bind(null,t.eventManager),t.Pu.yu=xR.bind(null,t.eventManager),t}function BR(n){const t=wt(n);return t.remoteStore.remoteSyncer.applySuccessfulWrite=OR.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=LR.bind(null,t),t}class hc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=Yc(t.databaseInfo.databaseId),this.sharedClientState=this.Du(t),this.persistence=this.Cu(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Fu(t,this.localStore),this.indexBackfillerScheduler=this.Mu(t,this.localStore)}Fu(t,e){return null}Mu(t,e){return null}vu(t){return jP(this.persistence,new UP,t.initialUser,this.serializer)}Cu(t){return new _0(ef.mi,this.serializer)}Du(t){return new XP}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}hc.provider={build:()=>new hc};class UR extends hc{constructor(t){super(),this.cacheSizeBytes=t}Fu(t,e){zt(this.persistence.referenceDelegate instanceof cc,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new IP(s,t.asyncQueue,e)}Cu(t){const e=this.cacheSizeBytes!==void 0?Qe.withCacheSize(this.cacheSizeBytes):Qe.DEFAULT;return new _0(s=>cc.mi(s,e),this.serializer)}}class Kh{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>jm(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=NR.bind(null,this.syncEngine),await yR(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return function(){return new vR}()}createDatastore(t){const e=Yc(t.databaseInfo.databaseId),s=function(r){return new eR(r)}(t.databaseInfo);return function(r,o,a,l){return new rR(r,o,a,l)}(t.authCredentials,t.appCheckCredentials,s,e)}createRemoteStore(t){return function(s,i,r,o,a){return new aR(s,i,r,o,a)}(this.localStore,this.datastore,t.asyncQueue,e=>jm(this.syncEngine,e,0),function(){return Nm.v()?new Nm:new QP}())}createSyncEngine(t,e){return function(i,r,o,a,l,c,h){const d=new AR(i,r,o,a,l,c);return h&&(d.gu=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}async terminate(){await async function(e){const s=wt(e);tt($i,"RemoteStore shutting down."),s.Ea.add(5),await Ea(s),s.Aa.shutdown(),s.Ra.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Kh.provider={build:()=>new Kh};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _f{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.Ou(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.Ou(this.observer.error,t):bs("Uncaught Error in snapshot listener:",t.toString()))}Nu(){this.muted=!0}Ou(t,e){setTimeout(()=>{this.muted||t(e)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oi="FirestoreClient";class $R{constructor(t,e,s,i,r){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=s,this.databaseInfo=i,this.user=Oe.UNAUTHENTICATED,this.clientId=zd.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=r,this.authCredentials.start(s,async o=>{tt(oi,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(s,o=>(tt(oi,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new fs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const s=uf(e,"Failed to shutdown persistence");t.reject(s)}}),t.promise}}async function Yu(n,t){n.asyncQueue.verifyOperationInProgress(),tt(oi,"Initializing OfflineComponentProvider");const e=n.configuration;await t.initialize(e);let s=e.initialUser;n.setCredentialChangeListener(async i=>{s.isEqual(i)||(await y0(t.localStore,i),s=i)}),t.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=t}async function Wm(n,t){n.asyncQueue.verifyOperationInProgress();const e=await zR(n);tt(oi,"Initializing OnlineComponentProvider"),await t.initialize(e,n.configuration),n.setCredentialChangeListener(s=>Bm(t.remoteStore,s)),n.setAppCheckTokenChangeListener((s,i)=>Bm(t.remoteStore,i)),n._onlineComponents=t}async function zR(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){tt(oi,"Using user provided OfflineComponentProvider");try{await Yu(n,n._uninitializedComponentsProvider._offline)}catch(t){const e=t;if(!function(i){return i.name==="FirebaseError"?i.code===U.FAILED_PRECONDITION||i.code===U.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(e))throw e;xr("Error using user provided cache. Falling back to memory cache: "+e),await Yu(n,new hc)}}else tt(oi,"Using default OfflineComponentProvider"),await Yu(n,new UR(void 0));return n._offlineComponents}async function V0(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(tt(oi,"Using user provided OnlineComponentProvider"),await Wm(n,n._uninitializedComponentsProvider._online)):(tt(oi,"Using default OnlineComponentProvider"),await Wm(n,new Kh))),n._onlineComponents}function jR(n){return V0(n).then(t=>t.syncEngine)}async function dc(n){const t=await V0(n),e=t.eventManager;return e.onListen=SR.bind(null,t.syncEngine),e.onUnlisten=RR.bind(null,t.syncEngine),e.onFirstRemoteStoreListen=CR.bind(null,t.syncEngine),e.onLastRemoteStoreUnlisten=kR.bind(null,t.syncEngine),e}function HR(n,t,e={}){const s=new fs;return n.asyncQueue.enqueueAndForget(async()=>function(r,o,a,l,c){const h=new _f({next:f=>{h.Nu(),o.enqueueAndForget(()=>df(r,d));const g=f.docs.has(a);!g&&f.fromCache?c.reject(new J(U.UNAVAILABLE,"Failed to get document because the client is offline.")):g&&f.fromCache&&l&&l.source==="server"?c.reject(new J(U.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(f)},error:f=>c.reject(f)}),d=new pf(jc(a.path),h,{includeMetadataChanges:!0,qa:!0});return hf(r,d)}(await dc(n),n.asyncQueue,t,e,s)),s.promise}function WR(n,t,e={}){const s=new fs;return n.asyncQueue.enqueueAndForget(async()=>function(r,o,a,l,c){const h=new _f({next:f=>{h.Nu(),o.enqueueAndForget(()=>df(r,d)),f.fromCache&&l.source==="server"?c.reject(new J(U.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(f)},error:f=>c.reject(f)}),d=new pf(a,h,{includeMetadataChanges:!0,qa:!0});return hf(r,d)}(await dc(n),n.asyncQueue,t,e,s)),s.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N0(n){const t={};return n.timeoutSeconds!==void 0&&(t.timeoutSeconds=n.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qm=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F0="firestore.googleapis.com",Gm=!0;class Km{constructor(t){if(t.host===void 0){if(t.ssl!==void 0)throw new J(U.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=F0,this.ssl=Gm}else this.host=t.host,this.ssl=t.ssl??Gm;if(this.isUsingEmulator=t.emulatorOptions!==void 0,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=m0;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<TP)throw new J(U.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}a1("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=N0(t.experimentalLongPollingOptions??{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new J(U.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new J(U.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new J(U.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(s,i){return s.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Aa{constructor(t,e,s,i){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=s,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Km({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new J(U.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new J(U.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Km(t),this._emulatorOptions=t.emulatorOptions||{},t.credentials!==void 0&&(this._authCredentials=function(s){if(!s)return new QC;switch(s.type){case"firstParty":return new e1(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new J(U.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const s=qm.get(e);s&&(tt("ComponentProvider","Removing Datastore"),qm.delete(e),s.terminate())}(this),Promise.resolve()}}function qR(n,t,e,s={}){n=Ge(n,Aa);const i=Dr(t),r=n._getSettings(),o={...r,emulatorOptions:n._getEmulatorOptions()},a=`${t}:${e}`;i&&(Vb(`https://${a}`),Nb("Firestore",!0)),r.host!==F0&&r.host!==a&&xr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...r,host:a,ssl:i,emulatorOptions:s};if(!Ni(l,o)&&(n._setSettings(l),s.mockUserToken)){let c,h;if(typeof s.mockUserToken=="string")c=s.mockUserToken,h=Oe.MOCK_USER;else{c=TI(s.mockUserToken,n._app?.options.projectId);const d=s.mockUserToken.sub||s.mockUserToken.user_id;if(!d)throw new J(U.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new Oe(d)}n._authCredentials=new JC(new Cv(c,h))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hi{constructor(t,e,s){this.converter=e,this._query=s,this.type="query",this.firestore=t}withConverter(t){return new hi(this.firestore,t,this._query)}}class oe{constructor(t,e,s){this.converter=e,this._key=s,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Xs(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new oe(this.firestore,t,this._key)}toJSON(){return{type:oe._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(t,e,s){if(wa(e,oe._jsonSchema))return new oe(t,s||null,new ut(Gt.fromString(e.referencePath)))}}oe._jsonSchemaVersion="firestore/documentReference/1.0",oe._jsonSchema={type:fe("string",oe._jsonSchemaVersion),referencePath:fe("string")};class Xs extends hi{constructor(t,e,s){super(t,e,jc(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new oe(this.firestore,null,new ut(t))}withConverter(t){return new Xs(this.firestore,t,this._path)}}function B0(n,t,...e){if(n=Se(n),jd("collection","path",t),n instanceof Aa){const s=Gt.fromString(t,...e);return am(s),new Xs(n,null,s)}{if(!(n instanceof oe||n instanceof Xs))throw new J(U.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(Gt.fromString(t,...e));return am(s),new Xs(n.firestore,null,s)}}function GR(n,t){if(n=Ge(n,Aa),jd("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new J(U.INVALID_ARGUMENT,`Invalid collection ID '${t}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new hi(n,null,function(s){return new Br(Gt.emptyPath(),s)}(t))}function pn(n,t,...e){if(n=Se(n),arguments.length===1&&(t=zd.newId()),jd("doc","path",t),n instanceof Aa){const s=Gt.fromString(t,...e);return om(s),new oe(n,null,new ut(s))}{if(!(n instanceof oe||n instanceof Xs))throw new J(U.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(Gt.fromString(t,...e));return om(s),new oe(n.firestore,n instanceof Xs?n.converter:null,new ut(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ym="AsyncQueue";class Xm{constructor(t=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new v0(this,"async_queue_retry"),this._c=()=>{const s=Ku();s&&tt(Ym,"Visibility state changed to "+s.visibilityState),this.M_.w_()},this.ac=t;const e=Ku();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.uc(),this.cc(t)}enterRestrictedMode(t){if(!this.ec){this.ec=!0,this.sc=t||!1;const e=Ku();e&&typeof e.removeEventListener=="function"&&e.removeEventListener("visibilitychange",this._c)}}enqueue(t){if(this.uc(),this.ec)return new Promise(()=>{});const e=new fs;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise)).then(()=>e.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Xu.push(t),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(t){if(!Fr(t))throw t;tt(Ym,"Operation failed with retryable error: "+t)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(t){const e=this.ac.then(()=>(this.rc=!0,t().catch(s=>{throw this.nc=s,this.rc=!1,bs("INTERNAL UNHANDLED ERROR: ",Qm(s)),s}).then(s=>(this.rc=!1,s))));return this.ac=e,e}enqueueAfterDelay(t,e,s){this.uc(),this.oc.indexOf(t)>-1&&(e=0);const i=cf.createAndSchedule(this,t,e,s,r=>this.hc(r));return this.tc.push(i),i}uc(){this.nc&&ft(47125,{Pc:Qm(this.nc)})}verifyOperationInProgress(){}async Tc(){let t;do t=this.ac,await t;while(t!==this.ac)}Ic(t){for(const e of this.tc)if(e.timerId===t)return!0;return!1}Ec(t){return this.Tc().then(()=>{this.tc.sort((e,s)=>e.targetTimeMs-s.targetTimeMs);for(const e of this.tc)if(e.skipDelay(),t!=="all"&&e.timerId===t)break;return this.Tc()})}dc(t){this.oc.push(t)}hc(t){const e=this.tc.indexOf(t);this.tc.splice(e,1)}}function Qm(n){let t=n.message||"";return n.stack&&(t=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jm(n){return function(e,s){if(typeof e!="object"||e===null)return!1;const i=e;for(const r of s)if(r in i&&typeof i[r]=="function")return!0;return!1}(n,["next","error","complete"])}class ws extends Aa{constructor(t,e,s,i){super(t,e,s,i),this.type="firestore",this._queue=new Xm,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new Xm(t),this._firestoreClient=void 0,await t}}}function $r(n,t){const e=typeof n=="object"?n:$b(),s=typeof n=="string"?n:sc,i=Rd(e,"firestore").getImmediate({identifier:s});if(!i._initialized){const r=wI("firestore");r&&qR(i,...r)}return i}function Jc(n){if(n._terminated)throw new J(U.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||KR(n),n._firestoreClient}function KR(n){const t=n._freezeSettings(),e=function(i,r,o,a){return new y1(i,r,o,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,N0(a.experimentalLongPollingOptions),a.useFetchStreams,a.isUsingEmulator)}(n._databaseId,n._app?.options.appId||"",n._persistenceKey,t);n._componentsProvider||t.localCache?._offlineComponentProvider&&t.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:t.localCache._offlineComponentProvider,_online:t.localCache._onlineComponentProvider}),n._firestoreClient=new $R(n._authCredentials,n._appCheckCredentials,n._queue,e,n._componentsProvider&&function(i){const r=i?._online.build();return{_offline:i?._offline.build(r),_online:r}}(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fn{constructor(t){this._byteString=t}static fromBase64String(t){try{return new fn(Ce.fromBase64String(t))}catch(e){throw new J(U.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(t){return new fn(Ce.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}toJSON(){return{type:fn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(t){if(wa(t,fn._jsonSchema))return fn.fromBase64String(t.bytes)}}fn._jsonSchemaVersion="firestore/bytes/1.0",fn._jsonSchema={type:fe("string",fn._jsonSchemaVersion),bytes:fe("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zc{constructor(...t){for(let e=0;e<t.length;++e)if(t[e].length===0)throw new J(U.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ae(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tu{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Un{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new J(U.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new J(U.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}_compareTo(t){return kt(this._lat,t._lat)||kt(this._long,t._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Un._jsonSchemaVersion}}static fromJSON(t){if(wa(t,Un._jsonSchema))return new Un(t.latitude,t.longitude)}}Un._jsonSchemaVersion="firestore/geoPoint/1.0",Un._jsonSchema={type:fe("string",Un._jsonSchemaVersion),latitude:fe("number"),longitude:fe("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $n{constructor(t){this._values=(t||[]).map(e=>e)}toArray(){return this._values.map(t=>t)}isEqual(t){return function(s,i){if(s.length!==i.length)return!1;for(let r=0;r<s.length;++r)if(s[r]!==i[r])return!1;return!0}(this._values,t._values)}toJSON(){return{type:$n._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(t){if(wa(t,$n._jsonSchema)){if(Array.isArray(t.vectorValues)&&t.vectorValues.every(e=>typeof e=="number"))return new $n(t.vectorValues);throw new J(U.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}$n._jsonSchemaVersion="firestore/vectorValue/1.0",$n._jsonSchema={type:fe("string",$n._jsonSchemaVersion),vectorValues:fe("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YR=/^__.*__$/;class XR{constructor(t,e,s){this.data=t,this.fieldMask=e,this.fieldTransforms=s}toMutation(t,e){return this.fieldMask!==null?new ui(t,this.data,this.fieldMask,e,this.fieldTransforms):new xa(t,this.data,e,this.fieldTransforms)}}class U0{constructor(t,e,s){this.data=t,this.fieldMask=e,this.fieldTransforms=s}toMutation(t,e){return new ui(t,this.data,this.fieldMask,e,this.fieldTransforms)}}function $0(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ft(40011,{Ac:n})}}class yf{constructor(t,e,s,i,r,o){this.settings=t,this.databaseId=e,this.serializer=s,this.ignoreUndefinedProperties=i,r===void 0&&this.Rc(),this.fieldTransforms=r||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(t){return new yf({...this.settings,...t},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(t){const e=this.path?.child(t),s=this.Vc({path:e,fc:!1});return s.gc(t),s}yc(t){const e=this.path?.child(t),s=this.Vc({path:e,fc:!1});return s.Rc(),s}wc(t){return this.Vc({path:void 0,fc:!0})}Sc(t){return fc(t,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(t){return this.fieldMask.find(e=>t.isPrefixOf(e))!==void 0||this.fieldTransforms.find(e=>t.isPrefixOf(e.field))!==void 0}Rc(){if(this.path)for(let t=0;t<this.path.length;t++)this.gc(this.path.get(t))}gc(t){if(t.length===0)throw this.Sc("Document fields must not be empty");if($0(this.Ac)&&YR.test(t))throw this.Sc('Document fields cannot begin and end with "__"')}}class QR{constructor(t,e,s){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=s||Yc(t)}Cc(t,e,s,i=!1){return new yf({Ac:t,methodName:e,Dc:s,path:Ae.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function eu(n){const t=n._freezeSettings(),e=Yc(n._databaseId);return new QR(n._databaseId,!!t.ignoreUndefinedProperties,e)}function z0(n,t,e,s,i,r={}){const o=n.Cc(r.merge||r.mergeFields?2:0,t,e,i);vf("Data must be an object, but it was:",o,s);const a=j0(s,o);let l,c;if(r.merge)l=new cn(o.fieldMask),c=o.fieldTransforms;else if(r.mergeFields){const h=[];for(const d of r.mergeFields){const f=Yh(t,d,e);if(!o.contains(f))throw new J(U.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);W0(h,f)||h.push(f)}l=new cn(h),c=o.fieldTransforms.filter(d=>l.covers(d.field))}else l=null,c=o.fieldTransforms;return new XR(new Je(a),l,c)}class nu extends tu{_toFieldTransform(t){if(t.Ac!==2)throw t.Ac===1?t.Sc(`${this._methodName}() can only appear at the top level of your update data`):t.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof nu}}class bf extends tu{constructor(t,e){super(t),this.Fc=e}_toFieldTransform(t){const e=new na(t.serializer,Zv(t.serializer,this.Fc));return new j1(t.path,e)}isEqual(t){return t instanceof bf&&this.Fc===t.Fc}}function JR(n,t,e,s){const i=n.Cc(1,t,e);vf("Data must be an object, but it was:",i,s);const r=[],o=Je.empty();ci(s,(l,c)=>{const h=wf(t,l,e);c=Se(c);const d=i.yc(h);if(c instanceof nu)r.push(h);else{const f=Sa(c,d);f!=null&&(r.push(h),o.set(h,f))}});const a=new cn(r);return new U0(o,a,i.fieldTransforms)}function ZR(n,t,e,s,i,r){const o=n.Cc(1,t,e),a=[Yh(t,s,e)],l=[i];if(r.length%2!=0)throw new J(U.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<r.length;f+=2)a.push(Yh(t,r[f])),l.push(r[f+1]);const c=[],h=Je.empty();for(let f=a.length-1;f>=0;--f)if(!W0(c,a[f])){const g=a[f];let _=l[f];_=Se(_);const y=o.yc(g);if(_ instanceof nu)c.push(g);else{const w=Sa(_,y);w!=null&&(c.push(g),h.set(g,w))}}const d=new cn(c);return new U0(h,d,o.fieldTransforms)}function tk(n,t,e,s=!1){return Sa(e,n.Cc(s?4:3,t))}function Sa(n,t){if(H0(n=Se(n)))return vf("Unsupported field value:",t,n),j0(n,t);if(n instanceof tu)return function(s,i){if(!$0(i.Ac))throw i.Sc(`${s._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${s._methodName}() is not currently supported inside arrays`);const r=s._toFieldTransform(i);r&&i.fieldTransforms.push(r)}(n,t),null;if(n===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),n instanceof Array){if(t.settings.fc&&t.Ac!==4)throw t.Sc("Nested arrays are not supported");return function(s,i){const r=[];let o=0;for(const a of s){let l=Sa(a,i.wc(o));l==null&&(l={nullValue:"NULL_VALUE"}),r.push(l),o++}return{arrayValue:{values:r}}}(n,t)}return function(s,i){if((s=Se(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return Zv(i.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const r=Kt.fromDate(s);return{timestampValue:lc(i.serializer,r)}}if(s instanceof Kt){const r=new Kt(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:lc(i.serializer,r)}}if(s instanceof Un)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof fn)return{bytesValue:c0(i.serializer,s._byteString)};if(s instanceof oe){const r=i.databaseId,o=s.firestore._databaseId;if(!o.isEqual(r))throw i.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:Zd(s.firestore._databaseId||i.databaseId,s._key.path)}}if(s instanceof $n)return function(o,a){return{mapValue:{fields:{[Nv]:{stringValue:Fv},[ic]:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw a.Sc("VectorValues must only contain numeric values.");return Yd(a.serializer,c)})}}}}}}(s,i);throw i.Sc(`Unsupported field value: ${Bc(s)}`)}(n,t)}function j0(n,t){const e={};return kv(n)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):ci(n,(s,i)=>{const r=Sa(i,t.mc(s));r!=null&&(e[s]=r)}),{mapValue:{fields:e}}}function H0(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Kt||n instanceof Un||n instanceof fn||n instanceof oe||n instanceof tu||n instanceof $n)}function vf(n,t,e){if(!H0(e)||!Pv(e)){const s=Bc(e);throw s==="an object"?t.Sc(n+" a custom object"):t.Sc(n+" "+s)}}function Yh(n,t,e){if((t=Se(t))instanceof Zc)return t._internalPath;if(typeof t=="string")return wf(n,t);throw fc("Field path arguments must be of type string or ",n,!1,void 0,e)}const ek=new RegExp("[~\\*/\\[\\]]");function wf(n,t,e){if(t.search(ek)>=0)throw fc(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,e);try{return new Zc(...t.split("."))._internalPath}catch{throw fc(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,e)}}function fc(n,t,e,s,i){const r=s&&!s.isEmpty(),o=i!==void 0;let a=`Function ${t}() called with invalid data`;e&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(r||o)&&(l+=" (found",r&&(l+=` in field ${s}`),o&&(l+=` in document ${i}`),l+=")"),new J(U.INVALID_ARGUMENT,a+n+l)}function W0(n,t){return n.some(e=>e.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q0{constructor(t,e,s,i,r){this._firestore=t,this._userDataWriter=e,this._key=s,this._document=i,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new oe(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new nk(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(G0("DocumentSnapshot.get",t));if(e!==null)return this._userDataWriter.convertValue(e)}}}class nk extends q0{data(){return super.data()}}function G0(n,t){return typeof t=="string"?wf(n,t):t instanceof Zc?t._internalPath:t._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K0(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new J(U.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class xf{}class sk extends xf{}function Y0(n,t,...e){let s=[];t instanceof xf&&s.push(t),s=s.concat(e),function(r){const o=r.filter(l=>l instanceof Ef).length,a=r.filter(l=>l instanceof Tf).length;if(o>1||o>0&&a>0)throw new J(U.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(s);for(const i of s)n=i._apply(n);return n}class Tf extends sk{constructor(t,e,s){super(),this._field=t,this._op=e,this._value=s,this.type="where"}static _create(t,e,s){return new Tf(t,e,s)}_apply(t){const e=this._parse(t);return X0(t._query,e),new hi(t.firestore,t.converter,Fh(t._query,e))}_parse(t){const e=eu(t.firestore);return function(r,o,a,l,c,h,d){let f;if(c.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new J(U.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){t_(d,h);const _=[];for(const y of d)_.push(Zm(l,r,y));f={arrayValue:{values:_}}}else f=Zm(l,r,d)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||t_(d,h),f=tk(a,o,d,h==="in"||h==="not-in");return de.create(c,h,f)}(t._query,"where",e,t.firestore._databaseId,this._field,this._op,this._value)}}class Ef extends xf{constructor(t,e){super(),this.type=t,this._queryConstraints=e}static _create(t,e){return new Ef(t,e)}_parse(t){const e=this._queryConstraints.map(s=>s._parse(t)).filter(s=>s.getFilters().length>0);return e.length===1?e[0]:An.create(e,this._getOperator())}_apply(t){const e=this._parse(t);return e.getFilters().length===0?t:(function(i,r){let o=i;const a=r.getFlattenedFilters();for(const l of a)X0(o,l),o=Fh(o,l)}(t._query,e),new hi(t.firestore,t.converter,Fh(t._query,e)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function Zm(n,t,e){if(typeof(e=Se(e))=="string"){if(e==="")throw new J(U.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!qv(t)&&e.indexOf("/")!==-1)throw new J(U.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${e}' contains a '/' character.`);const s=t.path.child(Gt.fromString(e));if(!ut.isDocumentKey(s))throw new J(U.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return gm(n,new ut(s))}if(e instanceof oe)return gm(n,e._key);throw new J(U.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Bc(e)}.`)}function t_(n,t){if(!Array.isArray(n)||n.length===0)throw new J(U.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function X0(n,t){const e=function(i,r){for(const o of i)for(const a of o.getFlattenedFilters())if(r.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(e!==null)throw e===t.op?new J(U.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new J(U.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${e.toString()}' filters.`)}class ik{convertValue(t,e="none"){switch(ii(t)){case 0:return null;case 1:return t.booleanValue;case 2:return le(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(si(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 11:return this.convertObject(t.mapValue,e);case 10:return this.convertVectorValue(t.mapValue);default:throw ft(62114,{value:t})}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t,e="none"){const s={};return ci(t,(i,r)=>{s[i]=this.convertValue(r,e)}),s}convertVectorValue(t){const e=t.fields?.[ic].arrayValue?.values?.map(s=>le(s.doubleValue));return new $n(e)}convertGeoPoint(t){return new Un(le(t.latitude),le(t.longitude))}convertArray(t,e){return(t.values||[]).map(s=>this.convertValue(s,e))}convertServerTimestamp(t,e){switch(e){case"previous":const s=zc(t);return s==null?null:this.convertValue(s,e);case"estimate":return this.convertTimestamp(Qo(t));default:return null}}convertTimestamp(t){const e=ni(t);return new Kt(e.seconds,e.nanos)}convertDocumentKey(t,e){const s=Gt.fromString(t);zt(g0(s),9688,{name:t});const i=new Jo(s.get(1),s.get(3)),r=new ut(s.popFirst(5));return i.isEqual(e)||bs(`Document ${r} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q0(n,t,e){let s;return s=n?e&&(e.merge||e.mergeFields)?n.toFirestore(t,e):n.toFirestore(t):t,s}class _o{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class Di extends q0{constructor(t,e,s,i,r,o){super(t,e,s,i,o),this._firestore=t,this._firestoreImpl=t,this.metadata=r}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new Dl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const s=this._document.data.field(G0("DocumentSnapshot.get",t));if(s!==null)return this._userDataWriter.convertValue(s,e.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new J(U.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t=this._document,e={};return e.type=Di._jsonSchemaVersion,e.bundle="",e.bundleSource="DocumentSnapshot",e.bundleName=this._key.toString(),!t||!t.isValidDocument()||!t.isFoundDocument()?e:(this._userDataWriter.convertObjectMap(t.data.value.mapValue.fields,"previous"),e.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),e)}}Di._jsonSchemaVersion="firestore/documentSnapshot/1.0",Di._jsonSchema={type:fe("string",Di._jsonSchemaVersion),bundleSource:fe("string","DocumentSnapshot"),bundleName:fe("string"),bundle:fe("string")};class Dl extends Di{data(t={}){return super.data(t)}}class Mi{constructor(t,e,s,i){this._firestore=t,this._userDataWriter=e,this._snapshot=i,this.metadata=new _o(i.hasPendingWrites,i.fromCache),this.query=s}get docs(){const t=[];return this.forEach(e=>t.push(e)),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,e){this._snapshot.docs.forEach(s=>{t.call(e,new Dl(this._firestore,this._userDataWriter,s.key,s,new _o(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new J(U.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(i,r){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const l=new Dl(i._firestore,i._userDataWriter,a.doc.key,a.doc,new _o(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>r||a.type!==3).map(a=>{const l=new Dl(i._firestore,i._userDataWriter,a.doc.key,a.doc,new _o(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,h=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:rk(a.type),doc:l,oldIndex:c,newIndex:h}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new J(U.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t={};t.type=Mi._jsonSchemaVersion,t.bundleSource="QuerySnapshot",t.bundleName=zd.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const e=[],s=[],i=[];return this.docs.forEach(r=>{r._document!==null&&(e.push(r._document),s.push(this._userDataWriter.convertObjectMap(r._document.data.value.mapValue.fields,"previous")),i.push(r.ref.path))}),t.bundle=(this._firestore,this.query._query,t.bundleName,"NOT SUPPORTED"),t}}function rk(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ft(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J0(n){n=Ge(n,oe);const t=Ge(n.firestore,ws);return HR(Jc(t),n._key).then(e=>Z0(t,n,e))}Mi._jsonSchemaVersion="firestore/querySnapshot/1.0",Mi._jsonSchema={type:fe("string",Mi._jsonSchemaVersion),bundleSource:fe("string","QuerySnapshot"),bundleName:fe("string"),bundle:fe("string")};class If extends ik{constructor(t){super(),this.firestore=t}convertBytes(t){return new fn(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new oe(this.firestore,null,e)}}function ok(n){n=Ge(n,hi);const t=Ge(n.firestore,ws),e=Jc(t),s=new If(t);return K0(n._query),WR(e,n._query).then(i=>new Mi(t,s,n,i))}function sa(n,t,e){n=Ge(n,oe);const s=Ge(n.firestore,ws),i=Q0(n.converter,t,e);return su(s,[z0(eu(s),"setDoc",n._key,i,n.converter!==null,e).toMutation(n._key,mn.none())])}function Xh(n,t,e,...s){n=Ge(n,oe);const i=Ge(n.firestore,ws),r=eu(i);let o;return o=typeof(t=Se(t))=="string"||t instanceof Zc?ZR(r,"updateDoc",n._key,t,e,s):JR(r,"updateDoc",n._key,t),su(i,[o.toMutation(n._key,mn.exists(!0))])}function ak(n){return su(Ge(n.firestore,ws),[new Xd(n._key,mn.none())])}function lk(n,t){const e=Ge(n.firestore,ws),s=pn(n),i=Q0(n.converter,t);return su(e,[z0(eu(n.firestore),"addDoc",s._key,i,n.converter!==null,{}).toMutation(s._key,mn.exists(!1))]).then(()=>s)}function ck(n,...t){n=Se(n);let e={includeMetadataChanges:!1,source:"default"},s=0;typeof t[s]!="object"||Jm(t[s])||(e=t[s++]);const i={includeMetadataChanges:e.includeMetadataChanges,source:e.source};if(Jm(t[s])){const l=t[s];t[s]=l.next?.bind(l),t[s+1]=l.error?.bind(l),t[s+2]=l.complete?.bind(l)}let r,o,a;if(n instanceof oe)o=Ge(n.firestore,ws),a=jc(n._key.path),r={next:l=>{t[s]&&t[s](Z0(o,n,l))},error:t[s+1],complete:t[s+2]};else{const l=Ge(n,hi);o=Ge(l.firestore,ws),a=l._query;const c=new If(o);r={next:h=>{t[s]&&t[s](new Mi(o,c,l,h))},error:t[s+1],complete:t[s+2]},K0(n._query)}return function(c,h,d,f){const g=new _f(f),_=new pf(h,g,d);return c.asyncQueue.enqueueAndForget(async()=>hf(await dc(c),_)),()=>{g.Nu(),c.asyncQueue.enqueueAndForget(async()=>df(await dc(c),_))}}(Jc(o),a,i,r)}function su(n,t){return function(s,i){const r=new fs;return s.asyncQueue.enqueueAndForget(async()=>DR(await jR(s),i,r)),r.promise}(Jc(n),t)}function Z0(n,t,e){const s=e.docs.get(t._key),i=new If(n);return new Di(n,i,t._key,s,new _o(e.hasPendingWrites,e.fromCache),t.converter)}function tw(n){return new bf("increment",n)}(function(t,e=!0){(function(i){Vr=i})(Mr),wr(new Fi("firestore",(s,{instanceIdentifier:i,options:r})=>{const o=s.getProvider("app").getImmediate(),a=new ws(new ZC(s.getProvider("auth-internal")),new n1(o,s.getProvider("app-check-internal")),function(c,h){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new J(U.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Jo(c.options.projectId,h)}(o,i),o);return r={useFetchStreams:e,...r},a._setSettings(r),a},"PUBLIC").setMultipleInstances(!0)),Ks(nm,sm,t),Ks(nm,sm,"esm2020")})();const Is=(n,t)=>{const e=n.__vccOpts||n;for(const[s,i]of t)e[s]=i;return e},uk={class:"flex flex-col items-center justify-center h-screen bg-gray-100 p-4 sm:p-6 md:p-8"},hk={key:0,class:"mt-6 text-gray-600"},dk={key:1,class:"mt-6 text-red-600 bg-red-100 p-3 rounded-md"},fk={__name:"LoginScreen",emits:["successfulLogin"],setup(n,{emit:t}){const e=Rt(!1),s=Rt(null),i=t,r=async()=>{e.value=!0,s.value=null;try{const o=Wi(),a=new rs,c=(await rC(o,a)).user;console.log("Google Login successful:",c),i("successfulLogin",c)}catch(o){console.error("Google Login error:",o),s.value=`Google Login failed: ${o.message}`}finally{e.value=!1}};return(o,a)=>(nt(),ht("div",uk,[a[2]||(a[2]=N("h1",{class:"text-3xl sm:text-4xl font-bold text-gray-800 mb-6 text-center"},"The Arcane Scholar’s Legacy",-1)),N("div",{class:"flex flex-col space-y-4 w-full max-w-sm"},[N("button",{onClick:r,class:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg shadow-md transition duration-300 ease-in-out flex items-center justify-center text-lg"},a[0]||(a[0]=[N("img",{src:"https://www.google.com/favicon.ico",alt:"Google Logo",class:"h-7 w-7 mr-3"},null,-1),Ln(" Sign in with Google ",-1)]))]),e.value?(nt(),ht("div",hk,a[1]||(a[1]=[N("p",null,"Loading...",-1)]))):ye("",!0),s.value?(nt(),ht("div",dk,[N("p",null,xt(s.value),1)])):ye("",!0)]))}},pk=Is(fk,[["__scopeId","data-v-f45bb7de"]]),gk={class:"flex flex-col items-center justify-center h-screen w-full bg-gray-950 text-yellow-300 p-4 sm:p-6 md:p-8 overflow-y-auto"},mk={key:0,class:"mt-4 text-yellow-400"},_k={key:1,class:"mt-4 text-red-500 bg-red-100 p-3 rounded-md"},yk={key:2,class:"w-full max-w-lg bg-violet-900 p-6 rounded-lg shadow-xl border border-yellow-700 text-center"},bk={key:3,class:"w-full max-w-3xl bg-violet-900 p-6 rounded-xl shadow-2xl border border-yellow-700"},vk=["innerHTML"],wk={class:"space-y-4"},xk={key:1,class:"space-y-4 mt-6"},Tk=["disabled"],Ek={key:4,class:"w-full max-w-3xl bg-violet-900 p-6 rounded-xl shadow-2xl border border-yellow-700"},Ik=["innerHTML"],Ak={class:"space-y-4"},Sk={key:1,class:"space-y-4 mt-6"},Ck=["disabled"],Pk={key:5,class:"w-full max-w-3xl bg-violet-900 p-6 rounded-xl shadow-2xl border border-yellow-700"},Rk={class:"text-sm text-yellow-400 mb-4 italic"},kk={class:"text-sm text-yellow-400 mb-4 italic"},Dk={key:0,class:"text-yellow-500"},Mk={key:1},Ok={key:2,class:"text-red-400"},Lk=["disabled"],Vk={__name:"CharacterManager",emits:["character-created","return-to-select"],setup(n,{emit:t}){const e=t,s=Wi(),i=$r(),r=typeof __app_id<"u"?__app_id:"default-app-id",o=Rt(!1),a=Rt(null),l=Rt("chapter1"),c=Rt({chapter1:"",chapter2:""}),h=Rt(!1),d=Rt({name:"",faction:"",specialty:"",knowledge:0,resources:{},research:{},prestige:0,skillPoints:0,location:"Unknown"}),f=Rt({name:"",loading:!1,fetched:!1}),g=async k=>{if(!f.value.fetched){try{const R=pn(i,`artifacts/${r}/users/${k}/profile/user_data`),L=await getDoc(R);if(L.exists()&&L.data().location){f.value.name=L.data().location,f.value.fetched=!0,d.value.location=f.value.name,console.log("Location loaded from profile:",f.value.name);return}}catch(R){console.error("Error reading user profile location:",R)}f.value.loading=!0;try{const R=await fetch("https://api.ip-api.com/json/?fields=city,regionName,country");if(!R.ok)throw new Error("Failed to fetch location data");const L=await R.json();let x="Unknown";L.city&&L.city!==""?x=L.city:L.regionName&&L.regionName!==""?x=L.regionName:L.country&&L.country!==""&&(x=L.country),f.value.name=x,d.value.location=x,f.value.fetched=!0;const b=pn(i,`artifacts/${r}/users/${k}/profile/user_data`);await sa(b,{location:x},{merge:!0})}catch(R){console.error("Location API error:",R),f.value.name="Unknown",d.value.location="Unknown"}finally{f.value.loading=!1}}},_=k=>{if(!k)return"";const L=k.replace(/</g,"&lt;").replace(/>/g,"&gt;").split(`
`);let x="",b=!1,T=[];const C=()=>{if(T.length===0)return;let P='<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-yellow-700 border border-yellow-700 rounded-lg">';const I=T[0].replace(/^\||\|$/g,"").split("|").map(yt=>yt.trim());if(I.length>0&&(P+='<thead class="bg-violet-800/80">',P+="<tr>",I.forEach(yt=>{let st=yt;st=st.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>"),st=st.replace(/\*(.*?)\*/g,"<em>$1</em>"),st=st.replace(/_(.*?)_/g,"<em>$1</em>"),P+=`<th scope="col" class="px-3 py-2 text-left text-xs font-medium text-yellow-300 uppercase tracking-wider">${st}</th>`}),P+="</tr>",P+="</thead>"),T.length>1){P+='<tbody class="divide-y divide-yellow-800">';for(let yt=2;yt<T.length;yt++){const mt=T[yt].replace(/^\||\|$/g,"").split("|").map(ot=>ot.trim());mt.length===I.length&&(P+='<tr class="bg-violet-900/50 hover:bg-violet-800/70">',mt.forEach(ot=>{let at=ot;at=at.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>"),at=at.replace(/\*(.*?)\*/g,"<em>$1</em>"),at=at.replace(/_(.*?)_/g,"<em>$1</em>"),P+=`<td class="px-3 py-2 whitespace-nowrap text-sm text-yellow-100">${at}</td>`}),P+="</tr>")}P+="</tbody>"}P+="</table></div>",x+=P,T=[]};return L.forEach(P=>{let M=P.trim();if(M.includes("|")&&!M.startsWith("#")){const st=M.match(/\|[:-]*\|/);if(T.length===0&&st)T.push(M);else if(T.length>0||M.startsWith("|")){b&&(x+="</ul>",b=!1),T.push(M);return}}if(T.length>0&&C(),M.length===0){b&&(x+="</ul>",b=!1);return}if(M.startsWith("###")){x+=`<h3 class="text-xl font-bold text-yellow-200 mt-4 mb-2">${M.substring(3).trim()}</h3>`;return}if(M.startsWith("##")){x+=`<h2 class="text-2xl font-serif text-yellow-100 mt-6 mb-3 border-b border-yellow-700 pb-1">${M.substring(2).trim()}</h2>`;return}if(M.startsWith("#")){x+=`<h1 class="text-3xl font-serif text-yellow-50 mt-8 mb-4">${M.substring(1).trim()}</h1>`;return}if(M==="---"){b&&(x+="</ul>",b=!1),x+='<hr class="my-6 border-yellow-800">';return}if(M.startsWith("* ")||M.startsWith("- ")){b||(x+='<ul class="list-disc ml-6 space-y-1 mb-4">',b=!0);let st=M.substring(2).trim();st=st.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>"),st=st.replace(/\*(.*?)\*/g,"<em>$1</em>"),st=st.replace(/_(.*?)_/g,"<em>$1</em>"),x+=`<li>${st}</li>`;return}b&&(x+="</ul>",b=!1);let yt=M;yt=yt.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>"),yt=yt.replace(/\*(.*?)\*/g,"<em>$1</em>"),yt=yt.replace(/_(.*?)_/g,"<em>$1</em>"),x+=`<p class="mb-4">${yt}</p>`}),b&&(x+="</ul>"),T.length>0&&C(),x},y=async()=>{try{const k=await fetch("/the-arcane-scholar-s-legacy/Chapter1.md");if(!k.ok)throw new Error("Failed to fetch Chapter1.md.");const R=await k.text();c.value.chapter1=_(R),console.log("Successfully read and parsed Chapter1.md.");const L=await fetch("/the-arcane-scholar-s-legacy/Chapter2.md");if(!L.ok)throw new Error("Failed to fetch Chapter2.md.");const x=await L.text();c.value.chapter2=_(x),console.log("Successfully read and parsed Chapter2.md."),h.value=!0}catch(k){console.error("Error fetching lore:",k),a.value=`Failed to load game lore (${k.message}). Ensure Chapter1.md and Chapter2.md exist.`}};kr(()=>{y(),s.currentUser&&g(s.currentUser.uid)});const w=k=>{d.value.faction=k},E=k=>{d.value.specialty=k},S=()=>{l.value==="factionSelect"?l.value="chapter2":l.value==="specialtySelect"&&(l.value="nameAssign")},A=async()=>{const k=s.currentUser?.uid;if(!k){a.value="User not authenticated. Please log in again.";return}if(!d.value.name){a.value="Please enter a name for your scholar.";return}o.value=!0,a.value=null;try{const R=B0(i,`artifacts/${r}/users/${k}/characters`);d.value.location=f.value.name||"Unknown";const L=await lk(R,d.value),x=pn(i,`artifacts/${r}/users/${k}/profile/user_data`);await Xh(x,{characterCount:tw(1)},{merge:!0});const b=pn(i,`artifacts/${r}/public/data/leaderboard`,L.id),T={name:d.value.name,prestige:d.value.prestige,faction:d.value.faction,specialty:d.value.specialty,location:d.value.location,userId:k};await sa(b,T,{merge:!0}),console.log("New character created with ID:",L.id),e("character-created",L.id)}catch(R){console.error("Error creating character:",R),R.message.includes("permission denied")||R.message.includes("unauthorized")?a.value="Creation failed: You have reached the maximum limit of 4 characters. Please delete one to continue.":a.value=`Failed to create character: ${R.message}`}finally{o.value=!1}};return(k,R)=>(nt(),ht("div",gk,[R[17]||(R[17]=N("h2",{class:"text-4xl font-serif text-yellow-100 mb-8 text-center leading-tight"},"Forge Your Legacy",-1)),o.value?(nt(),ht("div",mk,"Loading...")):ye("",!0),a.value?(nt(),ht("div",_k,xt(a.value),1)):ye("",!0),h.value?l.value==="chapter1"||l.value==="factionSelect"?(nt(),ht("div",bk,[R[11]||(R[11]=N("h3",{class:"text-2xl font-serif text-yellow-100 mb-4 border-b border-yellow-600 pb-2"},"Chapter 1: The First Whisper",-1)),N("div",{innerHTML:c.value.chapter1,class:"text-lg text-yellow-100/90 leading-relaxed mb-6 max-h-80 overflow-y-auto markdown-content"},null,8,vk),N("div",wk,[l.value==="chapter1"?(nt(),ht("button",{key:0,onClick:R[0]||(R[0]=L=>l.value="factionSelect"),class:"w-full py-3 px-4 rounded-lg text-xl font-bold bg-green-700 hover:bg-green-800 text-white shadow-lg transition-all duration-200 ease-in-out"}," Continue to Faction Selection ")):ye("",!0),l.value==="factionSelect"?(nt(),ht("div",xk,[N("button",{onClick:R[1]||(R[1]=L=>w("Lumen")),class:et(["w-full py-3 px-4 rounded-lg text-xl font-bold transition-all duration-200 ease-in-out",d.value.faction==="Lumen"?"bg-blue-600 text-white shadow-xl":"bg-violet-800 hover:bg-blue-500 text-yellow-100"])}," Select Lumen ",2),N("button",{onClick:R[2]||(R[2]=L=>w("Umbra")),class:et(["w-full py-3 px-4 rounded-lg text-xl font-bold transition-all duration-200 ease-in-out",d.value.faction==="Umbra"?"bg-purple-600 text-white shadow-xl":"bg-violet-800 hover:bg-purple-500 text-yellow-100"])}," Select Umbra ",2),N("button",{onClick:S,disabled:!d.value.faction,class:"w-full py-3 px-4 rounded-lg text-xl font-bold bg-green-700 hover:bg-green-800 text-white shadow-lg transition-all duration-200 ease-in-out disabled:opacity-50 disabled:cursor-not-allowed"}," Proceed ",8,Tk),N("button",{onClick:R[3]||(R[3]=L=>l.value="chapter1"),class:"w-full py-2 px-4 rounded-lg text-sm bg-gray-600 hover:bg-gray-700 text-white transition-all duration-200 ease-in-out"}," Go Back ")])):ye("",!0)])])):l.value==="chapter2"||l.value==="specialtySelect"?(nt(),ht("div",Ek,[R[12]||(R[12]=N("h3",{class:"text-2xl font-serif text-yellow-100 mb-4 border-b border-yellow-600 pb-2"},"Chapter 2: The Second Whisper",-1)),N("div",{innerHTML:c.value.chapter2,class:"text-lg text-yellow-100/90 leading-relaxed mb-6 max-h-80 overflow-y-auto markdown-content"},null,8,Ik),N("div",Ak,[l.value==="chapter2"?(nt(),ht("button",{key:0,onClick:R[4]||(R[4]=L=>l.value="specialtySelect"),class:"w-full py-3 px-4 rounded-lg text-xl font-bold bg-green-700 hover:bg-green-800 text-white shadow-lg transition-all duration-200 ease-in-out"}," Continue to Specialty Selection ")):ye("",!0),l.value==="specialtySelect"?(nt(),ht("div",Sk,[N("button",{onClick:R[5]||(R[5]=L=>E("Arcane")),class:et(["w-full py-3 px-4 rounded-lg text-xl font-bold transition-all duration-200 ease-in-out",d.value.specialty==="Arcane"?"bg-cyan-600 text-white shadow-xl":"bg-violet-800 hover:bg-cyan-500 text-yellow-100"])}," Select Arcane ",2),N("button",{onClick:R[6]||(R[6]=L=>E("Alchemist")),class:et(["w-full py-3 px-4 rounded-lg text-xl font-bold transition-all duration-200 ease-in-out",d.value.specialty==="Alchemist"?"bg-amber-600 text-white shadow-xl":"bg-violet-800 hover:bg-amber-500 text-yellow-100"])}," Select Alchemist ",2),N("button",{onClick:S,disabled:!d.value.specialty,class:"w-full py-3 px-4 rounded-lg text-xl font-bold bg-green-700 hover:bg-green-800 text-white shadow-lg transition-all duration-200 ease-in-out disabled:opacity-50 disabled:cursor-not-allowed"}," Proceed ",8,Ck),N("button",{onClick:R[7]||(R[7]=L=>l.value="chapter1"),class:"w-full py-2 px-4 rounded-lg text-sm bg-gray-600 hover:bg-gray-700 text-white transition-all duration-200 ease-in-out"}," Go Back ")])):ye("",!0)])])):l.value==="nameAssign"?(nt(),ht("div",Pk,[R[15]||(R[15]=N("h3",{class:"text-2xl font-serif text-yellow-100 mb-4 border-b border-yellow-600 pb-2"},"Assign Your Scholar Name",-1)),R[16]||(R[16]=N("p",{class:"text-lg text-yellow-300 mb-4"}," Name your scholar, choose wisely as this name will define your legacy. ",-1)),N("p",Rk," Faction: "+xt(d.value.faction)+" | Specialty: "+xt(d.value.specialty),1),N("p",kk,[R[13]||(R[13]=Ln(" Current Location: ",-1)),f.value.loading?(nt(),ht("span",Dk,"Detecting location...")):f.value.name?(nt(),ht("span",Mk,xt(f.value.name),1)):(nt(),ht("span",Ok,"Location Unknown (This will be 'Unknown' on the global leaderboards)"))]),N("form",{onSubmit:Pb(A,["prevent"]),class:"space-y-4"},[N("div",null,[R[14]||(R[14]=N("label",{for:"characterName",class:"block text-lg text-yellow-300 mb-2"},"Scholar's Name:",-1)),ho(N("input",{id:"characterName","onUpdate:modelValue":R[8]||(R[8]=L=>d.value.name=L),type:"text",required:"",class:"w-full p-3 rounded-lg bg-gray-800 text-yellow-100 border border-yellow-700 focus:outline-none focus:ring-2 focus:ring-yellow-500",placeholder:"Enter a name"},null,512),[[rI,d.value.name]])]),N("button",{type:"submit",disabled:!d.value.name||o.value,class:"w-full py-3 px-4 rounded-lg text-xl font-bold bg-green-700 hover:bg-green-800 text-white shadow-lg transition-all duration-200 ease-in-out disabled:opacity-50 disabled:cursor-not-allowed"}," Forge Legacy ",8,Lk)],32),N("button",{onClick:R[9]||(R[9]=L=>l.value="specialtySelect"),class:"w-full py-2 px-4 mt-4 rounded-lg text-sm bg-gray-600 hover:bg-gray-700 text-white transition-all duration-200 ease-in-out"}," Go Back ")])):ye("",!0):(nt(),ht("div",yk,R[10]||(R[10]=[N("p",{class:"text-lg text-yellow-300"},"Loading lore...",-1)])))]))}},Nk={class:"flex flex-col items-center justify-center min-h-screen w-full bg-gray-950 text-yellow-300 font-sans p-6"},Fk={class:"bg-violet-900 p-8 rounded-xl shadow-2xl border border-yellow-700 w-full max-w-2xl"},Bk={class:"bg-violet-800 p-6 rounded-lg shadow-inner mb-8"},Uk={key:0,class:"text-center text-lg text-red-400 font-bold mb-3 p-2 rounded-lg bg-red-900/50"},$k=["disabled"],zk={class:"bg-violet-800 p-6 rounded-lg shadow-inner"},jk={class:"text-2xl font-serif text-yellow-100 mb-4 border-b border-yellow-600 pb-2"},Hk={key:0,class:"text-center text-sm text-yellow-400 italic"},Wk={key:1,class:"space-y-4"},qk=["onClick"],Gk={class:"text-2xl font-bold text-yellow-100"},Kk={class:"text-sm text-yellow-400"},Yk=["onClick"],Xk={key:0,class:"fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center p-4 z-50"},Qk={key:1,class:"fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center p-4 z-50"},Jk={class:"bg-red-900 p-8 rounded-xl shadow-2xl border border-red-700 w-full max-w-sm text-center"},Zk={class:"text-red-100 mb-6"},ro=4,tD={__name:"CharacterSelectionView",emits:["characterSelected","startNewCharacterCreation"],setup(n,{emit:t}){const e=t,s=Rt([]),i=Rt(0),r=Rt(!1),o=Rt(null),a=Rt(!1),l=Rt(""),c=Wi(),h=$r(),d=typeof __app_id<"u"?__app_id:"default-app-id",f=async S=>{if(S)try{const A=pn(h,`artifacts/${d}/users/${S}/profile/user_data`),k=await J0(A);k.exists()?i.value=k.data().characterCount||0:(await sa(A,{characterCount:0},{merge:!0}),i.value=0),console.log(`Character count loaded: ${i.value}`)}catch(A){console.error("Error fetching or initializing user profile:",A)}},g=async S=>{if(S)try{const A=B0(h,`artifacts/${d}/users/${S}/characters`),k=Y0(A),R=await ok(k);s.value=R.docs.map(x=>({id:x.id,...x.data()})),i.value=s.value.length;const L=pn(h,`artifacts/${d}/users/${S}/profile/user_data`);await Xh(L,{characterCount:s.value.length},{merge:!0})}catch(A){console.error("Error fetching characters:",A),l.value="Failed to load characters. Please check your connection.",a.value=!0}},_=S=>{e("characterSelected",S)},y=S=>{o.value=S,r.value=!0},w=()=>{r.value=!1,o.value=null},E=async()=>{const S=c.currentUser?.uid;if(!(!S||!o.value))try{const A=pn(h,`artifacts/${d}/users/${S}/characters`,o.value);await ak(A);const k=pn(h,`artifacts/${d}/users/${S}/profile/user_data`);await Xh(k,{characterCount:tw(-1)},{merge:!0}),console.log("Character deleted successfully and count decremented."),r.value=!1,o.value=null,await g(S)}catch(A){console.error("Error deleting character:",A),l.value=`Failed to delete character: ${A.message}`,a.value=!0}};return kr(()=>{cv(c,async S=>{S&&(await f(S.uid),await g(S.uid))})}),(S,A)=>(nt(),ht("div",Nk,[N("div",Fk,[A[2]||(A[2]=N("h2",{class:"text-4xl font-serif text-yellow-100 mb-6 text-center"},"Your Scholars",-1)),N("div",Bk,[i.value>=ro?(nt(),ht("p",Uk," Limit Reached ("+xt(ro)+" Max): Delete a scholar to forge a new legacy. ")):ye("",!0),N("button",{onClick:A[0]||(A[0]=k=>e("startNewCharacterCreation")),disabled:i.value>=ro,class:et(["w-full py-3 px-4 rounded-lg text-xl font-bold text-white shadow-lg transition-all duration-200 ease-in-out",i.value>=ro?"bg-gray-600 cursor-not-allowed":"bg-green-700 hover:bg-green-800"])}," Forge a New Legacy ",10,$k)]),N("div",zk,[N("h3",jk," Continue Your Legacy ("+xt(s.value.length)+" / "+xt(ro)+") ",1),s.value.length===0?(nt(),ht("p",Hk," No scholars found. Forge your first one above! ")):(nt(),ht("ul",Wk,[(nt(!0),ht(rn,null,Dc(s.value,k=>(nt(),ht("li",{key:k.id,class:"flex items-center justify-between bg-violet-700 p-4 rounded-lg shadow-md transition duration-200 ease-in-out hover:bg-violet-600"},[N("div",{onClick:R=>_(k.id),class:"flex-grow cursor-pointer"},[N("h3",Gk,xt(k.name),1),N("p",Kk," Faction: "+xt(k.faction)+" | Specialty: "+xt(k.specialty),1)],8,qk),N("button",{onClick:Pb(R=>y(k.id),["stop"]),class:"ml-4 bg-red-700 hover:bg-red-800 text-white font-bold py-2 px-4 rounded-lg shadow-md transition duration-200 ease-in-out"}," Delete ",8,Yk)]))),128))]))])]),r.value?(nt(),ht("div",Xk,[N("div",{class:"bg-violet-900 p-8 rounded-xl shadow-2xl border border-yellow-700 w-full max-w-md text-center"},[A[3]||(A[3]=N("h3",{class:"text-2xl font-bold text-yellow-100 mb-4"},"Confirm Deletion",-1)),A[4]||(A[4]=N("p",{class:"text-yellow-300 mb-6"},"Are you sure you want to delete this scholar? This action cannot be undone.",-1)),N("div",{class:"flex justify-center space-x-4"},[N("button",{onClick:E,class:"bg-red-700 hover:bg-red-800 text-white font-bold py-2 px-6 rounded-lg"},"Delete"),N("button",{onClick:w,class:"bg-gray-700 hover:bg-gray-800 text-white font-bold py-2 px-6 rounded-lg"},"Cancel")])])])):ye("",!0),a.value?(nt(),ht("div",Qk,[N("div",Jk,[A[5]||(A[5]=N("h3",{class:"text-2xl font-bold text-red-300 mb-4"},"Error",-1)),N("p",Zk,xt(l.value),1),N("button",{onClick:A[1]||(A[1]=k=>a.value=!1),class:"bg-red-700 hover:bg-red-800 text-white font-bold py-2 px-6 rounded-lg"},"Close")])])):ye("",!0)]))}},eD=Is(tD,[["__scopeId","data-v-fc551975"]]),nD={class:"flex items-start space-x-6 mb-4"},sD={class:"flex flex-col items-center w-28 flex-shrink-0"},iD=["title"],rD={class:"flex-grow"},oD={class:"flex flex-col items-center justify-center space-y-6 mt-8"},aD={class:"font-bold"},lD={key:0},cD={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-6"},uD={key:0},hD=["onClick","disabled"],dD={key:0,class:"mt-8 text-center"},fD={__name:"SanctumView",props:{knowledge:{type:Number,required:!0},passiveKnowledgeGain:{type:Number,required:!0},multiplierTiers:{type:Array,required:!0},characterDetails:{type:Object,required:!0},currentTierIndex:{type:Number,required:!0},themeClasses:{type:Object,required:!0,default:()=>({primaryBg:"bg-gray-950",primaryText:"text-yellow-300",accentBorder:"border-yellow-600",sidebarBg:"bg-violet-950",activeMenuBg:"bg-green-800"})}},emits:["generate-knowledge","buy-multiplier","advance-tier"],setup(n,{emit:t}){const e=n,s=t,i=l=>{if(l==null)return"0.00";l=Number(l);const c=[{value:1e12,symbol:"T"},{value:1e9,symbol:"B"},{value:1e6,symbol:"M"},{value:1e3,symbol:"K"}];for(let h=0;h<c.length;h++){const{value:d,symbol:f}=c[h];if(Math.abs(l)>=d){const g=l/d;let _;return g<10?_=g.toFixed(3):g<100?_=g.toFixed(2):_=g.toFixed(1),_+f}}return l.toFixed(2)},r=hs(()=>e.multiplierTiers[e.currentTierIndex]),o=hs(()=>{const l=r.value;if(!l)return!1;const c=l.multipliers.every(d=>d.level===d.maxLevel),h=e.multiplierTiers[e.currentTierIndex+1];return c&&h}),a=(l,c)=>{const h=e.multiplierTiers[l]?.multipliers[c];return h?h.baseCost*Math.pow(h.costMultiplier,h.level):1/0};return(l,c)=>(nt(),ht("section",{class:et([e.themeClasses.primaryText,e.themeClasses.accentBorder,e.themeClasses.primaryBg,"p-6 rounded-lg shadow-xl border"])},[N("div",nD,[N("div",sD,[N("div",{class:et(["w-24 h-24 sm:w-28 sm:h-28 border-2 rounded-lg shadow-inner flex items-center justify-center",[e.themeClasses.primaryBg,e.themeClasses.accentBorder]])},[N("span",{class:et([e.themeClasses.primaryText,"text-sm italic opacity-70"])},"Avatar",2)],2),N("h3",{class:et(["mt-2 text-lg font-bold text-center truncate w-full",e.themeClasses.primaryText]),title:n.characterDetails.name},xt(n.characterDetails.name),11,iD),N("p",{class:et(["text-sm",e.themeClasses.primaryText])},"Prestige: "+xt(n.characterDetails.prestige),3)]),N("div",rD,[N("h2",{class:et(["text-3xl font-serif mb-2 pb-2 border-b",[e.themeClasses.primaryText,e.themeClasses.accentBorder]])}," Sanctum Overview ",2),N("p",{class:et(["text-lg",e.themeClasses.primaryText])}," Welcome back, Scholar. The whispers of ancient knowledge await your command. ",2)])]),N("div",oD,[N("span",{class:et(["text-4xl sm:text-5xl font-bold mb-4",e.themeClasses.primaryText])}," Current Knowledge: "+xt(i(n.knowledge)),3),N("button",{onClick:c[0]||(c[0]=h=>s("generate-knowledge")),class:et([e.themeClasses.activeMenuBg,"text-white font-bold py-4 px-8 rounded-full text-2xl shadow-lg transition duration-300 ease-in-out transform hover:scale-105 hover:opacity-80"])}," Generate Knowledge ",2),N("p",{class:et(["text-sm mt-2",e.themeClasses.primaryText])},"Click to harness raw arcane energy and convert it into Knowledge.",2),N("p",{class:et(["text-xl mt-4",e.themeClasses.primaryText])},[c[2]||(c[2]=Ln(" Passive Knowledge Gain: ",-1)),N("span",aD,xt(i(n.passiveKnowledgeGain)),1),c[3]||(c[3]=Ln(" / second ",-1))],2)]),N("div",{class:et(["mt-10 pt-6 border-t",e.themeClasses.accentBorder])},[r.value?(nt(),ht("div",lD,[N("h4",{class:et(["text-3xl font-serif mb-6 text-center",[e.themeClasses.primaryText]])},xt(r.value.name),3),N("div",cD,[(nt(!0),ht(rn,null,Dc(r.value.multipliers,(h,d)=>(nt(),ht("div",{key:`multiplier-${e.currentTierIndex}-${d}`,class:et(["p-4 rounded-lg border shadow-md flex flex-col",[e.themeClasses.primaryBg,e.themeClasses.accentBorder]])},[N("h4",{class:et(["text-xl mb-2",e.themeClasses.primaryText])},xt(h.name)+" (Level "+xt(h.level)+" / "+xt(h.maxLevel)+") ",3),N("p",{class:et(["text-sm mb-2",e.themeClasses.primaryText])},[Ln(" Current effect: +"+xt(i(h.baseEffect*Math.pow(h.effectMultiplier,h.level>0?h.level-1:0)))+" knowledge/s ",1),h.level>0&&h.level<h.maxLevel?(nt(),ht("span",uD,"(Next: +"+xt(i(h.baseEffect*Math.pow(h.effectMultiplier,h.level)))+" knowledge/s)",1)):ye("",!0)],2),N("p",{class:et(["text-sm mb-4",e.themeClasses.primaryText])},[Ln(" Cost for next level ("+xt(h.level+1)+"): ",1),N("span",{class:et(["font-bold",e.themeClasses.primaryText])},xt(i(a(e.currentTierIndex,d)))+" Knowledge",3)],2),h.level<h.maxLevel?(nt(),ht("button",{key:0,onClick:f=>s("buy-multiplier",{tierIndex:e.currentTierIndex,multiplierIndex:d}),disabled:n.knowledge<a(e.currentTierIndex,d),class:et(["mt-auto bg-blue-700 hover:bg-blue-800 text-white py-2 px-4 rounded-md text-base font-bold transition duration-300 ease-in-out",n.knowledge<a(e.currentTierIndex,d)?"opacity-50 cursor-not-allowed":""])}," Buy Upgrade (Level "+xt(h.level+1)+") ",11,hD)):(nt(),ht("div",{key:1,class:et(["mt-auto text-center py-2 rounded-md font-bold text-base shadow-inner",[e.themeClasses.activeMenuBg,e.themeClasses.primaryText,"bg-opacity-80"]])}," Max Level Reached ✅ ",2))],2))),128))]),o.value?(nt(),ht("div",dD,[N("button",{onClick:c[1]||(c[1]=h=>s("advance-tier")),class:et(["py-3 px-6 rounded-lg text-xl font-bold transition duration-300 ease-in-out transform hover:scale-105",e.themeClasses.activeMenuBg,e.themeClasses.primaryText])}," Go to Next Tier: "+xt(e.multiplierTiers[e.currentTierIndex+1].name)+" → ",3)])):ye("",!0)])):(nt(),ht("div",{key:1,class:et(["text-center p-4 rounded-lg border border-dashed",[e.themeClasses.sidebarBg,e.themeClasses.accentBorder,e.themeClasses.primaryText]])},c[4]||(c[4]=[N("p",{class:"italic"},"Loading Arcane Data...",-1)]),2))],2)],2))}},pD=Is(fD,[["__scopeId","data-v-ba649607"]]),gD={__name:"ResearchView",props:{themeClasses:{type:Object,required:!0,default:()=>({primaryBg:"bg-gray-950",primaryText:"text-yellow-300",accentBorder:"border-yellow-600",sidebarBg:"bg-violet-950",activeMenuBg:"bg-green-800"})}},setup(n){const t=n,{themeClasses:e}=t;return console.log("ResearchView: Component loaded."),(s,i)=>(nt(),ht("section",{class:et([Ht(e).sidebarBg,Ht(e).primaryText,Ht(e).accentBorder,"p-6 rounded-lg shadow-xl border"])},[N("h2",{class:et(["text-3xl font-serif mb-6 border-b pb-3",[Ht(e).primaryText,Ht(e).accentBorder]])}," Research ",2),N("p",{class:et(["text-lg",Ht(e).primaryText])}," Uncover forgotten spells and ancient technologies. ",2),N("p",{class:et(["text-sm mt-4",Ht(e).primaryText])},"This section will contain various research projects, their costs, and effects.",2)],2))}},mD=Is(gD,[["__scopeId","data-v-675a273d"]]),_D={__name:"ExpeditionsView",props:{themeClasses:{type:Object,required:!0,default:()=>({primaryBg:"bg-gray-950",primaryText:"text-yellow-300",accentBorder:"border-yellow-600",sidebarBg:"bg-violet-950",activeMenuBg:"bg-green-800"})}},setup(n){const t=n,{themeClasses:e}=t;return console.log("ExpeditionsView: Component loaded."),(s,i)=>(nt(),ht("section",{class:et([Ht(e).primaryBg,Ht(e).primaryText,Ht(e).accentBorder,"p-6 rounded-lg shadow-xl border"])},[N("h2",{class:et(["text-3xl font-serif mb-6 border-b pb-3",[Ht(e).primaryText,Ht(e).accentBorder]])}," Expeditions ",2),N("p",{class:et(["text-lg",Ht(e).primaryText])}," Send your scholars on perilous journeys to retrieve rare artifacts and knowledge. ",2),N("p",{class:et(["text-sm mt-4",Ht(e).primaryText])},"Manage your expeditions, track their progress, and claim rewards here.",2)],2))}},yD=Is(_D,[["__scopeId","data-v-9c681b39"]]),bD={__name:"InventoryView",props:{themeClasses:{type:Object,required:!0,default:()=>({primaryBg:"bg-gray-950",primaryText:"text-yellow-300",accentBorder:"border-yellow-600",sidebarBg:"bg-violet-950",activeMenuBg:"bg-green-800"})}},setup(n){const t=n,{themeClasses:e}=t;return console.log("InventoryView: Component loaded."),(s,i)=>(nt(),ht("section",{class:et([Ht(e).primaryBg,Ht(e).primaryText,Ht(e).accentBorder,"p-6 rounded-lg shadow-xl border"])},[N("h2",{class:et(["text-3xl font-serif mb-6 border-b pb-3",[Ht(e).primaryText,Ht(e).accentBorder]])}," Inventory ",2),N("p",{class:et(["text-lg",Ht(e).primaryText])}," Behold your collected treasures and resources. ",2),N("p",{class:et(["text-sm mt-4",Ht(e).primaryText])},"This section will display all your acquired items, resources, and their quantities.",2)],2))}},vD=Is(bD,[["__scopeId","data-v-d4a9dca2"]]),wD={__name:"SkillTreeView",props:{themeClasses:{type:Object,required:!0,default:()=>({primaryBg:"bg-gray-950",primaryText:"text-yellow-300",accentBorder:"border-yellow-600",sidebarBg:"bg-violet-950",activeMenuBg:"bg-green-800"})}},setup(n){const t=n,{themeClasses:e}=t;return console.log("SkillTreeView: Component loaded."),(s,i)=>(nt(),ht("section",{class:et([Ht(e).primaryBg,Ht(e).primaryText,Ht(e).accentBorder,"p-6 rounded-lg shadow-xl border"])},[N("h2",{class:et(["text-3xl font-serif mb-6 border-b pb-3",[Ht(e).primaryText,Ht(e).accentBorder]])}," Skill Tree ",2),N("p",{class:et(["text-lg",Ht(e).primaryText])}," Forge your destiny by mastering powerful skills and abilities. ",2),N("p",{class:et(["text-sm mt-4",Ht(e).primaryText])},"Invest your hard-earned skill points to unlock new capabilities and enhance existing ones.",2)],2))}},xD=Is(wD,[["__scopeId","data-v-20e61295"]]),TD={class:"bg-gray-800 p-6 rounded-lg shadow-inner"},ED={class:"flex items-center space-x-2"},ID={class:"flex items-center space-x-2"},AD={class:"flex items-center space-x-2"},SD={class:"flex items-center space-x-2 ml-auto"},CD={key:1,class:"text-lg text-yellow-400 p-4 text-center"},PD={key:2,class:"text-lg text-red-500 bg-red-900/50 p-4 rounded-lg text-center"},RD={key:3,class:"text-lg text-yellow-500 p-4 text-center bg-gray-900/50 rounded-lg"},kD={key:4,class:"overflow-x-auto"},DD={class:"min-w-full divide-y divide-gray-700 rounded-lg"},MD={class:"divide-y divide-gray-800"},OD={class:"px-4 py-4 whitespace-nowrap text-sm font-medium"},LD={class:"px-4 py-4 whitespace-nowrap text-sm font-medium"},VD={class:"px-4 py-4 whitespace-nowrap text-sm"},ND={class:"px-4 py-4 whitespace-nowrap text-sm"},FD={class:"px-4 py-4 whitespace-nowrap text-sm"},BD={class:"px-4 py-4 whitespace-nowrap text-sm"},UD={class:"px-4 py-4 whitespace-nowrap text-xs"},$D={class:"px-4 py-4 whitespace-nowrap text-xs opacity-50"},zD={__name:"ClassificationView",props:{themeClasses:{type:Object,required:!0,default:()=>({primaryBg:"bg-gray-950",primaryText:"text-yellow-300",accentBorder:"border-yellow-600",sidebarBg:"bg-violet-950",activeMenuBg:"bg-green-800"})}},setup(n){const t={prestige:3,tierSum:2,count:1};typeof __app_id<"u"&&__app_id;const e=$r(),s=Wi();let i;const r=Rt([]),o=Rt(!0),a=Rt(null),l=Rt(""),c=Rt(""),h=Rt(""),d=Rt("prestige"),f=Rt("desc"),g=()=>{if(!s.currentUser){a.value="You must be logged in to view the Classification.",o.value=!1;return}const S=GR(e,"leaderboard"),A=Y0(S);o.value=!0,a.value=null,i=ck(A,k=>{try{const R=[];k.forEach(L=>{const x=L.data();R.push({id:L.id,currentTierIndex:x.currentTierIndex||0,...x})}),r.value=R}catch(R){console.error("Error processing leaderboard snapshot:",R),a.value="Failed to process data from the server."}finally{o.value=!1}},k=>{console.error("Error fetching leaderboard:",k),a.value=`Access Denied or Connection Error: ${k.message}`,o.value=!1})},_=()=>{f.value=f.value==="desc"?"asc":"desc"},y=hs(()=>{const A=[...r.value.filter(k=>{if(l.value&&k.faction!==l.value||c.value&&k.specialty!==c.value)return!1;const R=k.location||"",L=h.value;return!(L&&R!==L)})];return A.sort((k,R)=>{const L=k[d.value],x=R[d.value];if(d.value==="prestige"||d.value==="currentTierIndex"){const b=(L||0)-(x||0);return f.value==="asc"?b:-b}if(typeof L=="string"){const b=(L||"").localeCompare(x||"");return f.value==="asc"?b:-b}return 0}),A}),w=hs(()=>{const S={Lumen:{count:0,tierSum:0,prestigeSum:0},Umbra:{count:0,tierSum:0,prestigeSum:0},Other:{count:0,tierSum:0,prestigeSum:0}};return y.value.forEach(A=>{const k=(A.currentTierIndex||0)+1,R=A.prestige||0,L=A.faction==="Lumen"||A.faction==="Umbra"?A.faction:"Other";S[L].count++,S[L].tierSum+=k,S[L].prestigeSum+=R}),S}),E=hs(()=>{const S=w.value,A=t,k=I=>I.prestigeSum*A.prestige+I.tierSum*A.tierSum+I.count*A.count,R=k(S.Lumen),L=k(S.Umbra),x=k(S.Other),b=R+L+x;if(b===0)return[];const T=R/b*100,C=L/b*100,P=x/b*100,M=[{name:"Lumen",data:[["Total Weighted Dominance",Math.round(T*100)/100]],backgroundColor:"#FFD700"},{name:"Umbra",data:[["Total Weighted Dominance",Math.round(C*100)/100]],backgroundColor:"#8A2BE2"}];return P>.01&&M.push({name:"Other/Unassigned",data:[["Total Weighted Dominance",Math.round(P*100)/100]],backgroundColor:"#4A5568"}),M});return kr(()=>{const S=s.onAuthStateChanged(A=>{S(),A?g():(o.value=!1,a.value="You must be logged in to view the Classification.")})}),kc(()=>{i&&(i(),console.log("ClassificationView: Firestore listener unsubscribed."))}),(S,A)=>{const k=WT("bar-chart");return nt(),ht("section",{class:et([n.themeClasses.primaryBg,n.themeClasses.primaryText,n.themeClasses.accentBorder,"p-6 rounded-lg shadow-xl border overflow-auto h-full"])},[N("h2",{class:et(["text-3xl font-serif mb-6 border-b pb-3",[n.themeClasses.primaryText,n.themeClasses.accentBorder]])}," Classification: Global Scholars ",2),N("p",{class:et(["text-sm mt-4 mb-4",n.themeClasses.primaryText])}," View the global rankings of all scholars. Use the controls below to filter and sort the data. ",2),!o.value&&!a.value?(nt(),ht("div",{key:0,class:et(["mb-8 p-4 rounded-lg border",n.themeClasses.accentBorder])},[A[5]||(A[5]=N("h3",{class:"text-xl font-bold mb-4"},"Composite Faction Dominance (Percentage)",-1)),N("div",TD,[A[4]||(A[4]=N("h4",{class:"text-lg font-semibold mb-4"},"Total Weighted Dominance (Prestige 3x, Tier Sum 2x, Count 1x)",-1)),qe(k,{data:E.value,options:{scales:{x:{beginAtZero:!0,max:100,stacked:!0,title:{display:!0,text:"Percentage Dominance (%)"}},y:{stacked:!0}},responsive:!0,maintainAspectRatio:!1,height:"100px",indexAxis:"y",plugins:{tooltip:{callbacks:{label:R=>R.dataset.label+": "+R.parsed.x.toFixed(2)+"%"}},legend:{position:"bottom"}}}},null,8,["data","options"])]),A[6]||(A[6]=N("p",{class:"text-xs mt-4 text-gray-400"}," *Dominance is calculated based on a composite score: (Prestige x3) + (Tier Sum x2) + (Scholar Count x1). Data reflects the current filters applied. ",-1))],2)):ye("",!0),N("div",{class:et(["flex flex-wrap gap-4 mb-6 p-4 rounded-lg border",n.themeClasses.accentBorder])},[N("div",ED,[A[8]||(A[8]=N("label",{for:"filter-faction",class:"font-bold text-sm"},"Faction:",-1)),ho(N("select",{id:"filter-faction","onUpdate:modelValue":A[0]||(A[0]=R=>l.value=R),class:et(["p-2 rounded-md shadow-inner text-sm",["bg-gray-800",n.themeClasses.primaryText,n.themeClasses.accentBorder]])},A[7]||(A[7]=[N("option",{value:""},"All Factions",-1),N("option",{value:"Lumen"},"Lumen",-1),N("option",{value:"Umbra"},"Umbra",-1)]),2),[[Ja,l.value]])]),N("div",ID,[A[10]||(A[10]=N("label",{for:"filter-specialty",class:"font-bold text-sm"},"Specialty:",-1)),ho(N("select",{id:"filter-specialty","onUpdate:modelValue":A[1]||(A[1]=R=>c.value=R),class:et(["p-2 rounded-md shadow-inner text-sm",["bg-gray-800",n.themeClasses.primaryText,n.themeClasses.accentBorder]])},A[9]||(A[9]=[N("option",{value:""},"All Specialties",-1),N("option",{value:"Arcane"},"Arcane",-1),N("option",{value:"Alchemist"},"Alchemist",-1)]),2),[[Ja,c.value]])]),N("div",AD,[A[12]||(A[12]=N("label",{for:"filter-location",class:"font-bold text-sm"},"Location:",-1)),ho(N("select",{id:"filter-location","onUpdate:modelValue":A[2]||(A[2]=R=>h.value=R),class:et(["p-2 rounded-md shadow-inner text-sm",["bg-gray-800",n.themeClasses.primaryText,n.themeClasses.accentBorder]])},A[11]||(A[11]=[ug('<option value="" data-v-2b87b89f>All Locations</option><option value="Aethelgard" data-v-2b87b89f>Aethelgard</option><option value="The Shadow Wastes" data-v-2b87b89f>The Shadow Wastes</option><option value="Great Library" data-v-2b87b89f>Great Library</option><option value="The Citadel" data-v-2b87b89f>The Citadel</option><option value="Hidden Village" data-v-2b87b89f>Hidden Village</option>',6)]),2),[[Ja,h.value]])]),N("div",SD,[A[14]||(A[14]=N("label",{for:"sort-by",class:"font-bold text-sm"},"Sort By:",-1)),ho(N("select",{id:"sort-by","onUpdate:modelValue":A[3]||(A[3]=R=>d.value=R),class:et(["p-2 rounded-md shadow-inner text-sm",["bg-gray-800",n.themeClasses.primaryText,n.themeClasses.accentBorder]])},A[13]||(A[13]=[ug('<option value="prestige" data-v-2b87b89f>Prestige (Default)</option><option value="currentTierIndex" data-v-2b87b89f>Tier</option><option value="name" data-v-2b87b89f>Name</option><option value="faction" data-v-2b87b89f>Faction</option><option value="specialty" data-v-2b87b89f>Specialty</option><option value="location" data-v-2b87b89f>Location</option>',6)]),2),[[Ja,d.value]])]),N("button",{onClick:_,class:et(["py-2 px-3 rounded-md text-sm font-bold shadow-md transition duration-200",[f.value==="desc"?"bg-red-700 hover:bg-red-600":"bg-green-700 hover:bg-green-600","text-white"]])}," Sort: "+xt(f.value==="desc"?"High to Low (⬇️)":"Low to High (⬆️)"),3)],2),o.value?(nt(),ht("div",CD,"Loading global rankings...")):a.value?(nt(),ht("div",PD,"Error fetching rankings: "+xt(a.value),1)):y.value.length===0?(nt(),ht("div",RD," No scholars found matching the current filters. ")):(nt(),ht("div",kD,[N("table",DD,[N("thead",{class:et(["bg-violet-900/70",n.themeClasses.primaryText])},A[15]||(A[15]=[N("tr",null,[N("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider"},"#"),N("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider"},"Name"),N("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider"},"Prestige"),N("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider"},"Tier"),N("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider"},"Faction"),N("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider"},"Specialty"),N("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider"},"Location"),N("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider"},"Owner ID")],-1)]),2),N("tbody",MD,[(nt(!0),ht(rn,null,Dc(y.value,(R,L)=>(nt(),ht("tr",{key:R.id,class:"transition duration-150 ease-in-out hover:bg-gray-800"},[N("td",OD,xt(L+1),1),N("td",LD,xt(R.name),1),N("td",VD,xt(R.prestige),1),N("td",ND,xt((R.currentTierIndex||0)+1),1),N("td",FD,xt(R.faction),1),N("td",BD,xt(R.specialty),1),N("td",UD,xt(R.location||"Unknown"),1),N("td",$D,xt(R.userId),1)]))),128))])])]))],2)}}},jD=Is(zD,[["__scopeId","data-v-2b87b89f"]]),HD={class:"flex items-center space-x-4"},WD={class:"text-lg"},qD={class:"font-bold text-yellow-100 text-2xl"},GD={class:"text-lg"},KD={class:"font-bold text-yellow-100 text-2xl"},YD={class:"text-lg"},XD={class:"font-bold text-yellow-100 text-2xl"},QD=["disabled"],JD={class:"flex flex-1 overflow-hidden"},ZD=["title"],tM=["onClick"],eM=["title"],nM={key:0,class:"whitespace-nowrap overflow-hidden"},sM={__name:"MainGameComponent",props:{userId:{type:String,required:!0},characterId:{type:String,required:!0}},emits:["returnToCharacterSelect"],setup(n,{emit:t}){const e=n,s=t,i=Rt(0),r=Rt(0),o=Rt({name:"",faction:"",specialty:"",prestige:0,location:""}),a=Rt([]),l=Rt("sanctum"),c=Rt(!1),h=Rt(!1),d=Rt(0),f=Rt(0),g=Wi(),_=$r(),y=typeof __app_id<"u"?__app_id:"default-app-id",w=lt=>{if(lt==null)return"0.00";lt=Number(lt);const it=[{value:1e12,symbol:"T"},{value:1e9,symbol:"B"},{value:1e6,symbol:"M"},{value:1e3,symbol:"K"}];for(let q=0;q<it.length;q++){const{value:Z,symbol:Ft}=it[q];if(Math.abs(lt)>=Z){const St=lt/Z;let At;return St<10?At=St.toFixed(2):St<100?At=St.toFixed(1):At=Math.floor(St).toString(),At=At.replace(/\.00$/,"").replace(/(\.\d)0$/,"$1"),At+Ft}}return lt.toFixed(2)},E=hs(()=>{const{faction:lt,specialty:it}=o.value;let q="bg-gray-950",Z="text-yellow-300",Ft="bg-violet-900",St="border-yellow-600",At="bg-violet-950",ue="bg-green-800";return lt==="Lumen"?it==="Arcane"?(q="bg-white",Z="text-blue-900",Ft="bg-amber-500",St="border-blue-500",At="bg-blue-50",ue="bg-blue-300"):it==="Alchemist"?(q="bg-gray-50",Z="text-green-900",Ft="bg-lime-600",St="border-green-700",At="bg-lime-50",ue="bg-lime-300"):(q="bg-gray-100",Z="text-gray-800",Ft="bg-amber-500",St="border-amber-700",At="bg-amber-100",ue="bg-amber-300"):lt==="Umbra"&&(it==="Arcane"?(q="bg-black",Z="text-lime-400",Ft="bg-purple-950",St="border-lime-500",At="bg-purple-900",ue="bg-lime-700"):it==="Alchemist"&&(q="bg-red-950",Z="text-red-300",Ft="bg-red-800",St="border-red-600",At="bg-red-900",ue="bg-red-700")),{primaryBg:q,primaryText:Z,headerBg:Ft,accentBorder:St,sidebarBg:At,activeMenuBg:ue}}),S=()=>{h.value=!h.value},A=hs(()=>1+o.value.prestige*.005),k=lt=>{const{faction:it,specialty:q}=o.value;let Z=["Novice Whispers","Apprentice Glyphs","Adept's Tomes","Mystic Runes","Etheric Weavings","Celestial Charts","Planar Bindings","Chronomancer's Texts","Abjurer's Wards","Transmuter's Circles","Grandmaster's Codex","Archmage's Grimoire","Aetheric Formulas","Cosmic Inscriptions","Reality Equations","Void Manuscripts","Primordial Truths","Ascendant Doctrines","God-Hand Schematics","Nexus of All Knowledge"];return it==="Lumen"?q==="Arcane"?Z=["Solar Inscriptions","Starfire Studies","Aetheric Lumina","Ascendant Cantrips","Chalice of Radiance","Empyrean Scrolls","Divine Geometry","Sunsong Orbs","Sanctified Wards","Radiant Transcriptions","The Holy Codex","High Archon's Primer","Light-Form Formulas","Cosmic Alignment","Edicts of Truth","Ethereal Scripts","Primal Genesis","Edicts of the Source","Schema of Creation","Heart of the Cosmos"]:q==="Alchemist"&&(Z=["Bright Concoctions","Verdant Formulas","Golden Retorts","Elixirs of Life","Vials of Purity","Reagent Catalysts","Alchemical Transmutations","Crystals of Growth","Stable Solutions","The Great Work","Philosopher's Stone","Magnum Opus","Homunculus Formulas","Symphony of Elements","Apothecary's Vault","True Essences","Materia Prima","The Unbreakable Bond","Perfect Synthesis","Wellspring of Vitality"]):it==="Umbra"&&(q==="Arcane"?Z=["Shadowed Whispers","Nocturnal Glyphs","Voidweaver Texts","Ebon Incantations","Sepulchral Weavings","Forbidden Scrolls","The Black Geometry","Moonshard Orbs","Cursed Wards","Malefic Transcriptions","The Shadow Codex","Necromancer's Grimoire","Dark Matter Formulas","Cosmic Discord","Equations of Decay","Void Manuscripts","Primal Entropy","Doctrines of the End","Schema of Annihilation","Heart of the Void"]:q==="Alchemist"&&(Z=["Crimson Brews","Corrupted Essences","Blackened Crucibles","Tinctures of Dread","Sanguine Phials","Venomous Catalysts","Vile Transmutations","Crystals of Stasis","Unstable Solutions","The Lesser Work","Blood Stone","Abyss Opus","Gargoyle Formulas","Dissonant Elements","Poisoner's Vault","Dark Essences","Materia Tenebrae","The Broken Bond","Failed Synthesis","Wellspring of Pestilence"])),Z[lt]||`Esoteric Tier ${lt+1}`},R=()=>{const{faction:lt,specialty:it}=o.value;let q=["Conduits","Scrolls","Crystals","Orbs"];return lt==="Lumen"?it==="Arcane"?q=["Light Channels","Sunstone Tablets","Prismatic Focus","Aether Orbs"]:it==="Alchemist"&&(q=["Flow Regulators","Reagent Formulas","Growth Crystals","Stabilizing Orbs"]):lt==="Umbra"&&(it==="Arcane"?q=["Shadow Conduits","Ebon Runes","Void Shards","Lunar Orbs"]:it==="Alchemist"&&(q=["Corrupting Vents","Necrotic Pages","Binding Agents","Decay Orbs"])),q},L=()=>{const lt=[],it=R(),q=A.value;for(let Z=0;Z<20;Z++){const Ft=Math.pow(1.8,Z),St=Math.pow(10,Z),At=20+Z*20;lt.push({name:`Tier ${Z+1}: ${k(Z)}`,unlocked:Z===0,multipliers:it.map((ue,yn)=>({level:0,maxLevel:At,baseCost:(10+yn*40)*St,costMultiplier:1.15+Z*.01,baseEffect:(.1+yn*.4)*Ft*q,effectMultiplier:1.05+Z*.005,name:ue}))})}return lt},x=hs(()=>{let lt=0;return a.value.forEach(it=>{it.unlocked&&it.multipliers.forEach(q=>{q.level>0&&(lt+=q.baseEffect*Math.pow(q.effectMultiplier,q.level-1))})}),lt}),b=()=>{i.value+=x.value||1},T=(lt,it)=>{const q=a.value[lt]?.multipliers[it];return q?q.baseCost/A.value*Math.pow(q.costMultiplier,q.level):1/0},C=({tierIndex:lt,multiplierIndex:it})=>{const q=a.value[lt],Z=q?.multipliers[it];if(!Z||Z.level>=Z.maxLevel)return;const Ft=T(lt,it);i.value>=Ft&&(i.value-=Ft,Z.level+=1,Z.level===Z.maxLevel&&q.multipliers.every(At=>At.level===At.maxLevel)&&a.value[lt+1]&&(a.value[lt+1].unlocked=!0),I())},P=()=>{o.value.prestige,o.value.prestige+=1,o.value.prestige>0&&o.value.prestige%10===0&&(f.value+=1),i.value=0,r.value=0,d.value=0,a.value=L(),I(),console.log(`PRESTIGE UP! Level: ${o.value.prestige}. Skill Points: ${f.value}`)},M=()=>{const lt=a.value[d.value],it=a.value[d.value+1];!lt||!lt.multipliers.every(q=>q.level===q.maxLevel)||(it?a.value[d.value+1].unlocked&&(d.value+=1,I()):P())},I=async()=>{if(c.value=!0,!g.currentUser||!e.characterId)return;const lt=g.currentUser.uid,it=pn(_,`artifacts/${y}/users/${lt}/characters`,e.characterId),q=pn(_,`artifacts/${y}/public/data/leaderboard`,e.characterId),Z={knowledge:i.value,prestige:o.value.prestige,currentTierIndex:d.value,multiplierTiers:a.value.map(St=>({unlocked:St.unlocked,levels:St.multipliers.map(At=>At.level)})),skillPoints:f.value,lastSaved:Kt.now()},Ft={name:o.value.name,prestige:o.value.prestige,faction:o.value.faction,specialty:o.value.specialty,location:o.value.location,userId:lt,currentTierIndex:d.value,lastUpdated:Kt.now()};try{await sa(it,Z,{merge:!0}),await sa(q,Ft,{merge:!0})}catch(St){console.error("Error saving game progress:",St)}finally{c.value=!1}},yt=async()=>{if(!g.currentUser||!e.characterId)return;const lt=pn(_,`artifacts/${y}/users/${g.currentUser.uid}/characters`,e.characterId);try{const it=await J0(lt);if(it.exists()){const q=it.data();o.value.name=q.name||"Scholar",o.value.faction=q.faction||"",o.value.specialty=q.specialty||"",o.value.prestige=q.prestige||0,o.value.location=q.location||"",f.value=q.skillPoints||0,d.value=q.currentTierIndex||0;const Z=L();q.multiplierTiers&&q.multiplierTiers.forEach((St,At)=>{Z[At]&&(Z[At].unlocked=St.unlocked,St.levels.forEach((ue,yn)=>{Z[At].multipliers[yn]&&(Z[At].multipliers[yn].level=ue)}))}),a.value=Z;const Ft=q.knowledge||0;if(q.lastSaved&&x.value>0){const St=(new Date().getTime()-q.lastSaved.toDate().getTime())/1e3;i.value=St>0?Ft+St*x.value:Ft}else i.value=Ft;r.value=i.value}else a.value=L(),i.value=0,r.value=0,d.value=0,f.value=0}catch(it){console.error("Error loading game progress:",it),a.value=L()}};let st=null;Po(i,lt=>{st&&cancelAnimationFrame(st);const it=()=>{const q=lt-r.value,Z=q/20;Math.abs(q)<.01?(r.value=lt,st=null):(r.value+=Z,st=requestAnimationFrame(it))};it()});const mt=async()=>{await I(),await g.signOut()},ot=async()=>{await I(),s("returnToCharacterSelect")};let at=null;kr(()=>{yt(),at=setInterval(()=>{x.value>0&&(i.value+=x.value)},1e3)}),kc(async()=>{at&&clearInterval(at),st&&cancelAnimationFrame(st),await I()});const Bt=[{id:"sanctum",name:"Sanctum / Home",icon:"🏠"},{id:"research",name:"Research",icon:"🔬"},{id:"expeditions",name:"Expeditions",icon:"🗺️"},{id:"inventory",name:"Inventory",icon:"🧰"},{id:"skill-tree",name:"Skill Tree",icon:"🌳"},{id:"classification",name:"Classification",icon:"📜"}];return(lt,it)=>(nt(),ht("div",{class:et([E.value.primaryBg,E.value.primaryText,"flex flex-col h-screen w-full font-sans overflow-hidden"])},[N("header",{class:et([E.value.headerBg,"shadow-lg border-b",E.value.accentBorder,"flex items-center justify-between p-4"])},[it[3]||(it[3]=N("h1",{class:"text-3xl font-serif text-yellow-100 tracking-wide"},"The Arcane Scholar’s Legacy",-1)),N("div",HD,[N("span",WD,[it[0]||(it[0]=Ln("Prestige: ",-1)),N("span",qD,xt(o.value.prestige),1)]),N("span",GD,[it[1]||(it[1]=Ln("Skill Points: ",-1)),N("span",KD,xt(f.value),1)]),N("span",YD,[it[2]||(it[2]=Ln("Knowledge: ",-1)),N("span",XD,xt(w(r.value)),1)]),N("button",{onClick:I,disabled:c.value,class:"bg-blue-700 hover:bg-blue-800 text-white font-bold py-2 px-4 rounded-lg shadow-md transition duration-300 ease-in-out disabled:opacity-50 disabled:cursor-not-allowed"},xt(c.value?"Saving...":"Save Progress"),9,QD),N("button",{onClick:ot,class:"bg-gray-700 hover:bg-gray-800 text-white font-bold py-2 px-4 rounded-lg shadow-md transition duration-300 ease-in-out"}," Back to Characters "),N("button",{onClick:mt,class:"bg-red-700 hover:bg-red-800 text-white font-bold py-2 px-4 rounded-lg shadow-md transition duration-300 ease-in-out"}," Log Out ")])],2),N("div",JD,[N("nav",{class:et([E.value.sidebarBg,"transition-all duration-300 p-4 border-r",E.value.accentBorder,"flex flex-col space-y-3",h.value?"w-20":"w-1/5 min-w-[180px]"])},[N("div",{class:et(["flex items-center",h.value?"justify-center":"justify-between"])},[N("h3",{class:et(["text-xl font-serif text-yellow-100 pb-2 mb-4 transition-opacity border-b",E.value.accentBorder,h.value?"opacity-0 h-0 p-0 overflow-hidden":"opacity-100"])}," Sanctum Menu ",2),N("button",{onClick:S,class:et(["p-2 rounded-full hover:opacity-80 transition duration-150 flex-shrink-0",E.value.primaryText]),title:h.value?"Expand Menu":"Collapse Menu"},[(nt(),ht("svg",{xmlns:"http://www.w3.org/2000/svg",class:et(["w-6 h-6 transform transition-transform duration-300",h.value?"rotate-180":""]),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},it[4]||(it[4]=[N("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M11 19l-7-7 7-7m8 14l-7-7 7-7"},null,-1)]),2))],10,ZD)],2),(nt(),ht(rn,null,Dc(Bt,q=>N("button",{key:q.id,onClick:Z=>l.value=q.id,class:et(["text-left py-2 rounded-lg transition duration-200 ease-in-out flex items-center",l.value===q.id?[E.value.activeMenuBg,E.value.primaryText,"shadow-inner"]:"hover:opacity-80",E.value.primaryText,h.value?"justify-center px-0":"px-4 space-x-3"])},[N("span",{class:et(["text-2xl flex-shrink-0",h.value?"mx-auto":""]),title:h.value?q.name:""},xt(q.icon),11,eM),h.value?ye("",!0):(nt(),ht("span",nM,xt(q.name),1))],10,tM)),64))],2),N("main",{class:et(["flex-1 p-6 overflow-y-auto custom-scrollbar",E.value.primaryBg])},[l.value==="sanctum"?(nt(),wn(pD,{key:0,knowledge:i.value,multiplierTiers:a.value,passiveKnowledgeGain:x.value,characterDetails:o.value,"theme-classes":E.value,currentTierIndex:d.value,onGenerateKnowledge:b,onBuyMultiplier:C,onAdvanceTier:M},null,8,["knowledge","multiplierTiers","passiveKnowledgeGain","characterDetails","theme-classes","currentTierIndex"])):l.value==="research"?(nt(),wn(mD,{key:1,"theme-classes":E.value},null,8,["theme-classes"])):l.value==="expeditions"?(nt(),wn(yD,{key:2,"theme-classes":E.value},null,8,["theme-classes"])):l.value==="inventory"?(nt(),wn(vD,{key:3,"theme-classes":E.value},null,8,["theme-classes"])):l.value==="skill-tree"?(nt(),wn(xD,{key:4,"theme-classes":E.value},null,8,["theme-classes"])):l.value==="classification"?(nt(),wn(jD,{key:5,"theme-classes":E.value},null,8,["theme-classes"])):ye("",!0)],2)])],2))}},iM=Is(sM,[["__scopeId","data-v-87429441"]]),rM={id:"app"},oM={key:0,class:"flex items-center justify-center h-screen w-full bg-gray-950 text-yellow-300 text-3xl font-serif"},aM={key:1},lM={__name:"App",setup(n){const t=Wi();$r();const e=Rt(null),s=Rt(!1),i=Rt(null),r=Rt("loading");kr(()=>{cv(t,h=>{e.value=h,s.value=!0,console.log("App.vue: Auth state changed. User:",h?h.uid:"None"),console.log("App.vue: Is app ready?",s.value)})}),Po([e,s,i],([h,d,f])=>{d&&(h?f?r.value="game":r.value="characterSelection":r.value="login")});const o=h=>{i.value=h,r.value="game",console.log("App.vue: Character selected with ID:",h)},a=()=>{r.value="characterCreation",console.log("App.vue: Starting new character creation. `currentView` is now:",r.value)},l=h=>{i.value=h,r.value="game",console.log("App.vue: New character created with ID:",h)},c=()=>{i.value=null,r.value="characterSelection",console.log("App.vue: Returning to character selection.")};return(h,d)=>(nt(),ht("div",rM,[s.value?(nt(),ht("div",aM,[r.value==="login"?(nt(),wn(pk,{key:0})):r.value==="characterSelection"?(nt(),wn(eD,{key:`selection-${e.value.uid}`,onCharacterSelected:o,onStartNewCharacterCreation:a})):r.value==="characterCreation"?(nt(),wn(Vk,{key:`creation-${e.value.uid}`,onCharacterCreated:l,onReturnToSelect:c})):r.value==="game"?(nt(),wn(iM,{key:`game-${i.value}`,userId:e.value.uid,characterId:i.value,onReturnToCharacterSelect:c},null,8,["userId","characterId"])):ye("",!0)])):(nt(),ht("div",oM," Loading... "))]))}};/*!
 * Chartkick.js v5.0.1
 * Create beautiful charts with one line of JavaScript
 * https://github.com/ankane/chartkick.js
 * MIT License
 */function Qs(n){return Object.prototype.toString.call(n)==="[object Array]"}function Af(n){return n instanceof Function}function Ml(n){return Object.prototype.toString.call(n)==="[object Object]"&&!Af(n)&&n instanceof Object}function Qh(n,t){for(var e in t)e!=="__proto__"&&(Ml(t[e])||Qs(t[e])?(Ml(t[e])&&!Ml(n[e])&&(n[e]={}),Qs(t[e])&&!Qs(n[e])&&(n[e]=[]),Qh(n[e],t[e])):t[e]!==void 0&&(n[e]=t[e]))}function se(n,t){var e={};return Qh(e,n),Qh(e,t),e}var cM=/^(\d\d\d\d)(?:-)?(\d\d)(?:-)?(\d\d)$/i;function uM(n){for(var t=0;t<n.length;t++)for(var e=n[t].data,s=0;s<e.length;s++)if(e[s][1]<0)return!0;return!1}function xs(n){return""+n}function zn(n){return parseFloat(n)}function On(n){if(n instanceof Date)return n;if(typeof n=="number")return new Date(n*1e3);var t=xs(n),e=t.match(cM);if(e){var s=parseInt(e[1],10),i=parseInt(e[2],10)-1,r=parseInt(e[3],10);return new Date(s,i,r)}else{var o=t.replace(/ /,"T").replace(" ","").replace("UTC","Z");return new Date(Date.parse(o)||t)}}function Sf(n){if(Qs(n))return n;var t=[];for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&t.push([e,n[e]]);return t}function Ca(n,t,e,s,i,r,o,a){return function(l,c,h){var d=l.data,f=se({},n);return f=se(f,h||{}),(l.singleSeriesFormat||"legend"in c)&&t(f,c.legend,l.singleSeriesFormat),c.title&&e(f,c.title),"min"in c?s(f,c.min):uM(d)||s(f,0),c.max&&i(f,c.max),"stacked"in c&&r(f,c.stacked),c.colors&&(f.colors=c.colors),c.xtitle&&o(f,c.xtitle),c.ytitle&&a(f,c.ytitle),f=se(f,c.library||{}),f}}function hM(n,t){return n[0].getTime()-t[0].getTime()}function Cf(n,t){return n[0]-t[0]}function ew(n,t){return n-t}function er(n,t){for(var e=0;e<n.length;e++)if(!t(n[e]))return!1;return!0}function dM(n){return n==="day"||n==="week"||n==="month"||n==="year"}function nw(n,t){if(t===void 0&&(t=!1),n.length===0)return null;var e=er(n,function(c){return c.getMilliseconds()===0&&c.getSeconds()===0});if(!e)return null;var s=er(n,function(c){return c.getMinutes()===0});if(!s)return"minute";var i=er(n,function(c){return c.getHours()===0});if(!i)return"hour";if(t)return"day";var r=er(n,function(c){return c.getDate()===1});if(!r){var o=n[0].getDay(),a=er(n,function(c){return c.getDay()===o});return a?"week":"day"}var l=er(n,function(c){return c.getMonth()===0});return l?"year":"month"}function Xu(n){return!isNaN(On(n))&&xs(n).length>=6}function fM(n){return typeof n=="number"}var e_=["bytes","KB","MB","GB","TB","PB","EB"];function vn(n,t,e,s){n=n||"",e.prefix&&(t<0&&(t=t*-1,n+="-"),n+=e.prefix);var i=e.suffix||"",r=e.precision,o=e.round;if(e.byteScale){var a=t>=0;a||(t*=-1);var l=s?e.byteScale:t,c;l>=1152921504606847e3?(t/=1152921504606847e3,c=6):l>=0x4000000000000?(t/=0x4000000000000,c=5):l>=1099511627776?(t/=1099511627776,c=4):l>=1073741824?(t/=1073741824,c=3):l>=1048576?(t/=1048576,c=2):l>=1024?(t/=1024,c=1):c=0,r===void 0&&o===void 0&&(t>=1023.5&&c<e_.length-1&&(t=1,c+=1),r=t>=1e3?4:3),i=" "+e_[c],a||(t*=-1)}if(r!==void 0&&o!==void 0)throw Error("Use either round or precision, not both");if(!s&&(r!==void 0&&(t=t.toPrecision(r),e.zeros||(t=parseFloat(t))),o!==void 0))if(o<0){var h=Math.pow(10,-1*o);t=parseInt((1*t/h).toFixed(0))*h}else t=t.toFixed(o),e.zeros||(t=parseFloat(t));if(e.thousands||e.decimal){t=xs(t);var d=t.split(".");t=d[0],e.thousands&&(t=t.replace(/\B(?=(\d{3})+(?!\d))/g,e.thousands)),d.length>1&&(t+=(e.decimal||".")+d[1])}return n+t+i}function n_(n,t,e){return e in t?t[e]:e in n.options?n.options[e]:null}var Pf={maintainAspectRatio:!1,animation:!1,plugins:{legend:{},tooltip:{displayColors:!1,callbacks:{}},title:{font:{size:20},color:"#333"}},interaction:{}},sw={scales:{y:{ticks:{maxTicksLimit:4},title:{font:{size:16},color:"#333"},grid:{}},x:{grid:{drawOnChartArea:!1},title:{font:{size:16},color:"#333"},time:{},ticks:{}}}},iw=["#3366CC","#DC3912","#FF9900","#109618","#990099","#3B3EAC","#0099C6","#DD4477","#66AA00","#B82E2E","#316395","#994499","#22AA99","#AAAA11","#6633CC","#E67300","#8B0707","#329262","#5574A6","#651067"];function Rf(n,t,e){t!==void 0?(n.plugins.legend.display=!!t,t&&t!==!0&&(n.plugins.legend.position=t)):e&&(n.plugins.legend.display=!1)}function kf(n,t){n.plugins.title.display=!0,n.plugins.title.text=t}function pM(n,t){t!==null&&(n.scales.y.min=zn(t))}function gM(n,t){n.scales.y.max=zn(t)}function mM(n,t){t!==null&&(n.scales.x.min=zn(t))}function _M(n,t){n.scales.x.max=zn(t)}function rw(n,t){n.scales.x.stacked=!!t,n.scales.y.stacked=!!t}function ow(n,t){n.scales.x.title.display=!0,n.scales.x.title.text=t}function aw(n,t){n.scales.y.title.display=!0,n.scales.y.title.text=t}function s_(n,t){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n);return e?"rgba("+parseInt(e[1],16)+", "+parseInt(e[2],16)+", "+parseInt(e[3],16)+", "+t+")":n}function Ms(n){return n!=null}function yM(n,t,e){var s=Math.ceil(n.element.offsetWidth/4/t.labels.length);s>25?s=25:s<10&&(s=10),e.scales.x.ticks.callback||(e.scales.x.ticks.callback=function(i){return i=xs(this.getLabelForValue(i)),i.length>s?i.substring(0,s-2)+"...":i})}function bM(n){for(var t=1,e=vM(n);e>=1024;)t*=1024,e/=1024;return t}function iu(n,t,e){var s={thousands:n.options.thousands,decimal:n.options.decimal},i=se({prefix:n.options.prefix,suffix:n.options.suffix,precision:n.options.precision,round:n.options.round,zeros:n.options.zeros},s);if(n.options.bytes){var r=n.data;e==="pie"&&(r=[{data:r}]),i.byteScale=bM(r)}if(e!=="pie"){var o=t.scales.y;e==="bar"&&(o=t.scales.x),i.byteScale&&(o.ticks.stepSize||(o.ticks.stepSize=i.byteScale/2),o.ticks.maxTicksLimit||(o.ticks.maxTicksLimit=4)),o.ticks.callback||(o.ticks.callback=function(l){return vn("",l,i,!0)}),(e==="scatter"||e==="bubble")&&!t.scales.x.ticks.callback&&(t.scales.x.ticks.callback=function(l){return vn("",l,s,!0)})}if(!t.plugins.tooltip.callbacks.label)if(e==="scatter")t.plugins.tooltip.callbacks.label=function(l){var c=l.dataset.label||"";c&&(c+=": ");var h=l.parsed;return c+"("+vn("",h.x,s)+", "+vn("",h.y,i)+")"};else if(e==="bubble")t.plugins.tooltip.callbacks.label=function(l){var c=l.dataset.label||"";c&&(c+=": ");var h=l.raw;return c+"("+vn("",h.x,s)+", "+vn("",h.y,i)+", "+vn("",h.v,s)+")"};else if(e==="pie")t.plugins.tooltip.callbacks.label=function(l){return vn("",l.parsed,i)};else{var a=e==="bar"?"x":"y";t.plugins.tooltip.callbacks.label=function(l){if(l.parsed[a]!==null){var c=l.dataset.label||"";return c&&(c+=": "),vn(c,l.parsed[a],i)}}}(e==="line"||e==="area")&&n.xtype==="number"&&(t.scales.x.ticks.callback||(t.scales.x.ticks.callback=function(l){return xs(l)}),t.plugins.tooltip.callbacks.title||(t.plugins.tooltip.callbacks.title=function(l){return xs(l[0].parsed.x)}))}function vM(n){for(var t=0,e=0;e<n.length;e++)for(var s=n[e].data,i=0;i<s.length;i++){var r=Math.abs(s[i][1]);r>t&&(t=r)}return t}function wM(n){for(var t=0,e=0;e<n.length;e++)for(var s=n[e].data,i=0;i<s.length;i++){var r=s[i][2];r>t&&(t=r)}return t}var Df=Ca(se(Pf,sw),Rf,kf,pM,gM,rw,ow,aw);function xM(n){for(var t=n.data,e={},s=[],i=[],r=[],o=0;o<t.length;o++)for(var a=t[o].data,l=0;l<a.length;l++){var c=a[l],h=n.xtype==="datetime"?c[0].getTime():c[0];e[h]||(e[h]=new Array(t.length),s.push(h)),e[h][o]=c[1]}(n.xtype==="datetime"||n.xtype==="number")&&s.sort(ew);for(var d=0;d<t.length;d++)r.push([]);for(var f=0;f<s.length;f++){var g=s[f],_=n.xtype==="datetime"?new Date(g):g;i.push(_);for(var y=e[g],w=0;w<t.length;w++){var E=y[w];r[w].push(E===void 0?null:E)}}return{labels:i,values:r}}function TM(n){for(var t=n.data,e=[],s=wM(t),i=0;i<t.length;i++){for(var r=t[i].data,o=[],a=0;a<r.length;a++){var l=r[a];o.push({x:l[0],y:l[1],r:l[2]*20/s,v:l[2]})}e.push(o)}return{labels:[],values:e}}function EM(n){for(var t=n.data,e=[],s=0;s<t.length;s++){var i=t[s].data;i.sort(Cf);for(var r=[],o=0;o<i.length;o++){var a=i[o];r.push({x:a[0],y:a[1]})}e.push(r)}return{labels:[],values:e}}function IM(n,t){return t==="bubble"?TM(n):n.xtype==="number"&&t!=="bar"&&t!=="column"?EM(n):xM(n)}function Mf(n,t,e){for(var s=IM(n,e),i=s.labels,r=s.values,o=n.data,a=[],l=n.options.colors||iw,c=0;c<o.length;c++){var h=o[c],d=void 0,f=void 0;if(n.options.colors&&n.singleSeriesFormat&&(e==="bar"||e==="column")&&!h.color&&Qs(n.options.colors)&&!Qs(n.options.colors[0])){d=l,f=[];for(var g=0;g<l.length;g++)f[g]=s_(d[g],.5)}else d=h.color||l[c],f=e!=="line"?s_(d,.5):d;var _={label:h.name||"",data:r[c],fill:e==="area",borderColor:d,backgroundColor:f,borderWidth:2},y=e==="line"||e==="area"||e==="scatter"||e==="bubble";y&&(_.pointBackgroundColor=d,_.pointHoverBackgroundColor=d,_.pointHitRadius=50),e==="bubble"&&(_.pointBackgroundColor=f,_.pointHoverBackgroundColor=f,_.pointHoverBorderWidth=2),h.stack&&(_.stack=h.stack);var w=n_(n,h,"curve");w===!1?_.tension=0:y&&(_.tension=.4);var E=n_(n,h,"points");E===!1&&(_.pointRadius=0,_.pointHoverRadius=0),_=se(_,n.options.dataset||{}),_=se(_,h.library||{}),_=se(_,h.dataset||{}),a.push(_)}var S=n.options.xmin,A=n.options.xmax;if(n.xtype==="datetime"?(Ms(S)&&(t.scales.x.min=On(S).getTime()),Ms(A)&&(t.scales.x.max=On(A).getTime())):n.xtype==="number"&&(Ms(S)&&(t.scales.x.min=S),Ms(A)&&(t.scales.x.max=A)),n.xtype==="datetime"){var k=nw(i);if(i.length===0&&(Ms(S)&&i.push(On(S)),Ms(A)&&i.push(On(A))),i.length>0){for(var R=(Ms(S)?On(S):i[0]).getTime(),L=(Ms(A)?On(A):i[0]).getTime(),x=1;x<i.length;x++){var b=i[x].getTime();b<R&&(R=b),b>L&&(L=b)}var T=(L-R)/(86400*1e3);if(!t.scales.x.time.unit){var C;if(k==="year"||T>365*10?(t.scales.x.time.unit="year",C=365):k==="month"||T>300?(t.scales.x.time.unit="month",C=30):k==="week"||k==="day"||T>10?(t.scales.x.time.unit="day",C=1):k==="hour"||T>.5?(t.scales.x.time.displayFormats={hour:"MMM d, h a"},t.scales.x.time.unit="hour",C=1/24):k==="minute"&&(t.scales.x.time.displayFormats={minute:"h:mm a"},t.scales.x.time.unit="minute",C=1/24/60),C&&T>0){var P=n.element.offsetWidth;if(P>0){var M=Math.ceil(T/C/(P/100));k==="week"&&C===1&&(M=Math.ceil(M/7)*7),t.scales.x.ticks.stepSize=M}}}t.scales.x.time.tooltipFormat||(k==="year"?t.scales.x.time.tooltipFormat="yyyy":k==="month"?t.scales.x.time.tooltipFormat="MMM yyyy":k==="week"||k==="day"?t.scales.x.time.tooltipFormat="PP":k==="hour"?t.scales.x.time.tooltipFormat="MMM d, h a":k==="minute"&&(t.scales.x.time.tooltipFormat="h:mm a"))}}return{labels:i,datasets:a}}var Kn=function(t){this.name="chartjs",this.library=t};Kn.prototype.renderLineChart=function(t,e){e||(e="line");var s={},i=Df(t,se(s,t.options));iu(t,i,e);var r=Mf(t,i,e);t.xtype==="number"?(i.scales.x.type=i.scales.x.type||"linear",i.scales.x.position=i.scales.x.position||"bottom"):i.scales.x.type=t.xtype==="string"?"category":"time",this.drawChart(t,"line",r,i)};Kn.prototype.renderPieChart=function(t){var e=se({},Pf);t.options.donut&&(e.cutout="50%"),"legend"in t.options&&Rf(e,t.options.legend),t.options.title&&kf(e,t.options.title),e=se(e,t.options.library||{}),iu(t,e,"pie");for(var s=[],i=[],r=0;r<t.data.length;r++){var o=t.data[r];s.push(o[0]),i.push(o[1])}var a={data:i,backgroundColor:t.options.colors||iw};a=se(a,t.options.dataset||{});var l={labels:s,datasets:[a]};this.drawChart(t,"pie",l,e)};Kn.prototype.renderColumnChart=function(t,e){var s;if(e==="bar"){var i=se(Pf,sw);i.indexAxis="y",i.scales.x.grid.drawOnChartArea=!0,i.scales.y.grid.drawOnChartArea=!1,delete i.scales.y.ticks.maxTicksLimit,s=Ca(i,Rf,kf,mM,_M,rw,ow,aw)(t,t.options)}else s=Df(t,t.options);iu(t,s,e);var r=Mf(t,s,"column");e!=="bar"&&yM(t,r,s),"mode"in s.interaction||(s.interaction.mode="index"),this.drawChart(t,"bar",r,s)};Kn.prototype.renderAreaChart=function(t){this.renderLineChart(t,"area")};Kn.prototype.renderBarChart=function(t){this.renderColumnChart(t,"bar")};Kn.prototype.renderScatterChart=function(t,e){e=e||"scatter";var s=Df(t,t.options);iu(t,s,e),"showLine"in s||(s.showLine=!1);var i=Mf(t,s,e);s.scales.x.type=s.scales.x.type||"linear",s.scales.x.position=s.scales.x.position||"bottom","mode"in s.interaction||(s.interaction.mode="nearest"),this.drawChart(t,e,i,s)};Kn.prototype.renderBubbleChart=function(t){this.renderScatterChart(t,"bubble")};Kn.prototype.destroy=function(t){t.chart&&t.chart.destroy()};Kn.prototype.drawChart=function(t,e,s,i){if(this.destroy(t),!t.destroyed){var r={type:e,data:s,options:i};t.options.code&&window.console.log("new Chart(ctx, "+JSON.stringify(r)+");"),t.element.innerHTML="<canvas></canvas>";var o=t.element.getElementsByTagName("CANVAS")[0];t.chart=new this.library(o,r)}};var lw={chart:{},xAxis:{title:{text:null},labels:{style:{fontSize:"12px"}}},yAxis:{title:{text:null},labels:{style:{fontSize:"12px"}}},title:{text:null},credits:{enabled:!1},legend:{borderWidth:0},tooltip:{style:{fontSize:"12px"}},plotOptions:{areaspline:{},area:{},series:{marker:{}}},time:{useUTC:!1}};function cw(n,t,e){t!==void 0?(n.legend.enabled=!!t,t&&t!==!0&&(t==="top"||t==="bottom"?n.legend.verticalAlign=t:(n.legend.layout="vertical",n.legend.verticalAlign="middle",n.legend.align=t))):e&&(n.legend.enabled=!1)}function uw(n,t){n.title.text=t}function AM(n,t){n.yAxis.min=t}function SM(n,t){n.yAxis.max=t}function CM(n,t){var e=t?t===!0?"normal":t:null;n.plotOptions.series.stacking=e,n.plotOptions.area.stacking=e,n.plotOptions.areaspline.stacking=e}function PM(n,t){n.xAxis.title.text=t}function RM(n,t){n.yAxis.title.text=t}var Of=Ca(lw,cw,uw,AM,SM,CM,PM,RM);function Lf(n,t,e){var s={prefix:n.options.prefix,suffix:n.options.suffix,thousands:n.options.thousands,decimal:n.options.decimal,precision:n.options.precision,round:n.options.round,zeros:n.options.zeros};e!=="pie"&&!Qs(t.yAxis)&&!t.yAxis.labels.formatter&&(t.yAxis.labels.formatter=function(){return vn("",this.value,s)}),!t.tooltip.pointFormatter&&!t.tooltip.pointFormat&&(t.tooltip.pointFormatter=function(){return'<span style="color:'+this.color+'">●</span> '+vn(this.series.name+": <b>",this.y,s)+"</b><br/>"})}var As=function(t){this.name="highcharts",this.library=t};As.prototype.renderLineChart=function(t,e){e=e||"spline";var s={};e==="areaspline"&&(s={plotOptions:{areaspline:{stacking:"normal"},area:{stacking:"normal"},series:{marker:{enabled:!1}}}}),t.options.curve===!1&&(e==="areaspline"?e="area":e==="spline"&&(e="line"));var i=Of(t,t.options,s);t.xtype==="number"?i.xAxis.type=i.xAxis.type||"linear":i.xAxis.type=t.xtype==="string"?"category":"datetime",i.chart.type||(i.chart.type=e),Lf(t,i,e);for(var r=t.data,o=0;o<r.length;o++){r[o].name=r[o].name||"Value";var a=r[o].data;if(t.xtype==="datetime")for(var l=0;l<a.length;l++)a[l][0]=a[l][0].getTime();else t.xtype==="number"&&a.sort(Cf);r[o].marker={symbol:"circle"},t.options.points===!1&&(r[o].marker.enabled=!1)}this.drawChart(t,r,i)};As.prototype.renderScatterChart=function(t){var e=Of(t,t.options,{});e.chart.type="scatter",this.drawChart(t,t.data,e)};As.prototype.renderPieChart=function(t){var e=se(lw,{});t.options.colors&&(e.colors=t.options.colors),t.options.donut&&(e.plotOptions={pie:{innerSize:"50%"}}),"legend"in t.options&&cw(e,t.options.legend),t.options.title&&uw(e,t.options.title);var s=se(e,t.options.library||{});Lf(t,s,"pie");var i=[{type:"pie",name:t.options.label||"Value",data:t.data}];this.drawChart(t,i,s)};As.prototype.renderColumnChart=function(t,e){e=e||"column";var s=t.data,i=Of(t,t.options),r=[],o=[];i.chart.type=e,Lf(t,i,e);for(var a=0;a<s.length;a++)for(var l=s[a],c=0;c<l.data.length;c++){var h=l.data[c];r[h[0]]||(r[h[0]]=new Array(s.length),o.push(h[0])),r[h[0]][a]=h[1]}t.xtype==="number"&&o.sort(ew),i.xAxis.categories=o;for(var d=[],f=0;f<s.length;f++){for(var g=[],_=0;_<o.length;_++)g.push(r[o[_]][f]||0);var y={name:s[f].name||"Value",data:g};s[f].stack&&(y.stack=s[f].stack),d.push(y)}this.drawChart(t,d,i)};As.prototype.renderBarChart=function(t){this.renderColumnChart(t,"bar")};As.prototype.renderAreaChart=function(t){this.renderLineChart(t,"areaspline")};As.prototype.destroy=function(t){t.chart&&t.chart.destroy()};As.prototype.drawChart=function(t,e,s){this.destroy(t),!t.destroyed&&(s.chart.renderTo=t.element.id,s.series=e,t.options.code&&window.console.log("new Highcharts.Chart("+JSON.stringify(s)+");"),t.chart=new this.library.Chart(s))};var i_={},Ol=[],Pa={chartArea:{},fontName:"'Lucida Grande', 'Lucida Sans Unicode', Verdana, Arial, Helvetica, sans-serif",pointSize:6,legend:{textStyle:{fontSize:12,color:"#444"},alignment:"center",position:"right"},curveType:"function",hAxis:{textStyle:{color:"#666",fontSize:12},titleTextStyle:{},gridlines:{color:"transparent"},baselineColor:"#ccc",viewWindow:{}},vAxis:{textStyle:{color:"#666",fontSize:12},titleTextStyle:{},baselineColor:"#ccc",viewWindow:{}},tooltip:{textStyle:{color:"#666",fontSize:12}}};function Vf(n,t,e){if(t!==void 0){var s;t?t===!0?s="right":s=t:s="none",n.legend.position=s}else e&&(n.legend.position="none")}function Nf(n,t){n.title=t,n.titleTextStyle={color:"#333",fontSize:"20px"}}function kM(n,t){n.vAxis.viewWindow.min=t}function DM(n,t){n.vAxis.viewWindow.max=t}function MM(n,t){n.hAxis.viewWindow.min=t}function OM(n,t){n.hAxis.viewWindow.max=t}function hw(n,t){n.isStacked=t||!1}function dw(n,t){n.hAxis.title=t,n.hAxis.titleTextStyle.italic=!1}function fw(n,t){n.vAxis.title=t,n.vAxis.titleTextStyle.italic=!1}var ru=Ca(Pa,Vf,Nf,kM,DM,hw,dw,fw);function LM(n){window.attachEvent?window.attachEvent("onresize",n):window.addEventListener&&window.addEventListener("resize",n,!0),n()}var tn=function(t){this.name="google",this.library=t};tn.prototype.renderLineChart=function(t){var e=this;this.waitForLoaded(t,function(){var s={};t.options.curve===!1&&(s.curveType="none"),t.options.points===!1&&(s.pointSize=0);var i=ru(t,t.options,s),r=e.createDataTable(t.data,t.xtype);e.drawChart(t,"LineChart",r,i)})};tn.prototype.renderPieChart=function(t){var e=this;this.waitForLoaded(t,function(){var s={chartArea:{top:"10%",height:"80%"},legend:{}};t.options.colors&&(s.colors=t.options.colors),t.options.donut&&(s.pieHole=.5),"legend"in t.options&&Vf(s,t.options.legend),t.options.title&&Nf(s,t.options.title);var i=se(se(Pa,s),t.options.library||{}),r=new e.library.visualization.DataTable;r.addColumn("string",""),r.addColumn("number","Value"),r.addRows(t.data),e.drawChart(t,"PieChart",r,i)})};tn.prototype.renderColumnChart=function(t){var e=this;this.waitForLoaded(t,function(){var s=ru(t,t.options),i=e.createDataTable(t.data,t.xtype);e.drawChart(t,"ColumnChart",i,s)})};tn.prototype.renderBarChart=function(t){var e=this;this.waitForLoaded(t,function(){var s={hAxis:{gridlines:{color:"#ccc"}}},i=Ca(Pa,Vf,Nf,MM,OM,hw,dw,fw)(t,t.options,s),r=e.createDataTable(t.data,t.xtype);e.drawChart(t,"BarChart",r,i)})};tn.prototype.renderAreaChart=function(t){var e=this;this.waitForLoaded(t,function(){var s={isStacked:!0,pointSize:0,areaOpacity:.5},i=ru(t,t.options,s),r=e.createDataTable(t.data,t.xtype);e.drawChart(t,"AreaChart",r,i)})};tn.prototype.renderGeoChart=function(t){var e=this;this.waitForLoaded(t,"geochart",function(){var s={legend:"none",colorAxis:{colors:t.options.colors||["#f6c7b6","#ce502d"]}},i=se(se(Pa,s),t.options.library||{}),r=new e.library.visualization.DataTable;r.addColumn("string",""),r.addColumn("number",t.options.label||"Value"),r.addRows(t.data),e.drawChart(t,"GeoChart",r,i)})};tn.prototype.renderScatterChart=function(t){var e=this;this.waitForLoaded(t,function(){for(var s={},i=ru(t,t.options,s),r=t.data,o=[],a=0;a<r.length;a++){r[a].name=r[a].name||"Value";for(var l=r[a].data,c=0;c<l.length;c++){var h=new Array(r.length+1);h[0]=l[c][0],h[a+1]=l[c][1],o.push(h)}}var d=new e.library.visualization.DataTable;d.addColumn("number","");for(var f=0;f<r.length;f++)d.addColumn("number",r[f].name);d.addRows(o),e.drawChart(t,"ScatterChart",d,i)})};tn.prototype.renderTimeline=function(t){var e=this;this.waitForLoaded(t,"timeline",function(){var s={legend:"none"};t.options.colors&&(s.colors=t.options.colors);var i=se(se(Pa,s),t.options.library||{}),r=new e.library.visualization.DataTable;r.addColumn({type:"string",id:"Name"}),r.addColumn({type:"date",id:"Start"}),r.addColumn({type:"date",id:"End"}),r.addRows(t.data),t.element.style.lineHeight="normal",e.drawChart(t,"Timeline",r,i)})};tn.prototype.destroy=function(t){t.chart&&t.chart.clearChart()};tn.prototype.drawChart=function(t,e,s,i){this.destroy(t),!t.destroyed&&(t.options.code&&window.console.log("var data = new google.visualization.DataTable("+s.toJSON()+`);
var chart = new google.visualization.`+e+`(element);
chart.draw(data, `+JSON.stringify(i)+");"),t.chart=new this.library.visualization[e](t.element),LM(function(){t.chart.draw(s,i)}))};tn.prototype.waitForLoaded=function(t,e,s){var i=this;if(s||(s=e,e="corechart"),Ol.push({pack:e,callback:s}),i_[e])this.runCallbacks();else{i_[e]=!0;var r={packages:[e],callback:function(){i.runCallbacks()}},o=t.__config();o.language&&(r.language=o.language),e==="geochart"&&o.mapsApiKey&&(r.mapsApiKey=o.mapsApiKey),this.library.charts.load("current",r)}};tn.prototype.runCallbacks=function(){for(var t=0;t<Ol.length;t++){var e=Ol[t],s=this.library.visualization&&(e.pack==="corechart"&&this.library.visualization.LineChart||e.pack==="timeline"&&this.library.visualization.Timeline||e.pack==="geochart"&&this.library.visualization.GeoChart);s&&(e.callback(),Ol.splice(t,1),t--)}};tn.prototype.createDataTable=function(t,e){for(var s=[],i=[],r=0;r<t.length;r++){var o=t[r];t[r].name=t[r].name||"Value";for(var a=0;a<o.data.length;a++){var l=o.data[a],c=e==="datetime"?l[0].getTime():l[0];s[c]||(s[c]=new Array(t.length),i.push(c)),s[c][r]=l[1]}}for(var h=[],d=[],f=0;f<i.length;f++){var g=i[f],_=void 0;e==="datetime"?(_=new Date(g),d.push(_)):_=g,h.push([_].concat(s[g]))}var y=!0;if(e==="datetime"){h.sort(hM);var w=nw(d,!0);y=dM(w)}else if(e==="number"){h.sort(Cf);for(var E=0;E<h.length;E++)h[E][0]=xs(h[E][0]);e="string"}var S=new this.library.visualization.DataTable;e=e==="datetime"&&y?"date":e,S.addColumn(e,"");for(var A=0;A<t.length;A++)S.addColumn("number",t[A].name);return S.addRows(h),S};var Oi=[];function VM(n){if(n){if(n.product==="Highcharts")return As;if(n.charts)return tn;if(Af(n))return Kn}throw new Error("Unknown adapter")}function No(n){for(var t=VM(n),e=0;e<Oi.length;e++)if(Oi[e].library===n)return;Oi.push(new t(n))}function NM(){"Chart"in window&&No(window.Chart),"Highcharts"in window&&No(window.Highcharts),window.google&&window.google.charts&&No(window.google)}function FM(n,t){var e="render"+n,s=t.options.adapter;NM();for(var i=0;i<Oi.length;i++){var r=Oi[i];if((!s||s===r.name)&&Af(r[e]))return t.adapter=r.name,t.__adapterObject=r,r[e](t)}throw Oi.length>0?new Error("No charting library found for "+n):new Error("No charting libraries found - be sure to include one before your charts")}var Et={charts:{},configure:function(n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(Et.config[t]=n[t])},setDefaultOptions:function(n){Et.options=n},eachChart:function(n){for(var t in Et.charts)Object.prototype.hasOwnProperty.call(Et.charts,t)&&n(Et.charts[t])},destroyAll:function(){for(var n in Et.charts)Object.prototype.hasOwnProperty.call(Et.charts,n)&&(Et.charts[n].destroy(),delete Et.charts[n])},config:{},options:{},adapters:Oi,addAdapter:No,use:function(n){return No(n),Et}};function BM(n){for(var t=[],e=0;e<n.length;e++)t.push([zn(n[e][0]),zn(n[e][1]),zn(n[e][2])]);return t}function UM(n,t){if(t==="bubble")return BM(n);var e;t==="number"?e=zn:t==="datetime"?e=On:e=xs;for(var s=[],i=0;i<n.length;i++)s.push([e(n[i][0]),zn(n[i][1])]);return s}function $M(n,t,e){return gw(n)?(e.xmin||e.xmax)&&(!e.xmin||Xu(e.xmin))&&(!e.xmax||Xu(e.xmax))?"datetime":"number":r_(n,fM)?"number":!t&&r_(n,Xu)?"datetime":"string"}function r_(n,t){for(var e=0;e<n.length;e++)for(var s=Sf(n[e].data),i=0;i<s.length;i++)if(!t(s[i][0]))return!1;return!0}function zM(n){for(var t=[],e=0;e<n.length;e++){var s={};for(var i in n[e])Object.prototype.hasOwnProperty.call(n[e],i)&&(s[i]=n[e][i]);t.push(s)}return t}function zr(n,t,e){var s=n.options,i=n.rawData;n.singleSeriesFormat=!Qs(i)||!Ml(i[0]),n.singleSeriesFormat&&(i=[{name:s.label,data:i}]),i=zM(i);for(var r=0;r<i.length;r++)i[r].data=Sf(i[r].data);n.xtype=t||(s.discrete?"string":$M(i,e,s));for(var o=0;o<i.length;o++)i[o].data=UM(i[o].data,n.xtype);return i}function pw(n){for(var t=Sf(n.rawData),e=0;e<t.length;e++)t[e]=[xs(t[e][0]),zn(t[e][1])];return t}function gw(n,t){if(t==="PieChart"||t==="GeoChart"||t==="Timeline")return n.length===0;for(var e=0;e<n.length;e++)if(n[e].data.length>0)return!1;return!0}function jM(n){var t=n.options.download;t===!0?t={}:typeof t=="string"&&(t={filename:t});var e=document.createElement("a");e.download=t.filename||"chart.png",e.style.position="absolute",e.style.top="20px",e.style.right="20px",e.style.zIndex=1e3,e.style.lineHeight="20px",e.target="_blank";var s=document.createElement("img"),i='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path fill="#CCCCCC" d="M344 240h-56L287.1 152c0-13.25-10.75-24-24-24h-16C234.7 128 223.1 138.8 223.1 152L224 240h-56c-9.531 0-18.16 5.656-22 14.38C142.2 263.1 143.9 273.3 150.4 280.3l88.75 96C243.7 381.2 250.1 384 256.8 384c7.781-.3125 13.25-2.875 17.75-7.844l87.25-96c6.406-7.031 8.031-17.19 4.188-25.88S353.5 240 344 240zM256 0C114.6 0 0 114.6 0 256s114.6 256 256 256s256-114.6 256-256S397.4 0 256 0zM256 464c-114.7 0-208-93.31-208-208S141.3 48 256 48s208 93.31 208 208S370.7 464 256 464z"/></svg>';s.src="data:image/svg+xml;utf8,"+encodeURIComponent(i),s.alt="Download",s.style.width="20px",s.style.height="20px",s.style.border="none",e.appendChild(s);var r=n.element;r.style.position="relative",n.__downloadAttached=!0,n.__enterEvent=r.addEventListener("mouseover",function(o){var a=o.relatedTarget;(!a||a!==this&&!this.contains(a))&&n.options.download&&(e.href=n.toImage(t),r.appendChild(e))}),n.__leaveEvent=r.addEventListener("mouseout",function(o){var a=o.relatedTarget;(!a||a!==this&&!this.contains(a))&&e.parentNode&&e.parentNode.removeChild(e)})}var mw=[],Jh=0,HM=4;function WM(n,t,e){mw.push([n,t,e]),Ff()}function Ff(){if(Jh<HM){var n=mw.shift();n&&(Jh++,GM(n[0],n[1],n[2]),Ff())}}function qM(){Jh--,Ff()}function GM(n,t,e){var s=new XMLHttpRequest;s.open("GET",n,!0),s.setRequestHeader("Content-Type","application/json"),s.onload=function(){qM(),s.status===200?t(JSON.parse(s.responseText)):e(s.statusText)},s.send()}function Bf(n,t){n.textContent=t}function Ll(n,t,e){e||(t="Error Loading Chart: "+t),Bf(n,t),n.style.color="#ff0000"}function Qu(n){try{n.__render()}catch(t){throw Ll(n.element,t.message),t}}function ia(n,t,e){if(e&&n.options.loading&&(typeof t=="string"||typeof t=="function")&&Bf(n.element,n.options.loading),typeof t=="string")WM(t,function(s){n.rawData=s,Qu(n)},function(s){Ll(n.element,s)});else if(typeof t=="function")try{t(function(s){n.rawData=s,Qu(n)},function(s){Ll(n.element,s,!0)})}catch(s){Ll(n.element,s,!0)}else n.rawData=t,Qu(n)}function KM(n,t){if(gw(t.data,n)){var e=t.options.empty||t.options.messages&&t.options.messages.empty||"No data";Bf(t.element,e)}else FM(n,t),t.options.download&&!t.__downloadAttached&&t.adapter==="chartjs"&&jM(t)}function YM(n){if(typeof n=="string"){var t=n;if(n=document.getElementById(n),!n)throw new Error("No element with id "+t)}return n}var Jt=function(t,e,s){this.element=YM(t),this.options=se(Et.options,s||{}),this.dataSource=e,this.element.id&&(Et.charts[this.element.id]=this),ia(this,e,!0),this.options.refresh&&this.startRefresh()};Jt.prototype.getElement=function(){return this.element};Jt.prototype.getDataSource=function(){return this.dataSource};Jt.prototype.getData=function(){return this.data};Jt.prototype.getOptions=function(){return this.options};Jt.prototype.getChartObject=function(){return this.chart};Jt.prototype.getAdapter=function(){return this.adapter};Jt.prototype.updateData=function(t,e){this.dataSource=t,e&&this.__updateOptions(e),ia(this,t,!0)};Jt.prototype.setOptions=function(t){this.__updateOptions(t),this.redraw()};Jt.prototype.redraw=function(){ia(this,this.rawData)};Jt.prototype.refreshData=function(){if(typeof this.dataSource=="string"){var t=this.dataSource.indexOf("?")===-1?"?":"&",e=this.dataSource+t+"_="+new Date().getTime();ia(this,e)}else typeof this.dataSource=="function"&&ia(this,this.dataSource)};Jt.prototype.startRefresh=function(){var t=this,e=this.options.refresh;if(e&&typeof this.dataSource!="string"&&typeof this.dataSource!="function")throw new Error("Data source must be a URL or callback for refresh");if(!this.intervalId)if(e)this.intervalId=setInterval(function(){t.refreshData()},e*1e3);else throw new Error("No refresh interval")};Jt.prototype.stopRefresh=function(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null)};Jt.prototype.toImage=function(t){if(this.adapter==="chartjs")if(t&&t.background&&t.background!=="transparent"){var e=this.chart.canvas,s=this.chart.ctx,i=document.createElement("canvas"),r=i.getContext("2d");return i.width=s.canvas.width,i.height=s.canvas.height,r.fillStyle=t.background,r.fillRect(0,0,i.width,i.height),r.drawImage(e,0,0),i.toDataURL("image/png")}else return this.chart.toBase64Image();else throw new Error("Feature only available for Chart.js")};Jt.prototype.destroy=function(){this.destroyed=!0,this.stopRefresh(),this.__adapterObject&&this.__adapterObject.destroy(this),this.__enterEvent&&this.element.removeEventListener("mouseover",this.__enterEvent),this.__leaveEvent&&this.element.removeEventListener("mouseout",this.__leaveEvent)};Jt.prototype.__updateOptions=function(t){var e=t.refresh&&t.refresh!==this.options.refresh;this.options=se(Et.options,t),e&&(this.stopRefresh(),this.startRefresh())};Jt.prototype.__render=function(){this.data=this.__processData(),KM(this.__chartName(),this)};Jt.prototype.__config=function(){return Et.config};var XM=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.__processData=function(){return zr(this)},t.prototype.__chartName=function(){return"LineChart"},t}(Jt),QM=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.__processData=function(){return pw(this)},t.prototype.__chartName=function(){return"PieChart"},t}(Jt),JM=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.__processData=function(){return zr(this,null,!0)},t.prototype.__chartName=function(){return"ColumnChart"},t}(Jt),ZM=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.__processData=function(){return zr(this,null,!0)},t.prototype.__chartName=function(){return"BarChart"},t}(Jt),t2=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.__processData=function(){return zr(this)},t.prototype.__chartName=function(){return"AreaChart"},t}(Jt),e2=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.__processData=function(){return pw(this)},t.prototype.__chartName=function(){return"GeoChart"},t}(Jt),n2=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.__processData=function(){return zr(this,"number")},t.prototype.__chartName=function(){return"ScatterChart"},t}(Jt),s2=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.__processData=function(){return zr(this,"bubble")},t.prototype.__chartName=function(){return"BubbleChart"},t}(Jt),i2=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.__processData=function(){for(var s=this.rawData,i=0;i<s.length;i++)s[i][1]=On(s[i][1]),s[i][2]=On(s[i][2]);return s},t.prototype.__chartName=function(){return"Timeline"},t}(Jt);Et.LineChart=XM;Et.PieChart=QM;Et.ColumnChart=JM;Et.BarChart=ZM;Et.AreaChart=t2;Et.GeoChart=e2;Et.ScatterChart=n2;Et.BubbleChart=s2;Et.Timeline=i2;typeof window<"u"&&!window.Chartkick&&(window.Chartkick=Et,document.addEventListener("turbolinks:before-render",function(){Et.config.autoDestroy!==!1&&Et.destroyAll()}),document.addEventListener("turbo:before-render",function(){Et.config.autoDestroy!==!1&&Et.destroyAll()}),setTimeout(function(){window.dispatchEvent(new Event("chartkick:load"))},0));Et.default=Et;/*!
 * Vue Chartkick
 * Create beautiful JavaScript charts with one line of Vue
 * https://github.com/ankane/vue-chartkick
 * v1.1.0
 * MIT License
 */var r2=1,Os=function(n,t,e){var s=["adapter","bytes","code","colors","curve","dataset","decimal","discrete","donut","download","empty","label","legend","library","loading","max","messages","min","points","precision","prefix","refresh","round","stacked","suffix","thousands","title","xmax","xmin","xtitle","ytitle","zeros"];n.component(t,{props:["data","id","width","height"].concat(s),render:function(){var i=this.chartOptions.loading!==void 0?this.chartOptions.loading:"Loading...";if(typeof i!="string")throw new Error("loading must be a string");return NE("div",{id:this.chartId,style:this.chartStyle},[i])},data:function(){return{chartId:null}},computed:{chartStyle:function(){return this.data,this.chartOptions,{height:this.height||"300px",lineHeight:this.height||"300px",width:this.width||"100%",textAlign:"center",color:"#999",fontSize:"14px",fontFamily:"'Lucida Grande', 'Lucida Sans Unicode', Verdana, Arial, Helvetica, sans-serif"}},chartOptions:function(){for(var i={},r=s,o=0;o<r.length;o++){var a=r[o];this[a]!==void 0&&(i[a]=this[a])}return i}},created:function(){this.chartId=this.chartId||this.id||"chart-"+r2++},mounted:function(){this.updateChart()},updated:function(){this.updateChart()},beforeUnmount:function(){this.chart&&this.chart.destroy()},methods:{updateChart:function(){this.data!==null?this.chart?this.chart.updateData(this.data,this.chartOptions):this.chart=new e(this.chartId,this.data,this.chartOptions):this.chart&&(this.chart.destroy(),this.chart=null,this.$el.innerText="Loading...")}}})};Et.install=function(n,t){t&&t.adapter&&Et.addAdapter(t.adapter),Os(n,"line-chart",Et.LineChart),Os(n,"pie-chart",Et.PieChart),Os(n,"column-chart",Et.ColumnChart),Os(n,"bar-chart",Et.BarChart),Os(n,"area-chart",Et.AreaChart),Os(n,"scatter-chart",Et.ScatterChart),Os(n,"geo-chart",Et.GeoChart),Os(n,"timeline",Et.Timeline)};/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function Ra(n){return n+.5|0}const $s=(n,t,e)=>Math.max(Math.min(n,e),t);function yo(n){return $s(Ra(n*2.55),0,255)}function Js(n){return $s(Ra(n*255),0,255)}function ns(n){return $s(Ra(n/2.55)/100,0,1)}function o_(n){return $s(Ra(n*100),0,100)}const dn={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Zh=[..."0123456789ABCDEF"],o2=n=>Zh[n&15],a2=n=>Zh[(n&240)>>4]+Zh[n&15],rl=n=>(n&240)>>4===(n&15),l2=n=>rl(n.r)&&rl(n.g)&&rl(n.b)&&rl(n.a);function c2(n){var t=n.length,e;return n[0]==="#"&&(t===4||t===5?e={r:255&dn[n[1]]*17,g:255&dn[n[2]]*17,b:255&dn[n[3]]*17,a:t===5?dn[n[4]]*17:255}:(t===7||t===9)&&(e={r:dn[n[1]]<<4|dn[n[2]],g:dn[n[3]]<<4|dn[n[4]],b:dn[n[5]]<<4|dn[n[6]],a:t===9?dn[n[7]]<<4|dn[n[8]]:255})),e}const u2=(n,t)=>n<255?t(n):"";function h2(n){var t=l2(n)?o2:a2;return n?"#"+t(n.r)+t(n.g)+t(n.b)+u2(n.a,t):void 0}const d2=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function _w(n,t,e){const s=t*Math.min(e,1-e),i=(r,o=(r+n/30)%12)=>e-s*Math.max(Math.min(o-3,9-o,1),-1);return[i(0),i(8),i(4)]}function f2(n,t,e){const s=(i,r=(i+n/60)%6)=>e-e*t*Math.max(Math.min(r,4-r,1),0);return[s(5),s(3),s(1)]}function p2(n,t,e){const s=_w(n,1,.5);let i;for(t+e>1&&(i=1/(t+e),t*=i,e*=i),i=0;i<3;i++)s[i]*=1-t-e,s[i]+=t;return s}function g2(n,t,e,s,i){return n===i?(t-e)/s+(t<e?6:0):t===i?(e-n)/s+2:(n-t)/s+4}function Uf(n){const e=n.r/255,s=n.g/255,i=n.b/255,r=Math.max(e,s,i),o=Math.min(e,s,i),a=(r+o)/2;let l,c,h;return r!==o&&(h=r-o,c=a>.5?h/(2-r-o):h/(r+o),l=g2(e,s,i,h,r),l=l*60+.5),[l|0,c||0,a]}function $f(n,t,e,s){return(Array.isArray(t)?n(t[0],t[1],t[2]):n(t,e,s)).map(Js)}function zf(n,t,e){return $f(_w,n,t,e)}function m2(n,t,e){return $f(p2,n,t,e)}function _2(n,t,e){return $f(f2,n,t,e)}function yw(n){return(n%360+360)%360}function y2(n){const t=d2.exec(n);let e=255,s;if(!t)return;t[5]!==s&&(e=t[6]?yo(+t[5]):Js(+t[5]));const i=yw(+t[2]),r=+t[3]/100,o=+t[4]/100;return t[1]==="hwb"?s=m2(i,r,o):t[1]==="hsv"?s=_2(i,r,o):s=zf(i,r,o),{r:s[0],g:s[1],b:s[2],a:e}}function b2(n,t){var e=Uf(n);e[0]=yw(e[0]+t),e=zf(e),n.r=e[0],n.g=e[1],n.b=e[2]}function v2(n){if(!n)return;const t=Uf(n),e=t[0],s=o_(t[1]),i=o_(t[2]);return n.a<255?`hsla(${e}, ${s}%, ${i}%, ${ns(n.a)})`:`hsl(${e}, ${s}%, ${i}%)`}const a_={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},l_={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function w2(){const n={},t=Object.keys(l_),e=Object.keys(a_);let s,i,r,o,a;for(s=0;s<t.length;s++){for(o=a=t[s],i=0;i<e.length;i++)r=e[i],a=a.replace(r,a_[r]);r=parseInt(l_[o],16),n[a]=[r>>16&255,r>>8&255,r&255]}return n}let ol;function x2(n){ol||(ol=w2(),ol.transparent=[0,0,0,0]);const t=ol[n.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}const T2=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function E2(n){const t=T2.exec(n);let e=255,s,i,r;if(t){if(t[7]!==s){const o=+t[7];e=t[8]?yo(o):$s(o*255,0,255)}return s=+t[1],i=+t[3],r=+t[5],s=255&(t[2]?yo(s):$s(s,0,255)),i=255&(t[4]?yo(i):$s(i,0,255)),r=255&(t[6]?yo(r):$s(r,0,255)),{r:s,g:i,b:r,a:e}}}function I2(n){return n&&(n.a<255?`rgba(${n.r}, ${n.g}, ${n.b}, ${ns(n.a)})`:`rgb(${n.r}, ${n.g}, ${n.b})`)}const Ju=n=>n<=.0031308?n*12.92:Math.pow(n,1/2.4)*1.055-.055,nr=n=>n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4);function A2(n,t,e){const s=nr(ns(n.r)),i=nr(ns(n.g)),r=nr(ns(n.b));return{r:Js(Ju(s+e*(nr(ns(t.r))-s))),g:Js(Ju(i+e*(nr(ns(t.g))-i))),b:Js(Ju(r+e*(nr(ns(t.b))-r))),a:n.a+e*(t.a-n.a)}}function al(n,t,e){if(n){let s=Uf(n);s[t]=Math.max(0,Math.min(s[t]+s[t]*e,t===0?360:1)),s=zf(s),n.r=s[0],n.g=s[1],n.b=s[2]}}function bw(n,t){return n&&Object.assign(t||{},n)}function c_(n){var t={r:0,g:0,b:0,a:255};return Array.isArray(n)?n.length>=3&&(t={r:n[0],g:n[1],b:n[2],a:255},n.length>3&&(t.a=Js(n[3]))):(t=bw(n,{r:0,g:0,b:0,a:1}),t.a=Js(t.a)),t}function S2(n){return n.charAt(0)==="r"?E2(n):y2(n)}class ra{constructor(t){if(t instanceof ra)return t;const e=typeof t;let s;e==="object"?s=c_(t):e==="string"&&(s=c2(t)||x2(t)||S2(t)),this._rgb=s,this._valid=!!s}get valid(){return this._valid}get rgb(){var t=bw(this._rgb);return t&&(t.a=ns(t.a)),t}set rgb(t){this._rgb=c_(t)}rgbString(){return this._valid?I2(this._rgb):void 0}hexString(){return this._valid?h2(this._rgb):void 0}hslString(){return this._valid?v2(this._rgb):void 0}mix(t,e){if(t){const s=this.rgb,i=t.rgb;let r;const o=e===r?.5:e,a=2*o-1,l=s.a-i.a,c=((a*l===-1?a:(a+l)/(1+a*l))+1)/2;r=1-c,s.r=255&c*s.r+r*i.r+.5,s.g=255&c*s.g+r*i.g+.5,s.b=255&c*s.b+r*i.b+.5,s.a=o*s.a+(1-o)*i.a,this.rgb=s}return this}interpolate(t,e){return t&&(this._rgb=A2(this._rgb,t._rgb,e)),this}clone(){return new ra(this.rgb)}alpha(t){return this._rgb.a=Js(t),this}clearer(t){const e=this._rgb;return e.a*=1-t,this}greyscale(){const t=this._rgb,e=Ra(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=e,this}opaquer(t){const e=this._rgb;return e.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return al(this._rgb,2,t),this}darken(t){return al(this._rgb,2,-t),this}saturate(t){return al(this._rgb,1,t),this}desaturate(t){return al(this._rgb,1,-t),this}rotate(t){return b2(this._rgb,t),this}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function Jn(){}const C2=(()=>{let n=0;return()=>n++})();function Ct(n){return n==null}function ee(n){if(Array.isArray&&Array.isArray(n))return!0;const t=Object.prototype.toString.call(n);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function Mt(n){return n!==null&&Object.prototype.toString.call(n)==="[object Object]"}function ae(n){return(typeof n=="number"||n instanceof Number)&&isFinite(+n)}function sn(n,t){return ae(n)?n:t}function vt(n,t){return typeof n>"u"?t:n}const P2=(n,t)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100:+n/t,vw=(n,t)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100*t:+n;function Xt(n,t,e){if(n&&typeof n.call=="function")return n.apply(e,t)}function jt(n,t,e,s){let i,r,o;if(ee(n))for(r=n.length,i=0;i<r;i++)t.call(e,n[i],i);else if(Mt(n))for(o=Object.keys(n),r=o.length,i=0;i<r;i++)t.call(e,n[o[i]],o[i])}function pc(n,t){let e,s,i,r;if(!n||!t||n.length!==t.length)return!1;for(e=0,s=n.length;e<s;++e)if(i=n[e],r=t[e],i.datasetIndex!==r.datasetIndex||i.index!==r.index)return!1;return!0}function gc(n){if(ee(n))return n.map(gc);if(Mt(n)){const t=Object.create(null),e=Object.keys(n),s=e.length;let i=0;for(;i<s;++i)t[e[i]]=gc(n[e[i]]);return t}return n}function ww(n){return["__proto__","prototype","constructor"].indexOf(n)===-1}function R2(n,t,e,s){if(!ww(n))return;const i=t[n],r=e[n];Mt(i)&&Mt(r)?oa(i,r,s):t[n]=gc(r)}function oa(n,t,e){const s=ee(t)?t:[t],i=s.length;if(!Mt(n))return n;e=e||{};const r=e.merger||R2;let o;for(let a=0;a<i;++a){if(o=s[a],!Mt(o))continue;const l=Object.keys(o);for(let c=0,h=l.length;c<h;++c)r(l[c],n,o,e)}return n}function Fo(n,t){return oa(n,t,{merger:k2})}function k2(n,t,e){if(!ww(n))return;const s=t[n],i=e[n];Mt(s)&&Mt(i)?Fo(s,i):Object.prototype.hasOwnProperty.call(t,n)||(t[n]=gc(i))}const u_={"":n=>n,x:n=>n.x,y:n=>n.y};function D2(n){const t=n.split("."),e=[];let s="";for(const i of t)s+=i,s.endsWith("\\")?s=s.slice(0,-1)+".":(e.push(s),s="");return e}function M2(n){const t=D2(n);return e=>{for(const s of t){if(s==="")break;e=e&&e[s]}return e}}function ai(n,t){return(u_[t]||(u_[t]=M2(t)))(n)}function jf(n){return n.charAt(0).toUpperCase()+n.slice(1)}const aa=n=>typeof n<"u",li=n=>typeof n=="function",h_=(n,t)=>{if(n.size!==t.size)return!1;for(const e of n)if(!t.has(e))return!1;return!0};function O2(n){return n.type==="mouseup"||n.type==="click"||n.type==="contextmenu"}const Nt=Math.PI,te=2*Nt,L2=te+Nt,mc=Number.POSITIVE_INFINITY,V2=Nt/180,ce=Nt/2,vi=Nt/4,d_=Nt*2/3,zs=Math.log10,jn=Math.sign;function Bo(n,t,e){return Math.abs(n-t)<e}function f_(n){const t=Math.round(n);n=Bo(n,t,n/1e3)?t:n;const e=Math.pow(10,Math.floor(zs(n))),s=n/e;return(s<=1?1:s<=2?2:s<=5?5:10)*e}function N2(n){const t=[],e=Math.sqrt(n);let s;for(s=1;s<e;s++)n%s===0&&(t.push(s),t.push(n/s));return e===(e|0)&&t.push(e),t.sort((i,r)=>i-r).pop(),t}function F2(n){return typeof n=="symbol"||typeof n=="object"&&n!==null&&!(Symbol.toPrimitive in n||"toString"in n||"valueOf"in n)}function Cr(n){return!F2(n)&&!isNaN(parseFloat(n))&&isFinite(n)}function B2(n,t){const e=Math.round(n);return e-t<=n&&e+t>=n}function xw(n,t,e){let s,i,r;for(s=0,i=n.length;s<i;s++)r=n[s][e],isNaN(r)||(t.min=Math.min(t.min,r),t.max=Math.max(t.max,r))}function Tn(n){return n*(Nt/180)}function Hf(n){return n*(180/Nt)}function p_(n){if(!ae(n))return;let t=1,e=0;for(;Math.round(n*t)/t!==n;)t*=10,e++;return e}function Tw(n,t){const e=t.x-n.x,s=t.y-n.y,i=Math.sqrt(e*e+s*s);let r=Math.atan2(s,e);return r<-.5*Nt&&(r+=te),{angle:r,distance:i}}function td(n,t){return Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2))}function U2(n,t){return(n-t+L2)%te-Nt}function Le(n){return(n%te+te)%te}function la(n,t,e,s){const i=Le(n),r=Le(t),o=Le(e),a=Le(r-i),l=Le(o-i),c=Le(i-r),h=Le(i-o);return i===r||i===o||s&&r===o||a>l&&c<h}function be(n,t,e){return Math.max(t,Math.min(e,n))}function $2(n){return be(n,-32768,32767)}function ls(n,t,e,s=1e-6){return n>=Math.min(t,e)-s&&n<=Math.max(t,e)+s}function Wf(n,t,e){e=e||(o=>n[o]<t);let s=n.length-1,i=0,r;for(;s-i>1;)r=i+s>>1,e(r)?i=r:s=r;return{lo:i,hi:s}}const cs=(n,t,e,s)=>Wf(n,e,s?i=>{const r=n[i][t];return r<e||r===e&&n[i+1][t]===e}:i=>n[i][t]<e),z2=(n,t,e)=>Wf(n,e,s=>n[s][t]>=e);function j2(n,t,e){let s=0,i=n.length;for(;s<i&&n[s]<t;)s++;for(;i>s&&n[i-1]>e;)i--;return s>0||i<n.length?n.slice(s,i):n}const Ew=["push","pop","shift","splice","unshift"];function H2(n,t){if(n._chartjs){n._chartjs.listeners.push(t);return}Object.defineProperty(n,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),Ew.forEach(e=>{const s="_onData"+jf(e),i=n[e];Object.defineProperty(n,e,{configurable:!0,enumerable:!1,value(...r){const o=i.apply(this,r);return n._chartjs.listeners.forEach(a=>{typeof a[s]=="function"&&a[s](...r)}),o}})})}function g_(n,t){const e=n._chartjs;if(!e)return;const s=e.listeners,i=s.indexOf(t);i!==-1&&s.splice(i,1),!(s.length>0)&&(Ew.forEach(r=>{delete n[r]}),delete n._chartjs)}function Iw(n){const t=new Set(n);return t.size===n.length?n:Array.from(t)}const Aw=function(){return typeof window>"u"?function(n){return n()}:window.requestAnimationFrame}();function Sw(n,t){let e=[],s=!1;return function(...i){e=i,s||(s=!0,Aw.call(window,()=>{s=!1,n.apply(t,e)}))}}function W2(n,t){let e;return function(...s){return t?(clearTimeout(e),e=setTimeout(n,t,s)):n.apply(this,s),t}}const qf=n=>n==="start"?"left":n==="end"?"right":"center",Me=(n,t,e)=>n==="start"?t:n==="end"?e:(t+e)/2,q2=(n,t,e,s)=>n===(s?"left":"right")?e:n==="center"?(t+e)/2:t;function Cw(n,t,e){const s=t.length;let i=0,r=s;if(n._sorted){const{iScale:o,vScale:a,_parsed:l}=n,c=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null,h=o.axis,{min:d,max:f,minDefined:g,maxDefined:_}=o.getUserBounds();if(g){if(i=Math.min(cs(l,h,d).lo,e?s:cs(t,h,o.getPixelForValue(d)).lo),c){const y=l.slice(0,i+1).reverse().findIndex(w=>!Ct(w[a.axis]));i-=Math.max(0,y)}i=be(i,0,s-1)}if(_){let y=Math.max(cs(l,o.axis,f,!0).hi+1,e?0:cs(t,h,o.getPixelForValue(f),!0).hi+1);if(c){const w=l.slice(y-1).findIndex(E=>!Ct(E[a.axis]));y+=Math.max(0,w)}r=be(y,i,s)-i}else r=s-i}return{start:i,count:r}}function Pw(n){const{xScale:t,yScale:e,_scaleRanges:s}=n,i={xmin:t.min,xmax:t.max,ymin:e.min,ymax:e.max};if(!s)return n._scaleRanges=i,!0;const r=s.xmin!==t.min||s.xmax!==t.max||s.ymin!==e.min||s.ymax!==e.max;return Object.assign(s,i),r}const ll=n=>n===0||n===1,m_=(n,t,e)=>-(Math.pow(2,10*(n-=1))*Math.sin((n-t)*te/e)),__=(n,t,e)=>Math.pow(2,-10*n)*Math.sin((n-t)*te/e)+1,Uo={linear:n=>n,easeInQuad:n=>n*n,easeOutQuad:n=>-n*(n-2),easeInOutQuad:n=>(n/=.5)<1?.5*n*n:-.5*(--n*(n-2)-1),easeInCubic:n=>n*n*n,easeOutCubic:n=>(n-=1)*n*n+1,easeInOutCubic:n=>(n/=.5)<1?.5*n*n*n:.5*((n-=2)*n*n+2),easeInQuart:n=>n*n*n*n,easeOutQuart:n=>-((n-=1)*n*n*n-1),easeInOutQuart:n=>(n/=.5)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2),easeInQuint:n=>n*n*n*n*n,easeOutQuint:n=>(n-=1)*n*n*n*n+1,easeInOutQuint:n=>(n/=.5)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2),easeInSine:n=>-Math.cos(n*ce)+1,easeOutSine:n=>Math.sin(n*ce),easeInOutSine:n=>-.5*(Math.cos(Nt*n)-1),easeInExpo:n=>n===0?0:Math.pow(2,10*(n-1)),easeOutExpo:n=>n===1?1:-Math.pow(2,-10*n)+1,easeInOutExpo:n=>ll(n)?n:n<.5?.5*Math.pow(2,10*(n*2-1)):.5*(-Math.pow(2,-10*(n*2-1))+2),easeInCirc:n=>n>=1?n:-(Math.sqrt(1-n*n)-1),easeOutCirc:n=>Math.sqrt(1-(n-=1)*n),easeInOutCirc:n=>(n/=.5)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1),easeInElastic:n=>ll(n)?n:m_(n,.075,.3),easeOutElastic:n=>ll(n)?n:__(n,.075,.3),easeInOutElastic(n){return ll(n)?n:n<.5?.5*m_(n*2,.1125,.45):.5+.5*__(n*2-1,.1125,.45)},easeInBack(n){return n*n*((1.70158+1)*n-1.70158)},easeOutBack(n){return(n-=1)*n*((1.70158+1)*n+1.70158)+1},easeInOutBack(n){let t=1.70158;return(n/=.5)<1?.5*(n*n*(((t*=1.525)+1)*n-t)):.5*((n-=2)*n*(((t*=1.525)+1)*n+t)+2)},easeInBounce:n=>1-Uo.easeOutBounce(1-n),easeOutBounce(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},easeInOutBounce:n=>n<.5?Uo.easeInBounce(n*2)*.5:Uo.easeOutBounce(n*2-1)*.5+.5};function Gf(n){if(n&&typeof n=="object"){const t=n.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function y_(n){return Gf(n)?n:new ra(n)}function Zu(n){return Gf(n)?n:new ra(n).saturate(.5).darken(.1).hexString()}const G2=["x","y","borderWidth","radius","tension"],K2=["color","borderColor","backgroundColor"];function Y2(n){n.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),n.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>t!=="onProgress"&&t!=="onComplete"&&t!=="fn"}),n.set("animations",{colors:{type:"color",properties:K2},numbers:{type:"number",properties:G2}}),n.describe("animations",{_fallback:"animation"}),n.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>t|0}}}})}function X2(n){n.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const b_=new Map;function Q2(n,t){t=t||{};const e=n+JSON.stringify(t);let s=b_.get(e);return s||(s=new Intl.NumberFormat(n,t),b_.set(e,s)),s}function ka(n,t,e){return Q2(t,e).format(n)}const Rw={values(n){return ee(n)?n:""+n},numeric(n,t,e){if(n===0)return"0";const s=this.chart.options.locale;let i,r=n;if(e.length>1){const c=Math.max(Math.abs(e[0].value),Math.abs(e[e.length-1].value));(c<1e-4||c>1e15)&&(i="scientific"),r=J2(n,e)}const o=zs(Math.abs(r)),a=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),l={notation:i,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(l,this.options.ticks.format),ka(n,s,l)},logarithmic(n,t,e){if(n===0)return"0";const s=e[t].significand||n/Math.pow(10,Math.floor(zs(n)));return[1,2,3,5,10,15].includes(s)||t>.8*e.length?Rw.numeric.call(this,n,t,e):""}};function J2(n,t){let e=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(e)>=1&&n!==Math.floor(n)&&(e=n-Math.floor(n)),e}var ou={formatters:Rw};function Z2(n){n.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,e)=>e.lineWidth,tickColor:(t,e)=>e.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:ou.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),n.route("scale.ticks","color","","color"),n.route("scale.grid","color","","borderColor"),n.route("scale.border","color","","borderColor"),n.route("scale.title","color","","color"),n.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&t!=="callback"&&t!=="parser",_indexable:t=>t!=="borderDash"&&t!=="tickBorderDash"&&t!=="dash"}),n.describe("scales",{_fallback:"scale"}),n.describe("scale.ticks",{_scriptable:t=>t!=="backdropPadding"&&t!=="callback",_indexable:t=>t!=="backdropPadding"})}const zi=Object.create(null),ed=Object.create(null);function $o(n,t){if(!t)return n;const e=t.split(".");for(let s=0,i=e.length;s<i;++s){const r=e[s];n=n[r]||(n[r]=Object.create(null))}return n}function th(n,t,e){return typeof t=="string"?oa($o(n,t),e):oa($o(n,""),t)}class tO{constructor(t,e){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=s=>s.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(s,i)=>Zu(i.backgroundColor),this.hoverBorderColor=(s,i)=>Zu(i.borderColor),this.hoverColor=(s,i)=>Zu(i.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(e)}set(t,e){return th(this,t,e)}get(t){return $o(this,t)}describe(t,e){return th(ed,t,e)}override(t,e){return th(zi,t,e)}route(t,e,s,i){const r=$o(this,t),o=$o(this,s),a="_"+e;Object.defineProperties(r,{[a]:{value:r[e],writable:!0},[e]:{enumerable:!0,get(){const l=this[a],c=o[i];return Mt(l)?Object.assign({},c,l):vt(l,c)},set(l){this[a]=l}}})}apply(t){t.forEach(e=>e(this))}}var ne=new tO({_scriptable:n=>!n.startsWith("on"),_indexable:n=>n!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[Y2,X2,Z2]);function eO(n){return!n||Ct(n.size)||Ct(n.family)?null:(n.style?n.style+" ":"")+(n.weight?n.weight+" ":"")+n.size+"px "+n.family}function _c(n,t,e,s,i){let r=t[i];return r||(r=t[i]=n.measureText(i).width,e.push(i)),r>s&&(s=r),s}function nO(n,t,e,s){s=s||{};let i=s.data=s.data||{},r=s.garbageCollect=s.garbageCollect||[];s.font!==t&&(i=s.data={},r=s.garbageCollect=[],s.font=t),n.save(),n.font=t;let o=0;const a=e.length;let l,c,h,d,f;for(l=0;l<a;l++)if(d=e[l],d!=null&&!ee(d))o=_c(n,i,r,o,d);else if(ee(d))for(c=0,h=d.length;c<h;c++)f=d[c],f!=null&&!ee(f)&&(o=_c(n,i,r,o,f));n.restore();const g=r.length/2;if(g>e.length){for(l=0;l<g;l++)delete i[r[l]];r.splice(0,g)}return o}function wi(n,t,e){const s=n.currentDevicePixelRatio,i=e!==0?Math.max(e/2,.5):0;return Math.round((t-i)*s)/s+i}function v_(n,t){!t&&!n||(t=t||n.getContext("2d"),t.save(),t.resetTransform(),t.clearRect(0,0,n.width,n.height),t.restore())}function nd(n,t,e,s){kw(n,t,e,s,null)}function kw(n,t,e,s,i){let r,o,a,l,c,h,d,f;const g=t.pointStyle,_=t.rotation,y=t.radius;let w=(_||0)*V2;if(g&&typeof g=="object"&&(r=g.toString(),r==="[object HTMLImageElement]"||r==="[object HTMLCanvasElement]")){n.save(),n.translate(e,s),n.rotate(w),n.drawImage(g,-g.width/2,-g.height/2,g.width,g.height),n.restore();return}if(!(isNaN(y)||y<=0)){switch(n.beginPath(),g){default:i?n.ellipse(e,s,i/2,y,0,0,te):n.arc(e,s,y,0,te),n.closePath();break;case"triangle":h=i?i/2:y,n.moveTo(e+Math.sin(w)*h,s-Math.cos(w)*y),w+=d_,n.lineTo(e+Math.sin(w)*h,s-Math.cos(w)*y),w+=d_,n.lineTo(e+Math.sin(w)*h,s-Math.cos(w)*y),n.closePath();break;case"rectRounded":c=y*.516,l=y-c,o=Math.cos(w+vi)*l,d=Math.cos(w+vi)*(i?i/2-c:l),a=Math.sin(w+vi)*l,f=Math.sin(w+vi)*(i?i/2-c:l),n.arc(e-d,s-a,c,w-Nt,w-ce),n.arc(e+f,s-o,c,w-ce,w),n.arc(e+d,s+a,c,w,w+ce),n.arc(e-f,s+o,c,w+ce,w+Nt),n.closePath();break;case"rect":if(!_){l=Math.SQRT1_2*y,h=i?i/2:l,n.rect(e-h,s-l,2*h,2*l);break}w+=vi;case"rectRot":d=Math.cos(w)*(i?i/2:y),o=Math.cos(w)*y,a=Math.sin(w)*y,f=Math.sin(w)*(i?i/2:y),n.moveTo(e-d,s-a),n.lineTo(e+f,s-o),n.lineTo(e+d,s+a),n.lineTo(e-f,s+o),n.closePath();break;case"crossRot":w+=vi;case"cross":d=Math.cos(w)*(i?i/2:y),o=Math.cos(w)*y,a=Math.sin(w)*y,f=Math.sin(w)*(i?i/2:y),n.moveTo(e-d,s-a),n.lineTo(e+d,s+a),n.moveTo(e+f,s-o),n.lineTo(e-f,s+o);break;case"star":d=Math.cos(w)*(i?i/2:y),o=Math.cos(w)*y,a=Math.sin(w)*y,f=Math.sin(w)*(i?i/2:y),n.moveTo(e-d,s-a),n.lineTo(e+d,s+a),n.moveTo(e+f,s-o),n.lineTo(e-f,s+o),w+=vi,d=Math.cos(w)*(i?i/2:y),o=Math.cos(w)*y,a=Math.sin(w)*y,f=Math.sin(w)*(i?i/2:y),n.moveTo(e-d,s-a),n.lineTo(e+d,s+a),n.moveTo(e+f,s-o),n.lineTo(e-f,s+o);break;case"line":o=i?i/2:Math.cos(w)*y,a=Math.sin(w)*y,n.moveTo(e-o,s-a),n.lineTo(e+o,s+a);break;case"dash":n.moveTo(e,s),n.lineTo(e+Math.cos(w)*(i?i/2:y),s+Math.sin(w)*y);break;case!1:n.closePath();break}n.fill(),t.borderWidth>0&&n.stroke()}}function us(n,t,e){return e=e||.5,!t||n&&n.x>t.left-e&&n.x<t.right+e&&n.y>t.top-e&&n.y<t.bottom+e}function au(n,t){n.save(),n.beginPath(),n.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),n.clip()}function lu(n){n.restore()}function sO(n,t,e,s,i){if(!t)return n.lineTo(e.x,e.y);if(i==="middle"){const r=(t.x+e.x)/2;n.lineTo(r,t.y),n.lineTo(r,e.y)}else i==="after"!=!!s?n.lineTo(t.x,e.y):n.lineTo(e.x,t.y);n.lineTo(e.x,e.y)}function iO(n,t,e,s){if(!t)return n.lineTo(e.x,e.y);n.bezierCurveTo(s?t.cp1x:t.cp2x,s?t.cp1y:t.cp2y,s?e.cp2x:e.cp1x,s?e.cp2y:e.cp1y,e.x,e.y)}function rO(n,t){t.translation&&n.translate(t.translation[0],t.translation[1]),Ct(t.rotation)||n.rotate(t.rotation),t.color&&(n.fillStyle=t.color),t.textAlign&&(n.textAlign=t.textAlign),t.textBaseline&&(n.textBaseline=t.textBaseline)}function oO(n,t,e,s,i){if(i.strikethrough||i.underline){const r=n.measureText(s),o=t-r.actualBoundingBoxLeft,a=t+r.actualBoundingBoxRight,l=e-r.actualBoundingBoxAscent,c=e+r.actualBoundingBoxDescent,h=i.strikethrough?(l+c)/2:c;n.strokeStyle=n.fillStyle,n.beginPath(),n.lineWidth=i.decorationWidth||2,n.moveTo(o,h),n.lineTo(a,h),n.stroke()}}function aO(n,t){const e=n.fillStyle;n.fillStyle=t.color,n.fillRect(t.left,t.top,t.width,t.height),n.fillStyle=e}function ji(n,t,e,s,i,r={}){const o=ee(t)?t:[t],a=r.strokeWidth>0&&r.strokeColor!=="";let l,c;for(n.save(),n.font=i.string,rO(n,r),l=0;l<o.length;++l)c=o[l],r.backdrop&&aO(n,r.backdrop),a&&(r.strokeColor&&(n.strokeStyle=r.strokeColor),Ct(r.strokeWidth)||(n.lineWidth=r.strokeWidth),n.strokeText(c,e,s,r.maxWidth)),n.fillText(c,e,s,r.maxWidth),oO(n,e,s,c,r),s+=Number(i.lineHeight);n.restore()}function ca(n,t){const{x:e,y:s,w:i,h:r,radius:o}=t;n.arc(e+o.topLeft,s+o.topLeft,o.topLeft,1.5*Nt,Nt,!0),n.lineTo(e,s+r-o.bottomLeft),n.arc(e+o.bottomLeft,s+r-o.bottomLeft,o.bottomLeft,Nt,ce,!0),n.lineTo(e+i-o.bottomRight,s+r),n.arc(e+i-o.bottomRight,s+r-o.bottomRight,o.bottomRight,ce,0,!0),n.lineTo(e+i,s+o.topRight),n.arc(e+i-o.topRight,s+o.topRight,o.topRight,0,-ce,!0),n.lineTo(e+o.topLeft,s)}const lO=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,cO=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function uO(n,t){const e=(""+n).match(lO);if(!e||e[1]==="normal")return t*1.2;switch(n=+e[2],e[3]){case"px":return n;case"%":n/=100;break}return t*n}const hO=n=>+n||0;function Kf(n,t){const e={},s=Mt(t),i=s?Object.keys(t):t,r=Mt(n)?s?o=>vt(n[o],n[t[o]]):o=>n[o]:()=>n;for(const o of i)e[o]=hO(r(o));return e}function Dw(n){return Kf(n,{top:"y",right:"x",bottom:"y",left:"x"})}function Li(n){return Kf(n,["topLeft","topRight","bottomLeft","bottomRight"])}function ze(n){const t=Dw(n);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function ge(n,t){n=n||{},t=t||ne.font;let e=vt(n.size,t.size);typeof e=="string"&&(e=parseInt(e,10));let s=vt(n.style,t.style);s&&!(""+s).match(cO)&&(console.warn('Invalid font style specified: "'+s+'"'),s=void 0);const i={family:vt(n.family,t.family),lineHeight:uO(vt(n.lineHeight,t.lineHeight),e),size:e,style:s,weight:vt(n.weight,t.weight),string:""};return i.string=eO(i),i}function bo(n,t,e,s){let i,r,o;for(i=0,r=n.length;i<r;++i)if(o=n[i],o!==void 0&&o!==void 0)return o}function dO(n,t,e){const{min:s,max:i}=n,r=vw(t,(i-s)/2),o=(a,l)=>e&&a===0?0:a+l;return{min:o(s,-Math.abs(r)),max:o(i,r)}}function di(n,t){return Object.assign(Object.create(n),t)}function Yf(n,t=[""],e,s,i=()=>n[0]){const r=e||n;typeof s>"u"&&(s=Vw("_fallback",n));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:n,_rootScopes:r,_fallback:s,_getTarget:i,override:a=>Yf([a,...n],t,r,s)};return new Proxy(o,{deleteProperty(a,l){return delete a[l],delete a._keys,delete n[0][l],!0},get(a,l){return Ow(a,l,()=>vO(l,t,n,a))},getOwnPropertyDescriptor(a,l){return Reflect.getOwnPropertyDescriptor(a._scopes[0],l)},getPrototypeOf(){return Reflect.getPrototypeOf(n[0])},has(a,l){return x_(a).includes(l)},ownKeys(a){return x_(a)},set(a,l,c){const h=a._storage||(a._storage=i());return a[l]=h[l]=c,delete a._keys,!0}})}function Pr(n,t,e,s){const i={_cacheable:!1,_proxy:n,_context:t,_subProxy:e,_stack:new Set,_descriptors:Mw(n,s),setContext:r=>Pr(n,r,e,s),override:r=>Pr(n.override(r),t,e,s)};return new Proxy(i,{deleteProperty(r,o){return delete r[o],delete n[o],!0},get(r,o,a){return Ow(r,o,()=>pO(r,o,a))},getOwnPropertyDescriptor(r,o){return r._descriptors.allKeys?Reflect.has(n,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(n,o)},getPrototypeOf(){return Reflect.getPrototypeOf(n)},has(r,o){return Reflect.has(n,o)},ownKeys(){return Reflect.ownKeys(n)},set(r,o,a){return n[o]=a,delete r[o],!0}})}function Mw(n,t={scriptable:!0,indexable:!0}){const{_scriptable:e=t.scriptable,_indexable:s=t.indexable,_allKeys:i=t.allKeys}=n;return{allKeys:i,scriptable:e,indexable:s,isScriptable:li(e)?e:()=>e,isIndexable:li(s)?s:()=>s}}const fO=(n,t)=>n?n+jf(t):t,Xf=(n,t)=>Mt(t)&&n!=="adapters"&&(Object.getPrototypeOf(t)===null||t.constructor===Object);function Ow(n,t,e){if(Object.prototype.hasOwnProperty.call(n,t)||t==="constructor")return n[t];const s=e();return n[t]=s,s}function pO(n,t,e){const{_proxy:s,_context:i,_subProxy:r,_descriptors:o}=n;let a=s[t];return li(a)&&o.isScriptable(t)&&(a=gO(t,a,n,e)),ee(a)&&a.length&&(a=mO(t,a,n,o.isIndexable)),Xf(t,a)&&(a=Pr(a,i,r&&r[t],o)),a}function gO(n,t,e,s){const{_proxy:i,_context:r,_subProxy:o,_stack:a}=e;if(a.has(n))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+n);a.add(n);let l=t(r,o||s);return a.delete(n),Xf(n,l)&&(l=Qf(i._scopes,i,n,l)),l}function mO(n,t,e,s){const{_proxy:i,_context:r,_subProxy:o,_descriptors:a}=e;if(typeof r.index<"u"&&s(n))return t[r.index%t.length];if(Mt(t[0])){const l=t,c=i._scopes.filter(h=>h!==l);t=[];for(const h of l){const d=Qf(c,i,n,h);t.push(Pr(d,r,o&&o[n],a))}}return t}function Lw(n,t,e){return li(n)?n(t,e):n}const _O=(n,t)=>n===!0?t:typeof n=="string"?ai(t,n):void 0;function yO(n,t,e,s,i){for(const r of t){const o=_O(e,r);if(o){n.add(o);const a=Lw(o._fallback,e,i);if(typeof a<"u"&&a!==e&&a!==s)return a}else if(o===!1&&typeof s<"u"&&e!==s)return null}return!1}function Qf(n,t,e,s){const i=t._rootScopes,r=Lw(t._fallback,e,s),o=[...n,...i],a=new Set;a.add(s);let l=w_(a,o,e,r||e,s);return l===null||typeof r<"u"&&r!==e&&(l=w_(a,o,r,l,s),l===null)?!1:Yf(Array.from(a),[""],i,r,()=>bO(t,e,s))}function w_(n,t,e,s,i){for(;e;)e=yO(n,t,e,s,i);return e}function bO(n,t,e){const s=n._getTarget();t in s||(s[t]={});const i=s[t];return ee(i)&&Mt(e)?e:i||{}}function vO(n,t,e,s){let i;for(const r of t)if(i=Vw(fO(r,n),e),typeof i<"u")return Xf(n,i)?Qf(e,s,n,i):i}function Vw(n,t){for(const e of t){if(!e)continue;const s=e[n];if(typeof s<"u")return s}}function x_(n){let t=n._keys;return t||(t=n._keys=wO(n._scopes)),t}function wO(n){const t=new Set;for(const e of n)for(const s of Object.keys(e).filter(i=>!i.startsWith("_")))t.add(s);return Array.from(t)}function Nw(n,t,e,s){const{iScale:i}=n,{key:r="r"}=this._parsing,o=new Array(s);let a,l,c,h;for(a=0,l=s;a<l;++a)c=a+e,h=t[c],o[a]={r:i.parse(ai(h,r),c)};return o}const xO=Number.EPSILON||1e-14,Rr=(n,t)=>t<n.length&&!n[t].skip&&n[t],Fw=n=>n==="x"?"y":"x";function TO(n,t,e,s){const i=n.skip?t:n,r=t,o=e.skip?t:e,a=td(r,i),l=td(o,r);let c=a/(a+l),h=l/(a+l);c=isNaN(c)?0:c,h=isNaN(h)?0:h;const d=s*c,f=s*h;return{previous:{x:r.x-d*(o.x-i.x),y:r.y-d*(o.y-i.y)},next:{x:r.x+f*(o.x-i.x),y:r.y+f*(o.y-i.y)}}}function EO(n,t,e){const s=n.length;let i,r,o,a,l,c=Rr(n,0);for(let h=0;h<s-1;++h)if(l=c,c=Rr(n,h+1),!(!l||!c)){if(Bo(t[h],0,xO)){e[h]=e[h+1]=0;continue}i=e[h]/t[h],r=e[h+1]/t[h],a=Math.pow(i,2)+Math.pow(r,2),!(a<=9)&&(o=3/Math.sqrt(a),e[h]=i*o*t[h],e[h+1]=r*o*t[h])}}function IO(n,t,e="x"){const s=Fw(e),i=n.length;let r,o,a,l=Rr(n,0);for(let c=0;c<i;++c){if(o=a,a=l,l=Rr(n,c+1),!a)continue;const h=a[e],d=a[s];o&&(r=(h-o[e])/3,a[`cp1${e}`]=h-r,a[`cp1${s}`]=d-r*t[c]),l&&(r=(l[e]-h)/3,a[`cp2${e}`]=h+r,a[`cp2${s}`]=d+r*t[c])}}function AO(n,t="x"){const e=Fw(t),s=n.length,i=Array(s).fill(0),r=Array(s);let o,a,l,c=Rr(n,0);for(o=0;o<s;++o)if(a=l,l=c,c=Rr(n,o+1),!!l){if(c){const h=c[t]-l[t];i[o]=h!==0?(c[e]-l[e])/h:0}r[o]=a?c?jn(i[o-1])!==jn(i[o])?0:(i[o-1]+i[o])/2:i[o-1]:i[o]}EO(n,i,r),IO(n,r,t)}function cl(n,t,e){return Math.max(Math.min(n,e),t)}function SO(n,t){let e,s,i,r,o,a=us(n[0],t);for(e=0,s=n.length;e<s;++e)o=r,r=a,a=e<s-1&&us(n[e+1],t),r&&(i=n[e],o&&(i.cp1x=cl(i.cp1x,t.left,t.right),i.cp1y=cl(i.cp1y,t.top,t.bottom)),a&&(i.cp2x=cl(i.cp2x,t.left,t.right),i.cp2y=cl(i.cp2y,t.top,t.bottom)))}function CO(n,t,e,s,i){let r,o,a,l;if(t.spanGaps&&(n=n.filter(c=>!c.skip)),t.cubicInterpolationMode==="monotone")AO(n,i);else{let c=s?n[n.length-1]:n[0];for(r=0,o=n.length;r<o;++r)a=n[r],l=TO(c,a,n[Math.min(r+1,o-(s?0:1))%o],t.tension),a.cp1x=l.previous.x,a.cp1y=l.previous.y,a.cp2x=l.next.x,a.cp2y=l.next.y,c=a}t.capBezierPoints&&SO(n,e)}function Jf(){return typeof window<"u"&&typeof document<"u"}function Zf(n){let t=n.parentNode;return t&&t.toString()==="[object ShadowRoot]"&&(t=t.host),t}function yc(n,t,e){let s;return typeof n=="string"?(s=parseInt(n,10),n.indexOf("%")!==-1&&(s=s/100*t.parentNode[e])):s=n,s}const cu=n=>n.ownerDocument.defaultView.getComputedStyle(n,null);function PO(n,t){return cu(n).getPropertyValue(t)}const RO=["top","right","bottom","left"];function Vi(n,t,e){const s={};e=e?"-"+e:"";for(let i=0;i<4;i++){const r=RO[i];s[r]=parseFloat(n[t+"-"+r+e])||0}return s.width=s.left+s.right,s.height=s.top+s.bottom,s}const kO=(n,t,e)=>(n>0||t>0)&&(!e||!e.shadowRoot);function DO(n,t){const e=n.touches,s=e&&e.length?e[0]:n,{offsetX:i,offsetY:r}=s;let o=!1,a,l;if(kO(i,r,n.target))a=i,l=r;else{const c=t.getBoundingClientRect();a=s.clientX-c.left,l=s.clientY-c.top,o=!0}return{x:a,y:l,box:o}}function Ai(n,t){if("native"in n)return n;const{canvas:e,currentDevicePixelRatio:s}=t,i=cu(e),r=i.boxSizing==="border-box",o=Vi(i,"padding"),a=Vi(i,"border","width"),{x:l,y:c,box:h}=DO(n,e),d=o.left+(h&&a.left),f=o.top+(h&&a.top);let{width:g,height:_}=t;return r&&(g-=o.width+a.width,_-=o.height+a.height),{x:Math.round((l-d)/g*e.width/s),y:Math.round((c-f)/_*e.height/s)}}function MO(n,t,e){let s,i;if(t===void 0||e===void 0){const r=n&&Zf(n);if(!r)t=n.clientWidth,e=n.clientHeight;else{const o=r.getBoundingClientRect(),a=cu(r),l=Vi(a,"border","width"),c=Vi(a,"padding");t=o.width-c.width-l.width,e=o.height-c.height-l.height,s=yc(a.maxWidth,r,"clientWidth"),i=yc(a.maxHeight,r,"clientHeight")}}return{width:t,height:e,maxWidth:s||mc,maxHeight:i||mc}}const js=n=>Math.round(n*10)/10;function OO(n,t,e,s){const i=cu(n),r=Vi(i,"margin"),o=yc(i.maxWidth,n,"clientWidth")||mc,a=yc(i.maxHeight,n,"clientHeight")||mc,l=MO(n,t,e);let{width:c,height:h}=l;if(i.boxSizing==="content-box"){const f=Vi(i,"border","width"),g=Vi(i,"padding");c-=g.width+f.width,h-=g.height+f.height}return c=Math.max(0,c-r.width),h=Math.max(0,s?c/s:h-r.height),c=js(Math.min(c,o,l.maxWidth)),h=js(Math.min(h,a,l.maxHeight)),c&&!h&&(h=js(c/2)),(t!==void 0||e!==void 0)&&s&&l.height&&h>l.height&&(h=l.height,c=js(Math.floor(h*s))),{width:c,height:h}}function T_(n,t,e){const s=t||1,i=js(n.height*s),r=js(n.width*s);n.height=js(n.height),n.width=js(n.width);const o=n.canvas;return o.style&&(e||!o.style.height&&!o.style.width)&&(o.style.height=`${n.height}px`,o.style.width=`${n.width}px`),n.currentDevicePixelRatio!==s||o.height!==i||o.width!==r?(n.currentDevicePixelRatio=s,o.height=i,o.width=r,n.ctx.setTransform(s,0,0,s,0,0),!0):!1}const LO=function(){let n=!1;try{const t={get passive(){return n=!0,!1}};Jf()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch{}return n}();function E_(n,t){const e=PO(n,t),s=e&&e.match(/^(\d+)(\.\d+)?px$/);return s?+s[1]:void 0}function Si(n,t,e,s){return{x:n.x+e*(t.x-n.x),y:n.y+e*(t.y-n.y)}}function VO(n,t,e,s){return{x:n.x+e*(t.x-n.x),y:s==="middle"?e<.5?n.y:t.y:s==="after"?e<1?n.y:t.y:e>0?t.y:n.y}}function NO(n,t,e,s){const i={x:n.cp2x,y:n.cp2y},r={x:t.cp1x,y:t.cp1y},o=Si(n,i,e),a=Si(i,r,e),l=Si(r,t,e),c=Si(o,a,e),h=Si(a,l,e);return Si(c,h,e)}const FO=function(n,t){return{x(e){return n+n+t-e},setWidth(e){t=e},textAlign(e){return e==="center"?e:e==="right"?"left":"right"},xPlus(e,s){return e-s},leftForLtr(e,s){return e-s}}},BO=function(){return{x(n){return n},setWidth(n){},textAlign(n){return n},xPlus(n,t){return n+t},leftForLtr(n,t){return n}}};function br(n,t,e){return n?FO(t,e):BO()}function Bw(n,t){let e,s;(t==="ltr"||t==="rtl")&&(e=n.canvas.style,s=[e.getPropertyValue("direction"),e.getPropertyPriority("direction")],e.setProperty("direction",t,"important"),n.prevTextDirection=s)}function Uw(n,t){t!==void 0&&(delete n.prevTextDirection,n.canvas.style.setProperty("direction",t[0],t[1]))}function $w(n){return n==="angle"?{between:la,compare:U2,normalize:Le}:{between:ls,compare:(t,e)=>t-e,normalize:t=>t}}function I_({start:n,end:t,count:e,loop:s,style:i}){return{start:n%e,end:t%e,loop:s&&(t-n+1)%e===0,style:i}}function UO(n,t,e){const{property:s,start:i,end:r}=e,{between:o,normalize:a}=$w(s),l=t.length;let{start:c,end:h,loop:d}=n,f,g;if(d){for(c+=l,h+=l,f=0,g=l;f<g&&o(a(t[c%l][s]),i,r);++f)c--,h--;c%=l,h%=l}return h<c&&(h+=l),{start:c,end:h,loop:d,style:n.style}}function zw(n,t,e){if(!e)return[n];const{property:s,start:i,end:r}=e,o=t.length,{compare:a,between:l,normalize:c}=$w(s),{start:h,end:d,loop:f,style:g}=UO(n,t,e),_=[];let y=!1,w=null,E,S,A;const k=()=>l(i,A,E)&&a(i,A)!==0,R=()=>a(r,E)===0||l(r,A,E),L=()=>y||k(),x=()=>!y||R();for(let b=h,T=h;b<=d;++b)S=t[b%o],!S.skip&&(E=c(S[s]),E!==A&&(y=l(E,i,r),w===null&&L()&&(w=a(E,i)===0?b:T),w!==null&&x()&&(_.push(I_({start:w,end:b,loop:f,count:o,style:g})),w=null),T=b,A=E));return w!==null&&_.push(I_({start:w,end:d,loop:f,count:o,style:g})),_}function jw(n,t){const e=[],s=n.segments;for(let i=0;i<s.length;i++){const r=zw(s[i],n.points,t);r.length&&e.push(...r)}return e}function $O(n,t,e,s){let i=0,r=t-1;if(e&&!s)for(;i<t&&!n[i].skip;)i++;for(;i<t&&n[i].skip;)i++;for(i%=t,e&&(r+=i);r>i&&n[r%t].skip;)r--;return r%=t,{start:i,end:r}}function zO(n,t,e,s){const i=n.length,r=[];let o=t,a=n[t],l;for(l=t+1;l<=e;++l){const c=n[l%i];c.skip||c.stop?a.skip||(s=!1,r.push({start:t%i,end:(l-1)%i,loop:s}),t=o=c.stop?l:null):(o=l,a.skip&&(t=l)),a=c}return o!==null&&r.push({start:t%i,end:o%i,loop:s}),r}function jO(n,t){const e=n.points,s=n.options.spanGaps,i=e.length;if(!i)return[];const r=!!n._loop,{start:o,end:a}=$O(e,i,r,s);if(s===!0)return A_(n,[{start:o,end:a,loop:r}],e,t);const l=a<o?a+i:a,c=!!n._fullLoop&&o===0&&a===i-1;return A_(n,zO(e,o,l,c),e,t)}function A_(n,t,e,s){return!s||!s.setContext||!e?t:HO(n,t,e,s)}function HO(n,t,e,s){const i=n._chart.getContext(),r=S_(n.options),{_datasetIndex:o,options:{spanGaps:a}}=n,l=e.length,c=[];let h=r,d=t[0].start,f=d;function g(_,y,w,E){const S=a?-1:1;if(_!==y){for(_+=l;e[_%l].skip;)_-=S;for(;e[y%l].skip;)y+=S;_%l!==y%l&&(c.push({start:_%l,end:y%l,loop:w,style:E}),h=E,d=y%l)}}for(const _ of t){d=a?d:_.start;let y=e[d%l],w;for(f=d+1;f<=_.end;f++){const E=e[f%l];w=S_(s.setContext(di(i,{type:"segment",p0:y,p1:E,p0DataIndex:(f-1)%l,p1DataIndex:f%l,datasetIndex:o}))),WO(w,h)&&g(d,f-1,_.loop,h),y=E,h=w}d<f-1&&g(d,f-1,_.loop,h)}return c}function S_(n){return{backgroundColor:n.backgroundColor,borderCapStyle:n.borderCapStyle,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderJoinStyle:n.borderJoinStyle,borderWidth:n.borderWidth,borderColor:n.borderColor}}function WO(n,t){if(!t)return!1;const e=[],s=function(i,r){return Gf(r)?(e.includes(r)||e.push(r),e.indexOf(r)):r};return JSON.stringify(n,s)!==JSON.stringify(t,s)}function ul(n,t,e){return n.options.clip?n[e]:t[e]}function qO(n,t){const{xScale:e,yScale:s}=n;return e&&s?{left:ul(e,t,"left"),right:ul(e,t,"right"),top:ul(s,t,"top"),bottom:ul(s,t,"bottom")}:t}function Hw(n,t){const e=t._clip;if(e.disabled)return!1;const s=qO(t,n.chartArea);return{left:e.left===!1?0:s.left-(e.left===!0?0:e.left),right:e.right===!1?n.width:s.right+(e.right===!0?0:e.right),top:e.top===!1?0:s.top-(e.top===!0?0:e.top),bottom:e.bottom===!1?n.height:s.bottom+(e.bottom===!0?0:e.bottom)}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class GO{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,e,s,i){const r=e.listeners[i],o=e.duration;r.forEach(a=>a({chart:t,initial:e.initial,numSteps:o,currentStep:Math.min(s-e.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=Aw.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(t=Date.now()){let e=0;this._charts.forEach((s,i)=>{if(!s.running||!s.items.length)return;const r=s.items;let o=r.length-1,a=!1,l;for(;o>=0;--o)l=r[o],l._active?(l._total>s.duration&&(s.duration=l._total),l.tick(t),a=!0):(r[o]=r[r.length-1],r.pop());a&&(i.draw(),this._notify(i,s,t,"progress")),r.length||(s.running=!1,this._notify(i,s,t,"complete"),s.initial=!1),e+=r.length}),this._lastDate=t,e===0&&(this._running=!1)}_getAnims(t){const e=this._charts;let s=e.get(t);return s||(s={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},e.set(t,s)),s}listen(t,e,s){this._getAnims(t).listeners[e].push(s)}add(t,e){!e||!e.length||this._getAnims(t).items.push(...e)}has(t){return this._getAnims(t).items.length>0}start(t){const e=this._charts.get(t);e&&(e.running=!0,e.start=Date.now(),e.duration=e.items.reduce((s,i)=>Math.max(s,i._duration),0),this._refresh())}running(t){if(!this._running)return!1;const e=this._charts.get(t);return!(!e||!e.running||!e.items.length)}stop(t){const e=this._charts.get(t);if(!e||!e.items.length)return;const s=e.items;let i=s.length-1;for(;i>=0;--i)s[i].cancel();e.items=[],this._notify(t,e,Date.now(),"complete")}remove(t){return this._charts.delete(t)}}var Zn=new GO;const C_="transparent",KO={boolean(n,t,e){return e>.5?t:n},color(n,t,e){const s=y_(n||C_),i=s.valid&&y_(t||C_);return i&&i.valid?i.mix(s,e).hexString():t},number(n,t,e){return n+(t-n)*e}};class YO{constructor(t,e,s,i){const r=e[s];i=bo([t.to,i,r,t.from]);const o=bo([t.from,r,i]);this._active=!0,this._fn=t.fn||KO[t.type||typeof o],this._easing=Uo[t.easing]||Uo.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=e,this._prop=s,this._from=o,this._to=i,this._promises=void 0}active(){return this._active}update(t,e,s){if(this._active){this._notify(!1);const i=this._target[this._prop],r=s-this._start,o=this._duration-r;this._start=s,this._duration=Math.floor(Math.max(o,t.duration)),this._total+=r,this._loop=!!t.loop,this._to=bo([t.to,e,i,t.from]),this._from=bo([t.from,i,e])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const e=t-this._start,s=this._duration,i=this._prop,r=this._from,o=this._loop,a=this._to;let l;if(this._active=r!==a&&(o||e<s),!this._active){this._target[i]=a,this._notify(!0);return}if(e<0){this._target[i]=r;return}l=e/s%2,l=o&&l>1?2-l:l,l=this._easing(Math.min(1,Math.max(0,l))),this._target[i]=this._fn(r,a,l)}wait(){const t=this._promises||(this._promises=[]);return new Promise((e,s)=>{t.push({res:e,rej:s})})}_notify(t){const e=t?"res":"rej",s=this._promises||[];for(let i=0;i<s.length;i++)s[i][e]()}}class Ww{constructor(t,e){this._chart=t,this._properties=new Map,this.configure(e)}configure(t){if(!Mt(t))return;const e=Object.keys(ne.animation),s=this._properties;Object.getOwnPropertyNames(t).forEach(i=>{const r=t[i];if(!Mt(r))return;const o={};for(const a of e)o[a]=r[a];(ee(r.properties)&&r.properties||[i]).forEach(a=>{(a===i||!s.has(a))&&s.set(a,o)})})}_animateOptions(t,e){const s=e.options,i=QO(t,s);if(!i)return[];const r=this._createAnimations(i,s);return s.$shared&&XO(t.options.$animations,s).then(()=>{t.options=s},()=>{}),r}_createAnimations(t,e){const s=this._properties,i=[],r=t.$animations||(t.$animations={}),o=Object.keys(e),a=Date.now();let l;for(l=o.length-1;l>=0;--l){const c=o[l];if(c.charAt(0)==="$")continue;if(c==="options"){i.push(...this._animateOptions(t,e));continue}const h=e[c];let d=r[c];const f=s.get(c);if(d)if(f&&d.active()){d.update(f,h,a);continue}else d.cancel();if(!f||!f.duration){t[c]=h;continue}r[c]=d=new YO(f,t,c,h),i.push(d)}return i}update(t,e){if(this._properties.size===0){Object.assign(t,e);return}const s=this._createAnimations(t,e);if(s.length)return Zn.add(this._chart,s),!0}}function XO(n,t){const e=[],s=Object.keys(t);for(let i=0;i<s.length;i++){const r=n[s[i]];r&&r.active()&&e.push(r.wait())}return Promise.all(e)}function QO(n,t){if(!t)return;let e=n.options;if(!e){n.options=t;return}return e.$shared&&(n.options=e=Object.assign({},e,{$shared:!1,$animations:{}})),e}function P_(n,t){const e=n&&n.options||{},s=e.reverse,i=e.min===void 0?t:0,r=e.max===void 0?t:0;return{start:s?r:i,end:s?i:r}}function JO(n,t,e){if(e===!1)return!1;const s=P_(n,e),i=P_(t,e);return{top:i.end,right:s.end,bottom:i.start,left:s.start}}function ZO(n){let t,e,s,i;return Mt(n)?(t=n.top,e=n.right,s=n.bottom,i=n.left):t=e=s=i=n,{top:t,right:e,bottom:s,left:i,disabled:n===!1}}function qw(n,t){const e=[],s=n._getSortedDatasetMetas(t);let i,r;for(i=0,r=s.length;i<r;++i)e.push(s[i].index);return e}function R_(n,t,e,s={}){const i=n.keys,r=s.mode==="single";let o,a,l,c;if(t===null)return;let h=!1;for(o=0,a=i.length;o<a;++o){if(l=+i[o],l===e){if(h=!0,s.all)continue;break}c=n.values[l],ae(c)&&(r||t===0||jn(t)===jn(c))&&(t+=c)}return!h&&!s.all?0:t}function tL(n,t){const{iScale:e,vScale:s}=t,i=e.axis==="x"?"x":"y",r=s.axis==="x"?"x":"y",o=Object.keys(n),a=new Array(o.length);let l,c,h;for(l=0,c=o.length;l<c;++l)h=o[l],a[l]={[i]:h,[r]:n[h]};return a}function eh(n,t){const e=n&&n.options.stacked;return e||e===void 0&&t.stack!==void 0}function eL(n,t,e){return`${n.id}.${t.id}.${e.stack||e.type}`}function nL(n){const{min:t,max:e,minDefined:s,maxDefined:i}=n.getUserBounds();return{min:s?t:Number.NEGATIVE_INFINITY,max:i?e:Number.POSITIVE_INFINITY}}function sL(n,t,e){const s=n[t]||(n[t]={});return s[e]||(s[e]={})}function k_(n,t,e,s){for(const i of t.getMatchingVisibleMetas(s).reverse()){const r=n[i.index];if(e&&r>0||!e&&r<0)return i.index}return null}function D_(n,t){const{chart:e,_cachedMeta:s}=n,i=e._stacks||(e._stacks={}),{iScale:r,vScale:o,index:a}=s,l=r.axis,c=o.axis,h=eL(r,o,s),d=t.length;let f;for(let g=0;g<d;++g){const _=t[g],{[l]:y,[c]:w}=_,E=_._stacks||(_._stacks={});f=E[c]=sL(i,h,y),f[a]=w,f._top=k_(f,o,!0,s.type),f._bottom=k_(f,o,!1,s.type);const S=f._visualValues||(f._visualValues={});S[a]=w}}function nh(n,t){const e=n.scales;return Object.keys(e).filter(s=>e[s].axis===t).shift()}function iL(n,t){return di(n,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}function rL(n,t,e){return di(n,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:e,index:t,mode:"default",type:"data"})}function oo(n,t){const e=n.controller.index,s=n.vScale&&n.vScale.axis;if(s){t=t||n._parsed;for(const i of t){const r=i._stacks;if(!r||r[s]===void 0||r[s][e]===void 0)return;delete r[s][e],r[s]._visualValues!==void 0&&r[s]._visualValues[e]!==void 0&&delete r[s]._visualValues[e]}}}const sh=n=>n==="reset"||n==="none",M_=(n,t)=>t?n:Object.assign({},n),oL=(n,t,e)=>n&&!t.hidden&&t._stacked&&{keys:qw(e,!0),values:null};class fi{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(t,e){this.chart=t,this._ctx=t.ctx,this.index=e,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=eh(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&oo(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,e=this._cachedMeta,s=this.getDataset(),i=(d,f,g,_)=>d==="x"?f:d==="r"?_:g,r=e.xAxisID=vt(s.xAxisID,nh(t,"x")),o=e.yAxisID=vt(s.yAxisID,nh(t,"y")),a=e.rAxisID=vt(s.rAxisID,nh(t,"r")),l=e.indexAxis,c=e.iAxisID=i(l,r,o,a),h=e.vAxisID=i(l,o,r,a);e.xScale=this.getScaleForId(r),e.yScale=this.getScaleForId(o),e.rScale=this.getScaleForId(a),e.iScale=this.getScaleForId(c),e.vScale=this.getScaleForId(h)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const e=this._cachedMeta;return t===e.iScale?e.vScale:e.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&g_(this._data,this),t._stacked&&oo(t)}_dataCheck(){const t=this.getDataset(),e=t.data||(t.data=[]),s=this._data;if(Mt(e)){const i=this._cachedMeta;this._data=tL(e,i)}else if(s!==e){if(s){g_(s,this);const i=this._cachedMeta;oo(i),i._parsed=[]}e&&Object.isExtensible(e)&&H2(e,this),this._syncList=[],this._data=e}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const e=this._cachedMeta,s=this.getDataset();let i=!1;this._dataCheck();const r=e._stacked;e._stacked=eh(e.vScale,e),e.stack!==s.stack&&(i=!0,oo(e),e.stack=s.stack),this._resyncElements(t),(i||r!==e._stacked)&&(D_(this,e._parsed),e._stacked=eh(e.vScale,e))}configure(){const t=this.chart.config,e=t.datasetScopeKeys(this._type),s=t.getOptionScopes(this.getDataset(),e,!0);this.options=t.createResolver(s,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,e){const{_cachedMeta:s,_data:i}=this,{iScale:r,_stacked:o}=s,a=r.axis;let l=t===0&&e===i.length?!0:s._sorted,c=t>0&&s._parsed[t-1],h,d,f;if(this._parsing===!1)s._parsed=i,s._sorted=!0,f=i;else{ee(i[t])?f=this.parseArrayData(s,i,t,e):Mt(i[t])?f=this.parseObjectData(s,i,t,e):f=this.parsePrimitiveData(s,i,t,e);const g=()=>d[a]===null||c&&d[a]<c[a];for(h=0;h<e;++h)s._parsed[h+t]=d=f[h],l&&(g()&&(l=!1),c=d);s._sorted=l}o&&D_(this,f)}parsePrimitiveData(t,e,s,i){const{iScale:r,vScale:o}=t,a=r.axis,l=o.axis,c=r.getLabels(),h=r===o,d=new Array(i);let f,g,_;for(f=0,g=i;f<g;++f)_=f+s,d[f]={[a]:h||r.parse(c[_],_),[l]:o.parse(e[_],_)};return d}parseArrayData(t,e,s,i){const{xScale:r,yScale:o}=t,a=new Array(i);let l,c,h,d;for(l=0,c=i;l<c;++l)h=l+s,d=e[h],a[l]={x:r.parse(d[0],h),y:o.parse(d[1],h)};return a}parseObjectData(t,e,s,i){const{xScale:r,yScale:o}=t,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,c=new Array(i);let h,d,f,g;for(h=0,d=i;h<d;++h)f=h+s,g=e[f],c[h]={x:r.parse(ai(g,a),f),y:o.parse(ai(g,l),f)};return c}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,e,s){const i=this.chart,r=this._cachedMeta,o=e[t.axis],a={keys:qw(i,!0),values:e._stacks[t.axis]._visualValues};return R_(a,o,r.index,{mode:s})}updateRangeFromParsed(t,e,s,i){const r=s[e.axis];let o=r===null?NaN:r;const a=i&&s._stacks[e.axis];i&&a&&(i.values=a,o=R_(i,r,this._cachedMeta.index)),t.min=Math.min(t.min,o),t.max=Math.max(t.max,o)}getMinMax(t,e){const s=this._cachedMeta,i=s._parsed,r=s._sorted&&t===s.iScale,o=i.length,a=this._getOtherScale(t),l=oL(e,s,this.chart),c={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:h,max:d}=nL(a);let f,g;function _(){g=i[f];const y=g[a.axis];return!ae(g[t.axis])||h>y||d<y}for(f=0;f<o&&!(!_()&&(this.updateRangeFromParsed(c,t,g,l),r));++f);if(r){for(f=o-1;f>=0;--f)if(!_()){this.updateRangeFromParsed(c,t,g,l);break}}return c}getAllParsedValues(t){const e=this._cachedMeta._parsed,s=[];let i,r,o;for(i=0,r=e.length;i<r;++i)o=e[i][t.axis],ae(o)&&s.push(o);return s}getMaxOverflow(){return!1}getLabelAndValue(t){const e=this._cachedMeta,s=e.iScale,i=e.vScale,r=this.getParsed(t);return{label:s?""+s.getLabelForValue(r[s.axis]):"",value:i?""+i.getLabelForValue(r[i.axis]):""}}_update(t){const e=this._cachedMeta;this.update(t||"default"),e._clip=ZO(vt(this.options.clip,JO(e.xScale,e.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,e=this.chart,s=this._cachedMeta,i=s.data||[],r=e.chartArea,o=[],a=this._drawStart||0,l=this._drawCount||i.length-a,c=this.options.drawActiveElementsOnTop;let h;for(s.dataset&&s.dataset.draw(t,r,a,l),h=a;h<a+l;++h){const d=i[h];d.hidden||(d.active&&c?o.push(d):d.draw(t,r))}for(h=0;h<o.length;++h)o[h].draw(t,r)}getStyle(t,e){const s=e?"active":"default";return t===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(s):this.resolveDataElementOptions(t||0,s)}getContext(t,e,s){const i=this.getDataset();let r;if(t>=0&&t<this._cachedMeta.data.length){const o=this._cachedMeta.data[t];r=o.$context||(o.$context=rL(this.getContext(),t,o)),r.parsed=this.getParsed(t),r.raw=i.data[t],r.index=r.dataIndex=t}else r=this.$context||(this.$context=iL(this.chart.getContext(),this.index)),r.dataset=i,r.index=r.datasetIndex=this.index;return r.active=!!e,r.mode=s,r}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,e){return this._resolveElementOptions(this.dataElementType.id,e,t)}_resolveElementOptions(t,e="default",s){const i=e==="active",r=this._cachedDataOpts,o=t+"-"+e,a=r[o],l=this.enableOptionSharing&&aa(s);if(a)return M_(a,l);const c=this.chart.config,h=c.datasetElementScopeKeys(this._type,t),d=i?[`${t}Hover`,"hover",t,""]:[t,""],f=c.getOptionScopes(this.getDataset(),h),g=Object.keys(ne.elements[t]),_=()=>this.getContext(s,i,e),y=c.resolveNamedOptions(f,g,_,d);return y.$shared&&(y.$shared=l,r[o]=Object.freeze(M_(y,l))),y}_resolveAnimations(t,e,s){const i=this.chart,r=this._cachedDataOpts,o=`animation-${e}`,a=r[o];if(a)return a;let l;if(i.options.animation!==!1){const h=this.chart.config,d=h.datasetAnimationScopeKeys(this._type,e),f=h.getOptionScopes(this.getDataset(),d);l=h.createResolver(f,this.getContext(t,s,e))}const c=new Ww(i,l&&l.animations);return l&&l._cacheable&&(r[o]=Object.freeze(c)),c}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,e){return!e||sh(t)||this.chart._animationsDisabled}_getSharedOptions(t,e){const s=this.resolveDataElementOptions(t,e),i=this._sharedOptions,r=this.getSharedOptions(s),o=this.includeOptions(e,r)||r!==i;return this.updateSharedOptions(r,e,s),{sharedOptions:r,includeOptions:o}}updateElement(t,e,s,i){sh(i)?Object.assign(t,s):this._resolveAnimations(e,i).update(t,s)}updateSharedOptions(t,e,s){t&&!sh(e)&&this._resolveAnimations(void 0,e).update(t,s)}_setStyle(t,e,s,i){t.active=i;const r=this.getStyle(e,i);this._resolveAnimations(e,s,i).update(t,{options:!i&&this.getSharedOptions(r)||r})}removeHoverStyle(t,e,s){this._setStyle(t,s,"active",!1)}setHoverStyle(t,e,s){this._setStyle(t,s,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const e=this._data,s=this._cachedMeta.data;for(const[a,l,c]of this._syncList)this[a](l,c);this._syncList=[];const i=s.length,r=e.length,o=Math.min(r,i);o&&this.parse(0,o),r>i?this._insertElements(i,r-i,t):r<i&&this._removeElements(r,i-r)}_insertElements(t,e,s=!0){const i=this._cachedMeta,r=i.data,o=t+e;let a;const l=c=>{for(c.length+=e,a=c.length-1;a>=o;a--)c[a]=c[a-e]};for(l(r),a=t;a<o;++a)r[a]=new this.dataElementType;this._parsing&&l(i._parsed),this.parse(t,e),s&&this.updateElements(r,t,e,"reset")}updateElements(t,e,s,i){}_removeElements(t,e){const s=this._cachedMeta;if(this._parsing){const i=s._parsed.splice(t,e);s._stacked&&oo(s,i)}s.data.splice(t,e)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[e,s,i]=t;this[e](s,i)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,e){e&&this._sync(["_removeElements",t,e]);const s=arguments.length-2;s&&this._sync(["_insertElements",t,s])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function aL(n,t){if(!n._cache.$bar){const e=n.getMatchingVisibleMetas(t);let s=[];for(let i=0,r=e.length;i<r;i++)s=s.concat(e[i].controller.getAllParsedValues(n));n._cache.$bar=Iw(s.sort((i,r)=>i-r))}return n._cache.$bar}function lL(n){const t=n.iScale,e=aL(t,n.type);let s=t._length,i,r,o,a;const l=()=>{o===32767||o===-32768||(aa(a)&&(s=Math.min(s,Math.abs(o-a)||s)),a=o)};for(i=0,r=e.length;i<r;++i)o=t.getPixelForValue(e[i]),l();for(a=void 0,i=0,r=t.ticks.length;i<r;++i)o=t.getPixelForTick(i),l();return s}function cL(n,t,e,s){const i=e.barThickness;let r,o;return Ct(i)?(r=t.min*e.categoryPercentage,o=e.barPercentage):(r=i*s,o=1),{chunk:r/s,ratio:o,start:t.pixels[n]-r/2}}function uL(n,t,e,s){const i=t.pixels,r=i[n];let o=n>0?i[n-1]:null,a=n<i.length-1?i[n+1]:null;const l=e.categoryPercentage;o===null&&(o=r-(a===null?t.end-t.start:a-r)),a===null&&(a=r+r-o);const c=r-(r-Math.min(o,a))/2*l;return{chunk:Math.abs(a-o)/2*l/s,ratio:e.barPercentage,start:c}}function hL(n,t,e,s){const i=e.parse(n[0],s),r=e.parse(n[1],s),o=Math.min(i,r),a=Math.max(i,r);let l=o,c=a;Math.abs(o)>Math.abs(a)&&(l=a,c=o),t[e.axis]=c,t._custom={barStart:l,barEnd:c,start:i,end:r,min:o,max:a}}function Gw(n,t,e,s){return ee(n)?hL(n,t,e,s):t[e.axis]=e.parse(n,s),t}function O_(n,t,e,s){const i=n.iScale,r=n.vScale,o=i.getLabels(),a=i===r,l=[];let c,h,d,f;for(c=e,h=e+s;c<h;++c)f=t[c],d={},d[i.axis]=a||i.parse(o[c],c),l.push(Gw(f,d,r,c));return l}function ih(n){return n&&n.barStart!==void 0&&n.barEnd!==void 0}function dL(n,t,e){return n!==0?jn(n):(t.isHorizontal()?1:-1)*(t.min>=e?1:-1)}function fL(n){let t,e,s,i,r;return n.horizontal?(t=n.base>n.x,e="left",s="right"):(t=n.base<n.y,e="bottom",s="top"),t?(i="end",r="start"):(i="start",r="end"),{start:e,end:s,reverse:t,top:i,bottom:r}}function pL(n,t,e,s){let i=t.borderSkipped;const r={};if(!i){n.borderSkipped=r;return}if(i===!0){n.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:a,reverse:l,top:c,bottom:h}=fL(n);i==="middle"&&e&&(n.enableBorderRadius=!0,(e._top||0)===s?i=c:(e._bottom||0)===s?i=h:(r[L_(h,o,a,l)]=!0,i=c)),r[L_(i,o,a,l)]=!0,n.borderSkipped=r}function L_(n,t,e,s){return s?(n=gL(n,t,e),n=V_(n,e,t)):n=V_(n,t,e),n}function gL(n,t,e){return n===t?e:n===e?t:n}function V_(n,t,e){return n==="start"?t:n==="end"?e:n}function mL(n,{inflateAmount:t},e){n.inflateAmount=t==="auto"?e===1?.33:0:t}class _L extends fi{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(t,e,s,i){return O_(t,e,s,i)}parseArrayData(t,e,s,i){return O_(t,e,s,i)}parseObjectData(t,e,s,i){const{iScale:r,vScale:o}=t,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,c=r.axis==="x"?a:l,h=o.axis==="x"?a:l,d=[];let f,g,_,y;for(f=s,g=s+i;f<g;++f)y=e[f],_={},_[r.axis]=r.parse(ai(y,c),f),d.push(Gw(ai(y,h),_,o,f));return d}updateRangeFromParsed(t,e,s,i){super.updateRangeFromParsed(t,e,s,i);const r=s._custom;r&&e===this._cachedMeta.vScale&&(t.min=Math.min(t.min,r.min),t.max=Math.max(t.max,r.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const e=this._cachedMeta,{iScale:s,vScale:i}=e,r=this.getParsed(t),o=r._custom,a=ih(o)?"["+o.start+", "+o.end+"]":""+i.getLabelForValue(r[i.axis]);return{label:""+s.getLabelForValue(r[s.axis]),value:a}}initialize(){this.enableOptionSharing=!0,super.initialize();const t=this._cachedMeta;t.stack=this.getDataset().stack}update(t){const e=this._cachedMeta;this.updateElements(e.data,0,e.data.length,t)}updateElements(t,e,s,i){const r=i==="reset",{index:o,_cachedMeta:{vScale:a}}=this,l=a.getBasePixel(),c=a.isHorizontal(),h=this._getRuler(),{sharedOptions:d,includeOptions:f}=this._getSharedOptions(e,i);for(let g=e;g<e+s;g++){const _=this.getParsed(g),y=r||Ct(_[a.axis])?{base:l,head:l}:this._calculateBarValuePixels(g),w=this._calculateBarIndexPixels(g,h),E=(_._stacks||{})[a.axis],S={horizontal:c,base:y.base,enableBorderRadius:!E||ih(_._custom)||o===E._top||o===E._bottom,x:c?y.head:w.center,y:c?w.center:y.head,height:c?w.size:Math.abs(y.size),width:c?Math.abs(y.size):w.size};f&&(S.options=d||this.resolveDataElementOptions(g,t[g].active?"active":i));const A=S.options||t[g].options;pL(S,A,E,o),mL(S,A,h.ratio),this.updateElement(t[g],g,S,i)}}_getStacks(t,e){const{iScale:s}=this._cachedMeta,i=s.getMatchingVisibleMetas(this._type).filter(h=>h.controller.options.grouped),r=s.options.stacked,o=[],a=this._cachedMeta.controller.getParsed(e),l=a&&a[s.axis],c=h=>{const d=h._parsed.find(g=>g[s.axis]===l),f=d&&d[h.vScale.axis];if(Ct(f)||isNaN(f))return!0};for(const h of i)if(!(e!==void 0&&c(h))&&((r===!1||o.indexOf(h.stack)===-1||r===void 0&&h.stack===void 0)&&o.push(h.stack),h.index===t))break;return o.length||o.push(void 0),o}_getStackCount(t){return this._getStacks(void 0,t).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const t=this.chart.scales,e=this.chart.options.indexAxis;return Object.keys(t).filter(s=>t[s].axis===e).shift()}_getAxis(){const t={},e=this.getFirstScaleIdForIndexAxis();for(const s of this.chart.data.datasets)t[vt(this.chart.options.indexAxis==="x"?s.xAxisID:s.yAxisID,e)]=!0;return Object.keys(t)}_getStackIndex(t,e,s){const i=this._getStacks(t,s),r=e!==void 0?i.indexOf(e):-1;return r===-1?i.length-1:r}_getRuler(){const t=this.options,e=this._cachedMeta,s=e.iScale,i=[];let r,o;for(r=0,o=e.data.length;r<o;++r)i.push(s.getPixelForValue(this.getParsed(r)[s.axis],r));const a=t.barThickness;return{min:a||lL(e),pixels:i,start:s._startPixel,end:s._endPixel,stackCount:this._getStackCount(),scale:s,grouped:t.grouped,ratio:a?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:e,_stacked:s,index:i},options:{base:r,minBarLength:o}}=this,a=r||0,l=this.getParsed(t),c=l._custom,h=ih(c);let d=l[e.axis],f=0,g=s?this.applyStack(e,l,s):d,_,y;g!==d&&(f=g-d,g=d),h&&(d=c.barStart,g=c.barEnd-c.barStart,d!==0&&jn(d)!==jn(c.barEnd)&&(f=0),f+=d);const w=!Ct(r)&&!h?r:f;let E=e.getPixelForValue(w);if(this.chart.getDataVisibility(t)?_=e.getPixelForValue(f+g):_=E,y=_-E,Math.abs(y)<o){y=dL(y,e,a)*o,d===a&&(E-=y/2);const S=e.getPixelForDecimal(0),A=e.getPixelForDecimal(1),k=Math.min(S,A),R=Math.max(S,A);E=Math.max(Math.min(E,R),k),_=E+y,s&&!h&&(l._stacks[e.axis]._visualValues[i]=e.getValueForPixel(_)-e.getValueForPixel(E))}if(E===e.getPixelForValue(a)){const S=jn(y)*e.getLineWidthForValue(a)/2;E+=S,y-=S}return{size:y,base:E,head:_,center:_+y/2}}_calculateBarIndexPixels(t,e){const s=e.scale,i=this.options,r=i.skipNull,o=vt(i.maxBarThickness,1/0);let a,l;const c=this._getAxisCount();if(e.grouped){const h=r?this._getStackCount(t):e.stackCount,d=i.barThickness==="flex"?uL(t,e,i,h*c):cL(t,e,i,h*c),f=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,g=this._getAxis().indexOf(vt(f,this.getFirstScaleIdForIndexAxis())),_=this._getStackIndex(this.index,this._cachedMeta.stack,r?t:void 0)+g;a=d.start+d.chunk*_+d.chunk/2,l=Math.min(o,d.chunk*d.ratio)}else a=s.getPixelForValue(this.getParsed(t)[s.axis],t),l=Math.min(o,e.min*e.ratio);return{base:a-l/2,head:a+l/2,center:a,size:l}}draw(){const t=this._cachedMeta,e=t.vScale,s=t.data,i=s.length;let r=0;for(;r<i;++r)this.getParsed(r)[e.axis]!==null&&!s[r].hidden&&s[r].draw(this._ctx)}}class yL extends fi{static id="bubble";static defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}};static overrides={scales:{x:{type:"linear"},y:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(t,e,s,i){const r=super.parsePrimitiveData(t,e,s,i);for(let o=0;o<r.length;o++)r[o]._custom=this.resolveDataElementOptions(o+s).radius;return r}parseArrayData(t,e,s,i){const r=super.parseArrayData(t,e,s,i);for(let o=0;o<r.length;o++){const a=e[s+o];r[o]._custom=vt(a[2],this.resolveDataElementOptions(o+s).radius)}return r}parseObjectData(t,e,s,i){const r=super.parseObjectData(t,e,s,i);for(let o=0;o<r.length;o++){const a=e[s+o];r[o]._custom=vt(a&&a.r&&+a.r,this.resolveDataElementOptions(o+s).radius)}return r}getMaxOverflow(){const t=this._cachedMeta.data;let e=0;for(let s=t.length-1;s>=0;--s)e=Math.max(e,t[s].size(this.resolveDataElementOptions(s))/2);return e>0&&e}getLabelAndValue(t){const e=this._cachedMeta,s=this.chart.data.labels||[],{xScale:i,yScale:r}=e,o=this.getParsed(t),a=i.getLabelForValue(o.x),l=r.getLabelForValue(o.y),c=o._custom;return{label:s[t]||"",value:"("+a+", "+l+(c?", "+c:"")+")"}}update(t){const e=this._cachedMeta.data;this.updateElements(e,0,e.length,t)}updateElements(t,e,s,i){const r=i==="reset",{iScale:o,vScale:a}=this._cachedMeta,{sharedOptions:l,includeOptions:c}=this._getSharedOptions(e,i),h=o.axis,d=a.axis;for(let f=e;f<e+s;f++){const g=t[f],_=!r&&this.getParsed(f),y={},w=y[h]=r?o.getPixelForDecimal(.5):o.getPixelForValue(_[h]),E=y[d]=r?a.getBasePixel():a.getPixelForValue(_[d]);y.skip=isNaN(w)||isNaN(E),c&&(y.options=l||this.resolveDataElementOptions(f,g.active?"active":i),r&&(y.options.radius=0)),this.updateElement(g,f,y,i)}}resolveDataElementOptions(t,e){const s=this.getParsed(t);let i=super.resolveDataElementOptions(t,e);i.$shared&&(i=Object.assign({},i,{$shared:!1}));const r=i.radius;return e!=="active"&&(i.radius=0),i.radius+=vt(s&&s._custom,r),i}}function bL(n,t,e){let s=1,i=1,r=0,o=0;if(t<te){const a=n,l=a+t,c=Math.cos(a),h=Math.sin(a),d=Math.cos(l),f=Math.sin(l),g=(A,k,R)=>la(A,a,l,!0)?1:Math.max(k,k*e,R,R*e),_=(A,k,R)=>la(A,a,l,!0)?-1:Math.min(k,k*e,R,R*e),y=g(0,c,d),w=g(ce,h,f),E=_(Nt,c,d),S=_(Nt+ce,h,f);s=(y-E)/2,i=(w-S)/2,r=-(y+E)/2,o=-(w+S)/2}return{ratioX:s,ratioY:i,offsetX:r,offsetY:o}}class tp extends fi{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:t=>t!=="spacing",_indexable:t=>t!=="spacing"&&!t.startsWith("borderDash")&&!t.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data,{labels:{pointStyle:s,textAlign:i,color:r,useBorderRadius:o,borderRadius:a}}=t.legend.options;return e.labels.length&&e.datasets.length?e.labels.map((l,c)=>{const d=t.getDatasetMeta(0).controller.getStyle(c);return{text:l,fillStyle:d.backgroundColor,fontColor:r,hidden:!t.getDataVisibility(c),lineDash:d.borderDash,lineDashOffset:d.borderDashOffset,lineJoin:d.borderJoinStyle,lineWidth:d.borderWidth,strokeStyle:d.borderColor,textAlign:i,pointStyle:s,borderRadius:o&&(a||d.borderRadius),index:c}}):[]}},onClick(t,e,s){s.chart.toggleDataVisibility(e.index),s.chart.update()}}}};constructor(t,e){super(t,e),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,e){const s=this.getDataset().data,i=this._cachedMeta;if(this._parsing===!1)i._parsed=s;else{let r=l=>+s[l];if(Mt(s[t])){const{key:l="value"}=this._parsing;r=c=>+ai(s[c],l)}let o,a;for(o=t,a=t+e;o<a;++o)i._parsed[o]=r(o)}}_getRotation(){return Tn(this.options.rotation-90)}_getCircumference(){return Tn(this.options.circumference)}_getRotationExtents(){let t=te,e=-te;for(let s=0;s<this.chart.data.datasets.length;++s)if(this.chart.isDatasetVisible(s)&&this.chart.getDatasetMeta(s).type===this._type){const i=this.chart.getDatasetMeta(s).controller,r=i._getRotation(),o=i._getCircumference();t=Math.min(t,r),e=Math.max(e,r+o)}return{rotation:t,circumference:e-t}}update(t){const e=this.chart,{chartArea:s}=e,i=this._cachedMeta,r=i.data,o=this.getMaxBorderWidth()+this.getMaxOffset(r)+this.options.spacing,a=Math.max((Math.min(s.width,s.height)-o)/2,0),l=Math.min(P2(this.options.cutout,a),1),c=this._getRingWeight(this.index),{circumference:h,rotation:d}=this._getRotationExtents(),{ratioX:f,ratioY:g,offsetX:_,offsetY:y}=bL(d,h,l),w=(s.width-o)/f,E=(s.height-o)/g,S=Math.max(Math.min(w,E)/2,0),A=vw(this.options.radius,S),k=Math.max(A*l,0),R=(A-k)/this._getVisibleDatasetWeightTotal();this.offsetX=_*A,this.offsetY=y*A,i.total=this.calculateTotal(),this.outerRadius=A-R*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-R*c,0),this.updateElements(r,0,r.length,t)}_circumference(t,e){const s=this.options,i=this._cachedMeta,r=this._getCircumference();return e&&s.animation.animateRotate||!this.chart.getDataVisibility(t)||i._parsed[t]===null||i.data[t].hidden?0:this.calculateCircumference(i._parsed[t]*r/te)}updateElements(t,e,s,i){const r=i==="reset",o=this.chart,a=o.chartArea,c=o.options.animation,h=(a.left+a.right)/2,d=(a.top+a.bottom)/2,f=r&&c.animateScale,g=f?0:this.innerRadius,_=f?0:this.outerRadius,{sharedOptions:y,includeOptions:w}=this._getSharedOptions(e,i);let E=this._getRotation(),S;for(S=0;S<e;++S)E+=this._circumference(S,r);for(S=e;S<e+s;++S){const A=this._circumference(S,r),k=t[S],R={x:h+this.offsetX,y:d+this.offsetY,startAngle:E,endAngle:E+A,circumference:A,outerRadius:_,innerRadius:g};w&&(R.options=y||this.resolveDataElementOptions(S,k.active?"active":i)),E+=A,this.updateElement(k,S,R,i)}}calculateTotal(){const t=this._cachedMeta,e=t.data;let s=0,i;for(i=0;i<e.length;i++){const r=t._parsed[i];r!==null&&!isNaN(r)&&this.chart.getDataVisibility(i)&&!e[i].hidden&&(s+=Math.abs(r))}return s}calculateCircumference(t){const e=this._cachedMeta.total;return e>0&&!isNaN(t)?te*(Math.abs(t)/e):0}getLabelAndValue(t){const e=this._cachedMeta,s=this.chart,i=s.data.labels||[],r=ka(e._parsed[t],s.options.locale);return{label:i[t]||"",value:r}}getMaxBorderWidth(t){let e=0;const s=this.chart;let i,r,o,a,l;if(!t){for(i=0,r=s.data.datasets.length;i<r;++i)if(s.isDatasetVisible(i)){o=s.getDatasetMeta(i),t=o.data,a=o.controller;break}}if(!t)return 0;for(i=0,r=t.length;i<r;++i)l=a.resolveDataElementOptions(i),l.borderAlign!=="inner"&&(e=Math.max(e,l.borderWidth||0,l.hoverBorderWidth||0));return e}getMaxOffset(t){let e=0;for(let s=0,i=t.length;s<i;++s){const r=this.resolveDataElementOptions(s);e=Math.max(e,r.offset||0,r.hoverOffset||0)}return e}_getRingWeightOffset(t){let e=0;for(let s=0;s<t;++s)this.chart.isDatasetVisible(s)&&(e+=this._getRingWeight(s));return e}_getRingWeight(t){return Math.max(vt(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}class vL extends fi{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(t){const e=this._cachedMeta,{dataset:s,data:i=[],_dataset:r}=e,o=this.chart._animationsDisabled;let{start:a,count:l}=Cw(e,i,o);this._drawStart=a,this._drawCount=l,Pw(e)&&(a=0,l=i.length),s._chart=this.chart,s._datasetIndex=this.index,s._decimated=!!r._decimated,s.points=i;const c=this.resolveDatasetElementOptions(t);this.options.showLine||(c.borderWidth=0),c.segment=this.options.segment,this.updateElement(s,void 0,{animated:!o,options:c},t),this.updateElements(i,a,l,t)}updateElements(t,e,s,i){const r=i==="reset",{iScale:o,vScale:a,_stacked:l,_dataset:c}=this._cachedMeta,{sharedOptions:h,includeOptions:d}=this._getSharedOptions(e,i),f=o.axis,g=a.axis,{spanGaps:_,segment:y}=this.options,w=Cr(_)?_:Number.POSITIVE_INFINITY,E=this.chart._animationsDisabled||r||i==="none",S=e+s,A=t.length;let k=e>0&&this.getParsed(e-1);for(let R=0;R<A;++R){const L=t[R],x=E?L:{};if(R<e||R>=S){x.skip=!0;continue}const b=this.getParsed(R),T=Ct(b[g]),C=x[f]=o.getPixelForValue(b[f],R),P=x[g]=r||T?a.getBasePixel():a.getPixelForValue(l?this.applyStack(a,b,l):b[g],R);x.skip=isNaN(C)||isNaN(P)||T,x.stop=R>0&&Math.abs(b[f]-k[f])>w,y&&(x.parsed=b,x.raw=c.data[R]),d&&(x.options=h||this.resolveDataElementOptions(R,L.active?"active":i)),E||this.updateElement(L,R,x,i),k=b}}getMaxOverflow(){const t=this._cachedMeta,e=t.dataset,s=e.options&&e.options.borderWidth||0,i=t.data||[];if(!i.length)return s;const r=i[0].size(this.resolveDataElementOptions(0)),o=i[i.length-1].size(this.resolveDataElementOptions(i.length-1));return Math.max(s,r,o)/2}draw(){const t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}}class Kw extends fi{static id="polarArea";static defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:s,color:i}}=t.legend.options;return e.labels.map((r,o)=>{const l=t.getDatasetMeta(0).controller.getStyle(o);return{text:r,fillStyle:l.backgroundColor,strokeStyle:l.borderColor,fontColor:i,lineWidth:l.borderWidth,pointStyle:s,hidden:!t.getDataVisibility(o),index:o}})}return[]}},onClick(t,e,s){s.chart.toggleDataVisibility(e.index),s.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};constructor(t,e){super(t,e),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(t){const e=this._cachedMeta,s=this.chart,i=s.data.labels||[],r=ka(e._parsed[t].r,s.options.locale);return{label:i[t]||"",value:r}}parseObjectData(t,e,s,i){return Nw.bind(this)(t,e,s,i)}update(t){const e=this._cachedMeta.data;this._updateRadius(),this.updateElements(e,0,e.length,t)}getMinMax(){const t=this._cachedMeta,e={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return t.data.forEach((s,i)=>{const r=this.getParsed(i).r;!isNaN(r)&&this.chart.getDataVisibility(i)&&(r<e.min&&(e.min=r),r>e.max&&(e.max=r))}),e}_updateRadius(){const t=this.chart,e=t.chartArea,s=t.options,i=Math.min(e.right-e.left,e.bottom-e.top),r=Math.max(i/2,0),o=Math.max(s.cutoutPercentage?r/100*s.cutoutPercentage:1,0),a=(r-o)/t.getVisibleDatasetCount();this.outerRadius=r-a*this.index,this.innerRadius=this.outerRadius-a}updateElements(t,e,s,i){const r=i==="reset",o=this.chart,l=o.options.animation,c=this._cachedMeta.rScale,h=c.xCenter,d=c.yCenter,f=c.getIndexAngle(0)-.5*Nt;let g=f,_;const y=360/this.countVisibleElements();for(_=0;_<e;++_)g+=this._computeAngle(_,i,y);for(_=e;_<e+s;_++){const w=t[_];let E=g,S=g+this._computeAngle(_,i,y),A=o.getDataVisibility(_)?c.getDistanceFromCenterForValue(this.getParsed(_).r):0;g=S,r&&(l.animateScale&&(A=0),l.animateRotate&&(E=S=f));const k={x:h,y:d,innerRadius:0,outerRadius:A,startAngle:E,endAngle:S,options:this.resolveDataElementOptions(_,w.active?"active":i)};this.updateElement(w,_,k,i)}}countVisibleElements(){const t=this._cachedMeta;let e=0;return t.data.forEach((s,i)=>{!isNaN(this.getParsed(i).r)&&this.chart.getDataVisibility(i)&&e++}),e}_computeAngle(t,e,s){return this.chart.getDataVisibility(t)?Tn(this.resolveDataElementOptions(t,e).angle||s):0}}class wL extends tp{static id="pie";static defaults={cutout:0,rotation:0,circumference:360,radius:"100%"}}class xL extends fi{static id="radar";static defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}};static overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};getLabelAndValue(t){const e=this._cachedMeta.vScale,s=this.getParsed(t);return{label:e.getLabels()[t],value:""+e.getLabelForValue(s[e.axis])}}parseObjectData(t,e,s,i){return Nw.bind(this)(t,e,s,i)}update(t){const e=this._cachedMeta,s=e.dataset,i=e.data||[],r=e.iScale.getLabels();if(s.points=i,t!=="resize"){const o=this.resolveDatasetElementOptions(t);this.options.showLine||(o.borderWidth=0);const a={_loop:!0,_fullLoop:r.length===i.length,options:o};this.updateElement(s,void 0,a,t)}this.updateElements(i,0,i.length,t)}updateElements(t,e,s,i){const r=this._cachedMeta.rScale,o=i==="reset";for(let a=e;a<e+s;a++){const l=t[a],c=this.resolveDataElementOptions(a,l.active?"active":i),h=r.getPointPositionForValue(a,this.getParsed(a).r),d=o?r.xCenter:h.x,f=o?r.yCenter:h.y,g={x:d,y:f,angle:h.angle,skip:isNaN(d)||isNaN(f),options:c};this.updateElement(l,a,g,i)}}}class TL extends fi{static id="scatter";static defaults={datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1};static overrides={interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}};getLabelAndValue(t){const e=this._cachedMeta,s=this.chart.data.labels||[],{xScale:i,yScale:r}=e,o=this.getParsed(t),a=i.getLabelForValue(o.x),l=r.getLabelForValue(o.y);return{label:s[t]||"",value:"("+a+", "+l+")"}}update(t){const e=this._cachedMeta,{data:s=[]}=e,i=this.chart._animationsDisabled;let{start:r,count:o}=Cw(e,s,i);if(this._drawStart=r,this._drawCount=o,Pw(e)&&(r=0,o=s.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:a,_dataset:l}=e;a._chart=this.chart,a._datasetIndex=this.index,a._decimated=!!l._decimated,a.points=s;const c=this.resolveDatasetElementOptions(t);c.segment=this.options.segment,this.updateElement(a,void 0,{animated:!i,options:c},t)}else this.datasetElementType&&(delete e.dataset,this.datasetElementType=!1);this.updateElements(s,r,o,t)}addElements(){const{showLine:t}=this.options;!this.datasetElementType&&t&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(t,e,s,i){const r=i==="reset",{iScale:o,vScale:a,_stacked:l,_dataset:c}=this._cachedMeta,h=this.resolveDataElementOptions(e,i),d=this.getSharedOptions(h),f=this.includeOptions(i,d),g=o.axis,_=a.axis,{spanGaps:y,segment:w}=this.options,E=Cr(y)?y:Number.POSITIVE_INFINITY,S=this.chart._animationsDisabled||r||i==="none";let A=e>0&&this.getParsed(e-1);for(let k=e;k<e+s;++k){const R=t[k],L=this.getParsed(k),x=S?R:{},b=Ct(L[_]),T=x[g]=o.getPixelForValue(L[g],k),C=x[_]=r||b?a.getBasePixel():a.getPixelForValue(l?this.applyStack(a,L,l):L[_],k);x.skip=isNaN(T)||isNaN(C)||b,x.stop=k>0&&Math.abs(L[g]-A[g])>E,w&&(x.parsed=L,x.raw=c.data[k]),f&&(x.options=d||this.resolveDataElementOptions(k,R.active?"active":i)),S||this.updateElement(R,k,x,i),A=L}this.updateSharedOptions(d,i,h)}getMaxOverflow(){const t=this._cachedMeta,e=t.data||[];if(!this.options.showLine){let a=0;for(let l=e.length-1;l>=0;--l)a=Math.max(a,e[l].size(this.resolveDataElementOptions(l))/2);return a>0&&a}const s=t.dataset,i=s.options&&s.options.borderWidth||0;if(!e.length)return i;const r=e[0].size(this.resolveDataElementOptions(0)),o=e[e.length-1].size(this.resolveDataElementOptions(e.length-1));return Math.max(i,r,o)/2}}var EL=Object.freeze({__proto__:null,BarController:_L,BubbleController:yL,DoughnutController:tp,LineController:vL,PieController:wL,PolarAreaController:Kw,RadarController:xL,ScatterController:TL});function xi(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class ep{static override(t){Object.assign(ep.prototype,t)}options;constructor(t){this.options=t||{}}init(){}formats(){return xi()}parse(){return xi()}format(){return xi()}add(){return xi()}diff(){return xi()}startOf(){return xi()}endOf(){return xi()}}var IL={_date:ep};function AL(n,t,e,s){const{controller:i,data:r,_sorted:o}=n,a=i._cachedMeta.iScale,l=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null;if(a&&t===a.axis&&t!=="r"&&o&&r.length){const c=a._reversePixels?z2:cs;if(s){if(i._sharedOptions){const h=r[0],d=typeof h.getRange=="function"&&h.getRange(t);if(d){const f=c(r,t,e-d),g=c(r,t,e+d);return{lo:f.lo,hi:g.hi}}}}else{const h=c(r,t,e);if(l){const{vScale:d}=i._cachedMeta,{_parsed:f}=n,g=f.slice(0,h.lo+1).reverse().findIndex(y=>!Ct(y[d.axis]));h.lo-=Math.max(0,g);const _=f.slice(h.hi).findIndex(y=>!Ct(y[d.axis]));h.hi+=Math.max(0,_)}return h}}return{lo:0,hi:r.length-1}}function uu(n,t,e,s,i){const r=n.getSortedVisibleDatasetMetas(),o=e[t];for(let a=0,l=r.length;a<l;++a){const{index:c,data:h}=r[a],{lo:d,hi:f}=AL(r[a],t,o,i);for(let g=d;g<=f;++g){const _=h[g];_.skip||s(_,c,g)}}}function SL(n){const t=n.indexOf("x")!==-1,e=n.indexOf("y")!==-1;return function(s,i){const r=t?Math.abs(s.x-i.x):0,o=e?Math.abs(s.y-i.y):0;return Math.sqrt(Math.pow(r,2)+Math.pow(o,2))}}function rh(n,t,e,s,i){const r=[];return!i&&!n.isPointInArea(t)||uu(n,e,t,function(a,l,c){!i&&!us(a,n.chartArea,0)||a.inRange(t.x,t.y,s)&&r.push({element:a,datasetIndex:l,index:c})},!0),r}function CL(n,t,e,s){let i=[];function r(o,a,l){const{startAngle:c,endAngle:h}=o.getProps(["startAngle","endAngle"],s),{angle:d}=Tw(o,{x:t.x,y:t.y});la(d,c,h)&&i.push({element:o,datasetIndex:a,index:l})}return uu(n,e,t,r),i}function PL(n,t,e,s,i,r){let o=[];const a=SL(e);let l=Number.POSITIVE_INFINITY;function c(h,d,f){const g=h.inRange(t.x,t.y,i);if(s&&!g)return;const _=h.getCenterPoint(i);if(!(!!r||n.isPointInArea(_))&&!g)return;const w=a(t,_);w<l?(o=[{element:h,datasetIndex:d,index:f}],l=w):w===l&&o.push({element:h,datasetIndex:d,index:f})}return uu(n,e,t,c),o}function oh(n,t,e,s,i,r){return!r&&!n.isPointInArea(t)?[]:e==="r"&&!s?CL(n,t,e,i):PL(n,t,e,s,i,r)}function N_(n,t,e,s,i){const r=[],o=e==="x"?"inXRange":"inYRange";let a=!1;return uu(n,e,t,(l,c,h)=>{l[o]&&l[o](t[e],i)&&(r.push({element:l,datasetIndex:c,index:h}),a=a||l.inRange(t.x,t.y,i))}),s&&!a?[]:r}var RL={modes:{index(n,t,e,s){const i=Ai(t,n),r=e.axis||"x",o=e.includeInvisible||!1,a=e.intersect?rh(n,i,r,s,o):oh(n,i,r,!1,s,o),l=[];return a.length?(n.getSortedVisibleDatasetMetas().forEach(c=>{const h=a[0].index,d=c.data[h];d&&!d.skip&&l.push({element:d,datasetIndex:c.index,index:h})}),l):[]},dataset(n,t,e,s){const i=Ai(t,n),r=e.axis||"xy",o=e.includeInvisible||!1;let a=e.intersect?rh(n,i,r,s,o):oh(n,i,r,!1,s,o);if(a.length>0){const l=a[0].datasetIndex,c=n.getDatasetMeta(l).data;a=[];for(let h=0;h<c.length;++h)a.push({element:c[h],datasetIndex:l,index:h})}return a},point(n,t,e,s){const i=Ai(t,n),r=e.axis||"xy",o=e.includeInvisible||!1;return rh(n,i,r,s,o)},nearest(n,t,e,s){const i=Ai(t,n),r=e.axis||"xy",o=e.includeInvisible||!1;return oh(n,i,r,e.intersect,s,o)},x(n,t,e,s){const i=Ai(t,n);return N_(n,i,"x",e.intersect,s)},y(n,t,e,s){const i=Ai(t,n);return N_(n,i,"y",e.intersect,s)}}};const Yw=["left","top","right","bottom"];function ao(n,t){return n.filter(e=>e.pos===t)}function F_(n,t){return n.filter(e=>Yw.indexOf(e.pos)===-1&&e.box.axis===t)}function lo(n,t){return n.sort((e,s)=>{const i=t?s:e,r=t?e:s;return i.weight===r.weight?i.index-r.index:i.weight-r.weight})}function kL(n){const t=[];let e,s,i,r,o,a;for(e=0,s=(n||[]).length;e<s;++e)i=n[e],{position:r,options:{stack:o,stackWeight:a=1}}=i,t.push({index:e,box:i,pos:r,horizontal:i.isHorizontal(),weight:i.weight,stack:o&&r+o,stackWeight:a});return t}function DL(n){const t={};for(const e of n){const{stack:s,pos:i,stackWeight:r}=e;if(!s||!Yw.includes(i))continue;const o=t[s]||(t[s]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=r}return t}function ML(n,t){const e=DL(n),{vBoxMaxWidth:s,hBoxMaxHeight:i}=t;let r,o,a;for(r=0,o=n.length;r<o;++r){a=n[r];const{fullSize:l}=a.box,c=e[a.stack],h=c&&a.stackWeight/c.weight;a.horizontal?(a.width=h?h*s:l&&t.availableWidth,a.height=i):(a.width=s,a.height=h?h*i:l&&t.availableHeight)}return e}function OL(n){const t=kL(n),e=lo(t.filter(c=>c.box.fullSize),!0),s=lo(ao(t,"left"),!0),i=lo(ao(t,"right")),r=lo(ao(t,"top"),!0),o=lo(ao(t,"bottom")),a=F_(t,"x"),l=F_(t,"y");return{fullSize:e,leftAndTop:s.concat(r),rightAndBottom:i.concat(l).concat(o).concat(a),chartArea:ao(t,"chartArea"),vertical:s.concat(i).concat(l),horizontal:r.concat(o).concat(a)}}function B_(n,t,e,s){return Math.max(n[e],t[e])+Math.max(n[s],t[s])}function Xw(n,t){n.top=Math.max(n.top,t.top),n.left=Math.max(n.left,t.left),n.bottom=Math.max(n.bottom,t.bottom),n.right=Math.max(n.right,t.right)}function LL(n,t,e,s){const{pos:i,box:r}=e,o=n.maxPadding;if(!Mt(i)){e.size&&(n[i]-=e.size);const d=s[e.stack]||{size:0,count:1};d.size=Math.max(d.size,e.horizontal?r.height:r.width),e.size=d.size/d.count,n[i]+=e.size}r.getPadding&&Xw(o,r.getPadding());const a=Math.max(0,t.outerWidth-B_(o,n,"left","right")),l=Math.max(0,t.outerHeight-B_(o,n,"top","bottom")),c=a!==n.w,h=l!==n.h;return n.w=a,n.h=l,e.horizontal?{same:c,other:h}:{same:h,other:c}}function VL(n){const t=n.maxPadding;function e(s){const i=Math.max(t[s]-n[s],0);return n[s]+=i,i}n.y+=e("top"),n.x+=e("left"),e("right"),e("bottom")}function NL(n,t){const e=t.maxPadding;function s(i){const r={left:0,top:0,right:0,bottom:0};return i.forEach(o=>{r[o]=Math.max(t[o],e[o])}),r}return s(n?["left","right"]:["top","bottom"])}function vo(n,t,e,s){const i=[];let r,o,a,l,c,h;for(r=0,o=n.length,c=0;r<o;++r){a=n[r],l=a.box,l.update(a.width||t.w,a.height||t.h,NL(a.horizontal,t));const{same:d,other:f}=LL(t,e,a,s);c|=d&&i.length,h=h||f,l.fullSize||i.push(a)}return c&&vo(i,t,e,s)||h}function hl(n,t,e,s,i){n.top=e,n.left=t,n.right=t+s,n.bottom=e+i,n.width=s,n.height=i}function U_(n,t,e,s){const i=e.padding;let{x:r,y:o}=t;for(const a of n){const l=a.box,c=s[a.stack]||{placed:0,weight:1},h=a.stackWeight/c.weight||1;if(a.horizontal){const d=t.w*h,f=c.size||l.height;aa(c.start)&&(o=c.start),l.fullSize?hl(l,i.left,o,e.outerWidth-i.right-i.left,f):hl(l,t.left+c.placed,o,d,f),c.start=o,c.placed+=d,o=l.bottom}else{const d=t.h*h,f=c.size||l.width;aa(c.start)&&(r=c.start),l.fullSize?hl(l,r,i.top,f,e.outerHeight-i.bottom-i.top):hl(l,r,t.top+c.placed,f,d),c.start=r,c.placed+=d,r=l.right}}t.x=r,t.y=o}var Be={addBox(n,t){n.boxes||(n.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(e){t.draw(e)}}]},n.boxes.push(t)},removeBox(n,t){const e=n.boxes?n.boxes.indexOf(t):-1;e!==-1&&n.boxes.splice(e,1)},configure(n,t,e){t.fullSize=e.fullSize,t.position=e.position,t.weight=e.weight},update(n,t,e,s){if(!n)return;const i=ze(n.options.layout.padding),r=Math.max(t-i.width,0),o=Math.max(e-i.height,0),a=OL(n.boxes),l=a.vertical,c=a.horizontal;jt(n.boxes,y=>{typeof y.beforeLayout=="function"&&y.beforeLayout()});const h=l.reduce((y,w)=>w.box.options&&w.box.options.display===!1?y:y+1,0)||1,d=Object.freeze({outerWidth:t,outerHeight:e,padding:i,availableWidth:r,availableHeight:o,vBoxMaxWidth:r/2/h,hBoxMaxHeight:o/2}),f=Object.assign({},i);Xw(f,ze(s));const g=Object.assign({maxPadding:f,w:r,h:o,x:i.left,y:i.top},i),_=ML(l.concat(c),d);vo(a.fullSize,g,d,_),vo(l,g,d,_),vo(c,g,d,_)&&vo(l,g,d,_),VL(g),U_(a.leftAndTop,g,d,_),g.x+=g.w,g.y+=g.h,U_(a.rightAndBottom,g,d,_),n.chartArea={left:g.left,top:g.top,right:g.left+g.w,bottom:g.top+g.h,height:g.h,width:g.w},jt(a.chartArea,y=>{const w=y.box;Object.assign(w,n.chartArea),w.update(g.w,g.h,{left:0,top:0,right:0,bottom:0})})}};class Qw{acquireContext(t,e){}releaseContext(t){return!1}addEventListener(t,e,s){}removeEventListener(t,e,s){}getDevicePixelRatio(){return 1}getMaximumSize(t,e,s,i){return e=Math.max(0,e||t.width),s=s||t.height,{width:e,height:Math.max(0,i?Math.floor(e/i):s)}}isAttached(t){return!0}updateConfig(t){}}class FL extends Qw{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const Vl="$chartjs",BL={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},$_=n=>n===null||n==="";function UL(n,t){const e=n.style,s=n.getAttribute("height"),i=n.getAttribute("width");if(n[Vl]={initial:{height:s,width:i,style:{display:e.display,height:e.height,width:e.width}}},e.display=e.display||"block",e.boxSizing=e.boxSizing||"border-box",$_(i)){const r=E_(n,"width");r!==void 0&&(n.width=r)}if($_(s))if(n.style.height==="")n.height=n.width/(t||2);else{const r=E_(n,"height");r!==void 0&&(n.height=r)}return n}const Jw=LO?{passive:!0}:!1;function $L(n,t,e){n&&n.addEventListener(t,e,Jw)}function zL(n,t,e){n&&n.canvas&&n.canvas.removeEventListener(t,e,Jw)}function jL(n,t){const e=BL[n.type]||n.type,{x:s,y:i}=Ai(n,t);return{type:e,chart:t,native:n,x:s!==void 0?s:null,y:i!==void 0?i:null}}function bc(n,t){for(const e of n)if(e===t||e.contains(t))return!0}function HL(n,t,e){const s=n.canvas,i=new MutationObserver(r=>{let o=!1;for(const a of r)o=o||bc(a.addedNodes,s),o=o&&!bc(a.removedNodes,s);o&&e()});return i.observe(document,{childList:!0,subtree:!0}),i}function WL(n,t,e){const s=n.canvas,i=new MutationObserver(r=>{let o=!1;for(const a of r)o=o||bc(a.removedNodes,s),o=o&&!bc(a.addedNodes,s);o&&e()});return i.observe(document,{childList:!0,subtree:!0}),i}const ua=new Map;let z_=0;function Zw(){const n=window.devicePixelRatio;n!==z_&&(z_=n,ua.forEach((t,e)=>{e.currentDevicePixelRatio!==n&&t()}))}function qL(n,t){ua.size||window.addEventListener("resize",Zw),ua.set(n,t)}function GL(n){ua.delete(n),ua.size||window.removeEventListener("resize",Zw)}function KL(n,t,e){const s=n.canvas,i=s&&Zf(s);if(!i)return;const r=Sw((a,l)=>{const c=i.clientWidth;e(a,l),c<i.clientWidth&&e()},window),o=new ResizeObserver(a=>{const l=a[0],c=l.contentRect.width,h=l.contentRect.height;c===0&&h===0||r(c,h)});return o.observe(i),qL(n,r),o}function ah(n,t,e){e&&e.disconnect(),t==="resize"&&GL(n)}function YL(n,t,e){const s=n.canvas,i=Sw(r=>{n.ctx!==null&&e(jL(r,n))},n);return $L(s,t,i),i}class XL extends Qw{acquireContext(t,e){const s=t&&t.getContext&&t.getContext("2d");return s&&s.canvas===t?(UL(t,e),s):null}releaseContext(t){const e=t.canvas;if(!e[Vl])return!1;const s=e[Vl].initial;["height","width"].forEach(r=>{const o=s[r];Ct(o)?e.removeAttribute(r):e.setAttribute(r,o)});const i=s.style||{};return Object.keys(i).forEach(r=>{e.style[r]=i[r]}),e.width=e.width,delete e[Vl],!0}addEventListener(t,e,s){this.removeEventListener(t,e);const i=t.$proxies||(t.$proxies={}),o={attach:HL,detach:WL,resize:KL}[e]||YL;i[e]=o(t,e,s)}removeEventListener(t,e){const s=t.$proxies||(t.$proxies={}),i=s[e];if(!i)return;({attach:ah,detach:ah,resize:ah}[e]||zL)(t,e,i),s[e]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,e,s,i){return OO(t,e,s,i)}isAttached(t){const e=t&&Zf(t);return!!(e&&e.isConnected)}}function QL(n){return!Jf()||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas?FL:XL}let Ss=class{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(t){const{x:e,y:s}=this.getProps(["x","y"],t);return{x:e,y:s}}hasValue(){return Cr(this.x)&&Cr(this.y)}getProps(t,e){const s=this.$animations;if(!e||!s)return this;const i={};return t.forEach(r=>{i[r]=s[r]&&s[r].active()?s[r]._to:this[r]}),i}};function JL(n,t){const e=n.options.ticks,s=ZL(n),i=Math.min(e.maxTicksLimit||s,s),r=e.major.enabled?eV(t):[],o=r.length,a=r[0],l=r[o-1],c=[];if(o>i)return nV(t,c,r,o/i),c;const h=tV(r,t,i);if(o>0){let d,f;const g=o>1?Math.round((l-a)/(o-1)):null;for(dl(t,c,h,Ct(g)?0:a-g,a),d=0,f=o-1;d<f;d++)dl(t,c,h,r[d],r[d+1]);return dl(t,c,h,l,Ct(g)?t.length:l+g),c}return dl(t,c,h),c}function ZL(n){const t=n.options.offset,e=n._tickSize(),s=n._length/e+(t?0:1),i=n._maxLength/e;return Math.floor(Math.min(s,i))}function tV(n,t,e){const s=sV(n),i=t.length/e;if(!s)return Math.max(i,1);const r=N2(s);for(let o=0,a=r.length-1;o<a;o++){const l=r[o];if(l>i)return l}return Math.max(i,1)}function eV(n){const t=[];let e,s;for(e=0,s=n.length;e<s;e++)n[e].major&&t.push(e);return t}function nV(n,t,e,s){let i=0,r=e[0],o;for(s=Math.ceil(s),o=0;o<n.length;o++)o===r&&(t.push(n[o]),i++,r=e[i*s])}function dl(n,t,e,s,i){const r=vt(s,0),o=Math.min(vt(i,n.length),n.length);let a=0,l,c,h;for(e=Math.ceil(e),i&&(l=i-s,e=l/Math.floor(l/e)),h=r;h<0;)a++,h=Math.round(r+a*e);for(c=Math.max(r,0);c<o;c++)c===h&&(t.push(n[c]),a++,h=Math.round(r+a*e))}function sV(n){const t=n.length;let e,s;if(t<2)return!1;for(s=n[0],e=1;e<t;++e)if(n[e]-n[e-1]!==s)return!1;return s}const iV=n=>n==="left"?"right":n==="right"?"left":n,j_=(n,t,e)=>t==="top"||t==="left"?n[t]+e:n[t]-e,H_=(n,t)=>Math.min(t||n,n);function W_(n,t){const e=[],s=n.length/t,i=n.length;let r=0;for(;r<i;r+=s)e.push(n[Math.floor(r)]);return e}function rV(n,t,e){const s=n.ticks.length,i=Math.min(t,s-1),r=n._startPixel,o=n._endPixel,a=1e-6;let l=n.getPixelForTick(i),c;if(!(e&&(s===1?c=Math.max(l-r,o-l):t===0?c=(n.getPixelForTick(1)-l)/2:c=(l-n.getPixelForTick(i-1))/2,l+=i<t?c:-c,l<r-a||l>o+a)))return l}function oV(n,t){jt(n,e=>{const s=e.gc,i=s.length/2;let r;if(i>t){for(r=0;r<i;++r)delete e.data[s[r]];s.splice(0,i)}})}function co(n){return n.drawTicks?n.tickLength:0}function q_(n,t){if(!n.display)return 0;const e=ge(n.font,t),s=ze(n.padding);return(ee(n.text)?n.text.length:1)*e.lineHeight+s.height}function aV(n,t){return di(n,{scale:t,type:"scale"})}function lV(n,t,e){return di(n,{tick:e,index:t,type:"tick"})}function cV(n,t,e){let s=qf(n);return(e&&t!=="right"||!e&&t==="right")&&(s=iV(s)),s}function uV(n,t,e,s){const{top:i,left:r,bottom:o,right:a,chart:l}=n,{chartArea:c,scales:h}=l;let d=0,f,g,_;const y=o-i,w=a-r;if(n.isHorizontal()){if(g=Me(s,r,a),Mt(e)){const E=Object.keys(e)[0],S=e[E];_=h[E].getPixelForValue(S)+y-t}else e==="center"?_=(c.bottom+c.top)/2+y-t:_=j_(n,e,t);f=a-r}else{if(Mt(e)){const E=Object.keys(e)[0],S=e[E];g=h[E].getPixelForValue(S)-w+t}else e==="center"?g=(c.left+c.right)/2-w+t:g=j_(n,e,t);_=Me(s,o,i),d=e==="left"?-ce:ce}return{titleX:g,titleY:_,maxWidth:f,rotation:d}}class Ki extends Ss{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,e){return t}getUserBounds(){let{_userMin:t,_userMax:e,_suggestedMin:s,_suggestedMax:i}=this;return t=sn(t,Number.POSITIVE_INFINITY),e=sn(e,Number.NEGATIVE_INFINITY),s=sn(s,Number.POSITIVE_INFINITY),i=sn(i,Number.NEGATIVE_INFINITY),{min:sn(t,s),max:sn(e,i),minDefined:ae(t),maxDefined:ae(e)}}getMinMax(t){let{min:e,max:s,minDefined:i,maxDefined:r}=this.getUserBounds(),o;if(i&&r)return{min:e,max:s};const a=this.getMatchingVisibleMetas();for(let l=0,c=a.length;l<c;++l)o=a[l].controller.getMinMax(this,t),i||(e=Math.min(e,o.min)),r||(s=Math.max(s,o.max));return e=r&&e>s?s:e,s=i&&e>s?e:s,{min:sn(e,sn(s,e)),max:sn(s,sn(e,s))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Xt(this.options.beforeUpdate,[this])}update(t,e,s){const{beginAtZero:i,grace:r,ticks:o}=this.options,a=o.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=e,this._margins=s=Object.assign({left:0,right:0,top:0,bottom:0},s),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+s.left+s.right:this.height+s.top+s.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=dO(this,r,i),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const l=a<this.ticks.length;this._convertTicksToLabels(l?W_(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=JL(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t=this.options.reverse,e,s;this.isHorizontal()?(e=this.left,s=this.right):(e=this.top,s=this.bottom,t=!t),this._startPixel=e,this._endPixel=s,this._reversePixels=t,this._length=s-e,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Xt(this.options.afterUpdate,[this])}beforeSetDimensions(){Xt(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Xt(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),Xt(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Xt(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const e=this.options.ticks;let s,i,r;for(s=0,i=t.length;s<i;s++)r=t[s],r.label=Xt(e.callback,[r.value,s,t],this)}afterTickToLabelConversion(){Xt(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Xt(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,e=t.ticks,s=H_(this.ticks.length,t.ticks.maxTicksLimit),i=e.minRotation||0,r=e.maxRotation;let o=i,a,l,c;if(!this._isVisible()||!e.display||i>=r||s<=1||!this.isHorizontal()){this.labelRotation=i;return}const h=this._getLabelSizes(),d=h.widest.width,f=h.highest.height,g=be(this.chart.width-d,0,this.maxWidth);a=t.offset?this.maxWidth/s:g/(s-1),d+6>a&&(a=g/(s-(t.offset?.5:1)),l=this.maxHeight-co(t.grid)-e.padding-q_(t.title,this.chart.options.font),c=Math.sqrt(d*d+f*f),o=Hf(Math.min(Math.asin(be((h.highest.height+6)/a,-1,1)),Math.asin(be(l/c,-1,1))-Math.asin(be(f/c,-1,1)))),o=Math.max(i,Math.min(r,o))),this.labelRotation=o}afterCalculateLabelRotation(){Xt(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Xt(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:e,options:{ticks:s,title:i,grid:r}}=this,o=this._isVisible(),a=this.isHorizontal();if(o){const l=q_(i,e.options.font);if(a?(t.width=this.maxWidth,t.height=co(r)+l):(t.height=this.maxHeight,t.width=co(r)+l),s.display&&this.ticks.length){const{first:c,last:h,widest:d,highest:f}=this._getLabelSizes(),g=s.padding*2,_=Tn(this.labelRotation),y=Math.cos(_),w=Math.sin(_);if(a){const E=s.mirror?0:w*d.width+y*f.height;t.height=Math.min(this.maxHeight,t.height+E+g)}else{const E=s.mirror?0:y*d.width+w*f.height;t.width=Math.min(this.maxWidth,t.width+E+g)}this._calculatePadding(c,h,w,y)}}this._handleMargins(),a?(this.width=this._length=e.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=e.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,e,s,i){const{ticks:{align:r,padding:o},position:a}=this.options,l=this.labelRotation!==0,c=a!=="top"&&this.axis==="x";if(this.isHorizontal()){const h=this.getPixelForTick(0)-this.left,d=this.right-this.getPixelForTick(this.ticks.length-1);let f=0,g=0;l?c?(f=i*t.width,g=s*e.height):(f=s*t.height,g=i*e.width):r==="start"?g=e.width:r==="end"?f=t.width:r!=="inner"&&(f=t.width/2,g=e.width/2),this.paddingLeft=Math.max((f-h+o)*this.width/(this.width-h),0),this.paddingRight=Math.max((g-d+o)*this.width/(this.width-d),0)}else{let h=e.height/2,d=t.height/2;r==="start"?(h=0,d=t.height):r==="end"&&(h=e.height,d=0),this.paddingTop=h+o,this.paddingBottom=d+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Xt(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:e}=this.options;return e==="top"||e==="bottom"||t==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){this.beforeTickToLabelConversion(),this.generateTickLabels(t);let e,s;for(e=0,s=t.length;e<s;e++)Ct(t[e].label)&&(t.splice(e,1),s--,e--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const e=this.options.ticks.sampleSize;let s=this.ticks;e<s.length&&(s=W_(s,e)),this._labelSizes=t=this._computeLabelSizes(s,s.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,e,s){const{ctx:i,_longestTextCache:r}=this,o=[],a=[],l=Math.floor(e/H_(e,s));let c=0,h=0,d,f,g,_,y,w,E,S,A,k,R;for(d=0;d<e;d+=l){if(_=t[d].label,y=this._resolveTickFontOptions(d),i.font=w=y.string,E=r[w]=r[w]||{data:{},gc:[]},S=y.lineHeight,A=k=0,!Ct(_)&&!ee(_))A=_c(i,E.data,E.gc,A,_),k=S;else if(ee(_))for(f=0,g=_.length;f<g;++f)R=_[f],!Ct(R)&&!ee(R)&&(A=_c(i,E.data,E.gc,A,R),k+=S);o.push(A),a.push(k),c=Math.max(A,c),h=Math.max(k,h)}oV(r,e);const L=o.indexOf(c),x=a.indexOf(h),b=T=>({width:o[T]||0,height:a[T]||0});return{first:b(0),last:b(e-1),widest:b(L),highest:b(x),widths:o,heights:a}}getLabelForValue(t){return t}getPixelForValue(t,e){return NaN}getValueForPixel(t){}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const e=this._startPixel+t*this._length;return $2(this._alignToPixels?wi(this.chart,e,0):e)}getDecimalForPixel(t){const e=(t-this._startPixel)/this._length;return this._reversePixels?1-e:e}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:e}=this;return t<0&&e<0?e:t>0&&e>0?t:0}getContext(t){const e=this.ticks||[];if(t>=0&&t<e.length){const s=e[t];return s.$context||(s.$context=lV(this.getContext(),t,s))}return this.$context||(this.$context=aV(this.chart.getContext(),this))}_tickSize(){const t=this.options.ticks,e=Tn(this.labelRotation),s=Math.abs(Math.cos(e)),i=Math.abs(Math.sin(e)),r=this._getLabelSizes(),o=t.autoSkipPadding||0,a=r?r.widest.width+o:0,l=r?r.highest.height+o:0;return this.isHorizontal()?l*s>a*i?a/s:l/i:l*i<a*s?l/s:a/i}_isVisible(){const t=this.options.display;return t!=="auto"?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const e=this.axis,s=this.chart,i=this.options,{grid:r,position:o,border:a}=i,l=r.offset,c=this.isHorizontal(),d=this.ticks.length+(l?1:0),f=co(r),g=[],_=a.setContext(this.getContext()),y=_.display?_.width:0,w=y/2,E=function(mt){return wi(s,mt,y)};let S,A,k,R,L,x,b,T,C,P,M,I;if(o==="top")S=E(this.bottom),x=this.bottom-f,T=S-w,P=E(t.top)+w,I=t.bottom;else if(o==="bottom")S=E(this.top),P=t.top,I=E(t.bottom)-w,x=S+w,T=this.top+f;else if(o==="left")S=E(this.right),L=this.right-f,b=S-w,C=E(t.left)+w,M=t.right;else if(o==="right")S=E(this.left),C=t.left,M=E(t.right)-w,L=S+w,b=this.left+f;else if(e==="x"){if(o==="center")S=E((t.top+t.bottom)/2+.5);else if(Mt(o)){const mt=Object.keys(o)[0],ot=o[mt];S=E(this.chart.scales[mt].getPixelForValue(ot))}P=t.top,I=t.bottom,x=S+w,T=x+f}else if(e==="y"){if(o==="center")S=E((t.left+t.right)/2);else if(Mt(o)){const mt=Object.keys(o)[0],ot=o[mt];S=E(this.chart.scales[mt].getPixelForValue(ot))}L=S-w,b=L-f,C=t.left,M=t.right}const yt=vt(i.ticks.maxTicksLimit,d),st=Math.max(1,Math.ceil(d/yt));for(A=0;A<d;A+=st){const mt=this.getContext(A),ot=r.setContext(mt),at=a.setContext(mt),Bt=ot.lineWidth,lt=ot.color,it=at.dash||[],q=at.dashOffset,Z=ot.tickWidth,Ft=ot.tickColor,St=ot.tickBorderDash||[],At=ot.tickBorderDashOffset;k=rV(this,A,l),k!==void 0&&(R=wi(s,k,Bt),c?L=b=C=M=R:x=T=P=I=R,g.push({tx1:L,ty1:x,tx2:b,ty2:T,x1:C,y1:P,x2:M,y2:I,width:Bt,color:lt,borderDash:it,borderDashOffset:q,tickWidth:Z,tickColor:Ft,tickBorderDash:St,tickBorderDashOffset:At}))}return this._ticksLength=d,this._borderValue=S,g}_computeLabelItems(t){const e=this.axis,s=this.options,{position:i,ticks:r}=s,o=this.isHorizontal(),a=this.ticks,{align:l,crossAlign:c,padding:h,mirror:d}=r,f=co(s.grid),g=f+h,_=d?-h:g,y=-Tn(this.labelRotation),w=[];let E,S,A,k,R,L,x,b,T,C,P,M,I="middle";if(i==="top")L=this.bottom-_,x=this._getXAxisLabelAlignment();else if(i==="bottom")L=this.top+_,x=this._getXAxisLabelAlignment();else if(i==="left"){const st=this._getYAxisLabelAlignment(f);x=st.textAlign,R=st.x}else if(i==="right"){const st=this._getYAxisLabelAlignment(f);x=st.textAlign,R=st.x}else if(e==="x"){if(i==="center")L=(t.top+t.bottom)/2+g;else if(Mt(i)){const st=Object.keys(i)[0],mt=i[st];L=this.chart.scales[st].getPixelForValue(mt)+g}x=this._getXAxisLabelAlignment()}else if(e==="y"){if(i==="center")R=(t.left+t.right)/2-g;else if(Mt(i)){const st=Object.keys(i)[0],mt=i[st];R=this.chart.scales[st].getPixelForValue(mt)}x=this._getYAxisLabelAlignment(f).textAlign}e==="y"&&(l==="start"?I="top":l==="end"&&(I="bottom"));const yt=this._getLabelSizes();for(E=0,S=a.length;E<S;++E){A=a[E],k=A.label;const st=r.setContext(this.getContext(E));b=this.getPixelForTick(E)+r.labelOffset,T=this._resolveTickFontOptions(E),C=T.lineHeight,P=ee(k)?k.length:1;const mt=P/2,ot=st.color,at=st.textStrokeColor,Bt=st.textStrokeWidth;let lt=x;o?(R=b,x==="inner"&&(E===S-1?lt=this.options.reverse?"left":"right":E===0?lt=this.options.reverse?"right":"left":lt="center"),i==="top"?c==="near"||y!==0?M=-P*C+C/2:c==="center"?M=-yt.highest.height/2-mt*C+C:M=-yt.highest.height+C/2:c==="near"||y!==0?M=C/2:c==="center"?M=yt.highest.height/2-mt*C:M=yt.highest.height-P*C,d&&(M*=-1),y!==0&&!st.showLabelBackdrop&&(R+=C/2*Math.sin(y))):(L=b,M=(1-P)*C/2);let it;if(st.showLabelBackdrop){const q=ze(st.backdropPadding),Z=yt.heights[E],Ft=yt.widths[E];let St=M-q.top,At=0-q.left;switch(I){case"middle":St-=Z/2;break;case"bottom":St-=Z;break}switch(x){case"center":At-=Ft/2;break;case"right":At-=Ft;break;case"inner":E===S-1?At-=Ft:E>0&&(At-=Ft/2);break}it={left:At,top:St,width:Ft+q.width,height:Z+q.height,color:st.backdropColor}}w.push({label:k,font:T,textOffset:M,options:{rotation:y,color:ot,strokeColor:at,strokeWidth:Bt,textAlign:lt,textBaseline:I,translation:[R,L],backdrop:it}})}return w}_getXAxisLabelAlignment(){const{position:t,ticks:e}=this.options;if(-Tn(this.labelRotation))return t==="top"?"left":"right";let i="center";return e.align==="start"?i="left":e.align==="end"?i="right":e.align==="inner"&&(i="inner"),i}_getYAxisLabelAlignment(t){const{position:e,ticks:{crossAlign:s,mirror:i,padding:r}}=this.options,o=this._getLabelSizes(),a=t+r,l=o.widest.width;let c,h;return e==="left"?i?(h=this.right+r,s==="near"?c="left":s==="center"?(c="center",h+=l/2):(c="right",h+=l)):(h=this.right-a,s==="near"?c="right":s==="center"?(c="center",h-=l/2):(c="left",h=this.left)):e==="right"?i?(h=this.left+r,s==="near"?c="right":s==="center"?(c="center",h-=l/2):(c="left",h-=l)):(h=this.left+a,s==="near"?c="left":s==="center"?(c="center",h+=l/2):(c="right",h=this.right)):c="right",{textAlign:c,x:h}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,e=this.options.position;if(e==="left"||e==="right")return{top:0,left:this.left,bottom:t.height,right:this.right};if(e==="top"||e==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:t.width}}drawBackground(){const{ctx:t,options:{backgroundColor:e},left:s,top:i,width:r,height:o}=this;e&&(t.save(),t.fillStyle=e,t.fillRect(s,i,r,o),t.restore())}getLineWidthForValue(t){const e=this.options.grid;if(!this._isVisible()||!e.display)return 0;const i=this.ticks.findIndex(r=>r.value===t);return i>=0?e.setContext(this.getContext(i)).lineWidth:0}drawGrid(t){const e=this.options.grid,s=this.ctx,i=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let r,o;const a=(l,c,h)=>{!h.width||!h.color||(s.save(),s.lineWidth=h.width,s.strokeStyle=h.color,s.setLineDash(h.borderDash||[]),s.lineDashOffset=h.borderDashOffset,s.beginPath(),s.moveTo(l.x,l.y),s.lineTo(c.x,c.y),s.stroke(),s.restore())};if(e.display)for(r=0,o=i.length;r<o;++r){const l=i[r];e.drawOnChartArea&&a({x:l.x1,y:l.y1},{x:l.x2,y:l.y2},l),e.drawTicks&&a({x:l.tx1,y:l.ty1},{x:l.tx2,y:l.ty2},{color:l.tickColor,width:l.tickWidth,borderDash:l.tickBorderDash,borderDashOffset:l.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:e,options:{border:s,grid:i}}=this,r=s.setContext(this.getContext()),o=s.display?r.width:0;if(!o)return;const a=i.setContext(this.getContext(0)).lineWidth,l=this._borderValue;let c,h,d,f;this.isHorizontal()?(c=wi(t,this.left,o)-o/2,h=wi(t,this.right,a)+a/2,d=f=l):(d=wi(t,this.top,o)-o/2,f=wi(t,this.bottom,a)+a/2,c=h=l),e.save(),e.lineWidth=r.width,e.strokeStyle=r.color,e.beginPath(),e.moveTo(c,d),e.lineTo(h,f),e.stroke(),e.restore()}drawLabels(t){if(!this.options.ticks.display)return;const s=this.ctx,i=this._computeLabelArea();i&&au(s,i);const r=this.getLabelItems(t);for(const o of r){const a=o.options,l=o.font,c=o.label,h=o.textOffset;ji(s,c,0,h,l,a)}i&&lu(s)}drawTitle(){const{ctx:t,options:{position:e,title:s,reverse:i}}=this;if(!s.display)return;const r=ge(s.font),o=ze(s.padding),a=s.align;let l=r.lineHeight/2;e==="bottom"||e==="center"||Mt(e)?(l+=o.bottom,ee(s.text)&&(l+=r.lineHeight*(s.text.length-1))):l+=o.top;const{titleX:c,titleY:h,maxWidth:d,rotation:f}=uV(this,l,e,a);ji(t,s.text,0,0,r,{color:s.color,maxWidth:d,rotation:f,textAlign:cV(a,e,i),textBaseline:"middle",translation:[c,h]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,e=t.ticks&&t.ticks.z||0,s=vt(t.grid&&t.grid.z,-1),i=vt(t.border&&t.border.z,0);return!this._isVisible()||this.draw!==Ki.prototype.draw?[{z:e,draw:r=>{this.draw(r)}}]:[{z:s,draw:r=>{this.drawBackground(),this.drawGrid(r),this.drawTitle()}},{z:i,draw:()=>{this.drawBorder()}},{z:e,draw:r=>{this.drawLabels(r)}}]}getMatchingVisibleMetas(t){const e=this.chart.getSortedVisibleDatasetMetas(),s=this.axis+"AxisID",i=[];let r,o;for(r=0,o=e.length;r<o;++r){const a=e[r];a[s]===this.id&&(!t||a.type===t)&&i.push(a)}return i}_resolveTickFontOptions(t){const e=this.options.ticks.setContext(this.getContext(t));return ge(e.font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class fl{constructor(t,e,s){this.type=t,this.scope=e,this.override=s,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const e=Object.getPrototypeOf(t);let s;fV(e)&&(s=this.register(e));const i=this.items,r=t.id,o=this.scope+"."+r;if(!r)throw new Error("class does not have id: "+t);return r in i||(i[r]=t,hV(t,o,s),this.override&&ne.override(t.id,t.overrides)),o}get(t){return this.items[t]}unregister(t){const e=this.items,s=t.id,i=this.scope;s in e&&delete e[s],i&&s in ne[i]&&(delete ne[i][s],this.override&&delete zi[s])}}function hV(n,t,e){const s=oa(Object.create(null),[e?ne.get(e):{},ne.get(t),n.defaults]);ne.set(t,s),n.defaultRoutes&&dV(t,n.defaultRoutes),n.descriptors&&ne.describe(t,n.descriptors)}function dV(n,t){Object.keys(t).forEach(e=>{const s=e.split("."),i=s.pop(),r=[n].concat(s).join("."),o=t[e].split("."),a=o.pop(),l=o.join(".");ne.route(r,i,l,a)})}function fV(n){return"id"in n&&"defaults"in n}class pV{constructor(){this.controllers=new fl(fi,"datasets",!0),this.elements=new fl(Ss,"elements"),this.plugins=new fl(Object,"plugins"),this.scales=new fl(Ki,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,e,s){[...e].forEach(i=>{const r=s||this._getRegistryForType(i);s||r.isForType(i)||r===this.plugins&&i.id?this._exec(t,r,i):jt(i,o=>{const a=s||this._getRegistryForType(o);this._exec(t,a,o)})})}_exec(t,e,s){const i=jf(t);Xt(s["before"+i],[],s),e[t](s),Xt(s["after"+i],[],s)}_getRegistryForType(t){for(let e=0;e<this._typedRegistries.length;e++){const s=this._typedRegistries[e];if(s.isForType(t))return s}return this.plugins}_get(t,e,s){const i=e.get(t);if(i===void 0)throw new Error('"'+t+'" is not a registered '+s+".");return i}}var kn=new pV;class gV{constructor(){this._init=void 0}notify(t,e,s,i){if(e==="beforeInit"&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install")),this._init===void 0)return;const r=i?this._descriptors(t).filter(i):this._descriptors(t),o=this._notify(r,t,e,s);return e==="afterDestroy"&&(this._notify(r,t,"stop"),this._notify(this._init,t,"uninstall"),this._init=void 0),o}_notify(t,e,s,i){i=i||{};for(const r of t){const o=r.plugin,a=o[s],l=[e,i,r.options];if(Xt(a,l,o)===!1&&i.cancelable)return!1}return!0}invalidate(){Ct(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const e=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),e}_createDescriptors(t,e){const s=t&&t.config,i=vt(s.options&&s.options.plugins,{}),r=mV(s);return i===!1&&!e?[]:yV(t,r,i,e)}_notifyStateChanges(t){const e=this._oldCache||[],s=this._cache,i=(r,o)=>r.filter(a=>!o.some(l=>a.plugin.id===l.plugin.id));this._notify(i(e,s),t,"stop"),this._notify(i(s,e),t,"start")}}function mV(n){const t={},e=[],s=Object.keys(kn.plugins.items);for(let r=0;r<s.length;r++)e.push(kn.getPlugin(s[r]));const i=n.plugins||[];for(let r=0;r<i.length;r++){const o=i[r];e.indexOf(o)===-1&&(e.push(o),t[o.id]=!0)}return{plugins:e,localIds:t}}function _V(n,t){return!t&&n===!1?null:n===!0?{}:n}function yV(n,{plugins:t,localIds:e},s,i){const r=[],o=n.getContext();for(const a of t){const l=a.id,c=_V(s[l],i);c!==null&&r.push({plugin:a,options:bV(n.config,{plugin:a,local:e[l]},c,o)})}return r}function bV(n,{plugin:t,local:e},s,i){const r=n.pluginScopeKeys(t),o=n.getOptionScopes(s,r);return e&&t.defaults&&o.push(t.defaults),n.createResolver(o,i,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function sd(n,t){const e=ne.datasets[n]||{};return((t.datasets||{})[n]||{}).indexAxis||t.indexAxis||e.indexAxis||"x"}function vV(n,t){let e=n;return n==="_index_"?e=t:n==="_value_"&&(e=t==="x"?"y":"x"),e}function wV(n,t){return n===t?"_index_":"_value_"}function G_(n){if(n==="x"||n==="y"||n==="r")return n}function xV(n){if(n==="top"||n==="bottom")return"x";if(n==="left"||n==="right")return"y"}function id(n,...t){if(G_(n))return n;for(const e of t){const s=e.axis||xV(e.position)||n.length>1&&G_(n[0].toLowerCase());if(s)return s}throw new Error(`Cannot determine type of '${n}' axis. Please provide 'axis' or 'position' option.`)}function K_(n,t,e){if(e[t+"AxisID"]===n)return{axis:t}}function TV(n,t){if(t.data&&t.data.datasets){const e=t.data.datasets.filter(s=>s.xAxisID===n||s.yAxisID===n);if(e.length)return K_(n,"x",e[0])||K_(n,"y",e[0])}return{}}function EV(n,t){const e=zi[n.type]||{scales:{}},s=t.scales||{},i=sd(n.type,t),r=Object.create(null);return Object.keys(s).forEach(o=>{const a=s[o];if(!Mt(a))return console.error(`Invalid scale configuration for scale: ${o}`);if(a._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const l=id(o,a,TV(o,n),ne.scales[a.type]),c=wV(l,i),h=e.scales||{};r[o]=Fo(Object.create(null),[{axis:l},a,h[l],h[c]])}),n.data.datasets.forEach(o=>{const a=o.type||n.type,l=o.indexAxis||sd(a,t),h=(zi[a]||{}).scales||{};Object.keys(h).forEach(d=>{const f=vV(d,l),g=o[f+"AxisID"]||f;r[g]=r[g]||Object.create(null),Fo(r[g],[{axis:f},s[g],h[d]])})}),Object.keys(r).forEach(o=>{const a=r[o];Fo(a,[ne.scales[a.type],ne.scale])}),r}function tx(n){const t=n.options||(n.options={});t.plugins=vt(t.plugins,{}),t.scales=EV(n,t)}function ex(n){return n=n||{},n.datasets=n.datasets||[],n.labels=n.labels||[],n}function IV(n){return n=n||{},n.data=ex(n.data),tx(n),n}const Y_=new Map,nx=new Set;function pl(n,t){let e=Y_.get(n);return e||(e=t(),Y_.set(n,e),nx.add(e)),e}const uo=(n,t,e)=>{const s=ai(t,e);s!==void 0&&n.add(s)};class AV{constructor(t){this._config=IV(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=ex(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),tx(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return pl(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,e){return pl(`${t}.transition.${e}`,()=>[[`datasets.${t}.transitions.${e}`,`transitions.${e}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,e){return pl(`${t}-${e}`,()=>[[`datasets.${t}.elements.${e}`,`datasets.${t}`,`elements.${e}`,""]])}pluginScopeKeys(t){const e=t.id,s=this.type;return pl(`${s}-plugin-${e}`,()=>[[`plugins.${e}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,e){const s=this._scopeCache;let i=s.get(t);return(!i||e)&&(i=new Map,s.set(t,i)),i}getOptionScopes(t,e,s){const{options:i,type:r}=this,o=this._cachedScopes(t,s),a=o.get(e);if(a)return a;const l=new Set;e.forEach(h=>{t&&(l.add(t),h.forEach(d=>uo(l,t,d))),h.forEach(d=>uo(l,i,d)),h.forEach(d=>uo(l,zi[r]||{},d)),h.forEach(d=>uo(l,ne,d)),h.forEach(d=>uo(l,ed,d))});const c=Array.from(l);return c.length===0&&c.push(Object.create(null)),nx.has(e)&&o.set(e,c),c}chartOptionScopes(){const{options:t,type:e}=this;return[t,zi[e]||{},ne.datasets[e]||{},{type:e},ne,ed]}resolveNamedOptions(t,e,s,i=[""]){const r={$shared:!0},{resolver:o,subPrefixes:a}=X_(this._resolverCache,t,i);let l=o;if(CV(o,e)){r.$shared=!1,s=li(s)?s():s;const c=this.createResolver(t,s,a);l=Pr(o,s,c)}for(const c of e)r[c]=l[c];return r}createResolver(t,e,s=[""],i){const{resolver:r}=X_(this._resolverCache,t,s);return Mt(e)?Pr(r,e,void 0,i):r}}function X_(n,t,e){let s=n.get(t);s||(s=new Map,n.set(t,s));const i=e.join();let r=s.get(i);return r||(r={resolver:Yf(t,e),subPrefixes:e.filter(a=>!a.toLowerCase().includes("hover"))},s.set(i,r)),r}const SV=n=>Mt(n)&&Object.getOwnPropertyNames(n).some(t=>li(n[t]));function CV(n,t){const{isScriptable:e,isIndexable:s}=Mw(n);for(const i of t){const r=e(i),o=s(i),a=(o||r)&&n[i];if(r&&(li(a)||SV(a))||o&&ee(a))return!0}return!1}var PV="4.5.1";const RV=["top","bottom","left","right","chartArea"];function Q_(n,t){return n==="top"||n==="bottom"||RV.indexOf(n)===-1&&t==="x"}function J_(n,t){return function(e,s){return e[n]===s[n]?e[t]-s[t]:e[n]-s[n]}}function Z_(n){const t=n.chart,e=t.options.animation;t.notifyPlugins("afterRender"),Xt(e&&e.onComplete,[n],t)}function kV(n){const t=n.chart,e=t.options.animation;Xt(e&&e.onProgress,[n],t)}function sx(n){return Jf()&&typeof n=="string"?n=document.getElementById(n):n&&n.length&&(n=n[0]),n&&n.canvas&&(n=n.canvas),n}const Nl={},ty=n=>{const t=sx(n);return Object.values(Nl).filter(e=>e.canvas===t).pop()};function DV(n,t,e){const s=Object.keys(n);for(const i of s){const r=+i;if(r>=t){const o=n[i];delete n[i],(e>0||r>t)&&(n[r+e]=o)}}}function MV(n,t,e,s){return!e||n.type==="mouseout"?null:s?t:n}class np{static defaults=ne;static instances=Nl;static overrides=zi;static registry=kn;static version=PV;static getChart=ty;static register(...t){kn.add(...t),ey()}static unregister(...t){kn.remove(...t),ey()}constructor(t,e){const s=this.config=new AV(e),i=sx(t),r=ty(i);if(r)throw new Error("Canvas is already in use. Chart with ID '"+r.id+"' must be destroyed before the canvas with ID '"+r.canvas.id+"' can be reused.");const o=s.createResolver(s.chartOptionScopes(),this.getContext());this.platform=new(s.platform||QL(i)),this.platform.updateConfig(s);const a=this.platform.acquireContext(i,o.aspectRatio),l=a&&a.canvas,c=l&&l.height,h=l&&l.width;if(this.id=C2(),this.ctx=a,this.canvas=l,this.width=h,this.height=c,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new gV,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=W2(d=>this.update(d),o.resizeDelay||0),this._dataChanges=[],Nl[this.id]=this,!a||!l){console.error("Failed to create chart: can't acquire context from the given item");return}Zn.listen(this,"complete",Z_),Zn.listen(this,"progress",kV),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:e},width:s,height:i,_aspectRatio:r}=this;return Ct(t)?e&&r?r:i?s/i:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return kn}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():T_(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return v_(this.canvas,this.ctx),this}stop(){return Zn.stop(this),this}resize(t,e){Zn.running(this)?this._resizeBeforeDraw={width:t,height:e}:this._resize(t,e)}_resize(t,e){const s=this.options,i=this.canvas,r=s.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(i,t,e,r),a=s.devicePixelRatio||this.platform.getDevicePixelRatio(),l=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,T_(this,a,!0)&&(this.notifyPlugins("resize",{size:o}),Xt(s.onResize,[this,o],this),this.attached&&this._doResize(l)&&this.render())}ensureScalesHaveIDs(){const e=this.options.scales||{};jt(e,(s,i)=>{s.id=i})}buildOrUpdateScales(){const t=this.options,e=t.scales,s=this.scales,i=Object.keys(s).reduce((o,a)=>(o[a]=!1,o),{});let r=[];e&&(r=r.concat(Object.keys(e).map(o=>{const a=e[o],l=id(o,a),c=l==="r",h=l==="x";return{options:a,dposition:c?"chartArea":h?"bottom":"left",dtype:c?"radialLinear":h?"category":"linear"}}))),jt(r,o=>{const a=o.options,l=a.id,c=id(l,a),h=vt(a.type,o.dtype);(a.position===void 0||Q_(a.position,c)!==Q_(o.dposition))&&(a.position=o.dposition),i[l]=!0;let d=null;if(l in s&&s[l].type===h)d=s[l];else{const f=kn.getScale(h);d=new f({id:l,type:h,ctx:this.ctx,chart:this}),s[d.id]=d}d.init(a,t)}),jt(i,(o,a)=>{o||delete s[a]}),jt(s,o=>{Be.configure(this,o,o.options),Be.addBox(this,o)})}_updateMetasets(){const t=this._metasets,e=this.data.datasets.length,s=t.length;if(t.sort((i,r)=>i.index-r.index),s>e){for(let i=e;i<s;++i)this._destroyDatasetMeta(i);t.splice(e,s-e)}this._sortedMetasets=t.slice(0).sort(J_("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:e}}=this;t.length>e.length&&delete this._stacks,t.forEach((s,i)=>{e.filter(r=>r===s._dataset).length===0&&this._destroyDatasetMeta(i)})}buildOrUpdateControllers(){const t=[],e=this.data.datasets;let s,i;for(this._removeUnreferencedMetasets(),s=0,i=e.length;s<i;s++){const r=e[s];let o=this.getDatasetMeta(s);const a=r.type||this.config.type;if(o.type&&o.type!==a&&(this._destroyDatasetMeta(s),o=this.getDatasetMeta(s)),o.type=a,o.indexAxis=r.indexAxis||sd(a,this.options),o.order=r.order||0,o.index=s,o.label=""+r.label,o.visible=this.isDatasetVisible(s),o.controller)o.controller.updateIndex(s),o.controller.linkScales();else{const l=kn.getController(a),{datasetElementType:c,dataElementType:h}=ne.datasets[a];Object.assign(l,{dataElementType:kn.getElement(h),datasetElementType:c&&kn.getElement(c)}),o.controller=new l(this,s),t.push(o.controller)}}return this._updateMetasets(),t}_resetElements(){jt(this.data.datasets,(t,e)=>{this.getDatasetMeta(e).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const e=this.config;e.update();const s=this._options=e.createResolver(e.chartOptionScopes(),this.getContext()),i=this._animationsDisabled=!s.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0})===!1)return;const r=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let c=0,h=this.data.datasets.length;c<h;c++){const{controller:d}=this.getDatasetMeta(c),f=!i&&r.indexOf(d)===-1;d.buildOrUpdateElements(f),o=Math.max(+d.getMaxOverflow(),o)}o=this._minPadding=s.layout.autoPadding?o:0,this._updateLayout(o),i||jt(r,c=>{c.reset()}),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(J_("z","_idx"));const{_active:a,_lastEvent:l}=this;l?this._eventHandler(l,!0):a.length&&this._updateHoverStyles(a,a,!0),this.render()}_updateScales(){jt(this.scales,t=>{Be.removeBox(this,t)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,e=new Set(Object.keys(this._listeners)),s=new Set(t.events);(!h_(e,s)||!!this._responsiveListeners!==t.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,e=this._getUniformDataChanges()||[];for(const{method:s,start:i,count:r}of e){const o=s==="_removeElements"?-r:r;DV(t,i,o)}}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const e=this.data.datasets.length,s=r=>new Set(t.filter(o=>o[0]===r).map((o,a)=>a+","+o.splice(1).join(","))),i=s(0);for(let r=1;r<e;r++)if(!h_(i,s(r)))return;return Array.from(i).map(r=>r.split(",")).map(r=>({method:r[1],start:+r[2],count:+r[3]}))}_updateLayout(t){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Be.update(this,this.width,this.height,t);const e=this.chartArea,s=e.width<=0||e.height<=0;this._layers=[],jt(this.boxes,i=>{s&&i.position==="chartArea"||(i.configure&&i.configure(),this._layers.push(...i._layers()))},this),this._layers.forEach((i,r)=>{i._idx=r}),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})!==!1){for(let e=0,s=this.data.datasets.length;e<s;++e)this.getDatasetMeta(e).controller.configure();for(let e=0,s=this.data.datasets.length;e<s;++e)this._updateDataset(e,li(t)?t({datasetIndex:e}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,e){const s=this.getDatasetMeta(t),i={meta:s,index:t,mode:e,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",i)!==!1&&(s.controller._update(e),i.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",i))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Zn.has(this)?this.attached&&!Zn.running(this)&&Zn.start(this):(this.draw(),Z_({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:s,height:i}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(s,i)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const e=this._layers;for(t=0;t<e.length&&e[t].z<=0;++t)e[t].draw(this.chartArea);for(this._drawDatasets();t<e.length;++t)e[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const e=this._sortedMetasets,s=[];let i,r;for(i=0,r=e.length;i<r;++i){const o=e[i];(!t||o.visible)&&s.push(o)}return s}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const t=this.getSortedVisibleDatasetMetas();for(let e=t.length-1;e>=0;--e)this._drawDataset(t[e]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const e=this.ctx,s={meta:t,index:t.index,cancelable:!0},i=Hw(this,t);this.notifyPlugins("beforeDatasetDraw",s)!==!1&&(i&&au(e,i),t.controller.draw(),i&&lu(e),s.cancelable=!1,this.notifyPlugins("afterDatasetDraw",s))}isPointInArea(t){return us(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,e,s,i){const r=RL.modes[e];return typeof r=="function"?r(this,t,s,i):[]}getDatasetMeta(t){const e=this.data.datasets[t],s=this._metasets;let i=s.filter(r=>r&&r._dataset===e).pop();return i||(i={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:e&&e.order||0,index:t,_dataset:e,_parsed:[],_sorted:!1},s.push(i)),i}getContext(){return this.$context||(this.$context=di(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const e=this.data.datasets[t];if(!e)return!1;const s=this.getDatasetMeta(t);return typeof s.hidden=="boolean"?!s.hidden:!e.hidden}setDatasetVisibility(t,e){const s=this.getDatasetMeta(t);s.hidden=!e}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,e,s){const i=s?"show":"hide",r=this.getDatasetMeta(t),o=r.controller._resolveAnimations(void 0,i);aa(e)?(r.data[e].hidden=!s,this.update()):(this.setDatasetVisibility(t,s),o.update(r,{visible:s}),this.update(a=>a.datasetIndex===t?i:void 0))}hide(t,e){this._updateVisibility(t,e,!1)}show(t,e){this._updateVisibility(t,e,!0)}_destroyDatasetMeta(t){const e=this._metasets[t];e&&e.controller&&e.controller._destroy(),delete this._metasets[t]}_stop(){let t,e;for(this.stop(),Zn.remove(this),t=0,e=this.data.datasets.length;t<e;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:e}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),v_(t,e),this.platform.releaseContext(e),this.canvas=null,this.ctx=null),delete Nl[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,e=this.platform,s=(r,o)=>{e.addEventListener(this,r,o),t[r]=o},i=(r,o,a)=>{r.offsetX=o,r.offsetY=a,this._eventHandler(r)};jt(this.options.events,r=>s(r,i))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,e=this.platform,s=(l,c)=>{e.addEventListener(this,l,c),t[l]=c},i=(l,c)=>{t[l]&&(e.removeEventListener(this,l,c),delete t[l])},r=(l,c)=>{this.canvas&&this.resize(l,c)};let o;const a=()=>{i("attach",a),this.attached=!0,this.resize(),s("resize",r),s("detach",o)};o=()=>{this.attached=!1,i("resize",r),this._stop(),this._resize(0,0),s("attach",a)},e.isAttached(this.canvas)?a():o()}unbindEvents(){jt(this._listeners,(t,e)=>{this.platform.removeEventListener(this,e,t)}),this._listeners={},jt(this._responsiveListeners,(t,e)=>{this.platform.removeEventListener(this,e,t)}),this._responsiveListeners=void 0}updateHoverStyle(t,e,s){const i=s?"set":"remove";let r,o,a,l;for(e==="dataset"&&(r=this.getDatasetMeta(t[0].datasetIndex),r.controller["_"+i+"DatasetHoverStyle"]()),a=0,l=t.length;a<l;++a){o=t[a];const c=o&&this.getDatasetMeta(o.datasetIndex).controller;c&&c[i+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const e=this._active||[],s=t.map(({datasetIndex:r,index:o})=>{const a=this.getDatasetMeta(r);if(!a)throw new Error("No dataset found at index "+r);return{datasetIndex:r,element:a.data[o],index:o}});!pc(s,e)&&(this._active=s,this._lastEvent=null,this._updateHoverStyles(s,e))}notifyPlugins(t,e,s){return this._plugins.notify(this,t,e,s)}isPluginEnabled(t){return this._plugins._cache.filter(e=>e.plugin.id===t).length===1}_updateHoverStyles(t,e,s){const i=this.options.hover,r=(l,c)=>l.filter(h=>!c.some(d=>h.datasetIndex===d.datasetIndex&&h.index===d.index)),o=r(e,t),a=s?t:r(t,e);o.length&&this.updateHoverStyle(o,i.mode,!1),a.length&&i.mode&&this.updateHoverStyle(a,i.mode,!0)}_eventHandler(t,e){const s={event:t,replay:e,cancelable:!0,inChartArea:this.isPointInArea(t)},i=o=>(o.options.events||this.options.events).includes(t.native.type);if(this.notifyPlugins("beforeEvent",s,i)===!1)return;const r=this._handleEvent(t,e,s.inChartArea);return s.cancelable=!1,this.notifyPlugins("afterEvent",s,i),(r||s.changed)&&this.render(),this}_handleEvent(t,e,s){const{_active:i=[],options:r}=this,o=e,a=this._getActiveElements(t,i,s,o),l=O2(t),c=MV(t,this._lastEvent,s,l);s&&(this._lastEvent=null,Xt(r.onHover,[t,a,this],this),l&&Xt(r.onClick,[t,a,this],this));const h=!pc(a,i);return(h||e)&&(this._active=a,this._updateHoverStyles(a,i,e)),this._lastEvent=c,h}_getActiveElements(t,e,s,i){if(t.type==="mouseout")return[];if(!s)return e;const r=this.options.hover;return this.getElementsAtEventForMode(t,r.mode,r,i)}}function ey(){return jt(np.instances,n=>n._plugins.invalidate())}function OV(n,t,e){const{startAngle:s,x:i,y:r,outerRadius:o,innerRadius:a,options:l}=t,{borderWidth:c,borderJoinStyle:h}=l,d=Math.min(c/o,Le(s-e));if(n.beginPath(),n.arc(i,r,o-c/2,s+d/2,e-d/2),a>0){const f=Math.min(c/a,Le(s-e));n.arc(i,r,a+c/2,e-f/2,s+f/2,!0)}else{const f=Math.min(c/2,o*Le(s-e));if(h==="round")n.arc(i,r,f,e-Nt/2,s+Nt/2,!0);else if(h==="bevel"){const g=2*f*f,_=-g*Math.cos(e+Nt/2)+i,y=-g*Math.sin(e+Nt/2)+r,w=g*Math.cos(s+Nt/2)+i,E=g*Math.sin(s+Nt/2)+r;n.lineTo(_,y),n.lineTo(w,E)}}n.closePath(),n.moveTo(0,0),n.rect(0,0,n.canvas.width,n.canvas.height),n.clip("evenodd")}function LV(n,t,e){const{startAngle:s,pixelMargin:i,x:r,y:o,outerRadius:a,innerRadius:l}=t;let c=i/a;n.beginPath(),n.arc(r,o,a,s-c,e+c),l>i?(c=i/l,n.arc(r,o,l,e+c,s-c,!0)):n.arc(r,o,i,e+ce,s-ce),n.closePath(),n.clip()}function VV(n){return Kf(n,["outerStart","outerEnd","innerStart","innerEnd"])}function NV(n,t,e,s){const i=VV(n.options.borderRadius),r=(e-t)/2,o=Math.min(r,s*t/2),a=l=>{const c=(e-Math.min(r,l))*s/2;return be(l,0,Math.min(r,c))};return{outerStart:a(i.outerStart),outerEnd:a(i.outerEnd),innerStart:be(i.innerStart,0,o),innerEnd:be(i.innerEnd,0,o)}}function sr(n,t,e,s){return{x:e+n*Math.cos(t),y:s+n*Math.sin(t)}}function vc(n,t,e,s,i,r){const{x:o,y:a,startAngle:l,pixelMargin:c,innerRadius:h}=t,d=Math.max(t.outerRadius+s+e-c,0),f=h>0?h+s+e+c:0;let g=0;const _=i-l;if(s){const st=h>0?h-s:0,mt=d>0?d-s:0,ot=(st+mt)/2,at=ot!==0?_*ot/(ot+s):_;g=(_-at)/2}const y=Math.max(.001,_*d-e/Nt)/d,w=(_-y)/2,E=l+w+g,S=i-w-g,{outerStart:A,outerEnd:k,innerStart:R,innerEnd:L}=NV(t,f,d,S-E),x=d-A,b=d-k,T=E+A/x,C=S-k/b,P=f+R,M=f+L,I=E+R/P,yt=S-L/M;if(n.beginPath(),r){const st=(T+C)/2;if(n.arc(o,a,d,T,st),n.arc(o,a,d,st,C),k>0){const Bt=sr(b,C,o,a);n.arc(Bt.x,Bt.y,k,C,S+ce)}const mt=sr(M,S,o,a);if(n.lineTo(mt.x,mt.y),L>0){const Bt=sr(M,yt,o,a);n.arc(Bt.x,Bt.y,L,S+ce,yt+Math.PI)}const ot=(S-L/f+(E+R/f))/2;if(n.arc(o,a,f,S-L/f,ot,!0),n.arc(o,a,f,ot,E+R/f,!0),R>0){const Bt=sr(P,I,o,a);n.arc(Bt.x,Bt.y,R,I+Math.PI,E-ce)}const at=sr(x,E,o,a);if(n.lineTo(at.x,at.y),A>0){const Bt=sr(x,T,o,a);n.arc(Bt.x,Bt.y,A,E-ce,T)}}else{n.moveTo(o,a);const st=Math.cos(T)*d+o,mt=Math.sin(T)*d+a;n.lineTo(st,mt);const ot=Math.cos(C)*d+o,at=Math.sin(C)*d+a;n.lineTo(ot,at)}n.closePath()}function FV(n,t,e,s,i){const{fullCircles:r,startAngle:o,circumference:a}=t;let l=t.endAngle;if(r){vc(n,t,e,s,l,i);for(let c=0;c<r;++c)n.fill();isNaN(a)||(l=o+(a%te||te))}return vc(n,t,e,s,l,i),n.fill(),l}function BV(n,t,e,s,i){const{fullCircles:r,startAngle:o,circumference:a,options:l}=t,{borderWidth:c,borderJoinStyle:h,borderDash:d,borderDashOffset:f,borderRadius:g}=l,_=l.borderAlign==="inner";if(!c)return;n.setLineDash(d||[]),n.lineDashOffset=f,_?(n.lineWidth=c*2,n.lineJoin=h||"round"):(n.lineWidth=c,n.lineJoin=h||"bevel");let y=t.endAngle;if(r){vc(n,t,e,s,y,i);for(let w=0;w<r;++w)n.stroke();isNaN(a)||(y=o+(a%te||te))}_&&LV(n,t,y),l.selfJoin&&y-o>=Nt&&g===0&&h!=="miter"&&OV(n,t,y),r||(vc(n,t,e,s,y,i),n.stroke())}class UV extends Ss{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:t=>t!=="borderDash"};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(t){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,t&&Object.assign(this,t)}inRange(t,e,s){const i=this.getProps(["x","y"],s),{angle:r,distance:o}=Tw(i,{x:t,y:e}),{startAngle:a,endAngle:l,innerRadius:c,outerRadius:h,circumference:d}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],s),f=(this.options.spacing+this.options.borderWidth)/2,g=vt(d,l-a),_=la(r,a,l)&&a!==l,y=g>=te||_,w=ls(o,c+f,h+f);return y&&w}getCenterPoint(t){const{x:e,y:s,startAngle:i,endAngle:r,innerRadius:o,outerRadius:a}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],t),{offset:l,spacing:c}=this.options,h=(i+r)/2,d=(o+a+c+l)/2;return{x:e+Math.cos(h)*d,y:s+Math.sin(h)*d}}tooltipPosition(t){return this.getCenterPoint(t)}draw(t){const{options:e,circumference:s}=this,i=(e.offset||0)/4,r=(e.spacing||0)/2,o=e.circular;if(this.pixelMargin=e.borderAlign==="inner"?.33:0,this.fullCircles=s>te?Math.floor(s/te):0,s===0||this.innerRadius<0||this.outerRadius<0)return;t.save();const a=(this.startAngle+this.endAngle)/2;t.translate(Math.cos(a)*i,Math.sin(a)*i);const l=1-Math.sin(Math.min(Nt,s||0)),c=i*l;t.fillStyle=e.backgroundColor,t.strokeStyle=e.borderColor,FV(t,this,c,r,o),BV(t,this,c,r,o),t.restore()}}function ix(n,t,e=t){n.lineCap=vt(e.borderCapStyle,t.borderCapStyle),n.setLineDash(vt(e.borderDash,t.borderDash)),n.lineDashOffset=vt(e.borderDashOffset,t.borderDashOffset),n.lineJoin=vt(e.borderJoinStyle,t.borderJoinStyle),n.lineWidth=vt(e.borderWidth,t.borderWidth),n.strokeStyle=vt(e.borderColor,t.borderColor)}function $V(n,t,e){n.lineTo(e.x,e.y)}function zV(n){return n.stepped?sO:n.tension||n.cubicInterpolationMode==="monotone"?iO:$V}function rx(n,t,e={}){const s=n.length,{start:i=0,end:r=s-1}=e,{start:o,end:a}=t,l=Math.max(i,o),c=Math.min(r,a),h=i<o&&r<o||i>a&&r>a;return{count:s,start:l,loop:t.loop,ilen:c<l&&!h?s+c-l:c-l}}function jV(n,t,e,s){const{points:i,options:r}=t,{count:o,start:a,loop:l,ilen:c}=rx(i,e,s),h=zV(r);let{move:d=!0,reverse:f}=s||{},g,_,y;for(g=0;g<=c;++g)_=i[(a+(f?c-g:g))%o],!_.skip&&(d?(n.moveTo(_.x,_.y),d=!1):h(n,y,_,f,r.stepped),y=_);return l&&(_=i[(a+(f?c:0))%o],h(n,y,_,f,r.stepped)),!!l}function HV(n,t,e,s){const i=t.points,{count:r,start:o,ilen:a}=rx(i,e,s),{move:l=!0,reverse:c}=s||{};let h=0,d=0,f,g,_,y,w,E;const S=k=>(o+(c?a-k:k))%r,A=()=>{y!==w&&(n.lineTo(h,w),n.lineTo(h,y),n.lineTo(h,E))};for(l&&(g=i[S(0)],n.moveTo(g.x,g.y)),f=0;f<=a;++f){if(g=i[S(f)],g.skip)continue;const k=g.x,R=g.y,L=k|0;L===_?(R<y?y=R:R>w&&(w=R),h=(d*h+k)/++d):(A(),n.lineTo(k,R),_=L,d=0,y=w=R),E=R}A()}function rd(n){const t=n.options,e=t.borderDash&&t.borderDash.length;return!n._decimated&&!n._loop&&!t.tension&&t.cubicInterpolationMode!=="monotone"&&!t.stepped&&!e?HV:jV}function WV(n){return n.stepped?VO:n.tension||n.cubicInterpolationMode==="monotone"?NO:Si}function qV(n,t,e,s){let i=t._path;i||(i=t._path=new Path2D,t.path(i,e,s)&&i.closePath()),ix(n,t.options),n.stroke(i)}function GV(n,t,e,s){const{segments:i,options:r}=t,o=rd(t);for(const a of i)ix(n,r,a.style),n.beginPath(),o(n,t,a,{start:e,end:e+s-1})&&n.closePath(),n.stroke()}const KV=typeof Path2D=="function";function YV(n,t,e,s){KV&&!t.options.segment?qV(n,t,e,s):GV(n,t,e,s)}class hu extends Ss{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:t=>t!=="borderDash"&&t!=="fill"};constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,e){const s=this.options;if((s.tension||s.cubicInterpolationMode==="monotone")&&!s.stepped&&!this._pointsUpdated){const i=s.spanGaps?this._loop:this._fullLoop;CO(this._points,s,t,i,e),this._pointsUpdated=!0}}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=jO(this,this.options.segment))}first(){const t=this.segments,e=this.points;return t.length&&e[t[0].start]}last(){const t=this.segments,e=this.points,s=t.length;return s&&e[t[s-1].end]}interpolate(t,e){const s=this.options,i=t[e],r=this.points,o=jw(this,{property:e,start:i,end:i});if(!o.length)return;const a=[],l=WV(s);let c,h;for(c=0,h=o.length;c<h;++c){const{start:d,end:f}=o[c],g=r[d],_=r[f];if(g===_){a.push(g);continue}const y=Math.abs((i-g[e])/(_[e]-g[e])),w=l(g,_,y,s.stepped);w[e]=t[e],a.push(w)}return a.length===1?a[0]:a}pathSegment(t,e,s){return rd(this)(t,this,e,s)}path(t,e,s){const i=this.segments,r=rd(this);let o=this._loop;e=e||0,s=s||this.points.length-e;for(const a of i)o&=r(t,this,a,{start:e,end:e+s-1});return!!o}draw(t,e,s,i){const r=this.options||{};(this.points||[]).length&&r.borderWidth&&(t.save(),YV(t,this,s,i),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function ny(n,t,e,s){const i=n.options,{[e]:r}=n.getProps([e],s);return Math.abs(t-r)<i.radius+i.hitRadius}class XV extends Ss{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(t){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,t&&Object.assign(this,t)}inRange(t,e,s){const i=this.options,{x:r,y:o}=this.getProps(["x","y"],s);return Math.pow(t-r,2)+Math.pow(e-o,2)<Math.pow(i.hitRadius+i.radius,2)}inXRange(t,e){return ny(this,t,"x",e)}inYRange(t,e){return ny(this,t,"y",e)}getCenterPoint(t){const{x:e,y:s}=this.getProps(["x","y"],t);return{x:e,y:s}}size(t){t=t||this.options||{};let e=t.radius||0;e=Math.max(e,e&&t.hoverRadius||0);const s=e&&t.borderWidth||0;return(e+s)*2}draw(t,e){const s=this.options;this.skip||s.radius<.1||!us(this,e,this.size(s)/2)||(t.strokeStyle=s.borderColor,t.lineWidth=s.borderWidth,t.fillStyle=s.backgroundColor,nd(t,s,this.x,this.y))}getRange(){const t=this.options||{};return t.radius+t.hitRadius}}function ox(n,t){const{x:e,y:s,base:i,width:r,height:o}=n.getProps(["x","y","base","width","height"],t);let a,l,c,h,d;return n.horizontal?(d=o/2,a=Math.min(e,i),l=Math.max(e,i),c=s-d,h=s+d):(d=r/2,a=e-d,l=e+d,c=Math.min(s,i),h=Math.max(s,i)),{left:a,top:c,right:l,bottom:h}}function Hs(n,t,e,s){return n?0:be(t,e,s)}function QV(n,t,e){const s=n.options.borderWidth,i=n.borderSkipped,r=Dw(s);return{t:Hs(i.top,r.top,0,e),r:Hs(i.right,r.right,0,t),b:Hs(i.bottom,r.bottom,0,e),l:Hs(i.left,r.left,0,t)}}function JV(n,t,e){const{enableBorderRadius:s}=n.getProps(["enableBorderRadius"]),i=n.options.borderRadius,r=Li(i),o=Math.min(t,e),a=n.borderSkipped,l=s||Mt(i);return{topLeft:Hs(!l||a.top||a.left,r.topLeft,0,o),topRight:Hs(!l||a.top||a.right,r.topRight,0,o),bottomLeft:Hs(!l||a.bottom||a.left,r.bottomLeft,0,o),bottomRight:Hs(!l||a.bottom||a.right,r.bottomRight,0,o)}}function ZV(n){const t=ox(n),e=t.right-t.left,s=t.bottom-t.top,i=QV(n,e/2,s/2),r=JV(n,e/2,s/2);return{outer:{x:t.left,y:t.top,w:e,h:s,radius:r},inner:{x:t.left+i.l,y:t.top+i.t,w:e-i.l-i.r,h:s-i.t-i.b,radius:{topLeft:Math.max(0,r.topLeft-Math.max(i.t,i.l)),topRight:Math.max(0,r.topRight-Math.max(i.t,i.r)),bottomLeft:Math.max(0,r.bottomLeft-Math.max(i.b,i.l)),bottomRight:Math.max(0,r.bottomRight-Math.max(i.b,i.r))}}}}function lh(n,t,e,s){const i=t===null,r=e===null,a=n&&!(i&&r)&&ox(n,s);return a&&(i||ls(t,a.left,a.right))&&(r||ls(e,a.top,a.bottom))}function tN(n){return n.topLeft||n.topRight||n.bottomLeft||n.bottomRight}function eN(n,t){n.rect(t.x,t.y,t.w,t.h)}function ch(n,t,e={}){const s=n.x!==e.x?-t:0,i=n.y!==e.y?-t:0,r=(n.x+n.w!==e.x+e.w?t:0)-s,o=(n.y+n.h!==e.y+e.h?t:0)-i;return{x:n.x+s,y:n.y+i,w:n.w+r,h:n.h+o,radius:n.radius}}class nN extends Ss{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:e,options:{borderColor:s,backgroundColor:i}}=this,{inner:r,outer:o}=ZV(this),a=tN(o.radius)?ca:eN;t.save(),(o.w!==r.w||o.h!==r.h)&&(t.beginPath(),a(t,ch(o,e,r)),t.clip(),a(t,ch(r,-e,o)),t.fillStyle=s,t.fill("evenodd")),t.beginPath(),a(t,ch(r,e)),t.fillStyle=i,t.fill(),t.restore()}inRange(t,e,s){return lh(this,t,e,s)}inXRange(t,e){return lh(this,t,null,e)}inYRange(t,e){return lh(this,null,t,e)}getCenterPoint(t){const{x:e,y:s,base:i,horizontal:r}=this.getProps(["x","y","base","horizontal"],t);return{x:r?(e+i)/2:e,y:r?s:(s+i)/2}}getRange(t){return t==="x"?this.width/2:this.height/2}}var sN=Object.freeze({__proto__:null,ArcElement:UV,BarElement:nN,LineElement:hu,PointElement:XV});const od=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],sy=od.map(n=>n.replace("rgb(","rgba(").replace(")",", 0.5)"));function ax(n){return od[n%od.length]}function lx(n){return sy[n%sy.length]}function iN(n,t){return n.borderColor=ax(t),n.backgroundColor=lx(t),++t}function rN(n,t){return n.backgroundColor=n.data.map(()=>ax(t++)),t}function oN(n,t){return n.backgroundColor=n.data.map(()=>lx(t++)),t}function aN(n){let t=0;return(e,s)=>{const i=n.getDatasetMeta(s).controller;i instanceof tp?t=rN(e,t):i instanceof Kw?t=oN(e,t):i&&(t=iN(e,t))}}function iy(n){let t;for(t in n)if(n[t].borderColor||n[t].backgroundColor)return!0;return!1}function lN(n){return n&&(n.borderColor||n.backgroundColor)}function cN(){return ne.borderColor!=="rgba(0,0,0,0.1)"||ne.backgroundColor!=="rgba(0,0,0,0.1)"}var uN={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(n,t,e){if(!e.enabled)return;const{data:{datasets:s},options:i}=n.config,{elements:r}=i,o=iy(s)||lN(i)||r&&iy(r)||cN();if(!e.forceOverride&&o)return;const a=aN(n);s.forEach(a)}};function hN(n,t,e,s,i){const r=i.samples||s;if(r>=e)return n.slice(t,t+e);const o=[],a=(e-2)/(r-2);let l=0;const c=t+e-1;let h=t,d,f,g,_,y;for(o[l++]=n[h],d=0;d<r-2;d++){let w=0,E=0,S;const A=Math.floor((d+1)*a)+1+t,k=Math.min(Math.floor((d+2)*a)+1,e)+t,R=k-A;for(S=A;S<k;S++)w+=n[S].x,E+=n[S].y;w/=R,E/=R;const L=Math.floor(d*a)+1+t,x=Math.min(Math.floor((d+1)*a)+1,e)+t,{x:b,y:T}=n[h];for(g=_=-1,S=L;S<x;S++)_=.5*Math.abs((b-w)*(n[S].y-T)-(b-n[S].x)*(E-T)),_>g&&(g=_,f=n[S],y=S);o[l++]=f,h=y}return o[l++]=n[c],o}function dN(n,t,e,s){let i=0,r=0,o,a,l,c,h,d,f,g,_,y;const w=[],E=t+e-1,S=n[t].x,k=n[E].x-S;for(o=t;o<t+e;++o){a=n[o],l=(a.x-S)/k*s,c=a.y;const R=l|0;if(R===h)c<_?(_=c,d=o):c>y&&(y=c,f=o),i=(r*i+a.x)/++r;else{const L=o-1;if(!Ct(d)&&!Ct(f)){const x=Math.min(d,f),b=Math.max(d,f);x!==g&&x!==L&&w.push({...n[x],x:i}),b!==g&&b!==L&&w.push({...n[b],x:i})}o>0&&L!==g&&w.push(n[L]),w.push(a),h=R,r=0,_=y=c,d=f=g=o}}return w}function cx(n){if(n._decimated){const t=n._data;delete n._decimated,delete n._data,Object.defineProperty(n,"data",{configurable:!0,enumerable:!0,writable:!0,value:t})}}function ry(n){n.data.datasets.forEach(t=>{cx(t)})}function fN(n,t){const e=t.length;let s=0,i;const{iScale:r}=n,{min:o,max:a,minDefined:l,maxDefined:c}=r.getUserBounds();return l&&(s=be(cs(t,r.axis,o).lo,0,e-1)),c?i=be(cs(t,r.axis,a).hi+1,s,e)-s:i=e-s,{start:s,count:i}}var pN={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(n,t,e)=>{if(!e.enabled){ry(n);return}const s=n.width;n.data.datasets.forEach((i,r)=>{const{_data:o,indexAxis:a}=i,l=n.getDatasetMeta(r),c=o||i.data;if(bo([a,n.options.indexAxis])==="y"||!l.controller.supportsDecimation)return;const h=n.scales[l.xAxisID];if(h.type!=="linear"&&h.type!=="time"||n.options.parsing)return;let{start:d,count:f}=fN(l,c);const g=e.threshold||4*s;if(f<=g){cx(i);return}Ct(o)&&(i._data=c,delete i.data,Object.defineProperty(i,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(y){this._data=y}}));let _;switch(e.algorithm){case"lttb":_=hN(c,d,f,s,e);break;case"min-max":_=dN(c,d,f,s);break;default:throw new Error(`Unsupported decimation algorithm '${e.algorithm}'`)}i._decimated=_})},destroy(n){ry(n)}};function gN(n,t,e){const s=n.segments,i=n.points,r=t.points,o=[];for(const a of s){let{start:l,end:c}=a;c=du(l,c,i);const h=ad(e,i[l],i[c],a.loop);if(!t.segments){o.push({source:a,target:h,start:i[l],end:i[c]});continue}const d=jw(t,h);for(const f of d){const g=ad(e,r[f.start],r[f.end],f.loop),_=zw(a,i,g);for(const y of _)o.push({source:y,target:f,start:{[e]:oy(h,g,"start",Math.max)},end:{[e]:oy(h,g,"end",Math.min)}})}}return o}function ad(n,t,e,s){if(s)return;let i=t[n],r=e[n];return n==="angle"&&(i=Le(i),r=Le(r)),{property:n,start:i,end:r}}function mN(n,t){const{x:e=null,y:s=null}=n||{},i=t.points,r=[];return t.segments.forEach(({start:o,end:a})=>{a=du(o,a,i);const l=i[o],c=i[a];s!==null?(r.push({x:l.x,y:s}),r.push({x:c.x,y:s})):e!==null&&(r.push({x:e,y:l.y}),r.push({x:e,y:c.y}))}),r}function du(n,t,e){for(;t>n;t--){const s=e[t];if(!isNaN(s.x)&&!isNaN(s.y))break}return t}function oy(n,t,e,s){return n&&t?s(n[e],t[e]):n?n[e]:t?t[e]:0}function ux(n,t){let e=[],s=!1;return ee(n)?(s=!0,e=n):e=mN(n,t),e.length?new hu({points:e,options:{tension:0},_loop:s,_fullLoop:s}):null}function ay(n){return n&&n.fill!==!1}function _N(n,t,e){let i=n[t].fill;const r=[t];let o;if(!e)return i;for(;i!==!1&&r.indexOf(i)===-1;){if(!ae(i))return i;if(o=n[i],!o)return!1;if(o.visible)return i;r.push(i),i=o.fill}return!1}function yN(n,t,e){const s=xN(n);if(Mt(s))return isNaN(s.value)?!1:s;let i=parseFloat(s);return ae(i)&&Math.floor(i)===i?bN(s[0],t,i,e):["origin","start","end","stack","shape"].indexOf(s)>=0&&s}function bN(n,t,e,s){return(n==="-"||n==="+")&&(e=t+e),e===t||e<0||e>=s?!1:e}function vN(n,t){let e=null;return n==="start"?e=t.bottom:n==="end"?e=t.top:Mt(n)?e=t.getPixelForValue(n.value):t.getBasePixel&&(e=t.getBasePixel()),e}function wN(n,t,e){let s;return n==="start"?s=e:n==="end"?s=t.options.reverse?t.min:t.max:Mt(n)?s=n.value:s=t.getBaseValue(),s}function xN(n){const t=n.options,e=t.fill;let s=vt(e&&e.target,e);return s===void 0&&(s=!!t.backgroundColor),s===!1||s===null?!1:s===!0?"origin":s}function TN(n){const{scale:t,index:e,line:s}=n,i=[],r=s.segments,o=s.points,a=EN(t,e);a.push(ux({x:null,y:t.bottom},s));for(let l=0;l<r.length;l++){const c=r[l];for(let h=c.start;h<=c.end;h++)IN(i,o[h],a)}return new hu({points:i,options:{}})}function EN(n,t){const e=[],s=n.getMatchingVisibleMetas("line");for(let i=0;i<s.length;i++){const r=s[i];if(r.index===t)break;r.hidden||e.unshift(r.dataset)}return e}function IN(n,t,e){const s=[];for(let i=0;i<e.length;i++){const r=e[i],{first:o,last:a,point:l}=AN(r,t,"x");if(!(!l||o&&a)){if(o)s.unshift(l);else if(n.push(l),!a)break}}n.push(...s)}function AN(n,t,e){const s=n.interpolate(t,e);if(!s)return{};const i=s[e],r=n.segments,o=n.points;let a=!1,l=!1;for(let c=0;c<r.length;c++){const h=r[c],d=o[h.start][e],f=o[h.end][e];if(ls(i,d,f)){a=i===d,l=i===f;break}}return{first:a,last:l,point:s}}class hx{constructor(t){this.x=t.x,this.y=t.y,this.radius=t.radius}pathSegment(t,e,s){const{x:i,y:r,radius:o}=this;return e=e||{start:0,end:te},t.arc(i,r,o,e.end,e.start,!0),!s.bounds}interpolate(t){const{x:e,y:s,radius:i}=this,r=t.angle;return{x:e+Math.cos(r)*i,y:s+Math.sin(r)*i,angle:r}}}function SN(n){const{chart:t,fill:e,line:s}=n;if(ae(e))return CN(t,e);if(e==="stack")return TN(n);if(e==="shape")return!0;const i=PN(n);return i instanceof hx?i:ux(i,s)}function CN(n,t){const e=n.getDatasetMeta(t);return e&&n.isDatasetVisible(t)?e.dataset:null}function PN(n){return(n.scale||{}).getPointPositionForValue?kN(n):RN(n)}function RN(n){const{scale:t={},fill:e}=n,s=vN(e,t);if(ae(s)){const i=t.isHorizontal();return{x:i?s:null,y:i?null:s}}return null}function kN(n){const{scale:t,fill:e}=n,s=t.options,i=t.getLabels().length,r=s.reverse?t.max:t.min,o=wN(e,t,r),a=[];if(s.grid.circular){const l=t.getPointPositionForValue(0,r);return new hx({x:l.x,y:l.y,radius:t.getDistanceFromCenterForValue(o)})}for(let l=0;l<i;++l)a.push(t.getPointPositionForValue(l,o));return a}function uh(n,t,e){const s=SN(t),{chart:i,index:r,line:o,scale:a,axis:l}=t,c=o.options,h=c.fill,d=c.backgroundColor,{above:f=d,below:g=d}=h||{},_=i.getDatasetMeta(r),y=Hw(i,_);s&&o.points.length&&(au(n,e),DN(n,{line:o,target:s,above:f,below:g,area:e,scale:a,axis:l,clip:y}),lu(n))}function DN(n,t){const{line:e,target:s,above:i,below:r,area:o,scale:a,clip:l}=t,c=e._loop?"angle":t.axis;n.save();let h=r;r!==i&&(c==="x"?(ly(n,s,o.top),hh(n,{line:e,target:s,color:i,scale:a,property:c,clip:l}),n.restore(),n.save(),ly(n,s,o.bottom)):c==="y"&&(cy(n,s,o.left),hh(n,{line:e,target:s,color:r,scale:a,property:c,clip:l}),n.restore(),n.save(),cy(n,s,o.right),h=i)),hh(n,{line:e,target:s,color:h,scale:a,property:c,clip:l}),n.restore()}function ly(n,t,e){const{segments:s,points:i}=t;let r=!0,o=!1;n.beginPath();for(const a of s){const{start:l,end:c}=a,h=i[l],d=i[du(l,c,i)];r?(n.moveTo(h.x,h.y),r=!1):(n.lineTo(h.x,e),n.lineTo(h.x,h.y)),o=!!t.pathSegment(n,a,{move:o}),o?n.closePath():n.lineTo(d.x,e)}n.lineTo(t.first().x,e),n.closePath(),n.clip()}function cy(n,t,e){const{segments:s,points:i}=t;let r=!0,o=!1;n.beginPath();for(const a of s){const{start:l,end:c}=a,h=i[l],d=i[du(l,c,i)];r?(n.moveTo(h.x,h.y),r=!1):(n.lineTo(e,h.y),n.lineTo(h.x,h.y)),o=!!t.pathSegment(n,a,{move:o}),o?n.closePath():n.lineTo(e,d.y)}n.lineTo(e,t.first().y),n.closePath(),n.clip()}function hh(n,t){const{line:e,target:s,property:i,color:r,scale:o,clip:a}=t,l=gN(e,s,i);for(const{source:c,target:h,start:d,end:f}of l){const{style:{backgroundColor:g=r}={}}=c,_=s!==!0;n.save(),n.fillStyle=g,MN(n,o,a,_&&ad(i,d,f)),n.beginPath();const y=!!e.pathSegment(n,c);let w;if(_){y?n.closePath():uy(n,s,f,i);const E=!!s.pathSegment(n,h,{move:y,reverse:!0});w=y&&E,w||uy(n,s,d,i)}n.closePath(),n.fill(w?"evenodd":"nonzero"),n.restore()}}function MN(n,t,e,s){const i=t.chart.chartArea,{property:r,start:o,end:a}=s||{};if(r==="x"||r==="y"){let l,c,h,d;r==="x"?(l=o,c=i.top,h=a,d=i.bottom):(l=i.left,c=o,h=i.right,d=a),n.beginPath(),e&&(l=Math.max(l,e.left),h=Math.min(h,e.right),c=Math.max(c,e.top),d=Math.min(d,e.bottom)),n.rect(l,c,h-l,d-c),n.clip()}}function uy(n,t,e,s){const i=t.interpolate(e,s);i&&n.lineTo(i.x,i.y)}var ON={id:"filler",afterDatasetsUpdate(n,t,e){const s=(n.data.datasets||[]).length,i=[];let r,o,a,l;for(o=0;o<s;++o)r=n.getDatasetMeta(o),a=r.dataset,l=null,a&&a.options&&a instanceof hu&&(l={visible:n.isDatasetVisible(o),index:o,fill:yN(a,o,s),chart:n,axis:r.controller.options.indexAxis,scale:r.vScale,line:a}),r.$filler=l,i.push(l);for(o=0;o<s;++o)l=i[o],!(!l||l.fill===!1)&&(l.fill=_N(i,o,e.propagate))},beforeDraw(n,t,e){const s=e.drawTime==="beforeDraw",i=n.getSortedVisibleDatasetMetas(),r=n.chartArea;for(let o=i.length-1;o>=0;--o){const a=i[o].$filler;a&&(a.line.updateControlPoints(r,a.axis),s&&a.fill&&uh(n.ctx,a,r))}},beforeDatasetsDraw(n,t,e){if(e.drawTime!=="beforeDatasetsDraw")return;const s=n.getSortedVisibleDatasetMetas();for(let i=s.length-1;i>=0;--i){const r=s[i].$filler;ay(r)&&uh(n.ctx,r,n.chartArea)}},beforeDatasetDraw(n,t,e){const s=t.meta.$filler;!ay(s)||e.drawTime!=="beforeDatasetDraw"||uh(n.ctx,s,n.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const hy=(n,t)=>{let{boxHeight:e=t,boxWidth:s=t}=n;return n.usePointStyle&&(e=Math.min(e,t),s=n.pointStyleWidth||Math.min(s,t)),{boxWidth:s,boxHeight:e,itemHeight:Math.max(t,e)}},LN=(n,t)=>n!==null&&t!==null&&n.datasetIndex===t.datasetIndex&&n.index===t.index;class dy extends Ss{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e,s){this.maxWidth=t,this.maxHeight=e,this._margins=s,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let e=Xt(t.generateLabels,[this.chart],this)||[];t.filter&&(e=e.filter(s=>t.filter(s,this.chart.data))),t.sort&&(e=e.sort((s,i)=>t.sort(s,i,this.chart.data))),this.options.reverse&&e.reverse(),this.legendItems=e}fit(){const{options:t,ctx:e}=this;if(!t.display){this.width=this.height=0;return}const s=t.labels,i=ge(s.font),r=i.size,o=this._computeTitleHeight(),{boxWidth:a,itemHeight:l}=hy(s,r);let c,h;e.font=i.string,this.isHorizontal()?(c=this.maxWidth,h=this._fitRows(o,r,a,l)+10):(h=this.maxHeight,c=this._fitCols(o,i,a,l)+10),this.width=Math.min(c,t.maxWidth||this.maxWidth),this.height=Math.min(h,t.maxHeight||this.maxHeight)}_fitRows(t,e,s,i){const{ctx:r,maxWidth:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.lineWidths=[0],h=i+a;let d=t;r.textAlign="left",r.textBaseline="middle";let f=-1,g=-h;return this.legendItems.forEach((_,y)=>{const w=s+e/2+r.measureText(_.text).width;(y===0||c[c.length-1]+w+2*a>o)&&(d+=h,c[c.length-(y>0?0:1)]=0,g+=h,f++),l[y]={left:0,top:g,row:f,width:w,height:i},c[c.length-1]+=w+a}),d}_fitCols(t,e,s,i){const{ctx:r,maxHeight:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.columnSizes=[],h=o-t;let d=a,f=0,g=0,_=0,y=0;return this.legendItems.forEach((w,E)=>{const{itemWidth:S,itemHeight:A}=VN(s,e,r,w,i);E>0&&g+A+2*a>h&&(d+=f+a,c.push({width:f,height:g}),_+=f+a,y++,f=g=0),l[E]={left:_,top:g,col:y,width:S,height:A},f=Math.max(f,S),g+=A+a}),d+=f,c.push({width:f,height:g}),d}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:e,options:{align:s,labels:{padding:i},rtl:r}}=this,o=br(r,this.left,this.width);if(this.isHorizontal()){let a=0,l=Me(s,this.left+i,this.right-this.lineWidths[a]);for(const c of e)a!==c.row&&(a=c.row,l=Me(s,this.left+i,this.right-this.lineWidths[a])),c.top+=this.top+t+i,c.left=o.leftForLtr(o.x(l),c.width),l+=c.width+i}else{let a=0,l=Me(s,this.top+t+i,this.bottom-this.columnSizes[a].height);for(const c of e)c.col!==a&&(a=c.col,l=Me(s,this.top+t+i,this.bottom-this.columnSizes[a].height)),c.top=l,c.left+=this.left+i,c.left=o.leftForLtr(o.x(c.left),c.width),l+=c.height+i}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const t=this.ctx;au(t,this),this._draw(),lu(t)}}_draw(){const{options:t,columnSizes:e,lineWidths:s,ctx:i}=this,{align:r,labels:o}=t,a=ne.color,l=br(t.rtl,this.left,this.width),c=ge(o.font),{padding:h}=o,d=c.size,f=d/2;let g;this.drawTitle(),i.textAlign=l.textAlign("left"),i.textBaseline="middle",i.lineWidth=.5,i.font=c.string;const{boxWidth:_,boxHeight:y,itemHeight:w}=hy(o,d),E=function(L,x,b){if(isNaN(_)||_<=0||isNaN(y)||y<0)return;i.save();const T=vt(b.lineWidth,1);if(i.fillStyle=vt(b.fillStyle,a),i.lineCap=vt(b.lineCap,"butt"),i.lineDashOffset=vt(b.lineDashOffset,0),i.lineJoin=vt(b.lineJoin,"miter"),i.lineWidth=T,i.strokeStyle=vt(b.strokeStyle,a),i.setLineDash(vt(b.lineDash,[])),o.usePointStyle){const C={radius:y*Math.SQRT2/2,pointStyle:b.pointStyle,rotation:b.rotation,borderWidth:T},P=l.xPlus(L,_/2),M=x+f;kw(i,C,P,M,o.pointStyleWidth&&_)}else{const C=x+Math.max((d-y)/2,0),P=l.leftForLtr(L,_),M=Li(b.borderRadius);i.beginPath(),Object.values(M).some(I=>I!==0)?ca(i,{x:P,y:C,w:_,h:y,radius:M}):i.rect(P,C,_,y),i.fill(),T!==0&&i.stroke()}i.restore()},S=function(L,x,b){ji(i,b.text,L,x+w/2,c,{strikethrough:b.hidden,textAlign:l.textAlign(b.textAlign)})},A=this.isHorizontal(),k=this._computeTitleHeight();A?g={x:Me(r,this.left+h,this.right-s[0]),y:this.top+h+k,line:0}:g={x:this.left+h,y:Me(r,this.top+k+h,this.bottom-e[0].height),line:0},Bw(this.ctx,t.textDirection);const R=w+h;this.legendItems.forEach((L,x)=>{i.strokeStyle=L.fontColor,i.fillStyle=L.fontColor;const b=i.measureText(L.text).width,T=l.textAlign(L.textAlign||(L.textAlign=o.textAlign)),C=_+f+b;let P=g.x,M=g.y;l.setWidth(this.width),A?x>0&&P+C+h>this.right&&(M=g.y+=R,g.line++,P=g.x=Me(r,this.left+h,this.right-s[g.line])):x>0&&M+R>this.bottom&&(P=g.x=P+e[g.line].width+h,g.line++,M=g.y=Me(r,this.top+k+h,this.bottom-e[g.line].height));const I=l.x(P);if(E(I,M,L),P=q2(T,P+_+f,A?P+C:this.right,t.rtl),S(l.x(P),M,L),A)g.x+=C+h;else if(typeof L.text!="string"){const yt=c.lineHeight;g.y+=dx(L,yt)+h}else g.y+=R}),Uw(this.ctx,t.textDirection)}drawTitle(){const t=this.options,e=t.title,s=ge(e.font),i=ze(e.padding);if(!e.display)return;const r=br(t.rtl,this.left,this.width),o=this.ctx,a=e.position,l=s.size/2,c=i.top+l;let h,d=this.left,f=this.width;if(this.isHorizontal())f=Math.max(...this.lineWidths),h=this.top+c,d=Me(t.align,d,this.right-f);else{const _=this.columnSizes.reduce((y,w)=>Math.max(y,w.height),0);h=c+Me(t.align,this.top,this.bottom-_-t.labels.padding-this._computeTitleHeight())}const g=Me(a,d,d+f);o.textAlign=r.textAlign(qf(a)),o.textBaseline="middle",o.strokeStyle=e.color,o.fillStyle=e.color,o.font=s.string,ji(o,e.text,g,h,s)}_computeTitleHeight(){const t=this.options.title,e=ge(t.font),s=ze(t.padding);return t.display?e.lineHeight+s.height:0}_getLegendItemAt(t,e){let s,i,r;if(ls(t,this.left,this.right)&&ls(e,this.top,this.bottom)){for(r=this.legendHitBoxes,s=0;s<r.length;++s)if(i=r[s],ls(t,i.left,i.left+i.width)&&ls(e,i.top,i.top+i.height))return this.legendItems[s]}return null}handleEvent(t){const e=this.options;if(!BN(t.type,e))return;const s=this._getLegendItemAt(t.x,t.y);if(t.type==="mousemove"||t.type==="mouseout"){const i=this._hoveredItem,r=LN(i,s);i&&!r&&Xt(e.onLeave,[t,i,this],this),this._hoveredItem=s,s&&!r&&Xt(e.onHover,[t,s,this],this)}else s&&Xt(e.onClick,[t,s,this],this)}}function VN(n,t,e,s,i){const r=NN(s,n,t,e),o=FN(i,s,t.lineHeight);return{itemWidth:r,itemHeight:o}}function NN(n,t,e,s){let i=n.text;return i&&typeof i!="string"&&(i=i.reduce((r,o)=>r.length>o.length?r:o)),t+e.size/2+s.measureText(i).width}function FN(n,t,e){let s=n;return typeof t.text!="string"&&(s=dx(t,e)),s}function dx(n,t){const e=n.text?n.text.length:0;return t*e}function BN(n,t){return!!((n==="mousemove"||n==="mouseout")&&(t.onHover||t.onLeave)||t.onClick&&(n==="click"||n==="mouseup"))}var UN={id:"legend",_element:dy,start(n,t,e){const s=n.legend=new dy({ctx:n.ctx,options:e,chart:n});Be.configure(n,s,e),Be.addBox(n,s)},stop(n){Be.removeBox(n,n.legend),delete n.legend},beforeUpdate(n,t,e){const s=n.legend;Be.configure(n,s,e),s.options=e},afterUpdate(n){const t=n.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(n,t){t.replay||n.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(n,t,e){const s=t.datasetIndex,i=e.chart;i.isDatasetVisible(s)?(i.hide(s),t.hidden=!0):(i.show(s),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:n=>n.chart.options.color,boxWidth:40,padding:10,generateLabels(n){const t=n.data.datasets,{labels:{usePointStyle:e,pointStyle:s,textAlign:i,color:r,useBorderRadius:o,borderRadius:a}}=n.legend.options;return n._getSortedDatasetMetas().map(l=>{const c=l.controller.getStyle(e?0:void 0),h=ze(c.borderWidth);return{text:t[l.index].label,fillStyle:c.backgroundColor,fontColor:r,hidden:!l.visible,lineCap:c.borderCapStyle,lineDash:c.borderDash,lineDashOffset:c.borderDashOffset,lineJoin:c.borderJoinStyle,lineWidth:(h.width+h.height)/4,strokeStyle:c.borderColor,pointStyle:s||c.pointStyle,rotation:c.rotation,textAlign:i||c.textAlign,borderRadius:o&&(a||c.borderRadius),datasetIndex:l.index}},this)}},title:{color:n=>n.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:n=>!n.startsWith("on"),labels:{_scriptable:n=>!["generateLabels","filter","sort"].includes(n)}}};class sp extends Ss{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e){const s=this.options;if(this.left=0,this.top=0,!s.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=t,this.height=this.bottom=e;const i=ee(s.text)?s.text.length:1;this._padding=ze(s.padding);const r=i*ge(s.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=r:this.width=r}isHorizontal(){const t=this.options.position;return t==="top"||t==="bottom"}_drawArgs(t){const{top:e,left:s,bottom:i,right:r,options:o}=this,a=o.align;let l=0,c,h,d;return this.isHorizontal()?(h=Me(a,s,r),d=e+t,c=r-s):(o.position==="left"?(h=s+t,d=Me(a,i,e),l=Nt*-.5):(h=r-t,d=Me(a,e,i),l=Nt*.5),c=i-e),{titleX:h,titleY:d,maxWidth:c,rotation:l}}draw(){const t=this.ctx,e=this.options;if(!e.display)return;const s=ge(e.font),r=s.lineHeight/2+this._padding.top,{titleX:o,titleY:a,maxWidth:l,rotation:c}=this._drawArgs(r);ji(t,e.text,0,0,s,{color:e.color,maxWidth:l,rotation:c,textAlign:qf(e.align),textBaseline:"middle",translation:[o,a]})}}function $N(n,t){const e=new sp({ctx:n.ctx,options:t,chart:n});Be.configure(n,e,t),Be.addBox(n,e),n.titleBlock=e}var zN={id:"title",_element:sp,start(n,t,e){$N(n,e)},stop(n){const t=n.titleBlock;Be.removeBox(n,t),delete n.titleBlock},beforeUpdate(n,t,e){const s=n.titleBlock;Be.configure(n,s,e),s.options=e},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const gl=new WeakMap;var jN={id:"subtitle",start(n,t,e){const s=new sp({ctx:n.ctx,options:e,chart:n});Be.configure(n,s,e),Be.addBox(n,s),gl.set(n,s)},stop(n){Be.removeBox(n,gl.get(n)),gl.delete(n)},beforeUpdate(n,t,e){const s=gl.get(n);Be.configure(n,s,e),s.options=e},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const wo={average(n){if(!n.length)return!1;let t,e,s=new Set,i=0,r=0;for(t=0,e=n.length;t<e;++t){const a=n[t].element;if(a&&a.hasValue()){const l=a.tooltipPosition();s.add(l.x),i+=l.y,++r}}return r===0||s.size===0?!1:{x:[...s].reduce((a,l)=>a+l)/s.size,y:i/r}},nearest(n,t){if(!n.length)return!1;let e=t.x,s=t.y,i=Number.POSITIVE_INFINITY,r,o,a;for(r=0,o=n.length;r<o;++r){const l=n[r].element;if(l&&l.hasValue()){const c=l.getCenterPoint(),h=td(t,c);h<i&&(i=h,a=l)}}if(a){const l=a.tooltipPosition();e=l.x,s=l.y}return{x:e,y:s}}};function Pn(n,t){return t&&(ee(t)?Array.prototype.push.apply(n,t):n.push(t)),n}function ts(n){return(typeof n=="string"||n instanceof String)&&n.indexOf(`
`)>-1?n.split(`
`):n}function HN(n,t){const{element:e,datasetIndex:s,index:i}=t,r=n.getDatasetMeta(s).controller,{label:o,value:a}=r.getLabelAndValue(i);return{chart:n,label:o,parsed:r.getParsed(i),raw:n.data.datasets[s].data[i],formattedValue:a,dataset:r.getDataset(),dataIndex:i,datasetIndex:s,element:e}}function fy(n,t){const e=n.chart.ctx,{body:s,footer:i,title:r}=n,{boxWidth:o,boxHeight:a}=t,l=ge(t.bodyFont),c=ge(t.titleFont),h=ge(t.footerFont),d=r.length,f=i.length,g=s.length,_=ze(t.padding);let y=_.height,w=0,E=s.reduce((k,R)=>k+R.before.length+R.lines.length+R.after.length,0);if(E+=n.beforeBody.length+n.afterBody.length,d&&(y+=d*c.lineHeight+(d-1)*t.titleSpacing+t.titleMarginBottom),E){const k=t.displayColors?Math.max(a,l.lineHeight):l.lineHeight;y+=g*k+(E-g)*l.lineHeight+(E-1)*t.bodySpacing}f&&(y+=t.footerMarginTop+f*h.lineHeight+(f-1)*t.footerSpacing);let S=0;const A=function(k){w=Math.max(w,e.measureText(k).width+S)};return e.save(),e.font=c.string,jt(n.title,A),e.font=l.string,jt(n.beforeBody.concat(n.afterBody),A),S=t.displayColors?o+2+t.boxPadding:0,jt(s,k=>{jt(k.before,A),jt(k.lines,A),jt(k.after,A)}),S=0,e.font=h.string,jt(n.footer,A),e.restore(),w+=_.width,{width:w,height:y}}function WN(n,t){const{y:e,height:s}=t;return e<s/2?"top":e>n.height-s/2?"bottom":"center"}function qN(n,t,e,s){const{x:i,width:r}=s,o=e.caretSize+e.caretPadding;if(n==="left"&&i+r+o>t.width||n==="right"&&i-r-o<0)return!0}function GN(n,t,e,s){const{x:i,width:r}=e,{width:o,chartArea:{left:a,right:l}}=n;let c="center";return s==="center"?c=i<=(a+l)/2?"left":"right":i<=r/2?c="left":i>=o-r/2&&(c="right"),qN(c,n,t,e)&&(c="center"),c}function py(n,t,e){const s=e.yAlign||t.yAlign||WN(n,e);return{xAlign:e.xAlign||t.xAlign||GN(n,t,e,s),yAlign:s}}function KN(n,t){let{x:e,width:s}=n;return t==="right"?e-=s:t==="center"&&(e-=s/2),e}function YN(n,t,e){let{y:s,height:i}=n;return t==="top"?s+=e:t==="bottom"?s-=i+e:s-=i/2,s}function gy(n,t,e,s){const{caretSize:i,caretPadding:r,cornerRadius:o}=n,{xAlign:a,yAlign:l}=e,c=i+r,{topLeft:h,topRight:d,bottomLeft:f,bottomRight:g}=Li(o);let _=KN(t,a);const y=YN(t,l,c);return l==="center"?a==="left"?_+=c:a==="right"&&(_-=c):a==="left"?_-=Math.max(h,f)+i:a==="right"&&(_+=Math.max(d,g)+i),{x:be(_,0,s.width-t.width),y:be(y,0,s.height-t.height)}}function ml(n,t,e){const s=ze(e.padding);return t==="center"?n.x+n.width/2:t==="right"?n.x+n.width-s.right:n.x+s.left}function my(n){return Pn([],ts(n))}function XN(n,t,e){return di(n,{tooltip:t,tooltipItems:e,type:"tooltip"})}function _y(n,t){const e=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return e?n.override(e):n}const fx={beforeTitle:Jn,title(n){if(n.length>0){const t=n[0],e=t.chart.data.labels,s=e?e.length:0;if(this&&this.options&&this.options.mode==="dataset")return t.dataset.label||"";if(t.label)return t.label;if(s>0&&t.dataIndex<s)return e[t.dataIndex]}return""},afterTitle:Jn,beforeBody:Jn,beforeLabel:Jn,label(n){if(this&&this.options&&this.options.mode==="dataset")return n.label+": "+n.formattedValue||n.formattedValue;let t=n.dataset.label||"";t&&(t+=": ");const e=n.formattedValue;return Ct(e)||(t+=e),t},labelColor(n){const e=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{borderColor:e.borderColor,backgroundColor:e.backgroundColor,borderWidth:e.borderWidth,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(n){const e=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{pointStyle:e.pointStyle,rotation:e.rotation}},afterLabel:Jn,afterBody:Jn,beforeFooter:Jn,footer:Jn,afterFooter:Jn};function Ye(n,t,e,s){const i=n[t].call(e,s);return typeof i>"u"?fx[t].call(e,s):i}class yy extends Ss{static positioners=wo;constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const e=this.chart,s=this.options.setContext(this.getContext()),i=s.enabled&&e.options.animation&&s.animations,r=new Ww(this.chart,i);return i._cacheable&&(this._cachedAnimations=Object.freeze(r)),r}getContext(){return this.$context||(this.$context=XN(this.chart.getContext(),this,this._tooltipItems))}getTitle(t,e){const{callbacks:s}=e,i=Ye(s,"beforeTitle",this,t),r=Ye(s,"title",this,t),o=Ye(s,"afterTitle",this,t);let a=[];return a=Pn(a,ts(i)),a=Pn(a,ts(r)),a=Pn(a,ts(o)),a}getBeforeBody(t,e){return my(Ye(e.callbacks,"beforeBody",this,t))}getBody(t,e){const{callbacks:s}=e,i=[];return jt(t,r=>{const o={before:[],lines:[],after:[]},a=_y(s,r);Pn(o.before,ts(Ye(a,"beforeLabel",this,r))),Pn(o.lines,Ye(a,"label",this,r)),Pn(o.after,ts(Ye(a,"afterLabel",this,r))),i.push(o)}),i}getAfterBody(t,e){return my(Ye(e.callbacks,"afterBody",this,t))}getFooter(t,e){const{callbacks:s}=e,i=Ye(s,"beforeFooter",this,t),r=Ye(s,"footer",this,t),o=Ye(s,"afterFooter",this,t);let a=[];return a=Pn(a,ts(i)),a=Pn(a,ts(r)),a=Pn(a,ts(o)),a}_createItems(t){const e=this._active,s=this.chart.data,i=[],r=[],o=[];let a=[],l,c;for(l=0,c=e.length;l<c;++l)a.push(HN(this.chart,e[l]));return t.filter&&(a=a.filter((h,d,f)=>t.filter(h,d,f,s))),t.itemSort&&(a=a.sort((h,d)=>t.itemSort(h,d,s))),jt(a,h=>{const d=_y(t.callbacks,h);i.push(Ye(d,"labelColor",this,h)),r.push(Ye(d,"labelPointStyle",this,h)),o.push(Ye(d,"labelTextColor",this,h))}),this.labelColors=i,this.labelPointStyles=r,this.labelTextColors=o,this.dataPoints=a,a}update(t,e){const s=this.options.setContext(this.getContext()),i=this._active;let r,o=[];if(!i.length)this.opacity!==0&&(r={opacity:0});else{const a=wo[s.position].call(this,i,this._eventPosition);o=this._createItems(s),this.title=this.getTitle(o,s),this.beforeBody=this.getBeforeBody(o,s),this.body=this.getBody(o,s),this.afterBody=this.getAfterBody(o,s),this.footer=this.getFooter(o,s);const l=this._size=fy(this,s),c=Object.assign({},a,l),h=py(this.chart,s,c),d=gy(s,c,h,this.chart);this.xAlign=h.xAlign,this.yAlign=h.yAlign,r={opacity:1,x:d.x,y:d.y,width:l.width,height:l.height,caretX:a.x,caretY:a.y}}this._tooltipItems=o,this.$context=void 0,r&&this._resolveAnimations().update(this,r),t&&s.external&&s.external.call(this,{chart:this.chart,tooltip:this,replay:e})}drawCaret(t,e,s,i){const r=this.getCaretPosition(t,s,i);e.lineTo(r.x1,r.y1),e.lineTo(r.x2,r.y2),e.lineTo(r.x3,r.y3)}getCaretPosition(t,e,s){const{xAlign:i,yAlign:r}=this,{caretSize:o,cornerRadius:a}=s,{topLeft:l,topRight:c,bottomLeft:h,bottomRight:d}=Li(a),{x:f,y:g}=t,{width:_,height:y}=e;let w,E,S,A,k,R;return r==="center"?(k=g+y/2,i==="left"?(w=f,E=w-o,A=k+o,R=k-o):(w=f+_,E=w+o,A=k-o,R=k+o),S=w):(i==="left"?E=f+Math.max(l,h)+o:i==="right"?E=f+_-Math.max(c,d)-o:E=this.caretX,r==="top"?(A=g,k=A-o,w=E-o,S=E+o):(A=g+y,k=A+o,w=E+o,S=E-o),R=A),{x1:w,x2:E,x3:S,y1:A,y2:k,y3:R}}drawTitle(t,e,s){const i=this.title,r=i.length;let o,a,l;if(r){const c=br(s.rtl,this.x,this.width);for(t.x=ml(this,s.titleAlign,s),e.textAlign=c.textAlign(s.titleAlign),e.textBaseline="middle",o=ge(s.titleFont),a=s.titleSpacing,e.fillStyle=s.titleColor,e.font=o.string,l=0;l<r;++l)e.fillText(i[l],c.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+a,l+1===r&&(t.y+=s.titleMarginBottom-a)}}_drawColorBox(t,e,s,i,r){const o=this.labelColors[s],a=this.labelPointStyles[s],{boxHeight:l,boxWidth:c}=r,h=ge(r.bodyFont),d=ml(this,"left",r),f=i.x(d),g=l<h.lineHeight?(h.lineHeight-l)/2:0,_=e.y+g;if(r.usePointStyle){const y={radius:Math.min(c,l)/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:1},w=i.leftForLtr(f,c)+c/2,E=_+l/2;t.strokeStyle=r.multiKeyBackground,t.fillStyle=r.multiKeyBackground,nd(t,y,w,E),t.strokeStyle=o.borderColor,t.fillStyle=o.backgroundColor,nd(t,y,w,E)}else{t.lineWidth=Mt(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,t.strokeStyle=o.borderColor,t.setLineDash(o.borderDash||[]),t.lineDashOffset=o.borderDashOffset||0;const y=i.leftForLtr(f,c),w=i.leftForLtr(i.xPlus(f,1),c-2),E=Li(o.borderRadius);Object.values(E).some(S=>S!==0)?(t.beginPath(),t.fillStyle=r.multiKeyBackground,ca(t,{x:y,y:_,w:c,h:l,radius:E}),t.fill(),t.stroke(),t.fillStyle=o.backgroundColor,t.beginPath(),ca(t,{x:w,y:_+1,w:c-2,h:l-2,radius:E}),t.fill()):(t.fillStyle=r.multiKeyBackground,t.fillRect(y,_,c,l),t.strokeRect(y,_,c,l),t.fillStyle=o.backgroundColor,t.fillRect(w,_+1,c-2,l-2))}t.fillStyle=this.labelTextColors[s]}drawBody(t,e,s){const{body:i}=this,{bodySpacing:r,bodyAlign:o,displayColors:a,boxHeight:l,boxWidth:c,boxPadding:h}=s,d=ge(s.bodyFont);let f=d.lineHeight,g=0;const _=br(s.rtl,this.x,this.width),y=function(b){e.fillText(b,_.x(t.x+g),t.y+f/2),t.y+=f+r},w=_.textAlign(o);let E,S,A,k,R,L,x;for(e.textAlign=o,e.textBaseline="middle",e.font=d.string,t.x=ml(this,w,s),e.fillStyle=s.bodyColor,jt(this.beforeBody,y),g=a&&w!=="right"?o==="center"?c/2+h:c+2+h:0,k=0,L=i.length;k<L;++k){for(E=i[k],S=this.labelTextColors[k],e.fillStyle=S,jt(E.before,y),A=E.lines,a&&A.length&&(this._drawColorBox(e,t,k,_,s),f=Math.max(d.lineHeight,l)),R=0,x=A.length;R<x;++R)y(A[R]),f=d.lineHeight;jt(E.after,y)}g=0,f=d.lineHeight,jt(this.afterBody,y),t.y-=r}drawFooter(t,e,s){const i=this.footer,r=i.length;let o,a;if(r){const l=br(s.rtl,this.x,this.width);for(t.x=ml(this,s.footerAlign,s),t.y+=s.footerMarginTop,e.textAlign=l.textAlign(s.footerAlign),e.textBaseline="middle",o=ge(s.footerFont),e.fillStyle=s.footerColor,e.font=o.string,a=0;a<r;++a)e.fillText(i[a],l.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+s.footerSpacing}}drawBackground(t,e,s,i){const{xAlign:r,yAlign:o}=this,{x:a,y:l}=t,{width:c,height:h}=s,{topLeft:d,topRight:f,bottomLeft:g,bottomRight:_}=Li(i.cornerRadius);e.fillStyle=i.backgroundColor,e.strokeStyle=i.borderColor,e.lineWidth=i.borderWidth,e.beginPath(),e.moveTo(a+d,l),o==="top"&&this.drawCaret(t,e,s,i),e.lineTo(a+c-f,l),e.quadraticCurveTo(a+c,l,a+c,l+f),o==="center"&&r==="right"&&this.drawCaret(t,e,s,i),e.lineTo(a+c,l+h-_),e.quadraticCurveTo(a+c,l+h,a+c-_,l+h),o==="bottom"&&this.drawCaret(t,e,s,i),e.lineTo(a+g,l+h),e.quadraticCurveTo(a,l+h,a,l+h-g),o==="center"&&r==="left"&&this.drawCaret(t,e,s,i),e.lineTo(a,l+d),e.quadraticCurveTo(a,l,a+d,l),e.closePath(),e.fill(),i.borderWidth>0&&e.stroke()}_updateAnimationTarget(t){const e=this.chart,s=this.$animations,i=s&&s.x,r=s&&s.y;if(i||r){const o=wo[t.position].call(this,this._active,this._eventPosition);if(!o)return;const a=this._size=fy(this,t),l=Object.assign({},o,this._size),c=py(e,t,l),h=gy(t,l,c,e);(i._to!==h.x||r._to!==h.y)&&(this.xAlign=c.xAlign,this.yAlign=c.yAlign,this.width=a.width,this.height=a.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,h))}}_willRender(){return!!this.opacity}draw(t){const e=this.options.setContext(this.getContext());let s=this.opacity;if(!s)return;this._updateAnimationTarget(e);const i={width:this.width,height:this.height},r={x:this.x,y:this.y};s=Math.abs(s)<.001?0:s;const o=ze(e.padding),a=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;e.enabled&&a&&(t.save(),t.globalAlpha=s,this.drawBackground(r,t,i,e),Bw(t,e.textDirection),r.y+=o.top,this.drawTitle(r,t,e),this.drawBody(r,t,e),this.drawFooter(r,t,e),Uw(t,e.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,e){const s=this._active,i=t.map(({datasetIndex:a,index:l})=>{const c=this.chart.getDatasetMeta(a);if(!c)throw new Error("Cannot find a dataset at index "+a);return{datasetIndex:a,element:c.data[l],index:l}}),r=!pc(s,i),o=this._positionChanged(i,e);(r||o)&&(this._active=i,this._eventPosition=e,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,e,s=!0){if(e&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const i=this.options,r=this._active||[],o=this._getActiveElements(t,r,e,s),a=this._positionChanged(o,t),l=e||!pc(o,r)||a;return l&&(this._active=o,(i.enabled||i.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,e))),l}_getActiveElements(t,e,s,i){const r=this.options;if(t.type==="mouseout")return[];if(!i)return e.filter(a=>this.chart.data.datasets[a.datasetIndex]&&this.chart.getDatasetMeta(a.datasetIndex).controller.getParsed(a.index)!==void 0);const o=this.chart.getElementsAtEventForMode(t,r.mode,r,s);return r.reverse&&o.reverse(),o}_positionChanged(t,e){const{caretX:s,caretY:i,options:r}=this,o=wo[r.position].call(this,t,e);return o!==!1&&(s!==o.x||i!==o.y)}}var QN={id:"tooltip",_element:yy,positioners:wo,afterInit(n,t,e){e&&(n.tooltip=new yy({chart:n,options:e}))},beforeUpdate(n,t,e){n.tooltip&&n.tooltip.initialize(e)},reset(n,t,e){n.tooltip&&n.tooltip.initialize(e)},afterDraw(n){const t=n.tooltip;if(t&&t._willRender()){const e={tooltip:t};if(n.notifyPlugins("beforeTooltipDraw",{...e,cancelable:!0})===!1)return;t.draw(n.ctx),n.notifyPlugins("afterTooltipDraw",e)}},afterEvent(n,t){if(n.tooltip){const e=t.replay;n.tooltip.handleEvent(t.event,e,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(n,t)=>t.bodyFont.size,boxWidth:(n,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:fx},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:n=>n!=="filter"&&n!=="itemSort"&&n!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},JN=Object.freeze({__proto__:null,Colors:uN,Decimation:pN,Filler:ON,Legend:UN,SubTitle:jN,Title:zN,Tooltip:QN});const ZN=(n,t,e,s)=>(typeof t=="string"?(e=n.push(t)-1,s.unshift({index:e,label:t})):isNaN(t)&&(e=null),e);function tF(n,t,e,s){const i=n.indexOf(t);if(i===-1)return ZN(n,t,e,s);const r=n.lastIndexOf(t);return i!==r?e:i}const eF=(n,t)=>n===null?null:be(Math.round(n),0,t);function by(n){const t=this.getLabels();return n>=0&&n<t.length?t[n]:n}class nF extends Ki{static id="category";static defaults={ticks:{callback:by}};constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const e=this._addedLabels;if(e.length){const s=this.getLabels();for(const{index:i,label:r}of e)s[i]===r&&s.splice(i,1);this._addedLabels=[]}super.init(t)}parse(t,e){if(Ct(t))return null;const s=this.getLabels();return e=isFinite(e)&&s[e]===t?e:tF(s,t,vt(e,t),this._addedLabels),eF(e,s.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let{min:s,max:i}=this.getMinMax(!0);this.options.bounds==="ticks"&&(t||(s=0),e||(i=this.getLabels().length-1)),this.min=s,this.max=i}buildTicks(){const t=this.min,e=this.max,s=this.options.offset,i=[];let r=this.getLabels();r=t===0&&e===r.length-1?r:r.slice(t,e+1),this._valueRange=Math.max(r.length-(s?0:1),1),this._startValue=this.min-(s?.5:0);for(let o=t;o<=e;o++)i.push({value:o});return i}getLabelForValue(t){return by.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return typeof t!="number"&&(t=this.parse(t)),t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}function sF(n,t){const e=[],{bounds:i,step:r,min:o,max:a,precision:l,count:c,maxTicks:h,maxDigits:d,includeBounds:f}=n,g=r||1,_=h-1,{min:y,max:w}=t,E=!Ct(o),S=!Ct(a),A=!Ct(c),k=(w-y)/(d+1);let R=f_((w-y)/_/g)*g,L,x,b,T;if(R<1e-14&&!E&&!S)return[{value:y},{value:w}];T=Math.ceil(w/R)-Math.floor(y/R),T>_&&(R=f_(T*R/_/g)*g),Ct(l)||(L=Math.pow(10,l),R=Math.ceil(R*L)/L),i==="ticks"?(x=Math.floor(y/R)*R,b=Math.ceil(w/R)*R):(x=y,b=w),E&&S&&r&&B2((a-o)/r,R/1e3)?(T=Math.round(Math.min((a-o)/R,h)),R=(a-o)/T,x=o,b=a):A?(x=E?o:x,b=S?a:b,T=c-1,R=(b-x)/T):(T=(b-x)/R,Bo(T,Math.round(T),R/1e3)?T=Math.round(T):T=Math.ceil(T));const C=Math.max(p_(R),p_(x));L=Math.pow(10,Ct(l)?C:l),x=Math.round(x*L)/L,b=Math.round(b*L)/L;let P=0;for(E&&(f&&x!==o?(e.push({value:o}),x<o&&P++,Bo(Math.round((x+P*R)*L)/L,o,vy(o,k,n))&&P++):x<o&&P++);P<T;++P){const M=Math.round((x+P*R)*L)/L;if(S&&M>a)break;e.push({value:M})}return S&&f&&b!==a?e.length&&Bo(e[e.length-1].value,a,vy(a,k,n))?e[e.length-1].value=a:e.push({value:a}):(!S||b===a)&&e.push({value:b}),e}function vy(n,t,{horizontal:e,minRotation:s}){const i=Tn(s),r=(e?Math.sin(i):Math.cos(i))||.001,o=.75*t*(""+n).length;return Math.min(t/r,o)}class wc extends Ki{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,e){return Ct(t)||(typeof t=="number"||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:e,maxDefined:s}=this.getUserBounds();let{min:i,max:r}=this;const o=l=>i=e?i:l,a=l=>r=s?r:l;if(t){const l=jn(i),c=jn(r);l<0&&c<0?a(0):l>0&&c>0&&o(0)}if(i===r){let l=r===0?1:Math.abs(r*.05);a(r+l),t||o(i-l)}this.min=i,this.max=r}getTickLimit(){const t=this.options.ticks;let{maxTicksLimit:e,stepSize:s}=t,i;return s?(i=Math.ceil(this.max/s)-Math.floor(this.min/s)+1,i>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${s} would result generating up to ${i} ticks. Limiting to 1000.`),i=1e3)):(i=this.computeTickLimit(),e=e||11),e&&(i=Math.min(e,i)),i}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,e=t.ticks;let s=this.getTickLimit();s=Math.max(2,s);const i={maxTicks:s,bounds:t.bounds,min:t.min,max:t.max,precision:e.precision,step:e.stepSize,count:e.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:e.minRotation||0,includeBounds:e.includeBounds!==!1},r=this._range||this,o=sF(i,r);return t.bounds==="ticks"&&xw(o,this,"value"),t.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const t=this.ticks;let e=this.min,s=this.max;if(super.configure(),this.options.offset&&t.length){const i=(s-e)/Math.max(t.length-1,1)/2;e-=i,s+=i}this._startValue=e,this._endValue=s,this._valueRange=s-e}getLabelForValue(t){return ka(t,this.chart.options.locale,this.options.ticks.format)}}class iF extends wc{static id="linear";static defaults={ticks:{callback:ou.formatters.numeric}};determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=ae(t)?t:0,this.max=ae(e)?e:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),e=t?this.width:this.height,s=Tn(this.options.ticks.minRotation),i=(t?Math.sin(s):Math.cos(s))||.001,r=this._resolveTickFontOptions(0);return Math.ceil(e/Math.min(40,r.lineHeight/i))}getPixelForValue(t){return t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}const ha=n=>Math.floor(zs(n)),Ti=(n,t)=>Math.pow(10,ha(n)+t);function wy(n){return n/Math.pow(10,ha(n))===1}function xy(n,t,e){const s=Math.pow(10,e),i=Math.floor(n/s);return Math.ceil(t/s)-i}function rF(n,t){const e=t-n;let s=ha(e);for(;xy(n,t,s)>10;)s++;for(;xy(n,t,s)<10;)s--;return Math.min(s,ha(n))}function oF(n,{min:t,max:e}){t=sn(n.min,t);const s=[],i=ha(t);let r=rF(t,e),o=r<0?Math.pow(10,Math.abs(r)):1;const a=Math.pow(10,r),l=i>r?Math.pow(10,i):0,c=Math.round((t-l)*o)/o,h=Math.floor((t-l)/a/10)*a*10;let d=Math.floor((c-h)/Math.pow(10,r)),f=sn(n.min,Math.round((l+h+d*Math.pow(10,r))*o)/o);for(;f<e;)s.push({value:f,major:wy(f),significand:d}),d>=10?d=d<15?15:20:d++,d>=20&&(r++,d=2,o=r>=0?1:o),f=Math.round((l+h+d*Math.pow(10,r))*o)/o;const g=sn(n.max,f);return s.push({value:g,major:wy(g),significand:d}),s}class aF extends Ki{static id="logarithmic";static defaults={ticks:{callback:ou.formatters.logarithmic,major:{enabled:!0}}};constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(t,e){const s=wc.prototype.parse.apply(this,[t,e]);if(s===0){this._zero=!0;return}return ae(s)&&s>0?s:null}determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=ae(t)?Math.max(0,t):null,this.max=ae(e)?Math.max(0,e):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!ae(this._userMin)&&(this.min=t===Ti(this.min,0)?Ti(this.min,-1):Ti(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let s=this.min,i=this.max;const r=a=>s=t?s:a,o=a=>i=e?i:a;s===i&&(s<=0?(r(1),o(10)):(r(Ti(s,-1)),o(Ti(i,1)))),s<=0&&r(Ti(i,-1)),i<=0&&o(Ti(s,1)),this.min=s,this.max=i}buildTicks(){const t=this.options,e={min:this._userMin,max:this._userMax},s=oF(e,this);return t.bounds==="ticks"&&xw(s,this,"value"),t.reverse?(s.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),s}getLabelForValue(t){return t===void 0?"0":ka(t,this.chart.options.locale,this.options.ticks.format)}configure(){const t=this.min;super.configure(),this._startValue=zs(t),this._valueRange=zs(this.max)-zs(t)}getPixelForValue(t){return(t===void 0||t===0)&&(t=this.min),t===null||isNaN(t)?NaN:this.getPixelForDecimal(t===this.min?0:(zs(t)-this._startValue)/this._valueRange)}getValueForPixel(t){const e=this.getDecimalForPixel(t);return Math.pow(10,this._startValue+e*this._valueRange)}}function ld(n){const t=n.ticks;if(t.display&&n.display){const e=ze(t.backdropPadding);return vt(t.font&&t.font.size,ne.font.size)+e.height}return 0}function lF(n,t,e){return e=ee(e)?e:[e],{w:nO(n,t.string,e),h:e.length*t.lineHeight}}function Ty(n,t,e,s,i){return n===s||n===i?{start:t-e/2,end:t+e/2}:n<s||n>i?{start:t-e,end:t}:{start:t,end:t+e}}function cF(n){const t={l:n.left+n._padding.left,r:n.right-n._padding.right,t:n.top+n._padding.top,b:n.bottom-n._padding.bottom},e=Object.assign({},t),s=[],i=[],r=n._pointLabels.length,o=n.options.pointLabels,a=o.centerPointLabels?Nt/r:0;for(let l=0;l<r;l++){const c=o.setContext(n.getPointLabelContext(l));i[l]=c.padding;const h=n.getPointPosition(l,n.drawingArea+i[l],a),d=ge(c.font),f=lF(n.ctx,d,n._pointLabels[l]);s[l]=f;const g=Le(n.getIndexAngle(l)+a),_=Math.round(Hf(g)),y=Ty(_,h.x,f.w,0,180),w=Ty(_,h.y,f.h,90,270);uF(e,t,g,y,w)}n.setCenterPoint(t.l-e.l,e.r-t.r,t.t-e.t,e.b-t.b),n._pointLabelItems=fF(n,s,i)}function uF(n,t,e,s,i){const r=Math.abs(Math.sin(e)),o=Math.abs(Math.cos(e));let a=0,l=0;s.start<t.l?(a=(t.l-s.start)/r,n.l=Math.min(n.l,t.l-a)):s.end>t.r&&(a=(s.end-t.r)/r,n.r=Math.max(n.r,t.r+a)),i.start<t.t?(l=(t.t-i.start)/o,n.t=Math.min(n.t,t.t-l)):i.end>t.b&&(l=(i.end-t.b)/o,n.b=Math.max(n.b,t.b+l))}function hF(n,t,e){const s=n.drawingArea,{extra:i,additionalAngle:r,padding:o,size:a}=e,l=n.getPointPosition(t,s+i+o,r),c=Math.round(Hf(Le(l.angle+ce))),h=mF(l.y,a.h,c),d=pF(c),f=gF(l.x,a.w,d);return{visible:!0,x:l.x,y:h,textAlign:d,left:f,top:h,right:f+a.w,bottom:h+a.h}}function dF(n,t){if(!t)return!0;const{left:e,top:s,right:i,bottom:r}=n;return!(us({x:e,y:s},t)||us({x:e,y:r},t)||us({x:i,y:s},t)||us({x:i,y:r},t))}function fF(n,t,e){const s=[],i=n._pointLabels.length,r=n.options,{centerPointLabels:o,display:a}=r.pointLabels,l={extra:ld(r)/2,additionalAngle:o?Nt/i:0};let c;for(let h=0;h<i;h++){l.padding=e[h],l.size=t[h];const d=hF(n,h,l);s.push(d),a==="auto"&&(d.visible=dF(d,c),d.visible&&(c=d))}return s}function pF(n){return n===0||n===180?"center":n<180?"left":"right"}function gF(n,t,e){return e==="right"?n-=t:e==="center"&&(n-=t/2),n}function mF(n,t,e){return e===90||e===270?n-=t/2:(e>270||e<90)&&(n-=t),n}function _F(n,t,e){const{left:s,top:i,right:r,bottom:o}=e,{backdropColor:a}=t;if(!Ct(a)){const l=Li(t.borderRadius),c=ze(t.backdropPadding);n.fillStyle=a;const h=s-c.left,d=i-c.top,f=r-s+c.width,g=o-i+c.height;Object.values(l).some(_=>_!==0)?(n.beginPath(),ca(n,{x:h,y:d,w:f,h:g,radius:l}),n.fill()):n.fillRect(h,d,f,g)}}function yF(n,t){const{ctx:e,options:{pointLabels:s}}=n;for(let i=t-1;i>=0;i--){const r=n._pointLabelItems[i];if(!r.visible)continue;const o=s.setContext(n.getPointLabelContext(i));_F(e,o,r);const a=ge(o.font),{x:l,y:c,textAlign:h}=r;ji(e,n._pointLabels[i],l,c+a.lineHeight/2,a,{color:o.color,textAlign:h,textBaseline:"middle"})}}function px(n,t,e,s){const{ctx:i}=n;if(e)i.arc(n.xCenter,n.yCenter,t,0,te);else{let r=n.getPointPosition(0,t);i.moveTo(r.x,r.y);for(let o=1;o<s;o++)r=n.getPointPosition(o,t),i.lineTo(r.x,r.y)}}function bF(n,t,e,s,i){const r=n.ctx,o=t.circular,{color:a,lineWidth:l}=t;!o&&!s||!a||!l||e<0||(r.save(),r.strokeStyle=a,r.lineWidth=l,r.setLineDash(i.dash||[]),r.lineDashOffset=i.dashOffset,r.beginPath(),px(n,e,o,s),r.closePath(),r.stroke(),r.restore())}function vF(n,t,e){return di(n,{label:e,index:t,type:"pointLabel"})}class wF extends wc{static id="radialLinear";static defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:ou.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(t){return t},padding:5,centerPointLabels:!1}};static defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"};static descriptors={angleLines:{_fallback:"grid"}};constructor(t){super(t),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const t=this._padding=ze(ld(this.options)/2),e=this.width=this.maxWidth-t.width,s=this.height=this.maxHeight-t.height;this.xCenter=Math.floor(this.left+e/2+t.left),this.yCenter=Math.floor(this.top+s/2+t.top),this.drawingArea=Math.floor(Math.min(e,s)/2)}determineDataLimits(){const{min:t,max:e}=this.getMinMax(!1);this.min=ae(t)&&!isNaN(t)?t:0,this.max=ae(e)&&!isNaN(e)?e:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/ld(this.options))}generateTickLabels(t){wc.prototype.generateTickLabels.call(this,t),this._pointLabels=this.getLabels().map((e,s)=>{const i=Xt(this.options.pointLabels.callback,[e,s],this);return i||i===0?i:""}).filter((e,s)=>this.chart.getDataVisibility(s))}fit(){const t=this.options;t.display&&t.pointLabels.display?cF(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(t,e,s,i){this.xCenter+=Math.floor((t-e)/2),this.yCenter+=Math.floor((s-i)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(t,e,s,i))}getIndexAngle(t){const e=te/(this._pointLabels.length||1),s=this.options.startAngle||0;return Le(t*e+Tn(s))}getDistanceFromCenterForValue(t){if(Ct(t))return NaN;const e=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-t)*e:(t-this.min)*e}getValueForDistanceFromCenter(t){if(Ct(t))return NaN;const e=t/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-e:this.min+e}getPointLabelContext(t){const e=this._pointLabels||[];if(t>=0&&t<e.length){const s=e[t];return vF(this.getContext(),t,s)}}getPointPosition(t,e,s=0){const i=this.getIndexAngle(t)-ce+s;return{x:Math.cos(i)*e+this.xCenter,y:Math.sin(i)*e+this.yCenter,angle:i}}getPointPositionForValue(t,e){return this.getPointPosition(t,this.getDistanceFromCenterForValue(e))}getBasePosition(t){return this.getPointPositionForValue(t||0,this.getBaseValue())}getPointLabelPosition(t){const{left:e,top:s,right:i,bottom:r}=this._pointLabelItems[t];return{left:e,top:s,right:i,bottom:r}}drawBackground(){const{backgroundColor:t,grid:{circular:e}}=this.options;if(t){const s=this.ctx;s.save(),s.beginPath(),px(this,this.getDistanceFromCenterForValue(this._endValue),e,this._pointLabels.length),s.closePath(),s.fillStyle=t,s.fill(),s.restore()}}drawGrid(){const t=this.ctx,e=this.options,{angleLines:s,grid:i,border:r}=e,o=this._pointLabels.length;let a,l,c;if(e.pointLabels.display&&yF(this,o),i.display&&this.ticks.forEach((h,d)=>{if(d!==0||d===0&&this.min<0){l=this.getDistanceFromCenterForValue(h.value);const f=this.getContext(d),g=i.setContext(f),_=r.setContext(f);bF(this,g,l,o,_)}}),s.display){for(t.save(),a=o-1;a>=0;a--){const h=s.setContext(this.getPointLabelContext(a)),{color:d,lineWidth:f}=h;!f||!d||(t.lineWidth=f,t.strokeStyle=d,t.setLineDash(h.borderDash),t.lineDashOffset=h.borderDashOffset,l=this.getDistanceFromCenterForValue(e.reverse?this.min:this.max),c=this.getPointPosition(a,l),t.beginPath(),t.moveTo(this.xCenter,this.yCenter),t.lineTo(c.x,c.y),t.stroke())}t.restore()}}drawBorder(){}drawLabels(){const t=this.ctx,e=this.options,s=e.ticks;if(!s.display)return;const i=this.getIndexAngle(0);let r,o;t.save(),t.translate(this.xCenter,this.yCenter),t.rotate(i),t.textAlign="center",t.textBaseline="middle",this.ticks.forEach((a,l)=>{if(l===0&&this.min>=0&&!e.reverse)return;const c=s.setContext(this.getContext(l)),h=ge(c.font);if(r=this.getDistanceFromCenterForValue(this.ticks[l].value),c.showLabelBackdrop){t.font=h.string,o=t.measureText(a.label).width,t.fillStyle=c.backdropColor;const d=ze(c.backdropPadding);t.fillRect(-o/2-d.left,-r-h.size/2-d.top,o+d.width,h.size+d.height)}ji(t,a.label,0,-r,h,{color:c.color,strokeColor:c.textStrokeColor,strokeWidth:c.textStrokeWidth})}),t.restore()}drawTitle(){}}const fu={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Ze=Object.keys(fu);function Ey(n,t){return n-t}function Iy(n,t){if(Ct(t))return null;const e=n._adapter,{parser:s,round:i,isoWeekday:r}=n._parseOpts;let o=t;return typeof s=="function"&&(o=s(o)),ae(o)||(o=typeof s=="string"?e.parse(o,s):e.parse(o)),o===null?null:(i&&(o=i==="week"&&(Cr(r)||r===!0)?e.startOf(o,"isoWeek",r):e.startOf(o,i)),+o)}function Ay(n,t,e,s){const i=Ze.length;for(let r=Ze.indexOf(n);r<i-1;++r){const o=fu[Ze[r]],a=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((e-t)/(a*o.size))<=s)return Ze[r]}return Ze[i-1]}function xF(n,t,e,s,i){for(let r=Ze.length-1;r>=Ze.indexOf(e);r--){const o=Ze[r];if(fu[o].common&&n._adapter.diff(i,s,o)>=t-1)return o}return Ze[e?Ze.indexOf(e):0]}function TF(n){for(let t=Ze.indexOf(n)+1,e=Ze.length;t<e;++t)if(fu[Ze[t]].common)return Ze[t]}function Sy(n,t,e){if(!e)n[t]=!0;else if(e.length){const{lo:s,hi:i}=Wf(e,t),r=e[s]>=t?e[s]:e[i];n[r]=!0}}function EF(n,t,e,s){const i=n._adapter,r=+i.startOf(t[0].value,s),o=t[t.length-1].value;let a,l;for(a=r;a<=o;a=+i.add(a,1,s))l=e[a],l>=0&&(t[l].major=!0);return t}function Cy(n,t,e){const s=[],i={},r=t.length;let o,a;for(o=0;o<r;++o)a=t[o],i[a]=o,s.push({value:a,major:!1});return r===0||!e?s:EF(n,s,i,e)}class cd extends Ki{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,e={}){const s=t.time||(t.time={}),i=this._adapter=new IL._date(t.adapters.date);i.init(e),Fo(s.displayFormats,i.formats()),this._parseOpts={parser:s.parser,round:s.round,isoWeekday:s.isoWeekday},super.init(t),this._normalized=e.normalized}parse(t,e){return t===void 0?null:Iy(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,e=this._adapter,s=t.time.unit||"day";let{min:i,max:r,minDefined:o,maxDefined:a}=this.getUserBounds();function l(c){!o&&!isNaN(c.min)&&(i=Math.min(i,c.min)),!a&&!isNaN(c.max)&&(r=Math.max(r,c.max))}(!o||!a)&&(l(this._getLabelBounds()),(t.bounds!=="ticks"||t.ticks.source!=="labels")&&l(this.getMinMax(!1))),i=ae(i)&&!isNaN(i)?i:+e.startOf(Date.now(),s),r=ae(r)&&!isNaN(r)?r:+e.endOf(Date.now(),s)+1,this.min=Math.min(i,r-1),this.max=Math.max(i+1,r)}_getLabelBounds(){const t=this.getLabelTimestamps();let e=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;return t.length&&(e=t[0],s=t[t.length-1]),{min:e,max:s}}buildTicks(){const t=this.options,e=t.time,s=t.ticks,i=s.source==="labels"?this.getLabelTimestamps():this._generate();t.bounds==="ticks"&&i.length&&(this.min=this._userMin||i[0],this.max=this._userMax||i[i.length-1]);const r=this.min,o=this.max,a=j2(i,r,o);return this._unit=e.unit||(s.autoSkip?Ay(e.minUnit,this.min,this.max,this._getLabelCapacity(r)):xF(this,a.length,e.minUnit,this.min,this.max)),this._majorUnit=!s.major.enabled||this._unit==="year"?void 0:TF(this._unit),this.initOffsets(i),t.reverse&&a.reverse(),Cy(this,a,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(t=>+t.value))}initOffsets(t=[]){let e=0,s=0,i,r;this.options.offset&&t.length&&(i=this.getDecimalForValue(t[0]),t.length===1?e=1-i:e=(this.getDecimalForValue(t[1])-i)/2,r=this.getDecimalForValue(t[t.length-1]),t.length===1?s=r:s=(r-this.getDecimalForValue(t[t.length-2]))/2);const o=t.length<3?.5:.25;e=be(e,0,o),s=be(s,0,o),this._offsets={start:e,end:s,factor:1/(e+1+s)}}_generate(){const t=this._adapter,e=this.min,s=this.max,i=this.options,r=i.time,o=r.unit||Ay(r.minUnit,e,s,this._getLabelCapacity(e)),a=vt(i.ticks.stepSize,1),l=o==="week"?r.isoWeekday:!1,c=Cr(l)||l===!0,h={};let d=e,f,g;if(c&&(d=+t.startOf(d,"isoWeek",l)),d=+t.startOf(d,c?"day":o),t.diff(s,e,o)>1e5*a)throw new Error(e+" and "+s+" are too far apart with stepSize of "+a+" "+o);const _=i.ticks.source==="data"&&this.getDataTimestamps();for(f=d,g=0;f<s;f=+t.add(f,a,o),g++)Sy(h,f,_);return(f===s||i.bounds==="ticks"||g===1)&&Sy(h,f,_),Object.keys(h).sort(Ey).map(y=>+y)}getLabelForValue(t){const e=this._adapter,s=this.options.time;return s.tooltipFormat?e.format(t,s.tooltipFormat):e.format(t,s.displayFormats.datetime)}format(t,e){const i=this.options.time.displayFormats,r=this._unit,o=e||i[r];return this._adapter.format(t,o)}_tickFormatFunction(t,e,s,i){const r=this.options,o=r.ticks.callback;if(o)return Xt(o,[t,e,s],this);const a=r.time.displayFormats,l=this._unit,c=this._majorUnit,h=l&&a[l],d=c&&a[c],f=s[e],g=c&&d&&f&&f.major;return this._adapter.format(t,i||(g?d:h))}generateTickLabels(t){let e,s,i;for(e=0,s=t.length;e<s;++e)i=t[e],i.label=this._tickFormatFunction(i.value,e,t)}getDecimalForValue(t){return t===null?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const e=this._offsets,s=this.getDecimalForValue(t);return this.getPixelForDecimal((e.start+s)*e.factor)}getValueForPixel(t){const e=this._offsets,s=this.getDecimalForPixel(t)/e.factor-e.end;return this.min+s*(this.max-this.min)}_getLabelSize(t){const e=this.options.ticks,s=this.ctx.measureText(t).width,i=Tn(this.isHorizontal()?e.maxRotation:e.minRotation),r=Math.cos(i),o=Math.sin(i),a=this._resolveTickFontOptions(0).size;return{w:s*r+a*o,h:s*o+a*r}}_getLabelCapacity(t){const e=this.options.time,s=e.displayFormats,i=s[e.unit]||s.millisecond,r=this._tickFormatFunction(t,0,Cy(this,[t],this._majorUnit),i),o=this._getLabelSize(r),a=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return a>0?a:1}getDataTimestamps(){let t=this._cache.data||[],e,s;if(t.length)return t;const i=this.getMatchingVisibleMetas();if(this._normalized&&i.length)return this._cache.data=i[0].controller.getAllParsedValues(this);for(e=0,s=i.length;e<s;++e)t=t.concat(i[e].controller.getAllParsedValues(this));return this._cache.data=this.normalize(t)}getLabelTimestamps(){const t=this._cache.labels||[];let e,s;if(t.length)return t;const i=this.getLabels();for(e=0,s=i.length;e<s;++e)t.push(Iy(this,i[e]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return Iw(t.sort(Ey))}}function _l(n,t,e){let s=0,i=n.length-1,r,o,a,l;e?(t>=n[s].pos&&t<=n[i].pos&&({lo:s,hi:i}=cs(n,"pos",t)),{pos:r,time:a}=n[s],{pos:o,time:l}=n[i]):(t>=n[s].time&&t<=n[i].time&&({lo:s,hi:i}=cs(n,"time",t)),{time:r,pos:a}=n[s],{time:o,pos:l}=n[i]);const c=o-r;return c?a+(l-a)*(t-r)/c:a}class IF extends cd{static id="timeseries";static defaults=cd.defaults;constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),e=this._table=this.buildLookupTable(t);this._minPos=_l(e,this.min),this._tableRange=_l(e,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:e,max:s}=this,i=[],r=[];let o,a,l,c,h;for(o=0,a=t.length;o<a;++o)c=t[o],c>=e&&c<=s&&i.push(c);if(i.length<2)return[{time:e,pos:0},{time:s,pos:1}];for(o=0,a=i.length;o<a;++o)h=i[o+1],l=i[o-1],c=i[o],Math.round((h+l)/2)!==c&&r.push({time:c,pos:o/(a-1)});return r}_generate(){const t=this.min,e=this.max;let s=super.getDataTimestamps();return(!s.includes(t)||!s.length)&&s.splice(0,0,t),(!s.includes(e)||s.length===1)&&s.push(e),s.sort((i,r)=>i-r)}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const e=this.getDataTimestamps(),s=this.getLabelTimestamps();return e.length&&s.length?t=this.normalize(e.concat(s)):t=e.length?e:s,t=this._cache.all=t,t}getDecimalForValue(t){return(_l(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const e=this._offsets,s=this.getDecimalForPixel(t)/e.factor-e.end;return _l(this._table,s*this._tableRange+this._minPos,!0)}}var AF=Object.freeze({__proto__:null,CategoryScale:nF,LinearScale:iF,LogarithmicScale:aF,RadialLinearScale:wF,TimeScale:cd,TimeSeriesScale:IF});const SF=[EL,sN,JN,AF];np.register(...SF);var CF="firebase",PF="12.0.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ks(CF,PF,"app");Et.addAdapter(np);const RF={apiKey:"AIzaSyARajg1PBZ0n8gyWrrpWynr8298-pmm0l4",authDomain:"arcane-scholars-legacy.firebaseapp.com",projectId:"arcane-scholars-legacy",storageBucket:"arcane-scholars-legacy.firebasestorage.app",messagingSenderId:"976593685731",appId:"1:976593685731:web:bfa95e8221f0b76f27c9d6",measurementId:"G-W3VDVWF7LF"},xo=typeof __firebase_config<"u"&&Object.keys(JSON.parse(__firebase_config)).length>0?JSON.parse(__firebase_config):RF;const Py=typeof __initial_auth_token<"u"?__initial_auth_token:null;let dh,zo,gx;console.log("main.js: Starting Firebase initialization process...");console.log("main.js: Using firebaseConfig:",xo);if(xo&&Object.keys(xo).length>0&&xo.apiKey!=="YOUR_FIREBASE_API_KEY")try{dh=Ub(xo),zo=Wi(dh),gx=$r(dh),console.log("Firebase initialized successfully.")}catch(n){console.error("Failed to initialize Firebase:",n)}else console.warn("Firebase configuration is missing or placeholder. Firebase will not be fully initialized."),console.warn('Please replace "YOUR_FIREBASE_API_KEY", "YOUR_PROJECT_ID", etc., with your actual Firebase project credentials for local development.');async function kF(){if(!zo){console.warn("Firebase Auth not initialized, skipping authentication.");return}try{Py?(await NS(zo,Py),console.log("Signed in with custom token.")):(await DS(zo),console.log("Signed in anonymously."))}catch(n){console.error("Firebase authentication error:",n)}}const pu=uI(lM);pu.use(Et);pu.config.globalProperties.$auth=zo;pu.config.globalProperties.$db=gx;kF().then(()=>{pu.mount("#app")});

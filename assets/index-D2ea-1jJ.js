(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function e(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=e(i);fetch(i.href,r)}})();/**
* @vue/shared v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function md(n){const t=Object.create(null);for(const e of n.split(","))t[e]=1;return e=>e in t}const Ht={},cr=[],Vn=()=>{},Hx=()=>!1,Ic=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&(n.charCodeAt(2)>122||n.charCodeAt(2)<97),_d=n=>n.startsWith("onUpdate:"),Ge=Object.assign,yd=(n,t)=>{const e=n.indexOf(t);e>-1&&n.splice(e,1)},Wx=Object.prototype.hasOwnProperty,Bt=(n,t)=>Wx.call(n,t),mt=Array.isArray,ur=n=>da(n)==="[object Map]",Sc=n=>da(n)==="[object Set]",tg=n=>da(n)==="[object Date]",It=n=>typeof n=="function",de=n=>typeof n=="string",Hn=n=>typeof n=="symbol",Yt=n=>n!==null&&typeof n=="object",Oy=n=>(Yt(n)||It(n))&&It(n.then)&&It(n.catch),Ly=Object.prototype.toString,da=n=>Ly.call(n),qx=n=>da(n).slice(8,-1),Vy=n=>da(n)==="[object Object]",bd=n=>de(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,To=md(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Ac=n=>{const t=Object.create(null);return e=>t[e]||(t[e]=n(e))},Gx=/-(\w)/g,mn=Ac(n=>n.replace(Gx,(t,e)=>e?e.toUpperCase():"")),Kx=/\B([A-Z])/g,Hi=Ac(n=>n.replace(Kx,"-$1").toLowerCase()),Cc=Ac(n=>n.charAt(0).toUpperCase()+n.slice(1)),Ou=Ac(n=>n?`on${Cc(n)}`:""),Hs=(n,t)=>!Object.is(n,t),yl=(n,...t)=>{for(let e=0;e<n.length;e++)n[e](...t)},bh=(n,t,e,s=!1)=>{Object.defineProperty(n,t,{configurable:!0,enumerable:!1,writable:s,value:e})},Fl=n=>{const t=parseFloat(n);return isNaN(t)?n:t};let eg;const Pc=()=>eg||(eg=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function vd(n){if(mt(n)){const t={};for(let e=0;e<n.length;e++){const s=n[e],i=de(s)?Jx(s):vd(s);if(i)for(const r in i)t[r]=i[r]}return t}else if(de(n)||Yt(n))return n}const Yx=/;(?![^(]*\))/g,Xx=/:([^]+)/,Qx=/\/\*[^]*?\*\//g;function Jx(n){const t={};return n.replace(Qx,"").split(Yx).forEach(e=>{if(e){const s=e.split(Xx);s.length>1&&(t[s[0].trim()]=s[1].trim())}}),t}function q(n){let t="";if(de(n))t=n;else if(mt(n))for(let e=0;e<n.length;e++){const s=q(n[e]);s&&(t+=s+" ")}else if(Yt(n))for(const e in n)n[e]&&(t+=e+" ");return t.trim()}const Zx="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",tT=md(Zx);function Ny(n){return!!n||n===""}function eT(n,t){if(n.length!==t.length)return!1;let e=!0;for(let s=0;e&&s<n.length;s++)e=Rc(n[s],t[s]);return e}function Rc(n,t){if(n===t)return!0;let e=tg(n),s=tg(t);if(e||s)return e&&s?n.getTime()===t.getTime():!1;if(e=Hn(n),s=Hn(t),e||s)return n===t;if(e=mt(n),s=mt(t),e||s)return e&&s?eT(n,t):!1;if(e=Yt(n),s=Yt(t),e||s){if(!e||!s)return!1;const i=Object.keys(n).length,r=Object.keys(t).length;if(i!==r)return!1;for(const o in n){const a=n.hasOwnProperty(o),l=t.hasOwnProperty(o);if(a&&!l||!a&&l||!Rc(n[o],t[o]))return!1}}return String(n)===String(t)}function nT(n,t){return n.findIndex(e=>Rc(e,t))}const Fy=n=>!!(n&&n.__v_isRef===!0),pt=n=>de(n)?n:n==null?"":mt(n)||Yt(n)&&(n.toString===Ly||!It(n.toString))?Fy(n)?pt(n.value):JSON.stringify(n,By,2):String(n),By=(n,t)=>Fy(t)?By(n,t.value):ur(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((e,[s,i],r)=>(e[Lu(s,r)+" =>"]=i,e),{})}:Sc(t)?{[`Set(${t.size})`]:[...t.values()].map(e=>Lu(e))}:Hn(t)?Lu(t):Yt(t)&&!mt(t)&&!Vy(t)?String(t):t,Lu=(n,t="")=>{var e;return Hn(n)?`Symbol(${(e=n.description)!=null?e:t})`:n};/**
* @vue/reactivity v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Ye;class sT{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Ye,!t&&Ye&&(this.index=(Ye.scopes||(Ye.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,e;if(this.scopes)for(t=0,e=this.scopes.length;t<e;t++)this.scopes[t].pause();for(t=0,e=this.effects.length;t<e;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,e;if(this.scopes)for(t=0,e=this.scopes.length;t<e;t++)this.scopes[t].resume();for(t=0,e=this.effects.length;t<e;t++)this.effects[t].resume()}}run(t){if(this._active){const e=Ye;try{return Ye=this,t()}finally{Ye=e}}}on(){++this._on===1&&(this.prevScope=Ye,Ye=this)}off(){this._on>0&&--this._on===0&&(Ye=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){this._active=!1;let e,s;for(e=0,s=this.effects.length;e<s;e++)this.effects[e].stop();for(this.effects.length=0,e=0,s=this.cleanups.length;e<s;e++)this.cleanups[e]();if(this.cleanups.length=0,this.scopes){for(e=0,s=this.scopes.length;e<s;e++)this.scopes[e].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0}}}function iT(){return Ye}let Gt;const Vu=new WeakSet;class Uy{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Ye&&Ye.active&&Ye.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Vu.has(this)&&(Vu.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||zy(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,ng(this),jy(this);const t=Gt,e=Tn;Gt=this,Tn=!0;try{return this.fn()}finally{Hy(this),Gt=t,Tn=e,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)Td(t);this.deps=this.depsTail=void 0,ng(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Vu.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){vh(this)&&this.run()}get dirty(){return vh(this)}}let $y=0,Eo,Io;function zy(n,t=!1){if(n.flags|=8,t){n.next=Io,Io=n;return}n.next=Eo,Eo=n}function wd(){$y++}function xd(){if(--$y>0)return;if(Io){let t=Io;for(Io=void 0;t;){const e=t.next;t.next=void 0,t.flags&=-9,t=e}}let n;for(;Eo;){let t=Eo;for(Eo=void 0;t;){const e=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(s){n||(n=s)}t=e}}if(n)throw n}function jy(n){for(let t=n.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function Hy(n){let t,e=n.depsTail,s=e;for(;s;){const i=s.prevDep;s.version===-1?(s===e&&(e=i),Td(s),rT(s)):t=s,s.dep.activeLink=s.prevActiveLink,s.prevActiveLink=void 0,s=i}n.deps=t,n.depsTail=e}function vh(n){for(let t=n.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(Wy(t.dep.computed)||t.dep.version!==t.version))return!0;return!!n._dirty}function Wy(n){if(n.flags&4&&!(n.flags&16)||(n.flags&=-17,n.globalVersion===zo)||(n.globalVersion=zo,!n.isSSR&&n.flags&128&&(!n.deps&&!n._dirty||!vh(n))))return;n.flags|=2;const t=n.dep,e=Gt,s=Tn;Gt=n,Tn=!0;try{jy(n);const i=n.fn(n._value);(t.version===0||Hs(i,n._value))&&(n.flags|=128,n._value=i,t.version++)}catch(i){throw t.version++,i}finally{Gt=e,Tn=s,Hy(n),n.flags&=-3}}function Td(n,t=!1){const{dep:e,prevSub:s,nextSub:i}=n;if(s&&(s.nextSub=i,n.prevSub=void 0),i&&(i.prevSub=s,n.nextSub=void 0),e.subs===n&&(e.subs=s,!s&&e.computed)){e.computed.flags&=-5;for(let r=e.computed.deps;r;r=r.nextDep)Td(r,!0)}!t&&!--e.sc&&e.map&&e.map.delete(e.key)}function rT(n){const{prevDep:t,nextDep:e}=n;t&&(t.nextDep=e,n.prevDep=void 0),e&&(e.prevDep=t,n.nextDep=void 0)}let Tn=!0;const qy=[];function fs(){qy.push(Tn),Tn=!1}function ps(){const n=qy.pop();Tn=n===void 0?!0:n}function ng(n){const{cleanup:t}=n;if(n.cleanup=void 0,t){const e=Gt;Gt=void 0;try{t()}finally{Gt=e}}}let zo=0;class oT{constructor(t,e){this.sub=t,this.dep=e,this.version=e.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Ed{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){if(!Gt||!Tn||Gt===this.computed)return;let e=this.activeLink;if(e===void 0||e.sub!==Gt)e=this.activeLink=new oT(Gt,this),Gt.deps?(e.prevDep=Gt.depsTail,Gt.depsTail.nextDep=e,Gt.depsTail=e):Gt.deps=Gt.depsTail=e,Gy(e);else if(e.version===-1&&(e.version=this.version,e.nextDep)){const s=e.nextDep;s.prevDep=e.prevDep,e.prevDep&&(e.prevDep.nextDep=s),e.prevDep=Gt.depsTail,e.nextDep=void 0,Gt.depsTail.nextDep=e,Gt.depsTail=e,Gt.deps===e&&(Gt.deps=s)}return e}trigger(t){this.version++,zo++,this.notify(t)}notify(t){wd();try{for(let e=this.subs;e;e=e.prevSub)e.sub.notify()&&e.sub.dep.notify()}finally{xd()}}}function Gy(n){if(n.dep.sc++,n.sub.flags&4){const t=n.dep.computed;if(t&&!n.dep.subs){t.flags|=20;for(let s=t.deps;s;s=s.nextDep)Gy(s)}const e=n.dep.subs;e!==n&&(n.prevSub=e,e&&(e.nextSub=n)),n.dep.subs=n}}const wh=new WeakMap,Ri=Symbol(""),xh=Symbol(""),jo=Symbol("");function Le(n,t,e){if(Tn&&Gt){let s=wh.get(n);s||wh.set(n,s=new Map);let i=s.get(e);i||(s.set(e,i=new Ed),i.map=s,i.key=e),i.track()}}function rs(n,t,e,s,i,r){const o=wh.get(n);if(!o){zo++;return}const a=l=>{l&&l.trigger()};if(wd(),t==="clear")o.forEach(a);else{const l=mt(n),c=l&&bd(e);if(l&&e==="length"){const h=Number(s);o.forEach((d,f)=>{(f==="length"||f===jo||!Hn(f)&&f>=h)&&a(d)})}else switch((e!==void 0||o.has(void 0))&&a(o.get(e)),c&&a(o.get(jo)),t){case"add":l?c&&a(o.get("length")):(a(o.get(Ri)),ur(n)&&a(o.get(xh)));break;case"delete":l||(a(o.get(Ri)),ur(n)&&a(o.get(xh)));break;case"set":ur(n)&&a(o.get(Ri));break}}xd()}function tr(n){const t=Ft(n);return t===n?t:(Le(t,"iterate",jo),pn(n)?t:t.map(Ie))}function kc(n){return Le(n=Ft(n),"iterate",jo),n}const aT={__proto__:null,[Symbol.iterator](){return Nu(this,Symbol.iterator,Ie)},concat(...n){return tr(this).concat(...n.map(t=>mt(t)?tr(t):t))},entries(){return Nu(this,"entries",n=>(n[1]=Ie(n[1]),n))},every(n,t){return Zn(this,"every",n,t,void 0,arguments)},filter(n,t){return Zn(this,"filter",n,t,e=>e.map(Ie),arguments)},find(n,t){return Zn(this,"find",n,t,Ie,arguments)},findIndex(n,t){return Zn(this,"findIndex",n,t,void 0,arguments)},findLast(n,t){return Zn(this,"findLast",n,t,Ie,arguments)},findLastIndex(n,t){return Zn(this,"findLastIndex",n,t,void 0,arguments)},forEach(n,t){return Zn(this,"forEach",n,t,void 0,arguments)},includes(...n){return Fu(this,"includes",n)},indexOf(...n){return Fu(this,"indexOf",n)},join(n){return tr(this).join(n)},lastIndexOf(...n){return Fu(this,"lastIndexOf",n)},map(n,t){return Zn(this,"map",n,t,void 0,arguments)},pop(){return so(this,"pop")},push(...n){return so(this,"push",n)},reduce(n,...t){return sg(this,"reduce",n,t)},reduceRight(n,...t){return sg(this,"reduceRight",n,t)},shift(){return so(this,"shift")},some(n,t){return Zn(this,"some",n,t,void 0,arguments)},splice(...n){return so(this,"splice",n)},toReversed(){return tr(this).toReversed()},toSorted(n){return tr(this).toSorted(n)},toSpliced(...n){return tr(this).toSpliced(...n)},unshift(...n){return so(this,"unshift",n)},values(){return Nu(this,"values",Ie)}};function Nu(n,t,e){const s=kc(n),i=s[t]();return s!==n&&!pn(n)&&(i._next=i.next,i.next=()=>{const r=i._next();return r.value&&(r.value=e(r.value)),r}),i}const lT=Array.prototype;function Zn(n,t,e,s,i,r){const o=kc(n),a=o!==n&&!pn(n),l=o[t];if(l!==lT[t]){const d=l.apply(n,r);return a?Ie(d):d}let c=e;o!==n&&(a?c=function(d,f){return e.call(this,Ie(d),f,n)}:e.length>2&&(c=function(d,f){return e.call(this,d,f,n)}));const h=l.call(o,c,s);return a&&i?i(h):h}function sg(n,t,e,s){const i=kc(n);let r=e;return i!==n&&(pn(n)?e.length>3&&(r=function(o,a,l){return e.call(this,o,a,l,n)}):r=function(o,a,l){return e.call(this,o,Ie(a),l,n)}),i[t](r,...s)}function Fu(n,t,e){const s=Ft(n);Le(s,"iterate",jo);const i=s[t](...e);return(i===-1||i===!1)&&Cd(e[0])?(e[0]=Ft(e[0]),s[t](...e)):i}function so(n,t,e=[]){fs(),wd();const s=Ft(n)[t].apply(n,e);return xd(),ps(),s}const cT=md("__proto__,__v_isRef,__isVue"),Ky=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(Hn));function uT(n){Hn(n)||(n=String(n));const t=Ft(this);return Le(t,"has",n),t.hasOwnProperty(n)}class Yy{constructor(t=!1,e=!1){this._isReadonly=t,this._isShallow=e}get(t,e,s){if(e==="__v_skip")return t.__v_skip;const i=this._isReadonly,r=this._isShallow;if(e==="__v_isReactive")return!i;if(e==="__v_isReadonly")return i;if(e==="__v_isShallow")return r;if(e==="__v_raw")return s===(i?r?vT:Zy:r?Jy:Qy).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(s)?t:void 0;const o=mt(t);if(!i){let l;if(o&&(l=aT[e]))return l;if(e==="hasOwnProperty")return uT}const a=Reflect.get(t,e,Ue(t)?t:s);return(Hn(e)?Ky.has(e):cT(e))||(i||Le(t,"get",e),r)?a:Ue(a)?o&&bd(e)?a:a.value:Yt(a)?i?tb(a):Sd(a):a}}class Xy extends Yy{constructor(t=!1){super(!1,t)}set(t,e,s,i){let r=t[e];if(!this._isShallow){const l=Zs(r);if(!pn(s)&&!Zs(s)&&(r=Ft(r),s=Ft(s)),!mt(t)&&Ue(r)&&!Ue(s))return l?!1:(r.value=s,!0)}const o=mt(t)&&bd(e)?Number(e)<t.length:Bt(t,e),a=Reflect.set(t,e,s,Ue(t)?t:i);return t===Ft(i)&&(o?Hs(s,r)&&rs(t,"set",e,s):rs(t,"add",e,s)),a}deleteProperty(t,e){const s=Bt(t,e);t[e];const i=Reflect.deleteProperty(t,e);return i&&s&&rs(t,"delete",e,void 0),i}has(t,e){const s=Reflect.has(t,e);return(!Hn(e)||!Ky.has(e))&&Le(t,"has",e),s}ownKeys(t){return Le(t,"iterate",mt(t)?"length":Ri),Reflect.ownKeys(t)}}class hT extends Yy{constructor(t=!1){super(!0,t)}set(t,e){return!0}deleteProperty(t,e){return!0}}const dT=new Xy,fT=new hT,pT=new Xy(!0);const Th=n=>n,Ya=n=>Reflect.getPrototypeOf(n);function gT(n,t,e){return function(...s){const i=this.__v_raw,r=Ft(i),o=ur(r),a=n==="entries"||n===Symbol.iterator&&o,l=n==="keys"&&o,c=i[n](...s),h=e?Th:t?Bl:Ie;return!t&&Le(r,"iterate",l?xh:Ri),{next(){const{value:d,done:f}=c.next();return f?{value:d,done:f}:{value:a?[h(d[0]),h(d[1])]:h(d),done:f}},[Symbol.iterator](){return this}}}}function Xa(n){return function(...t){return n==="delete"?!1:n==="clear"?void 0:this}}function mT(n,t){const e={get(i){const r=this.__v_raw,o=Ft(r),a=Ft(i);n||(Hs(i,a)&&Le(o,"get",i),Le(o,"get",a));const{has:l}=Ya(o),c=t?Th:n?Bl:Ie;if(l.call(o,i))return c(r.get(i));if(l.call(o,a))return c(r.get(a));r!==o&&r.get(i)},get size(){const i=this.__v_raw;return!n&&Le(Ft(i),"iterate",Ri),Reflect.get(i,"size",i)},has(i){const r=this.__v_raw,o=Ft(r),a=Ft(i);return n||(Hs(i,a)&&Le(o,"has",i),Le(o,"has",a)),i===a?r.has(i):r.has(i)||r.has(a)},forEach(i,r){const o=this,a=o.__v_raw,l=Ft(a),c=t?Th:n?Bl:Ie;return!n&&Le(l,"iterate",Ri),a.forEach((h,d)=>i.call(r,c(h),c(d),o))}};return Ge(e,n?{add:Xa("add"),set:Xa("set"),delete:Xa("delete"),clear:Xa("clear")}:{add(i){!t&&!pn(i)&&!Zs(i)&&(i=Ft(i));const r=Ft(this);return Ya(r).has.call(r,i)||(r.add(i),rs(r,"add",i,i)),this},set(i,r){!t&&!pn(r)&&!Zs(r)&&(r=Ft(r));const o=Ft(this),{has:a,get:l}=Ya(o);let c=a.call(o,i);c||(i=Ft(i),c=a.call(o,i));const h=l.call(o,i);return o.set(i,r),c?Hs(r,h)&&rs(o,"set",i,r):rs(o,"add",i,r),this},delete(i){const r=Ft(this),{has:o,get:a}=Ya(r);let l=o.call(r,i);l||(i=Ft(i),l=o.call(r,i)),a&&a.call(r,i);const c=r.delete(i);return l&&rs(r,"delete",i,void 0),c},clear(){const i=Ft(this),r=i.size!==0,o=i.clear();return r&&rs(i,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(i=>{e[i]=gT(i,n,t)}),e}function Id(n,t){const e=mT(n,t);return(s,i,r)=>i==="__v_isReactive"?!n:i==="__v_isReadonly"?n:i==="__v_raw"?s:Reflect.get(Bt(e,i)&&i in s?e:s,i,r)}const _T={get:Id(!1,!1)},yT={get:Id(!1,!0)},bT={get:Id(!0,!1)};const Qy=new WeakMap,Jy=new WeakMap,Zy=new WeakMap,vT=new WeakMap;function wT(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function xT(n){return n.__v_skip||!Object.isExtensible(n)?0:wT(qx(n))}function Sd(n){return Zs(n)?n:Ad(n,!1,dT,_T,Qy)}function TT(n){return Ad(n,!1,pT,yT,Jy)}function tb(n){return Ad(n,!0,fT,bT,Zy)}function Ad(n,t,e,s,i){if(!Yt(n)||n.__v_raw&&!(t&&n.__v_isReactive))return n;const r=xT(n);if(r===0)return n;const o=i.get(n);if(o)return o;const a=new Proxy(n,r===2?s:e);return i.set(n,a),a}function hr(n){return Zs(n)?hr(n.__v_raw):!!(n&&n.__v_isReactive)}function Zs(n){return!!(n&&n.__v_isReadonly)}function pn(n){return!!(n&&n.__v_isShallow)}function Cd(n){return n?!!n.__v_raw:!1}function Ft(n){const t=n&&n.__v_raw;return t?Ft(t):n}function ET(n){return!Bt(n,"__v_skip")&&Object.isExtensible(n)&&bh(n,"__v_skip",!0),n}const Ie=n=>Yt(n)?Sd(n):n,Bl=n=>Yt(n)?tb(n):n;function Ue(n){return n?n.__v_isRef===!0:!1}function At(n){return IT(n,!1)}function IT(n,t){return Ue(n)?n:new ST(n,t)}class ST{constructor(t,e){this.dep=new Ed,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=e?t:Ft(t),this._value=e?t:Ie(t),this.__v_isShallow=e}get value(){return this.dep.track(),this._value}set value(t){const e=this._rawValue,s=this.__v_isShallow||pn(t)||Zs(t);t=s?t:Ft(t),Hs(t,e)&&(this._rawValue=t,this._value=s?t:Ie(t),this.dep.trigger())}}function Ut(n){return Ue(n)?n.value:n}const AT={get:(n,t,e)=>t==="__v_raw"?n:Ut(Reflect.get(n,t,e)),set:(n,t,e,s)=>{const i=n[t];return Ue(i)&&!Ue(e)?(i.value=e,!0):Reflect.set(n,t,e,s)}};function eb(n){return hr(n)?n:new Proxy(n,AT)}class CT{constructor(t,e,s){this.fn=t,this.setter=e,this._value=void 0,this.dep=new Ed(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=zo-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!e,this.isSSR=s}notify(){if(this.flags|=16,!(this.flags&8)&&Gt!==this)return zy(this,!0),!0}get value(){const t=this.dep.track();return Wy(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function PT(n,t,e=!1){let s,i;return It(n)?s=n:(s=n.get,i=n.set),new CT(s,i,e)}const Qa={},Ul=new WeakMap;let Ei;function RT(n,t=!1,e=Ei){if(e){let s=Ul.get(e);s||Ul.set(e,s=[]),s.push(n)}}function kT(n,t,e=Ht){const{immediate:s,deep:i,once:r,scheduler:o,augmentJob:a,call:l}=e,c=k=>i?k:pn(k)||i===!1||i===0?os(k,1):os(k);let h,d,f,g,_=!1,b=!1;if(Ue(n)?(d=()=>n.value,_=pn(n)):hr(n)?(d=()=>c(n),_=!0):mt(n)?(b=!0,_=n.some(k=>hr(k)||pn(k)),d=()=>n.map(k=>{if(Ue(k))return k.value;if(hr(k))return c(k);if(It(k))return l?l(k,2):k()})):It(n)?t?d=l?()=>l(n,2):n:d=()=>{if(f){fs();try{f()}finally{ps()}}const k=Ei;Ei=h;try{return l?l(n,3,[g]):n(g)}finally{Ei=k}}:d=Vn,t&&i){const k=d,D=i===!0?1/0:i;d=()=>os(k(),D)}const v=iT(),A=()=>{h.stop(),v&&v.active&&yd(v.effects,h)};if(r&&t){const k=t;t=(...D)=>{k(...D),A()}}let C=b?new Array(n.length).fill(Qa):Qa;const O=k=>{if(!(!(h.flags&1)||!h.dirty&&!k))if(t){const D=h.run();if(i||_||(b?D.some((N,w)=>Hs(N,C[w])):Hs(D,C))){f&&f();const N=Ei;Ei=h;try{const w=[D,C===Qa?void 0:b&&C[0]===Qa?[]:C,g];C=D,l?l(t,3,w):t(...w)}finally{Ei=N}}}else h.run()};return a&&a(O),h=new Uy(d),h.scheduler=o?()=>o(O,!1):O,g=k=>RT(k,!1,h),f=h.onStop=()=>{const k=Ul.get(h);if(k){if(l)l(k,4);else for(const D of k)D();Ul.delete(h)}},t?s?O(!0):C=h.run():o?o(O.bind(null,!0),!0):h.run(),A.pause=h.pause.bind(h),A.resume=h.resume.bind(h),A.stop=A,A}function os(n,t=1/0,e){if(t<=0||!Yt(n)||n.__v_skip||(e=e||new Set,e.has(n)))return n;if(e.add(n),t--,Ue(n))os(n.value,t,e);else if(mt(n))for(let s=0;s<n.length;s++)os(n[s],t,e);else if(Sc(n)||ur(n))n.forEach(s=>{os(s,t,e)});else if(Vy(n)){for(const s in n)os(n[s],t,e);for(const s of Object.getOwnPropertySymbols(n))Object.prototype.propertyIsEnumerable.call(n,s)&&os(n[s],t,e)}return n}/**
* @vue/runtime-core v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function fa(n,t,e,s){try{return s?n(...s):n()}catch(i){Dc(i,t,e)}}function Wn(n,t,e,s){if(It(n)){const i=fa(n,t,e,s);return i&&Oy(i)&&i.catch(r=>{Dc(r,t,e)}),i}if(mt(n)){const i=[];for(let r=0;r<n.length;r++)i.push(Wn(n[r],t,e,s));return i}}function Dc(n,t,e,s=!0){const i=t?t.vnode:null,{errorHandler:r,throwUnhandledErrorInProduction:o}=t&&t.appContext.config||Ht;if(t){let a=t.parent;const l=t.proxy,c=`https://vuejs.org/error-reference/#runtime-${e}`;for(;a;){const h=a.ec;if(h){for(let d=0;d<h.length;d++)if(h[d](n,l,c)===!1)return}a=a.parent}if(r){fs(),fa(r,null,10,[n,l,c]),ps();return}}DT(n,e,i,s,o)}function DT(n,t,e,s=!0,i=!1){if(i)throw n;console.error(n)}const We=[];let Pn=-1;const dr=[];let Ds=null,ir=0;const nb=Promise.resolve();let $l=null;function sb(n){const t=$l||nb;return n?t.then(this?n.bind(this):n):t}function MT(n){let t=Pn+1,e=We.length;for(;t<e;){const s=t+e>>>1,i=We[s],r=Ho(i);r<n||r===n&&i.flags&2?t=s+1:e=s}return t}function Pd(n){if(!(n.flags&1)){const t=Ho(n),e=We[We.length-1];!e||!(n.flags&2)&&t>=Ho(e)?We.push(n):We.splice(MT(t),0,n),n.flags|=1,ib()}}function ib(){$l||($l=nb.then(ob))}function OT(n){mt(n)?dr.push(...n):Ds&&n.id===-1?Ds.splice(ir+1,0,n):n.flags&1||(dr.push(n),n.flags|=1),ib()}function ig(n,t,e=Pn+1){for(;e<We.length;e++){const s=We[e];if(s&&s.flags&2){if(n&&s.id!==n.uid)continue;We.splice(e,1),e--,s.flags&4&&(s.flags&=-2),s(),s.flags&4||(s.flags&=-2)}}}function rb(n){if(dr.length){const t=[...new Set(dr)].sort((e,s)=>Ho(e)-Ho(s));if(dr.length=0,Ds){Ds.push(...t);return}for(Ds=t,ir=0;ir<Ds.length;ir++){const e=Ds[ir];e.flags&4&&(e.flags&=-2),e.flags&8||e(),e.flags&=-2}Ds=null,ir=0}}const Ho=n=>n.id==null?n.flags&2?-1:1/0:n.id;function ob(n){try{for(Pn=0;Pn<We.length;Pn++){const t=We[Pn];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),fa(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;Pn<We.length;Pn++){const t=We[Pn];t&&(t.flags&=-2)}Pn=-1,We.length=0,rb(),$l=null,(We.length||dr.length)&&ob()}}let rn=null,ab=null;function zl(n){const t=rn;return rn=n,ab=n&&n.type.__scopeId||null,t}function LT(n,t=rn,e){if(!t||n._n)return n;const s=(...i)=>{s._d&&pg(-1);const r=zl(t);let o;try{o=n(...i)}finally{zl(r),s._d&&pg(1)}return o};return s._n=!0,s._c=!0,s._d=!0,s}function Ns(n,t){if(rn===null)return n;const e=Nc(rn),s=n.dirs||(n.dirs=[]);for(let i=0;i<t.length;i++){let[r,o,a,l=Ht]=t[i];r&&(It(r)&&(r={mounted:r,updated:r}),r.deep&&os(o),s.push({dir:r,instance:e,value:o,oldValue:void 0,arg:a,modifiers:l}))}return n}function yi(n,t,e,s){const i=n.dirs,r=t&&t.dirs;for(let o=0;o<i.length;o++){const a=i[o];r&&(a.oldValue=r[o].value);let l=a.dir[s];l&&(fs(),Wn(l,e,8,[n.el,a,n,t]),ps())}}const VT=Symbol("_vte"),NT=n=>n.__isTeleport;function Rd(n,t){n.shapeFlag&6&&n.component?(n.transition=t,Rd(n.component.subTree,t)):n.shapeFlag&128?(n.ssContent.transition=t.clone(n.ssContent),n.ssFallback.transition=t.clone(n.ssFallback)):n.transition=t}function lb(n){n.ids=[n.ids[0]+n.ids[2]+++"-",0,0]}function So(n,t,e,s,i=!1){if(mt(n)){n.forEach((_,b)=>So(_,t&&(mt(t)?t[b]:t),e,s,i));return}if(Ao(s)&&!i){s.shapeFlag&512&&s.type.__asyncResolved&&s.component.subTree.component&&So(n,t,e,s.component.subTree);return}const r=s.shapeFlag&4?Nc(s.component):s.el,o=i?null:r,{i:a,r:l}=n,c=t&&t.r,h=a.refs===Ht?a.refs={}:a.refs,d=a.setupState,f=Ft(d),g=d===Ht?()=>!1:_=>Bt(f,_);if(c!=null&&c!==l&&(de(c)?(h[c]=null,g(c)&&(d[c]=null)):Ue(c)&&(c.value=null)),It(l))fa(l,a,12,[o,h]);else{const _=de(l),b=Ue(l);if(_||b){const v=()=>{if(n.f){const A=_?g(l)?d[l]:h[l]:l.value;i?mt(A)&&yd(A,r):mt(A)?A.includes(r)||A.push(r):_?(h[l]=[r],g(l)&&(d[l]=h[l])):(l.value=[r],n.k&&(h[n.k]=l.value))}else _?(h[l]=o,g(l)&&(d[l]=o)):b&&(l.value=o,n.k&&(h[n.k]=o))};o?(v.id=-1,nn(v,e)):v()}}}Pc().requestIdleCallback;Pc().cancelIdleCallback;const Ao=n=>!!n.type.__asyncLoader,cb=n=>n.type.__isKeepAlive;function FT(n,t){ub(n,"a",t)}function BT(n,t){ub(n,"da",t)}function ub(n,t,e=Ne){const s=n.__wdc||(n.__wdc=()=>{let i=e;for(;i;){if(i.isDeactivated)return;i=i.parent}return n()});if(Mc(t,s,e),e){let i=e.parent;for(;i&&i.parent;)cb(i.parent.vnode)&&UT(s,t,e,i),i=i.parent}}function UT(n,t,e,s){const i=Mc(t,n,s,!0);Oc(()=>{yd(s[t],i)},e)}function Mc(n,t,e=Ne,s=!1){if(e){const i=e[n]||(e[n]=[]),r=t.__weh||(t.__weh=(...o)=>{fs();const a=pa(e),l=Wn(t,e,n,o);return a(),ps(),l});return s?i.unshift(r):i.push(r),r}}const ws=n=>(t,e=Ne)=>{(!Go||n==="sp")&&Mc(n,(...s)=>t(...s),e)},$T=ws("bm"),kr=ws("m"),zT=ws("bu"),jT=ws("u"),HT=ws("bum"),Oc=ws("um"),WT=ws("sp"),qT=ws("rtg"),GT=ws("rtc");function KT(n,t=Ne){Mc("ec",n,t)}const YT="components";function XT(n,t){return JT(YT,n,!0,t)||n}const QT=Symbol.for("v-ndc");function JT(n,t,e=!0,s=!1){const i=rn||Ne;if(i){const r=i.type;{const a=UE(r,!1);if(a&&(a===t||a===mn(t)||a===Cc(mn(t))))return r}const o=rg(i[n]||r[n],t)||rg(i.appContext[n],t);return!o&&s?r:o}}function rg(n,t){return n&&(n[t]||n[mn(t)]||n[Cc(mn(t))])}function Wo(n,t,e,s){let i;const r=e,o=mt(n);if(o||de(n)){const a=o&&hr(n);let l=!1,c=!1;a&&(l=!pn(n),c=Zs(n),n=kc(n)),i=new Array(n.length);for(let h=0,d=n.length;h<d;h++)i[h]=t(l?c?Bl(Ie(n[h])):Ie(n[h]):n[h],h,void 0,r)}else if(typeof n=="number"){i=new Array(n);for(let a=0;a<n;a++)i[a]=t(a+1,a,void 0,r)}else if(Yt(n))if(n[Symbol.iterator])i=Array.from(n,(a,l)=>t(a,l,void 0,r));else{const a=Object.keys(n);i=new Array(a.length);for(let l=0,c=a.length;l<c;l++){const h=a[l];i[l]=t(n[h],h,l,r)}}else i=[];return i}const Eh=n=>n?Rb(n)?Nc(n):Eh(n.parent):null,Co=Ge(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>Eh(n.parent),$root:n=>Eh(n.root),$host:n=>n.ce,$emit:n=>n.emit,$options:n=>db(n),$forceUpdate:n=>n.f||(n.f=()=>{Pd(n.update)}),$nextTick:n=>n.n||(n.n=sb.bind(n.proxy)),$watch:n=>vE.bind(n)}),Bu=(n,t)=>n!==Ht&&!n.__isScriptSetup&&Bt(n,t),ZT={get({_:n},t){if(t==="__v_skip")return!0;const{ctx:e,setupState:s,data:i,props:r,accessCache:o,type:a,appContext:l}=n;let c;if(t[0]!=="$"){const g=o[t];if(g!==void 0)switch(g){case 1:return s[t];case 2:return i[t];case 4:return e[t];case 3:return r[t]}else{if(Bu(s,t))return o[t]=1,s[t];if(i!==Ht&&Bt(i,t))return o[t]=2,i[t];if((c=n.propsOptions[0])&&Bt(c,t))return o[t]=3,r[t];if(e!==Ht&&Bt(e,t))return o[t]=4,e[t];Ih&&(o[t]=0)}}const h=Co[t];let d,f;if(h)return t==="$attrs"&&Le(n.attrs,"get",""),h(n);if((d=a.__cssModules)&&(d=d[t]))return d;if(e!==Ht&&Bt(e,t))return o[t]=4,e[t];if(f=l.config.globalProperties,Bt(f,t))return f[t]},set({_:n},t,e){const{data:s,setupState:i,ctx:r}=n;return Bu(i,t)?(i[t]=e,!0):s!==Ht&&Bt(s,t)?(s[t]=e,!0):Bt(n.props,t)||t[0]==="$"&&t.slice(1)in n?!1:(r[t]=e,!0)},has({_:{data:n,setupState:t,accessCache:e,ctx:s,appContext:i,propsOptions:r}},o){let a;return!!e[o]||n!==Ht&&Bt(n,o)||Bu(t,o)||(a=r[0])&&Bt(a,o)||Bt(s,o)||Bt(Co,o)||Bt(i.config.globalProperties,o)},defineProperty(n,t,e){return e.get!=null?n._.accessCache[t]=0:Bt(e,"value")&&this.set(n,t,e.value,null),Reflect.defineProperty(n,t,e)}};function og(n){return mt(n)?n.reduce((t,e)=>(t[e]=null,t),{}):n}let Ih=!0;function tE(n){const t=db(n),e=n.proxy,s=n.ctx;Ih=!1,t.beforeCreate&&ag(t.beforeCreate,n,"bc");const{data:i,computed:r,methods:o,watch:a,provide:l,inject:c,created:h,beforeMount:d,mounted:f,beforeUpdate:g,updated:_,activated:b,deactivated:v,beforeDestroy:A,beforeUnmount:C,destroyed:O,unmounted:k,render:D,renderTracked:N,renderTriggered:w,errorCaptured:y,serverPrefetch:x,expose:E,inheritAttrs:I,components:P,directives:S,filters:rt}=t;if(c&&eE(c,s,null),o)for(const ot in o){const H=o[ot];It(H)&&(s[ot]=H.bind(e))}if(i){const ot=i.call(e,e);Yt(ot)&&(n.data=Sd(ot))}if(Ih=!0,r)for(const ot in r){const H=r[ot],K=It(H)?H.bind(e,e):It(H.get)?H.get.bind(e,e):Vn,X=!It(H)&&It(H.set)?H.set.bind(e):Vn,ht=Ln({get:K,set:X});Object.defineProperty(s,ot,{enumerable:!0,configurable:!0,get:()=>ht.value,set:St=>ht.value=St})}if(a)for(const ot in a)hb(a[ot],s,e,ot);if(l){const ot=It(l)?l.call(e):l;Reflect.ownKeys(ot).forEach(H=>{aE(H,ot[H])})}h&&ag(h,n,"c");function dt(ot,H){mt(H)?H.forEach(K=>ot(K.bind(e))):H&&ot(H.bind(e))}if(dt($T,d),dt(kr,f),dt(zT,g),dt(jT,_),dt(FT,b),dt(BT,v),dt(KT,y),dt(GT,N),dt(qT,w),dt(HT,C),dt(Oc,k),dt(WT,x),mt(E))if(E.length){const ot=n.exposed||(n.exposed={});E.forEach(H=>{Object.defineProperty(ot,H,{get:()=>e[H],set:K=>e[H]=K,enumerable:!0})})}else n.exposed||(n.exposed={});D&&n.render===Vn&&(n.render=D),I!=null&&(n.inheritAttrs=I),P&&(n.components=P),S&&(n.directives=S),x&&lb(n)}function eE(n,t,e=Vn){mt(n)&&(n=Sh(n));for(const s in n){const i=n[s];let r;Yt(i)?"default"in i?r=bl(i.from||s,i.default,!0):r=bl(i.from||s):r=bl(i),Ue(r)?Object.defineProperty(t,s,{enumerable:!0,configurable:!0,get:()=>r.value,set:o=>r.value=o}):t[s]=r}}function ag(n,t,e){Wn(mt(n)?n.map(s=>s.bind(t.proxy)):n.bind(t.proxy),t,e)}function hb(n,t,e,s){let i=s.includes(".")?Ib(e,s):()=>e[s];if(de(n)){const r=t[n];It(r)&&Po(i,r)}else if(It(n))Po(i,n.bind(e));else if(Yt(n))if(mt(n))n.forEach(r=>hb(r,t,e,s));else{const r=It(n.handler)?n.handler.bind(e):t[n.handler];It(r)&&Po(i,r,n)}}function db(n){const t=n.type,{mixins:e,extends:s}=t,{mixins:i,optionsCache:r,config:{optionMergeStrategies:o}}=n.appContext,a=r.get(t);let l;return a?l=a:!i.length&&!e&&!s?l=t:(l={},i.length&&i.forEach(c=>jl(l,c,o,!0)),jl(l,t,o)),Yt(t)&&r.set(t,l),l}function jl(n,t,e,s=!1){const{mixins:i,extends:r}=t;r&&jl(n,r,e,!0),i&&i.forEach(o=>jl(n,o,e,!0));for(const o in t)if(!(s&&o==="expose")){const a=nE[o]||e&&e[o];n[o]=a?a(n[o],t[o]):t[o]}return n}const nE={data:lg,props:cg,emits:cg,methods:fo,computed:fo,beforeCreate:He,created:He,beforeMount:He,mounted:He,beforeUpdate:He,updated:He,beforeDestroy:He,beforeUnmount:He,destroyed:He,unmounted:He,activated:He,deactivated:He,errorCaptured:He,serverPrefetch:He,components:fo,directives:fo,watch:iE,provide:lg,inject:sE};function lg(n,t){return t?n?function(){return Ge(It(n)?n.call(this,this):n,It(t)?t.call(this,this):t)}:t:n}function sE(n,t){return fo(Sh(n),Sh(t))}function Sh(n){if(mt(n)){const t={};for(let e=0;e<n.length;e++)t[n[e]]=n[e];return t}return n}function He(n,t){return n?[...new Set([].concat(n,t))]:t}function fo(n,t){return n?Ge(Object.create(null),n,t):t}function cg(n,t){return n?mt(n)&&mt(t)?[...new Set([...n,...t])]:Ge(Object.create(null),og(n),og(t??{})):t}function iE(n,t){if(!n)return t;if(!t)return n;const e=Ge(Object.create(null),n);for(const s in t)e[s]=He(n[s],t[s]);return e}function fb(){return{app:null,config:{isNativeTag:Hx,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let rE=0;function oE(n,t){return function(s,i=null){It(s)||(s=Ge({},s)),i!=null&&!Yt(i)&&(i=null);const r=fb(),o=new WeakSet,a=[];let l=!1;const c=r.app={_uid:rE++,_component:s,_props:i,_container:null,_context:r,_instance:null,version:jE,get config(){return r.config},set config(h){},use(h,...d){return o.has(h)||(h&&It(h.install)?(o.add(h),h.install(c,...d)):It(h)&&(o.add(h),h(c,...d))),c},mixin(h){return r.mixins.includes(h)||r.mixins.push(h),c},component(h,d){return d?(r.components[h]=d,c):r.components[h]},directive(h,d){return d?(r.directives[h]=d,c):r.directives[h]},mount(h,d,f){if(!l){const g=c._ceVNode||Fe(s,i);return g.appContext=r,f===!0?f="svg":f===!1&&(f=void 0),n(g,h,f),l=!0,c._container=h,h.__vue_app__=c,Nc(g.component)}},onUnmount(h){a.push(h)},unmount(){l&&(Wn(a,c._instance,16),n(null,c._container),delete c._container.__vue_app__)},provide(h,d){return r.provides[h]=d,c},runWithContext(h){const d=fr;fr=c;try{return h()}finally{fr=d}}};return c}}let fr=null;function aE(n,t){if(Ne){let e=Ne.provides;const s=Ne.parent&&Ne.parent.provides;s===e&&(e=Ne.provides=Object.create(s)),e[n]=t}}function bl(n,t,e=!1){const s=LE();if(s||fr){let i=fr?fr._context.provides:s?s.parent==null||s.ce?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides:void 0;if(i&&n in i)return i[n];if(arguments.length>1)return e&&It(t)?t.call(s&&s.proxy):t}}const pb={},gb=()=>Object.create(pb),mb=n=>Object.getPrototypeOf(n)===pb;function lE(n,t,e,s=!1){const i={},r=gb();n.propsDefaults=Object.create(null),_b(n,t,i,r);for(const o in n.propsOptions[0])o in i||(i[o]=void 0);e?n.props=s?i:TT(i):n.type.props?n.props=i:n.props=r,n.attrs=r}function cE(n,t,e,s){const{props:i,attrs:r,vnode:{patchFlag:o}}=n,a=Ft(i),[l]=n.propsOptions;let c=!1;if((s||o>0)&&!(o&16)){if(o&8){const h=n.vnode.dynamicProps;for(let d=0;d<h.length;d++){let f=h[d];if(Lc(n.emitsOptions,f))continue;const g=t[f];if(l)if(Bt(r,f))g!==r[f]&&(r[f]=g,c=!0);else{const _=mn(f);i[_]=Ah(l,a,_,g,n,!1)}else g!==r[f]&&(r[f]=g,c=!0)}}}else{_b(n,t,i,r)&&(c=!0);let h;for(const d in a)(!t||!Bt(t,d)&&((h=Hi(d))===d||!Bt(t,h)))&&(l?e&&(e[d]!==void 0||e[h]!==void 0)&&(i[d]=Ah(l,a,d,void 0,n,!0)):delete i[d]);if(r!==a)for(const d in r)(!t||!Bt(t,d))&&(delete r[d],c=!0)}c&&rs(n.attrs,"set","")}function _b(n,t,e,s){const[i,r]=n.propsOptions;let o=!1,a;if(t)for(let l in t){if(To(l))continue;const c=t[l];let h;i&&Bt(i,h=mn(l))?!r||!r.includes(h)?e[h]=c:(a||(a={}))[h]=c:Lc(n.emitsOptions,l)||(!(l in s)||c!==s[l])&&(s[l]=c,o=!0)}if(r){const l=Ft(e),c=a||Ht;for(let h=0;h<r.length;h++){const d=r[h];e[d]=Ah(i,l,d,c[d],n,!Bt(c,d))}}return o}function Ah(n,t,e,s,i,r){const o=n[e];if(o!=null){const a=Bt(o,"default");if(a&&s===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&It(l)){const{propsDefaults:c}=i;if(e in c)s=c[e];else{const h=pa(i);s=c[e]=l.call(null,t),h()}}else s=l;i.ce&&i.ce._setProp(e,s)}o[0]&&(r&&!a?s=!1:o[1]&&(s===""||s===Hi(e))&&(s=!0))}return s}const uE=new WeakMap;function yb(n,t,e=!1){const s=e?uE:t.propsCache,i=s.get(n);if(i)return i;const r=n.props,o={},a=[];let l=!1;if(!It(n)){const h=d=>{l=!0;const[f,g]=yb(d,t,!0);Ge(o,f),g&&a.push(...g)};!e&&t.mixins.length&&t.mixins.forEach(h),n.extends&&h(n.extends),n.mixins&&n.mixins.forEach(h)}if(!r&&!l)return Yt(n)&&s.set(n,cr),cr;if(mt(r))for(let h=0;h<r.length;h++){const d=mn(r[h]);ug(d)&&(o[d]=Ht)}else if(r)for(const h in r){const d=mn(h);if(ug(d)){const f=r[h],g=o[d]=mt(f)||It(f)?{type:f}:Ge({},f),_=g.type;let b=!1,v=!0;if(mt(_))for(let A=0;A<_.length;++A){const C=_[A],O=It(C)&&C.name;if(O==="Boolean"){b=!0;break}else O==="String"&&(v=!1)}else b=It(_)&&_.name==="Boolean";g[0]=b,g[1]=v,(b||Bt(g,"default"))&&a.push(d)}}const c=[o,a];return Yt(n)&&s.set(n,c),c}function ug(n){return n[0]!=="$"&&!To(n)}const kd=n=>n==="_"||n==="__"||n==="_ctx"||n==="$stable",Dd=n=>mt(n)?n.map(Dn):[Dn(n)],hE=(n,t,e)=>{if(t._n)return t;const s=LT((...i)=>Dd(t(...i)),e);return s._c=!1,s},bb=(n,t,e)=>{const s=n._ctx;for(const i in n){if(kd(i))continue;const r=n[i];if(It(r))t[i]=hE(i,r,s);else if(r!=null){const o=Dd(r);t[i]=()=>o}}},vb=(n,t)=>{const e=Dd(t);n.slots.default=()=>e},wb=(n,t,e)=>{for(const s in t)(e||!kd(s))&&(n[s]=t[s])},dE=(n,t,e)=>{const s=n.slots=gb();if(n.vnode.shapeFlag&32){const i=t.__;i&&bh(s,"__",i,!0);const r=t._;r?(wb(s,t,e),e&&bh(s,"_",r,!0)):bb(t,s)}else t&&vb(n,t)},fE=(n,t,e)=>{const{vnode:s,slots:i}=n;let r=!0,o=Ht;if(s.shapeFlag&32){const a=t._;a?e&&a===1?r=!1:wb(i,t,e):(r=!t.$stable,bb(t,i)),o=t}else t&&(vb(n,t),o={default:1});if(r)for(const a in i)!kd(a)&&o[a]==null&&delete i[a]},nn=AE;function pE(n){return gE(n)}function gE(n,t){const e=Pc();e.__VUE__=!0;const{insert:s,remove:i,patchProp:r,createElement:o,createText:a,createComment:l,setText:c,setElementText:h,parentNode:d,nextSibling:f,setScopeId:g=Vn,insertStaticContent:_}=n,b=(R,L,B,W=null,z=null,j=null,tt=void 0,Q=null,Y=!!L.dynamicChildren)=>{if(R===L)return;R&&!io(R,L)&&(W=Xn(R),St(R,z,j,!0),R=null),L.patchFlag===-2&&(Y=!1,L.dynamicChildren=null);const{type:G,ref:ct,shapeFlag:Z}=L;switch(G){case Vc:v(R,L,B,W);break;case ti:A(R,L,B,W);break;case vl:R==null&&C(L,B,W,tt);break;case Qe:P(R,L,B,W,z,j,tt,Q,Y);break;default:Z&1?D(R,L,B,W,z,j,tt,Q,Y):Z&6?S(R,L,B,W,z,j,tt,Q,Y):(Z&64||Z&128)&&G.process(R,L,B,W,z,j,tt,Q,Y,Sn)}ct!=null&&z?So(ct,R&&R.ref,j,L||R,!L):ct==null&&R&&R.ref!=null&&So(R.ref,null,j,R,!0)},v=(R,L,B,W)=>{if(R==null)s(L.el=a(L.children),B,W);else{const z=L.el=R.el;L.children!==R.children&&c(z,L.children)}},A=(R,L,B,W)=>{R==null?s(L.el=l(L.children||""),B,W):L.el=R.el},C=(R,L,B,W)=>{[R.el,R.anchor]=_(R.children,L,B,W,R.el,R.anchor)},O=({el:R,anchor:L},B,W)=>{let z;for(;R&&R!==L;)z=f(R),s(R,B,W),R=z;s(L,B,W)},k=({el:R,anchor:L})=>{let B;for(;R&&R!==L;)B=f(R),i(R),R=B;i(L)},D=(R,L,B,W,z,j,tt,Q,Y)=>{L.type==="svg"?tt="svg":L.type==="math"&&(tt="mathml"),R==null?N(L,B,W,z,j,tt,Q,Y):x(R,L,z,j,tt,Q,Y)},N=(R,L,B,W,z,j,tt,Q)=>{let Y,G;const{props:ct,shapeFlag:Z,transition:at,dirs:_t}=R;if(Y=R.el=o(R.type,j,ct&&ct.is,ct),Z&8?h(Y,R.children):Z&16&&y(R.children,Y,null,W,z,Uu(R,j),tt,Q),_t&&yi(R,null,W,"created"),w(Y,R,R.scopeId,tt,W),ct){for(const Tt in ct)Tt!=="value"&&!To(Tt)&&r(Y,Tt,null,ct[Tt],j,W);"value"in ct&&r(Y,"value",null,ct.value,j),(G=ct.onVnodeBeforeMount)&&An(G,W,R)}_t&&yi(R,null,W,"beforeMount");const ft=mE(z,at);ft&&at.beforeEnter(Y),s(Y,L,B),((G=ct&&ct.onVnodeMounted)||ft||_t)&&nn(()=>{G&&An(G,W,R),ft&&at.enter(Y),_t&&yi(R,null,W,"mounted")},z)},w=(R,L,B,W,z)=>{if(B&&g(R,B),W)for(let j=0;j<W.length;j++)g(R,W[j]);if(z){let j=z.subTree;if(L===j||Ab(j.type)&&(j.ssContent===L||j.ssFallback===L)){const tt=z.vnode;w(R,tt,tt.scopeId,tt.slotScopeIds,z.parent)}}},y=(R,L,B,W,z,j,tt,Q,Y=0)=>{for(let G=Y;G<R.length;G++){const ct=R[G]=Q?Ms(R[G]):Dn(R[G]);b(null,ct,L,B,W,z,j,tt,Q)}},x=(R,L,B,W,z,j,tt)=>{const Q=L.el=R.el;let{patchFlag:Y,dynamicChildren:G,dirs:ct}=L;Y|=R.patchFlag&16;const Z=R.props||Ht,at=L.props||Ht;let _t;if(B&&bi(B,!1),(_t=at.onVnodeBeforeUpdate)&&An(_t,B,L,R),ct&&yi(L,R,B,"beforeUpdate"),B&&bi(B,!0),(Z.innerHTML&&at.innerHTML==null||Z.textContent&&at.textContent==null)&&h(Q,""),G?E(R.dynamicChildren,G,Q,B,W,Uu(L,z),j):tt||H(R,L,Q,null,B,W,Uu(L,z),j,!1),Y>0){if(Y&16)I(Q,Z,at,B,z);else if(Y&2&&Z.class!==at.class&&r(Q,"class",null,at.class,z),Y&4&&r(Q,"style",Z.style,at.style,z),Y&8){const ft=L.dynamicProps;for(let Tt=0;Tt<ft.length;Tt++){const Mt=ft[Tt],ve=Z[Mt],we=at[Mt];(we!==ve||Mt==="value")&&r(Q,Mt,ve,we,z,B)}}Y&1&&R.children!==L.children&&h(Q,L.children)}else!tt&&G==null&&I(Q,Z,at,B,z);((_t=at.onVnodeUpdated)||ct)&&nn(()=>{_t&&An(_t,B,L,R),ct&&yi(L,R,B,"updated")},W)},E=(R,L,B,W,z,j,tt)=>{for(let Q=0;Q<L.length;Q++){const Y=R[Q],G=L[Q],ct=Y.el&&(Y.type===Qe||!io(Y,G)||Y.shapeFlag&198)?d(Y.el):B;b(Y,G,ct,null,W,z,j,tt,!0)}},I=(R,L,B,W,z)=>{if(L!==B){if(L!==Ht)for(const j in L)!To(j)&&!(j in B)&&r(R,j,L[j],null,z,W);for(const j in B){if(To(j))continue;const tt=B[j],Q=L[j];tt!==Q&&j!=="value"&&r(R,j,Q,tt,z,W)}"value"in B&&r(R,"value",L.value,B.value,z)}},P=(R,L,B,W,z,j,tt,Q,Y)=>{const G=L.el=R?R.el:a(""),ct=L.anchor=R?R.anchor:a("");let{patchFlag:Z,dynamicChildren:at,slotScopeIds:_t}=L;_t&&(Q=Q?Q.concat(_t):_t),R==null?(s(G,B,W),s(ct,B,W),y(L.children||[],B,ct,z,j,tt,Q,Y)):Z>0&&Z&64&&at&&R.dynamicChildren?(E(R.dynamicChildren,at,B,z,j,tt,Q),(L.key!=null||z&&L===z.subTree)&&xb(R,L,!0)):H(R,L,B,ct,z,j,tt,Q,Y)},S=(R,L,B,W,z,j,tt,Q,Y)=>{L.slotScopeIds=Q,R==null?L.shapeFlag&512?z.ctx.activate(L,B,W,tt,Y):rt(L,B,W,z,j,tt,Y):it(R,L,Y)},rt=(R,L,B,W,z,j,tt)=>{const Q=R.component=OE(R,W,z);if(cb(R)&&(Q.ctx.renderer=Sn),VE(Q,!1,tt),Q.asyncDep){if(z&&z.registerDep(Q,dt,tt),!R.el){const Y=Q.subTree=Fe(ti);A(null,Y,L,B),R.placeholder=Y.el}}else dt(Q,R,L,B,z,j,tt)},it=(R,L,B)=>{const W=L.component=R.component;if(IE(R,L,B))if(W.asyncDep&&!W.asyncResolved){ot(W,L,B);return}else W.next=L,W.update();else L.el=R.el,W.vnode=L},dt=(R,L,B,W,z,j,tt)=>{const Q=()=>{if(R.isMounted){let{next:Z,bu:at,u:_t,parent:ft,vnode:Tt}=R;{const Ce=Tb(R);if(Ce){Z&&(Z.el=Tt.el,ot(R,Z,tt)),Ce.asyncDep.then(()=>{R.isUnmounted||Q()});return}}let Mt=Z,ve;bi(R,!1),Z?(Z.el=Tt.el,ot(R,Z,tt)):Z=Tt,at&&yl(at),(ve=Z.props&&Z.props.onVnodeBeforeUpdate)&&An(ve,ft,Z,Tt),bi(R,!0);const we=dg(R),cn=R.subTree;R.subTree=we,b(cn,we,d(cn.el),Xn(cn),R,z,j),Z.el=we.el,Mt===null&&SE(R,we.el),_t&&nn(_t,z),(ve=Z.props&&Z.props.onVnodeUpdated)&&nn(()=>An(ve,ft,Z,Tt),z)}else{let Z;const{el:at,props:_t}=L,{bm:ft,m:Tt,parent:Mt,root:ve,type:we}=R,cn=Ao(L);bi(R,!1),ft&&yl(ft),!cn&&(Z=_t&&_t.onVnodeBeforeMount)&&An(Z,Mt,L),bi(R,!0);{ve.ce&&ve.ce._def.shadowRoot!==!1&&ve.ce._injectChildStyle(we);const Ce=R.subTree=dg(R);b(null,Ce,B,W,R,z,j),L.el=Ce.el}if(Tt&&nn(Tt,z),!cn&&(Z=_t&&_t.onVnodeMounted)){const Ce=L;nn(()=>An(Z,Mt,Ce),z)}(L.shapeFlag&256||Mt&&Ao(Mt.vnode)&&Mt.vnode.shapeFlag&256)&&R.a&&nn(R.a,z),R.isMounted=!0,L=B=W=null}};R.scope.on();const Y=R.effect=new Uy(Q);R.scope.off();const G=R.update=Y.run.bind(Y),ct=R.job=Y.runIfDirty.bind(Y);ct.i=R,ct.id=R.uid,Y.scheduler=()=>Pd(ct),bi(R,!0),G()},ot=(R,L,B)=>{L.component=R;const W=R.vnode.props;R.vnode=L,R.next=null,cE(R,L.props,W,B),fE(R,L.children,B),fs(),ig(R),ps()},H=(R,L,B,W,z,j,tt,Q,Y=!1)=>{const G=R&&R.children,ct=R?R.shapeFlag:0,Z=L.children,{patchFlag:at,shapeFlag:_t}=L;if(at>0){if(at&128){X(G,Z,B,W,z,j,tt,Q,Y);return}else if(at&256){K(G,Z,B,W,z,j,tt,Q,Y);return}}_t&8?(ct&16&&oe(G,z,j),Z!==G&&h(B,Z)):ct&16?_t&16?X(G,Z,B,W,z,j,tt,Q,Y):oe(G,z,j,!0):(ct&8&&h(B,""),_t&16&&y(Z,B,W,z,j,tt,Q,Y))},K=(R,L,B,W,z,j,tt,Q,Y)=>{R=R||cr,L=L||cr;const G=R.length,ct=L.length,Z=Math.min(G,ct);let at;for(at=0;at<Z;at++){const _t=L[at]=Y?Ms(L[at]):Dn(L[at]);b(R[at],_t,B,null,z,j,tt,Q,Y)}G>ct?oe(R,z,j,!0,!1,Z):y(L,B,W,z,j,tt,Q,Y,Z)},X=(R,L,B,W,z,j,tt,Q,Y)=>{let G=0;const ct=L.length;let Z=R.length-1,at=ct-1;for(;G<=Z&&G<=at;){const _t=R[G],ft=L[G]=Y?Ms(L[G]):Dn(L[G]);if(io(_t,ft))b(_t,ft,B,null,z,j,tt,Q,Y);else break;G++}for(;G<=Z&&G<=at;){const _t=R[Z],ft=L[at]=Y?Ms(L[at]):Dn(L[at]);if(io(_t,ft))b(_t,ft,B,null,z,j,tt,Q,Y);else break;Z--,at--}if(G>Z){if(G<=at){const _t=at+1,ft=_t<ct?L[_t].el:W;for(;G<=at;)b(null,L[G]=Y?Ms(L[G]):Dn(L[G]),B,ft,z,j,tt,Q,Y),G++}}else if(G>at)for(;G<=Z;)St(R[G],z,j,!0),G++;else{const _t=G,ft=G,Tt=new Map;for(G=ft;G<=at;G++){const xe=L[G]=Y?Ms(L[G]):Dn(L[G]);xe.key!=null&&Tt.set(xe.key,G)}let Mt,ve=0;const we=at-ft+1;let cn=!1,Ce=0;const Is=new Array(we);for(G=0;G<we;G++)Is[G]=0;for(G=_t;G<=Z;G++){const xe=R[G];if(ve>=we){St(xe,z,j,!0);continue}let un;if(xe.key!=null)un=Tt.get(xe.key);else for(Mt=ft;Mt<=at;Mt++)if(Is[Mt-ft]===0&&io(xe,L[Mt])){un=Mt;break}un===void 0?St(xe,z,j,!0):(Is[un-ft]=G+1,un>=Ce?Ce=un:cn=!0,b(xe,L[un],B,null,z,j,tt,Q,Y),ve++)}const Hr=cn?_E(Is):cr;for(Mt=Hr.length-1,G=we-1;G>=0;G--){const xe=ft+G,un=L[xe],Ma=L[xe+1],Yi=xe+1<ct?Ma.el||Ma.placeholder:W;Is[G]===0?b(null,un,B,Yi,z,j,tt,Q,Y):cn&&(Mt<0||G!==Hr[Mt]?ht(un,B,Yi,2):Mt--)}}},ht=(R,L,B,W,z=null)=>{const{el:j,type:tt,transition:Q,children:Y,shapeFlag:G}=R;if(G&6){ht(R.component.subTree,L,B,W);return}if(G&128){R.suspense.move(L,B,W);return}if(G&64){tt.move(R,L,B,Sn);return}if(tt===Qe){s(j,L,B);for(let Z=0;Z<Y.length;Z++)ht(Y[Z],L,B,W);s(R.anchor,L,B);return}if(tt===vl){O(R,L,B);return}if(W!==2&&G&1&&Q)if(W===0)Q.beforeEnter(j),s(j,L,B),nn(()=>Q.enter(j),z);else{const{leave:Z,delayLeave:at,afterLeave:_t}=Q,ft=()=>{R.ctx.isUnmounted?i(j):s(j,L,B)},Tt=()=>{Z(j,()=>{ft(),_t&&_t()})};at?at(j,ft,Tt):Tt()}else s(j,L,B)},St=(R,L,B,W=!1,z=!1)=>{const{type:j,props:tt,ref:Q,children:Y,dynamicChildren:G,shapeFlag:ct,patchFlag:Z,dirs:at,cacheIndex:_t}=R;if(Z===-2&&(z=!1),Q!=null&&(fs(),So(Q,null,B,R,!0),ps()),_t!=null&&(L.renderCache[_t]=void 0),ct&256){L.ctx.deactivate(R);return}const ft=ct&1&&at,Tt=!Ao(R);let Mt;if(Tt&&(Mt=tt&&tt.onVnodeBeforeUnmount)&&An(Mt,L,R),ct&6)be(R.component,B,W);else{if(ct&128){R.suspense.unmount(B,W);return}ft&&yi(R,null,L,"beforeUnmount"),ct&64?R.type.remove(R,L,B,Sn,W):G&&!G.hasOnce&&(j!==Qe||Z>0&&Z&64)?oe(G,L,B,!1,!0):(j===Qe&&Z&384||!z&&ct&16)&&oe(Y,L,B),W&&bt(R)}(Tt&&(Mt=tt&&tt.onVnodeUnmounted)||ft)&&nn(()=>{Mt&&An(Mt,L,R),ft&&yi(R,null,L,"unmounted")},B)},bt=R=>{const{type:L,el:B,anchor:W,transition:z}=R;if(L===Qe){Nt(B,W);return}if(L===vl){k(R);return}const j=()=>{i(B),z&&!z.persisted&&z.afterLeave&&z.afterLeave()};if(R.shapeFlag&1&&z&&!z.persisted){const{leave:tt,delayLeave:Q}=z,Y=()=>tt(B,j);Q?Q(R.el,j,Y):Y()}else j()},Nt=(R,L)=>{let B;for(;R!==L;)B=f(R),i(R),R=B;i(L)},be=(R,L,B)=>{const{bum:W,scope:z,job:j,subTree:tt,um:Q,m:Y,a:G,parent:ct,slots:{__:Z}}=R;hg(Y),hg(G),W&&yl(W),ct&&mt(Z)&&Z.forEach(at=>{ct.renderCache[at]=void 0}),z.stop(),j&&(j.flags|=8,St(tt,R,L,B)),Q&&nn(Q,L),nn(()=>{R.isUnmounted=!0},L),L&&L.pendingBranch&&!L.isUnmounted&&R.asyncDep&&!R.asyncResolved&&R.suspenseId===L.pendingId&&(L.deps--,L.deps===0&&L.resolve())},oe=(R,L,B,W=!1,z=!1,j=0)=>{for(let tt=j;tt<R.length;tt++)St(R[tt],L,B,W,z)},Xn=R=>{if(R.shapeFlag&6)return Xn(R.component.subTree);if(R.shapeFlag&128)return R.suspense.next();const L=f(R.anchor||R.el),B=L&&L[VT];return B?f(B):L};let zr=!1;const Da=(R,L,B)=>{R==null?L._vnode&&St(L._vnode,null,null,!0):b(L._vnode||null,R,L,null,null,null,B),L._vnode=R,zr||(zr=!0,ig(),rb(),zr=!1)},Sn={p:b,um:St,m:ht,r:bt,mt:rt,mc:y,pc:H,pbc:E,n:Xn,o:n};return{render:Da,hydrate:void 0,createApp:oE(Da)}}function Uu({type:n,props:t},e){return e==="svg"&&n==="foreignObject"||e==="mathml"&&n==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:e}function bi({effect:n,job:t},e){e?(n.flags|=32,t.flags|=4):(n.flags&=-33,t.flags&=-5)}function mE(n,t){return(!n||n&&!n.pendingBranch)&&t&&!t.persisted}function xb(n,t,e=!1){const s=n.children,i=t.children;if(mt(s)&&mt(i))for(let r=0;r<s.length;r++){const o=s[r];let a=i[r];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=i[r]=Ms(i[r]),a.el=o.el),!e&&a.patchFlag!==-2&&xb(o,a)),a.type===Vc&&(a.el=o.el),a.type===ti&&!a.el&&(a.el=o.el)}}function _E(n){const t=n.slice(),e=[0];let s,i,r,o,a;const l=n.length;for(s=0;s<l;s++){const c=n[s];if(c!==0){if(i=e[e.length-1],n[i]<c){t[s]=i,e.push(s);continue}for(r=0,o=e.length-1;r<o;)a=r+o>>1,n[e[a]]<c?r=a+1:o=a;c<n[e[r]]&&(r>0&&(t[s]=e[r-1]),e[r]=s)}}for(r=e.length,o=e[r-1];r-- >0;)e[r]=o,o=t[o];return e}function Tb(n){const t=n.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:Tb(t)}function hg(n){if(n)for(let t=0;t<n.length;t++)n[t].flags|=8}const yE=Symbol.for("v-scx"),bE=()=>bl(yE);function Po(n,t,e){return Eb(n,t,e)}function Eb(n,t,e=Ht){const{immediate:s,deep:i,flush:r,once:o}=e,a=Ge({},e),l=t&&s||!t&&r!=="post";let c;if(Go){if(r==="sync"){const g=bE();c=g.__watcherHandles||(g.__watcherHandles=[])}else if(!l){const g=()=>{};return g.stop=Vn,g.resume=Vn,g.pause=Vn,g}}const h=Ne;a.call=(g,_,b)=>Wn(g,h,_,b);let d=!1;r==="post"?a.scheduler=g=>{nn(g,h&&h.suspense)}:r!=="sync"&&(d=!0,a.scheduler=(g,_)=>{_?g():Pd(g)}),a.augmentJob=g=>{t&&(g.flags|=4),d&&(g.flags|=2,h&&(g.id=h.uid,g.i=h))};const f=kT(n,t,a);return Go&&(c?c.push(f):l&&f()),f}function vE(n,t,e){const s=this.proxy,i=de(n)?n.includes(".")?Ib(s,n):()=>s[n]:n.bind(s,s);let r;It(t)?r=t:(r=t.handler,e=t);const o=pa(this),a=Eb(i,r.bind(s),e);return o(),a}function Ib(n,t){const e=t.split(".");return()=>{let s=n;for(let i=0;i<e.length&&s;i++)s=s[e[i]];return s}}const wE=(n,t)=>t==="modelValue"||t==="model-value"?n.modelModifiers:n[`${t}Modifiers`]||n[`${mn(t)}Modifiers`]||n[`${Hi(t)}Modifiers`];function xE(n,t,...e){if(n.isUnmounted)return;const s=n.vnode.props||Ht;let i=e;const r=t.startsWith("update:"),o=r&&wE(s,t.slice(7));o&&(o.trim&&(i=e.map(h=>de(h)?h.trim():h)),o.number&&(i=e.map(Fl)));let a,l=s[a=Ou(t)]||s[a=Ou(mn(t))];!l&&r&&(l=s[a=Ou(Hi(t))]),l&&Wn(l,n,6,i);const c=s[a+"Once"];if(c){if(!n.emitted)n.emitted={};else if(n.emitted[a])return;n.emitted[a]=!0,Wn(c,n,6,i)}}function Sb(n,t,e=!1){const s=t.emitsCache,i=s.get(n);if(i!==void 0)return i;const r=n.emits;let o={},a=!1;if(!It(n)){const l=c=>{const h=Sb(c,t,!0);h&&(a=!0,Ge(o,h))};!e&&t.mixins.length&&t.mixins.forEach(l),n.extends&&l(n.extends),n.mixins&&n.mixins.forEach(l)}return!r&&!a?(Yt(n)&&s.set(n,null),null):(mt(r)?r.forEach(l=>o[l]=null):Ge(o,r),Yt(n)&&s.set(n,o),o)}function Lc(n,t){return!n||!Ic(t)?!1:(t=t.slice(2).replace(/Once$/,""),Bt(n,t[0].toLowerCase()+t.slice(1))||Bt(n,Hi(t))||Bt(n,t))}function dg(n){const{type:t,vnode:e,proxy:s,withProxy:i,propsOptions:[r],slots:o,attrs:a,emit:l,render:c,renderCache:h,props:d,data:f,setupState:g,ctx:_,inheritAttrs:b}=n,v=zl(n);let A,C;try{if(e.shapeFlag&4){const k=i||s,D=k;A=Dn(c.call(D,k,h,d,g,f,_)),C=a}else{const k=t;A=Dn(k.length>1?k(d,{attrs:a,slots:o,emit:l}):k(d,null)),C=t.props?a:TE(a)}}catch(k){Ro.length=0,Dc(k,n,1),A=Fe(ti)}let O=A;if(C&&b!==!1){const k=Object.keys(C),{shapeFlag:D}=O;k.length&&D&7&&(r&&k.some(_d)&&(C=EE(C,r)),O=vr(O,C,!1,!0))}return e.dirs&&(O=vr(O,null,!1,!0),O.dirs=O.dirs?O.dirs.concat(e.dirs):e.dirs),e.transition&&Rd(O,e.transition),A=O,zl(v),A}const TE=n=>{let t;for(const e in n)(e==="class"||e==="style"||Ic(e))&&((t||(t={}))[e]=n[e]);return t},EE=(n,t)=>{const e={};for(const s in n)(!_d(s)||!(s.slice(9)in t))&&(e[s]=n[s]);return e};function IE(n,t,e){const{props:s,children:i,component:r}=n,{props:o,children:a,patchFlag:l}=t,c=r.emitsOptions;if(t.dirs||t.transition)return!0;if(e&&l>=0){if(l&1024)return!0;if(l&16)return s?fg(s,o,c):!!o;if(l&8){const h=t.dynamicProps;for(let d=0;d<h.length;d++){const f=h[d];if(o[f]!==s[f]&&!Lc(c,f))return!0}}}else return(i||a)&&(!a||!a.$stable)?!0:s===o?!1:s?o?fg(s,o,c):!0:!!o;return!1}function fg(n,t,e){const s=Object.keys(t);if(s.length!==Object.keys(n).length)return!0;for(let i=0;i<s.length;i++){const r=s[i];if(t[r]!==n[r]&&!Lc(e,r))return!0}return!1}function SE({vnode:n,parent:t},e){for(;t;){const s=t.subTree;if(s.suspense&&s.suspense.activeBranch===n&&(s.el=n.el),s===n)(n=t.vnode).el=e,t=t.parent;else break}}const Ab=n=>n.__isSuspense;function AE(n,t){t&&t.pendingBranch?mt(n)?t.effects.push(...n):t.effects.push(n):OT(n)}const Qe=Symbol.for("v-fgt"),Vc=Symbol.for("v-txt"),ti=Symbol.for("v-cmt"),vl=Symbol.for("v-stc"),Ro=[];let on=null;function st(n=!1){Ro.push(on=n?null:[])}function CE(){Ro.pop(),on=Ro[Ro.length-1]||null}let qo=1;function pg(n,t=!1){qo+=n,n<0&&on&&t&&(on.hasOnce=!0)}function Cb(n){return n.dynamicChildren=qo>0?on||cr:null,CE(),qo>0&&on&&on.push(n),n}function lt(n,t,e,s,i,r){return Cb(M(n,t,e,s,i,r,!0))}function vn(n,t,e,s,i){return Cb(Fe(n,t,e,s,i,!0))}function Hl(n){return n?n.__v_isVNode===!0:!1}function io(n,t){return n.type===t.type&&n.key===t.key}const Pb=({key:n})=>n??null,wl=({ref:n,ref_key:t,ref_for:e})=>(typeof n=="number"&&(n=""+n),n!=null?de(n)||Ue(n)||It(n)?{i:rn,r:n,k:t,f:!!e}:n:null);function M(n,t=null,e=null,s=0,i=null,r=n===Qe?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:n,props:t,key:t&&Pb(t),ref:t&&wl(t),scopeId:ab,slotScopeIds:null,children:e,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:s,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:rn};return a?(Md(l,e),r&128&&n.normalize(l)):e&&(l.shapeFlag|=de(e)?8:16),qo>0&&!o&&on&&(l.patchFlag>0||r&6)&&l.patchFlag!==32&&on.push(l),l}const Fe=PE;function PE(n,t=null,e=null,s=0,i=null,r=!1){if((!n||n===QT)&&(n=ti),Hl(n)){const a=vr(n,t,!0);return e&&Md(a,e),qo>0&&!r&&on&&(a.shapeFlag&6?on[on.indexOf(n)]=a:on.push(a)),a.patchFlag=-2,a}if($E(n)&&(n=n.__vccOpts),t){t=RE(t);let{class:a,style:l}=t;a&&!de(a)&&(t.class=q(a)),Yt(l)&&(Cd(l)&&!mt(l)&&(l=Ge({},l)),t.style=vd(l))}const o=de(n)?1:Ab(n)?128:NT(n)?64:Yt(n)?4:It(n)?2:0;return M(n,t,e,s,i,o,r,!0)}function RE(n){return n?Cd(n)||mb(n)?Ge({},n):n:null}function vr(n,t,e=!1,s=!1){const{props:i,ref:r,patchFlag:o,children:a,transition:l}=n,c=t?kE(i||{},t):i,h={__v_isVNode:!0,__v_skip:!0,type:n.type,props:c,key:c&&Pb(c),ref:t&&t.ref?e&&r?mt(r)?r.concat(wl(t)):[r,wl(t)]:wl(t):r,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:a,target:n.target,targetStart:n.targetStart,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:t&&n.type!==Qe?o===-1?16:o|16:o,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:l,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&vr(n.ssContent),ssFallback:n.ssFallback&&vr(n.ssFallback),placeholder:n.placeholder,el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce};return l&&s&&Rd(h,l.clone(h)),h}function bn(n=" ",t=0){return Fe(Vc,null,n,t)}function gg(n,t){const e=Fe(vl,null,n);return e.staticCount=t,e}function fe(n="",t=!1){return t?(st(),vn(ti,null,n)):Fe(ti,null,n)}function Dn(n){return n==null||typeof n=="boolean"?Fe(ti):mt(n)?Fe(Qe,null,n.slice()):Hl(n)?Ms(n):Fe(Vc,null,String(n))}function Ms(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:vr(n)}function Md(n,t){let e=0;const{shapeFlag:s}=n;if(t==null)t=null;else if(mt(t))e=16;else if(typeof t=="object")if(s&65){const i=t.default;i&&(i._c&&(i._d=!1),Md(n,i()),i._c&&(i._d=!0));return}else{e=32;const i=t._;!i&&!mb(t)?t._ctx=rn:i===3&&rn&&(rn.slots._===1?t._=1:(t._=2,n.patchFlag|=1024))}else It(t)?(t={default:t,_ctx:rn},e=32):(t=String(t),s&64?(e=16,t=[bn(t)]):e=8);n.children=t,n.shapeFlag|=e}function kE(...n){const t={};for(let e=0;e<n.length;e++){const s=n[e];for(const i in s)if(i==="class")t.class!==s.class&&(t.class=q([t.class,s.class]));else if(i==="style")t.style=vd([t.style,s.style]);else if(Ic(i)){const r=t[i],o=s[i];o&&r!==o&&!(mt(r)&&r.includes(o))&&(t[i]=r?[].concat(r,o):o)}else i!==""&&(t[i]=s[i])}return t}function An(n,t,e,s=null){Wn(n,t,7,[e,s])}const DE=fb();let ME=0;function OE(n,t,e){const s=n.type,i=(t?t.appContext:n.appContext)||DE,r={uid:ME++,vnode:n,type:s,parent:t,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new sT(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(i.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:yb(s,i),emitsOptions:Sb(s,i),emit:null,emitted:null,propsDefaults:Ht,inheritAttrs:s.inheritAttrs,ctx:Ht,data:Ht,props:Ht,attrs:Ht,slots:Ht,refs:Ht,setupState:Ht,setupContext:null,suspense:e,suspenseId:e?e.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=t?t.root:r,r.emit=xE.bind(null,r),n.ce&&n.ce(r),r}let Ne=null;const LE=()=>Ne||rn;let Wl,Ch;{const n=Pc(),t=(e,s)=>{let i;return(i=n[e])||(i=n[e]=[]),i.push(s),r=>{i.length>1?i.forEach(o=>o(r)):i[0](r)}};Wl=t("__VUE_INSTANCE_SETTERS__",e=>Ne=e),Ch=t("__VUE_SSR_SETTERS__",e=>Go=e)}const pa=n=>{const t=Ne;return Wl(n),n.scope.on(),()=>{n.scope.off(),Wl(t)}},mg=()=>{Ne&&Ne.scope.off(),Wl(null)};function Rb(n){return n.vnode.shapeFlag&4}let Go=!1;function VE(n,t=!1,e=!1){t&&Ch(t);const{props:s,children:i}=n.vnode,r=Rb(n);lE(n,s,r,t),dE(n,i,e||t);const o=r?NE(n,t):void 0;return t&&Ch(!1),o}function NE(n,t){const e=n.type;n.accessCache=Object.create(null),n.proxy=new Proxy(n.ctx,ZT);const{setup:s}=e;if(s){fs();const i=n.setupContext=s.length>1?BE(n):null,r=pa(n),o=fa(s,n,0,[n.props,i]),a=Oy(o);if(ps(),r(),(a||n.sp)&&!Ao(n)&&lb(n),a){if(o.then(mg,mg),t)return o.then(l=>{_g(n,l)}).catch(l=>{Dc(l,n,0)});n.asyncDep=o}else _g(n,o)}else kb(n)}function _g(n,t,e){It(t)?n.type.__ssrInlineRender?n.ssrRender=t:n.render=t:Yt(t)&&(n.setupState=eb(t)),kb(n)}function kb(n,t,e){const s=n.type;n.render||(n.render=s.render||Vn);{const i=pa(n);fs();try{tE(n)}finally{ps(),i()}}}const FE={get(n,t){return Le(n,"get",""),n[t]}};function BE(n){const t=e=>{n.exposed=e||{}};return{attrs:new Proxy(n.attrs,FE),slots:n.slots,emit:n.emit,expose:t}}function Nc(n){return n.exposed?n.exposeProxy||(n.exposeProxy=new Proxy(eb(ET(n.exposed)),{get(t,e){if(e in t)return t[e];if(e in Co)return Co[e](n)},has(t,e){return e in t||e in Co}})):n.proxy}function UE(n,t=!0){return It(n)?n.displayName||n.name:n.name||t&&n.__name}function $E(n){return It(n)&&"__vccOpts"in n}const Ln=(n,t)=>PT(n,t,Go);function zE(n,t,e){const s=arguments.length;return s===2?Yt(t)&&!mt(t)?Hl(t)?Fe(n,null,[t]):Fe(n,t):Fe(n,null,t):(s>3?e=Array.prototype.slice.call(arguments,2):s===3&&Hl(e)&&(e=[e]),Fe(n,t,e))}const jE="3.5.18";/**
* @vue/runtime-dom v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Ph;const yg=typeof window<"u"&&window.trustedTypes;if(yg)try{Ph=yg.createPolicy("vue",{createHTML:n=>n})}catch{}const Db=Ph?n=>Ph.createHTML(n):n=>n,HE="http://www.w3.org/2000/svg",WE="http://www.w3.org/1998/Math/MathML",ss=typeof document<"u"?document:null,bg=ss&&ss.createElement("template"),qE={insert:(n,t,e)=>{t.insertBefore(n,e||null)},remove:n=>{const t=n.parentNode;t&&t.removeChild(n)},createElement:(n,t,e,s)=>{const i=t==="svg"?ss.createElementNS(HE,n):t==="mathml"?ss.createElementNS(WE,n):e?ss.createElement(n,{is:e}):ss.createElement(n);return n==="select"&&s&&s.multiple!=null&&i.setAttribute("multiple",s.multiple),i},createText:n=>ss.createTextNode(n),createComment:n=>ss.createComment(n),setText:(n,t)=>{n.nodeValue=t},setElementText:(n,t)=>{n.textContent=t},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>ss.querySelector(n),setScopeId(n,t){n.setAttribute(t,"")},insertStaticContent(n,t,e,s,i,r){const o=e?e.previousSibling:t.lastChild;if(i&&(i===r||i.nextSibling))for(;t.insertBefore(i.cloneNode(!0),e),!(i===r||!(i=i.nextSibling)););else{bg.innerHTML=Db(s==="svg"?`<svg>${n}</svg>`:s==="mathml"?`<math>${n}</math>`:n);const a=bg.content;if(s==="svg"||s==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}t.insertBefore(a,e)}return[o?o.nextSibling:t.firstChild,e?e.previousSibling:t.lastChild]}},GE=Symbol("_vtc");function KE(n,t,e){const s=n[GE];s&&(t=(t?[t,...s]:[...s]).join(" ")),t==null?n.removeAttribute("class"):e?n.setAttribute("class",t):n.className=t}const ql=Symbol("_vod"),Mb=Symbol("_vsh"),$u={beforeMount(n,{value:t},{transition:e}){n[ql]=n.style.display==="none"?"":n.style.display,e&&t?e.beforeEnter(n):ro(n,t)},mounted(n,{value:t},{transition:e}){e&&t&&e.enter(n)},updated(n,{value:t,oldValue:e},{transition:s}){!t!=!e&&(s?t?(s.beforeEnter(n),ro(n,!0),s.enter(n)):s.leave(n,()=>{ro(n,!1)}):ro(n,t))},beforeUnmount(n,{value:t}){ro(n,t)}};function ro(n,t){n.style.display=t?n[ql]:"none",n[Mb]=!t}const YE=Symbol(""),XE=/(^|;)\s*display\s*:/;function QE(n,t,e){const s=n.style,i=de(e);let r=!1;if(e&&!i){if(t)if(de(t))for(const o of t.split(";")){const a=o.slice(0,o.indexOf(":")).trim();e[a]==null&&xl(s,a,"")}else for(const o in t)e[o]==null&&xl(s,o,"");for(const o in e)o==="display"&&(r=!0),xl(s,o,e[o])}else if(i){if(t!==e){const o=s[YE];o&&(e+=";"+o),s.cssText=e,r=XE.test(e)}}else t&&n.removeAttribute("style");ql in n&&(n[ql]=r?s.display:"",n[Mb]&&(s.display="none"))}const vg=/\s*!important$/;function xl(n,t,e){if(mt(e))e.forEach(s=>xl(n,t,s));else if(e==null&&(e=""),t.startsWith("--"))n.setProperty(t,e);else{const s=JE(n,t);vg.test(e)?n.setProperty(Hi(s),e.replace(vg,""),"important"):n[s]=e}}const wg=["Webkit","Moz","ms"],zu={};function JE(n,t){const e=zu[t];if(e)return e;let s=mn(t);if(s!=="filter"&&s in n)return zu[t]=s;s=Cc(s);for(let i=0;i<wg.length;i++){const r=wg[i]+s;if(r in n)return zu[t]=r}return t}const xg="http://www.w3.org/1999/xlink";function Tg(n,t,e,s,i,r=tT(t)){s&&t.startsWith("xlink:")?e==null?n.removeAttributeNS(xg,t.slice(6,t.length)):n.setAttributeNS(xg,t,e):e==null||r&&!Ny(e)?n.removeAttribute(t):n.setAttribute(t,r?"":Hn(e)?String(e):e)}function Eg(n,t,e,s,i){if(t==="innerHTML"||t==="textContent"){e!=null&&(n[t]=t==="innerHTML"?Db(e):e);return}const r=n.tagName;if(t==="value"&&r!=="PROGRESS"&&!r.includes("-")){const a=r==="OPTION"?n.getAttribute("value")||"":n.value,l=e==null?n.type==="checkbox"?"on":"":String(e);(a!==l||!("_value"in n))&&(n.value=l),e==null&&n.removeAttribute(t),n._value=e;return}let o=!1;if(e===""||e==null){const a=typeof n[t];a==="boolean"?e=Ny(e):e==null&&a==="string"?(e="",o=!0):a==="number"&&(e=0,o=!0)}try{n[t]=e}catch{}o&&n.removeAttribute(i||t)}function Ci(n,t,e,s){n.addEventListener(t,e,s)}function ZE(n,t,e,s){n.removeEventListener(t,e,s)}const Ig=Symbol("_vei");function tI(n,t,e,s,i=null){const r=n[Ig]||(n[Ig]={}),o=r[t];if(s&&o)o.value=s;else{const[a,l]=eI(t);if(s){const c=r[t]=iI(s,i);Ci(n,a,c,l)}else o&&(ZE(n,a,o,l),r[t]=void 0)}}const Sg=/(?:Once|Passive|Capture)$/;function eI(n){let t;if(Sg.test(n)){t={};let s;for(;s=n.match(Sg);)n=n.slice(0,n.length-s[0].length),t[s[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):Hi(n.slice(2)),t]}let ju=0;const nI=Promise.resolve(),sI=()=>ju||(nI.then(()=>ju=0),ju=Date.now());function iI(n,t){const e=s=>{if(!s._vts)s._vts=Date.now();else if(s._vts<=e.attached)return;Wn(rI(s,e.value),t,5,[s])};return e.value=n,e.attached=sI(),e}function rI(n,t){if(mt(t)){const e=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{e.call(n),n._stopped=!0},t.map(s=>i=>!i._stopped&&s&&s(i))}else return t}const Ag=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)>96&&n.charCodeAt(2)<123,oI=(n,t,e,s,i,r)=>{const o=i==="svg";t==="class"?KE(n,s,o):t==="style"?QE(n,e,s):Ic(t)?_d(t)||tI(n,t,e,s,r):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):aI(n,t,s,o))?(Eg(n,t,s),!n.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&Tg(n,t,s,o,r,t!=="value")):n._isVueCE&&(/[A-Z]/.test(t)||!de(s))?Eg(n,mn(t),s,r,t):(t==="true-value"?n._trueValue=s:t==="false-value"&&(n._falseValue=s),Tg(n,t,s,o))};function aI(n,t,e,s){if(s)return!!(t==="innerHTML"||t==="textContent"||t in n&&Ag(t)&&It(e));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="autocorrect"||t==="form"||t==="list"&&n.tagName==="INPUT"||t==="type"&&n.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const i=n.tagName;if(i==="IMG"||i==="VIDEO"||i==="CANVAS"||i==="SOURCE")return!1}return Ag(t)&&de(e)?!1:t in n}const Gl=n=>{const t=n.props["onUpdate:modelValue"]||!1;return mt(t)?e=>yl(t,e):t};function lI(n){n.target.composing=!0}function Cg(n){const t=n.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const pr=Symbol("_assign"),cI={created(n,{modifiers:{lazy:t,trim:e,number:s}},i){n[pr]=Gl(i);const r=s||i.props&&i.props.type==="number";Ci(n,t?"change":"input",o=>{if(o.target.composing)return;let a=n.value;e&&(a=a.trim()),r&&(a=Fl(a)),n[pr](a)}),e&&Ci(n,"change",()=>{n.value=n.value.trim()}),t||(Ci(n,"compositionstart",lI),Ci(n,"compositionend",Cg),Ci(n,"change",Cg))},mounted(n,{value:t}){n.value=t??""},beforeUpdate(n,{value:t,oldValue:e,modifiers:{lazy:s,trim:i,number:r}},o){if(n[pr]=Gl(o),n.composing)return;const a=(r||n.type==="number")&&!/^0\d/.test(n.value)?Fl(n.value):n.value,l=t??"";a!==l&&(document.activeElement===n&&n.type!=="range"&&(s&&t===e||i&&n.value.trim()===l)||(n.value=l))}},Ja={deep:!0,created(n,{value:t,modifiers:{number:e}},s){const i=Sc(t);Ci(n,"change",()=>{const r=Array.prototype.filter.call(n.options,o=>o.selected).map(o=>e?Fl(Kl(o)):Kl(o));n[pr](n.multiple?i?new Set(r):r:r[0]),n._assigning=!0,sb(()=>{n._assigning=!1})}),n[pr]=Gl(s)},mounted(n,{value:t}){Pg(n,t)},beforeUpdate(n,t,e){n[pr]=Gl(e)},updated(n,{value:t}){n._assigning||Pg(n,t)}};function Pg(n,t){const e=n.multiple,s=mt(t);if(!(e&&!s&&!Sc(t))){for(let i=0,r=n.options.length;i<r;i++){const o=n.options[i],a=Kl(o);if(e)if(s){const l=typeof a;l==="string"||l==="number"?o.selected=t.some(c=>String(c)===String(a)):o.selected=nT(t,a)>-1}else o.selected=t.has(a);else if(Rc(Kl(o),t)){n.selectedIndex!==i&&(n.selectedIndex=i);return}}!e&&n.selectedIndex!==-1&&(n.selectedIndex=-1)}}function Kl(n){return"_value"in n?n._value:n.value}const uI=["ctrl","shift","alt","meta"],hI={stop:n=>n.stopPropagation(),prevent:n=>n.preventDefault(),self:n=>n.target!==n.currentTarget,ctrl:n=>!n.ctrlKey,shift:n=>!n.shiftKey,alt:n=>!n.altKey,meta:n=>!n.metaKey,left:n=>"button"in n&&n.button!==0,middle:n=>"button"in n&&n.button!==1,right:n=>"button"in n&&n.button!==2,exact:(n,t)=>uI.some(e=>n[`${e}Key`]&&!t.includes(e))},Ob=(n,t)=>{const e=n._withMods||(n._withMods={}),s=t.join(".");return e[s]||(e[s]=(i,...r)=>{for(let o=0;o<t.length;o++){const a=hI[t[o]];if(a&&a(i,t))return}return n(i,...r)})},dI=Ge({patchProp:oI},qE);let Rg;function fI(){return Rg||(Rg=pE(dI))}const pI=(...n)=>{const t=fI().createApp(...n),{mount:e}=t;return t.mount=s=>{const i=mI(s);if(!i)return;const r=t._component;!It(r)&&!r.render&&!r.template&&(r.template=i.innerHTML),i.nodeType===1&&(i.textContent="");const o=e(i,!1,gI(i));return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),o},t};function gI(n){if(n instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&n instanceof MathMLElement)return"mathml"}function mI(n){return de(n)?document.querySelector(n):n}const _I=()=>{};var kg={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lb=function(n){const t=[];let e=0;for(let s=0;s<n.length;s++){let i=n.charCodeAt(s);i<128?t[e++]=i:i<2048?(t[e++]=i>>6|192,t[e++]=i&63|128):(i&64512)===55296&&s+1<n.length&&(n.charCodeAt(s+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++s)&1023),t[e++]=i>>18|240,t[e++]=i>>12&63|128,t[e++]=i>>6&63|128,t[e++]=i&63|128):(t[e++]=i>>12|224,t[e++]=i>>6&63|128,t[e++]=i&63|128)}return t},yI=function(n){const t=[];let e=0,s=0;for(;e<n.length;){const i=n[e++];if(i<128)t[s++]=String.fromCharCode(i);else if(i>191&&i<224){const r=n[e++];t[s++]=String.fromCharCode((i&31)<<6|r&63)}else if(i>239&&i<365){const r=n[e++],o=n[e++],a=n[e++],l=((i&7)<<18|(r&63)<<12|(o&63)<<6|a&63)-65536;t[s++]=String.fromCharCode(55296+(l>>10)),t[s++]=String.fromCharCode(56320+(l&1023))}else{const r=n[e++],o=n[e++];t[s++]=String.fromCharCode((i&15)<<12|(r&63)<<6|o&63)}}return t.join("")},Vb={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,t){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const e=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let i=0;i<n.length;i+=3){const r=n[i],o=i+1<n.length,a=o?n[i+1]:0,l=i+2<n.length,c=l?n[i+2]:0,h=r>>2,d=(r&3)<<4|a>>4;let f=(a&15)<<2|c>>6,g=c&63;l||(g=64,o||(f=64)),s.push(e[h],e[d],e[f],e[g])}return s.join("")},encodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(n):this.encodeByteArray(Lb(n),t)},decodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(n):yI(this.decodeStringToByteArray(n,t))},decodeStringToByteArray(n,t){this.init_();const e=t?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let i=0;i<n.length;){const r=e[n.charAt(i++)],a=i<n.length?e[n.charAt(i)]:0;++i;const c=i<n.length?e[n.charAt(i)]:64;++i;const d=i<n.length?e[n.charAt(i)]:64;if(++i,r==null||a==null||c==null||d==null)throw new bI;const f=r<<2|a>>4;if(s.push(f),c!==64){const g=a<<4&240|c>>2;if(s.push(g),d!==64){const _=c<<6&192|d;s.push(_)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class bI extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const vI=function(n){const t=Lb(n);return Vb.encodeByteArray(t,!0)},Yl=function(n){return vI(n).replace(/\./g,"")},Nb=function(n){try{return Vb.decodeString(n,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wI(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xI=()=>wI().__FIREBASE_DEFAULTS__,TI=()=>{if(typeof process>"u"||typeof kg>"u")return;const n=kg.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},EI=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=n&&Nb(n[1]);return t&&JSON.parse(t)},Fc=()=>{try{return _I()||xI()||TI()||EI()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Fb=n=>Fc()?.emulatorHosts?.[n],II=n=>{const t=Fb(n);if(!t)return;const e=t.lastIndexOf(":");if(e<=0||e+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const s=parseInt(t.substring(e+1),10);return t[0]==="["?[t.substring(1,e-1),s]:[t.substring(0,e),s]},Bb=()=>Fc()?.config,Ub=n=>Fc()?.[`_${n}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SI{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,s)=>{e?this.reject(e):this.resolve(s),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(e):t(e,s))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dr(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function $b(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AI(n,t){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const e={alg:"none",type:"JWT"},s=t||"demo-project",i=n.iat||0,r=n.sub||n.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${s}`,aud:s,iat:i,exp:i+3600,auth_time:i,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Yl(JSON.stringify(e)),Yl(JSON.stringify(o)),""].join(".")}const ko={};function CI(){const n={prod:[],emulator:[]};for(const t of Object.keys(ko))ko[t]?n.emulator.push(t):n.prod.push(t);return n}function PI(n){let t=document.getElementById(n),e=!1;return t||(t=document.createElement("div"),t.setAttribute("id",n),e=!0),{created:e,element:t}}let Dg=!1;function zb(n,t){if(typeof window>"u"||typeof document>"u"||!Dr(window.location.host)||ko[n]===t||ko[n]||Dg)return;ko[n]=t;function e(f){return`__firebase__banner__${f}`}const s="__firebase__banner",r=CI().prod.length>0;function o(){const f=document.getElementById(s);f&&f.remove()}function a(f){f.style.display="flex",f.style.background="#7faaf0",f.style.position="fixed",f.style.bottom="5px",f.style.left="5px",f.style.padding=".5em",f.style.borderRadius="5px",f.style.alignItems="center"}function l(f,g){f.setAttribute("width","24"),f.setAttribute("id",g),f.setAttribute("height","24"),f.setAttribute("viewBox","0 0 24 24"),f.setAttribute("fill","none"),f.style.marginLeft="-6px"}function c(){const f=document.createElement("span");return f.style.cursor="pointer",f.style.marginLeft="16px",f.style.fontSize="24px",f.innerHTML=" &times;",f.onclick=()=>{Dg=!0,o()},f}function h(f,g){f.setAttribute("id",g),f.innerText="Learn more",f.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",f.setAttribute("target","__blank"),f.style.paddingLeft="5px",f.style.textDecoration="underline"}function d(){const f=PI(s),g=e("text"),_=document.getElementById(g)||document.createElement("span"),b=e("learnmore"),v=document.getElementById(b)||document.createElement("a"),A=e("preprendIcon"),C=document.getElementById(A)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(f.created){const O=f.element;a(O),h(v,b);const k=c();l(C,A),O.append(C,_,v,k),document.body.appendChild(O)}r?(_.innerText="Preview backend disconnected.",C.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(C.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,_.innerText="Preview backend running in this workspace."),_.setAttribute("id",g)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",d):d()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $e(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function RI(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test($e())}function kI(){const n=Fc()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function DI(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function MI(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function OI(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function LI(){const n=$e();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function VI(){return!kI()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function NI(){try{return typeof indexedDB=="object"}catch{return!1}}function FI(){return new Promise((n,t)=>{try{let e=!0;const s="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(s);i.onsuccess=()=>{i.result.close(),e||self.indexedDB.deleteDatabase(s),n(!0)},i.onupgradeneeded=()=>{e=!1},i.onerror=()=>{t(i.error?.message||"")}}catch(e){t(e)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BI="FirebaseError";class xs extends Error{constructor(t,e,s){super(e),this.code=t,this.customData=s,this.name=BI,Object.setPrototypeOf(this,xs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ga.prototype.create)}}class ga{constructor(t,e,s){this.service=t,this.serviceName=e,this.errors=s}create(t,...e){const s=e[0]||{},i=`${this.service}/${t}`,r=this.errors[t],o=r?UI(r,s):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new xs(i,a,s)}}function UI(n,t){return n.replace($I,(e,s)=>{const i=t[s];return i!=null?String(i):`<${s}?>`})}const $I=/\{\$([^}]+)}/g;function zI(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}function Vi(n,t){if(n===t)return!0;const e=Object.keys(n),s=Object.keys(t);for(const i of e){if(!s.includes(i))return!1;const r=n[i],o=t[i];if(Mg(r)&&Mg(o)){if(!Vi(r,o))return!1}else if(r!==o)return!1}for(const i of s)if(!e.includes(i))return!1;return!0}function Mg(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ma(n){const t=[];for(const[e,s]of Object.entries(n))Array.isArray(s)?s.forEach(i=>{t.push(encodeURIComponent(e)+"="+encodeURIComponent(i))}):t.push(encodeURIComponent(e)+"="+encodeURIComponent(s));return t.length?"&"+t.join("&"):""}function jI(n,t){const e=new HI(n,t);return e.subscribe.bind(e)}class HI{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(()=>{t(this)}).catch(s=>{this.error(s)})}next(t){this.forEachObserver(e=>{e.next(t)})}error(t){this.forEachObserver(e=>{e.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,e,s){let i;if(t===void 0&&e===void 0&&s===void 0)throw new Error("Missing Observer.");WI(t,["next","error","complete"])?i=t:i={next:t,error:e,complete:s},i.next===void 0&&(i.next=Hu),i.error===void 0&&(i.error=Hu),i.complete===void 0&&(i.complete=Hu);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),r}unsubscribeOne(t){this.observers===void 0||this.observers[t]===void 0||(delete this.observers[t],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then(()=>{if(this.observers!==void 0&&this.observers[t]!==void 0)try{e(this.observers[t])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(t){this.finalized||(this.finalized=!0,t!==void 0&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function WI(n,t){if(typeof n!="object"||n===null)return!1;for(const e of t)if(e in n&&typeof n[e]=="function")return!0;return!1}function Hu(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ye(n){return n&&n._delegate?n._delegate:n}class Ni{constructor(t,e,s){this.name=t,this.instanceFactory=e,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ii="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qI{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const s=new SI;if(this.instancesDeferred.set(e,s),this.isInitialized(e)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:e});i&&s.resolve(i)}catch{}}return this.instancesDeferred.get(e).promise}getImmediate(t){const e=this.normalizeInstanceIdentifier(t?.identifier),s=t?.optional??!1;if(this.isInitialized(e)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:e})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(KI(t))try{this.getOrInitializeService({instanceIdentifier:Ii})}catch{}for(const[e,s]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(e);try{const r=this.getOrInitializeService({instanceIdentifier:i});s.resolve(r)}catch{}}}}clearInstance(t=Ii){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...t.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=Ii){return this.instances.has(t)}getOptions(t=Ii){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,s=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:s,options:e});for(const[r,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);s===a&&o.resolve(i)}return i}onInit(t,e){const s=this.normalizeInstanceIdentifier(e),i=this.onInitCallbacks.get(s)??new Set;i.add(t),this.onInitCallbacks.set(s,i);const r=this.instances.get(s);return r&&t(r,s),()=>{i.delete(t)}}invokeOnInitCallbacks(t,e){const s=this.onInitCallbacks.get(e);if(s)for(const i of s)try{i(t,e)}catch{}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let s=this.instances.get(t);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:GI(t),options:e}),this.instances.set(t,s),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(s,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,s)}catch{}return s||null}normalizeInstanceIdentifier(t=Ii){return this.component?this.component.multipleInstances?t:Ii:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function GI(n){return n===Ii?void 0:n}function KI(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YI{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new qI(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Pt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Pt||(Pt={}));const XI={debug:Pt.DEBUG,verbose:Pt.VERBOSE,info:Pt.INFO,warn:Pt.WARN,error:Pt.ERROR,silent:Pt.SILENT},QI=Pt.INFO,JI={[Pt.DEBUG]:"log",[Pt.VERBOSE]:"log",[Pt.INFO]:"info",[Pt.WARN]:"warn",[Pt.ERROR]:"error"},ZI=(n,t,...e)=>{if(t<n.logLevel)return;const s=new Date().toISOString(),i=JI[t];if(i)console[i](`[${s}]  ${n.name}:`,...e);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class Od{constructor(t){this.name=t,this._logLevel=QI,this._logHandler=ZI,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Pt))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?XI[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,Pt.DEBUG,...t),this._logHandler(this,Pt.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,Pt.VERBOSE,...t),this._logHandler(this,Pt.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,Pt.INFO,...t),this._logHandler(this,Pt.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,Pt.WARN,...t),this._logHandler(this,Pt.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,Pt.ERROR,...t),this._logHandler(this,Pt.ERROR,...t)}}const tS=(n,t)=>t.some(e=>n instanceof e);let Og,Lg;function eS(){return Og||(Og=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function nS(){return Lg||(Lg=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const jb=new WeakMap,Rh=new WeakMap,Hb=new WeakMap,Wu=new WeakMap,Ld=new WeakMap;function sS(n){const t=new Promise((e,s)=>{const i=()=>{n.removeEventListener("success",r),n.removeEventListener("error",o)},r=()=>{e(Ws(n.result)),i()},o=()=>{s(n.error),i()};n.addEventListener("success",r),n.addEventListener("error",o)});return t.then(e=>{e instanceof IDBCursor&&jb.set(e,n)}).catch(()=>{}),Ld.set(t,n),t}function iS(n){if(Rh.has(n))return;const t=new Promise((e,s)=>{const i=()=>{n.removeEventListener("complete",r),n.removeEventListener("error",o),n.removeEventListener("abort",o)},r=()=>{e(),i()},o=()=>{s(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",r),n.addEventListener("error",o),n.addEventListener("abort",o)});Rh.set(n,t)}let kh={get(n,t,e){if(n instanceof IDBTransaction){if(t==="done")return Rh.get(n);if(t==="objectStoreNames")return n.objectStoreNames||Hb.get(n);if(t==="store")return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return Ws(n[t])},set(n,t,e){return n[t]=e,!0},has(n,t){return n instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in n}};function rS(n){kh=n(kh)}function oS(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...e){const s=n.call(qu(this),t,...e);return Hb.set(s,t.sort?t.sort():[t]),Ws(s)}:nS().includes(n)?function(...t){return n.apply(qu(this),t),Ws(jb.get(this))}:function(...t){return Ws(n.apply(qu(this),t))}}function aS(n){return typeof n=="function"?oS(n):(n instanceof IDBTransaction&&iS(n),tS(n,eS())?new Proxy(n,kh):n)}function Ws(n){if(n instanceof IDBRequest)return sS(n);if(Wu.has(n))return Wu.get(n);const t=aS(n);return t!==n&&(Wu.set(n,t),Ld.set(t,n)),t}const qu=n=>Ld.get(n);function lS(n,t,{blocked:e,upgrade:s,blocking:i,terminated:r}={}){const o=indexedDB.open(n,t),a=Ws(o);return s&&o.addEventListener("upgradeneeded",l=>{s(Ws(o.result),l.oldVersion,l.newVersion,Ws(o.transaction),l)}),e&&o.addEventListener("blocked",l=>e(l.oldVersion,l.newVersion,l)),a.then(l=>{r&&l.addEventListener("close",()=>r()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const cS=["get","getKey","getAll","getAllKeys","count"],uS=["put","add","delete","clear"],Gu=new Map;function Vg(n,t){if(!(n instanceof IDBDatabase&&!(t in n)&&typeof t=="string"))return;if(Gu.get(t))return Gu.get(t);const e=t.replace(/FromIndex$/,""),s=t!==e,i=uS.includes(e);if(!(e in(s?IDBIndex:IDBObjectStore).prototype)||!(i||cS.includes(e)))return;const r=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let c=l.store;return s&&(c=c.index(a.shift())),(await Promise.all([c[e](...a),i&&l.done]))[0]};return Gu.set(t,r),r}rS(n=>({...n,get:(t,e,s)=>Vg(t,e)||n.get(t,e,s),has:(t,e)=>!!Vg(t,e)||n.has(t,e)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hS{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(dS(e)){const s=e.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(e=>e).join(" ")}}function dS(n){return n.getComponent()?.type==="VERSION"}const Dh="@firebase/app",Ng="0.14.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gs=new Od("@firebase/app"),fS="@firebase/app-compat",pS="@firebase/analytics-compat",gS="@firebase/analytics",mS="@firebase/app-check-compat",_S="@firebase/app-check",yS="@firebase/auth",bS="@firebase/auth-compat",vS="@firebase/database",wS="@firebase/data-connect",xS="@firebase/database-compat",TS="@firebase/functions",ES="@firebase/functions-compat",IS="@firebase/installations",SS="@firebase/installations-compat",AS="@firebase/messaging",CS="@firebase/messaging-compat",PS="@firebase/performance",RS="@firebase/performance-compat",kS="@firebase/remote-config",DS="@firebase/remote-config-compat",MS="@firebase/storage",OS="@firebase/storage-compat",LS="@firebase/firestore",VS="@firebase/ai",NS="@firebase/firestore-compat",FS="firebase",BS="12.0.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mh="[DEFAULT]",US={[Dh]:"fire-core",[fS]:"fire-core-compat",[gS]:"fire-analytics",[pS]:"fire-analytics-compat",[_S]:"fire-app-check",[mS]:"fire-app-check-compat",[yS]:"fire-auth",[bS]:"fire-auth-compat",[vS]:"fire-rtdb",[wS]:"fire-data-connect",[xS]:"fire-rtdb-compat",[TS]:"fire-fn",[ES]:"fire-fn-compat",[IS]:"fire-iid",[SS]:"fire-iid-compat",[AS]:"fire-fcm",[CS]:"fire-fcm-compat",[PS]:"fire-perf",[RS]:"fire-perf-compat",[kS]:"fire-rc",[DS]:"fire-rc-compat",[MS]:"fire-gcs",[OS]:"fire-gcs-compat",[LS]:"fire-fst",[NS]:"fire-fst-compat",[VS]:"fire-vertex","fire-js":"fire-js",[FS]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xl=new Map,$S=new Map,Oh=new Map;function Fg(n,t){try{n.container.addComponent(t)}catch(e){gs.debug(`Component ${t.name} failed to register with FirebaseApp ${n.name}`,e)}}function wr(n){const t=n.name;if(Oh.has(t))return gs.debug(`There were multiple attempts to register component ${t}.`),!1;Oh.set(t,n);for(const e of Xl.values())Fg(e,n);for(const e of $S.values())Fg(e,n);return!0}function Vd(n,t){const e=n.container.getProvider("heartbeat").getImmediate({optional:!0});return e&&e.triggerHeartbeat(),n.container.getProvider(t)}function dn(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zS={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},qs=new ga("app","Firebase",zS);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jS{constructor(t,e,s){this._isDeleted=!1,this._options={...t},this._config={...e},this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new Ni("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw qs.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mr=BS;function Wb(n,t={}){let e=n;typeof t!="object"&&(t={name:t});const s={name:Mh,automaticDataCollectionEnabled:!0,...t},i=s.name;if(typeof i!="string"||!i)throw qs.create("bad-app-name",{appName:String(i)});if(e||(e=Bb()),!e)throw qs.create("no-options");const r=Xl.get(i);if(r){if(Vi(e,r.options)&&Vi(s,r.config))return r;throw qs.create("duplicate-app",{appName:i})}const o=new YI(i);for(const l of Oh.values())o.addComponent(l);const a=new jS(e,s,o);return Xl.set(i,a),a}function qb(n=Mh){const t=Xl.get(n);if(!t&&n===Mh&&Bb())return Wb();if(!t)throw qs.create("no-app",{appName:n});return t}function Gs(n,t,e){let s=US[n]??n;e&&(s+=`-${e}`);const i=s.match(/\s|\//),r=t.match(/\s|\//);if(i||r){const o=[`Unable to register library "${s}" with version "${t}":`];i&&o.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&r&&o.push("and"),r&&o.push(`version name "${t}" contains illegal characters (whitespace or "/")`),gs.warn(o.join(" "));return}wr(new Ni(`${s}-version`,()=>({library:s,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HS="firebase-heartbeat-database",WS=1,Ko="firebase-heartbeat-store";let Ku=null;function Gb(){return Ku||(Ku=lS(HS,WS,{upgrade:(n,t)=>{switch(t){case 0:try{n.createObjectStore(Ko)}catch(e){console.warn(e)}}}}).catch(n=>{throw qs.create("idb-open",{originalErrorMessage:n.message})})),Ku}async function qS(n){try{const e=(await Gb()).transaction(Ko),s=await e.objectStore(Ko).get(Kb(n));return await e.done,s}catch(t){if(t instanceof xs)gs.warn(t.message);else{const e=qs.create("idb-get",{originalErrorMessage:t?.message});gs.warn(e.message)}}}async function Bg(n,t){try{const s=(await Gb()).transaction(Ko,"readwrite");await s.objectStore(Ko).put(t,Kb(n)),await s.done}catch(e){if(e instanceof xs)gs.warn(e.message);else{const s=qs.create("idb-set",{originalErrorMessage:e?.message});gs.warn(s.message)}}}function Kb(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GS=1024,KS=30;class YS{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new QS(e),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){try{const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Ug();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(i=>i.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:e}),this._heartbeatsCache.heartbeats.length>KS){const i=JS(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(t){gs.warn(t)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Ug(),{heartbeatsToSend:e,unsentEntries:s}=XS(this._heartbeatsCache.heartbeats),i=Yl(JSON.stringify({version:2,heartbeats:e}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return gs.warn(t),""}}}function Ug(){return new Date().toISOString().substring(0,10)}function XS(n,t=GS){const e=[];let s=n.slice();for(const i of n){const r=e.find(o=>o.agent===i.agent);if(r){if(r.dates.push(i.date),$g(e)>t){r.dates.pop();break}}else if(e.push({agent:i.agent,dates:[i.date]}),$g(e)>t){e.pop();break}s=s.slice(1)}return{heartbeatsToSend:e,unsentEntries:s}}class QS{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return NI()?FI().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const e=await qS(this.app);return e?.heartbeats?e:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){if(await this._canUseIndexedDBPromise){const s=await this.read();return Bg(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){if(await this._canUseIndexedDBPromise){const s=await this.read();return Bg(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...t.heartbeats]})}else return}}function $g(n){return Yl(JSON.stringify({version:2,heartbeats:n})).length}function JS(n){if(n.length===0)return-1;let t=0,e=n[0].date;for(let s=1;s<n.length;s++)n[s].date<e&&(e=n[s].date,t=s);return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZS(n){wr(new Ni("platform-logger",t=>new hS(t),"PRIVATE")),wr(new Ni("heartbeat",t=>new YS(t),"PRIVATE")),Gs(Dh,Ng,n),Gs(Dh,Ng,"esm2020"),Gs("fire-js","")}ZS("");function Yb(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const tA=Yb,Xb=new ga("auth","Firebase",Yb());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ql=new Od("@firebase/auth");function eA(n,...t){Ql.logLevel<=Pt.WARN&&Ql.warn(`Auth (${Mr}): ${n}`,...t)}function Tl(n,...t){Ql.logLevel<=Pt.ERROR&&Ql.error(`Auth (${Mr}): ${n}`,...t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qn(n,...t){throw Fd(n,...t)}function En(n,...t){return Fd(n,...t)}function Nd(n,t,e){const s={...tA(),[t]:e};return new ga("auth","Firebase",s).create(t,{appName:n.name})}function Ks(n){return Nd(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Qb(n,t,e){const s=e;if(!(t instanceof s))throw s.name!==t.constructor.name&&qn(n,"argument-error"),Nd(n,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Fd(n,...t){if(typeof n!="string"){const e=t[0],s=[...t.slice(1)];return s[0]&&(s[0].appName=n.name),n._errorFactory.create(e,...s)}return Xb.create(n,...t)}function yt(n,t,...e){if(!n)throw Fd(t,...e)}function as(n){const t="INTERNAL ASSERTION FAILED: "+n;throw Tl(t),new Error(t)}function ms(n,t){n||as(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lh(){return typeof self<"u"&&self.location?.href||""}function nA(){return zg()==="http:"||zg()==="https:"}function zg(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sA(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(nA()||MI()||"connection"in navigator)?navigator.onLine:!0}function iA(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _a{constructor(t,e){this.shortDelay=t,this.longDelay=e,ms(e>t,"Short delay should be less than long delay!"),this.isMobile=RI()||OI()}get(){return sA()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bd(n,t){ms(n.emulator,"Emulator should always be set here");const{url:e}=n.emulator;return t?`${e}${t.startsWith("/")?t.slice(1):t}`:e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jb{static initialize(t,e,s){this.fetchImpl=t,e&&(this.headersImpl=e),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;as("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;as("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;as("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rA={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oA=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],aA=new _a(3e4,6e4);function Bc(n,t){return n.tenantId&&!t.tenantId?{...t,tenantId:n.tenantId}:t}async function Or(n,t,e,s,i={}){return Zb(n,i,async()=>{let r={},o={};s&&(t==="GET"?o=s:r={body:JSON.stringify(s)});const a=ma({key:n.config.apiKey,...o}).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const c={method:t,headers:l,...r};return DI()||(c.referrerPolicy="no-referrer"),n.emulatorConfig&&Dr(n.emulatorConfig.host)&&(c.credentials="include"),Jb.fetch()(await ev(n,n.config.apiHost,e,a),c)})}async function Zb(n,t,e){n._canInitEmulator=!1;const s={...rA,...t};try{const i=new lA(n),r=await Promise.race([e(),i.promise]);i.clearNetworkTimeout();const o=await r.json();if("needConfirmation"in o)throw Za(n,"account-exists-with-different-credential",o);if(r.ok&&!("errorMessage"in o))return o;{const a=r.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Za(n,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Za(n,"email-already-in-use",o);if(l==="USER_DISABLED")throw Za(n,"user-disabled",o);const h=s[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw Nd(n,h,c);qn(n,h)}}catch(i){if(i instanceof xs)throw i;qn(n,"network-request-failed",{message:String(i)})}}async function tv(n,t,e,s,i={}){const r=await Or(n,t,e,s,i);return"mfaPendingCredential"in r&&qn(n,"multi-factor-auth-required",{_serverResponse:r}),r}async function ev(n,t,e,s){const i=`${t}${e}?${s}`,r=n,o=r.config.emulator?Bd(n.config,i):`${n.config.apiScheme}://${i}`;return oA.includes(e)&&(await r._persistenceManagerAvailable,r._getPersistenceType()==="COOKIE")?r._getPersistence()._getFinalTarget(o).toString():o}class lA{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((e,s)=>{this.timer=setTimeout(()=>s(En(this.auth,"network-request-failed")),aA.get())})}}function Za(n,t,e){const s={appName:n.name};e.email&&(s.email=e.email),e.phoneNumber&&(s.phoneNumber=e.phoneNumber);const i=En(n,t,s);return i.customData._tokenResponse=e,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cA(n,t){return Or(n,"POST","/v1/accounts:delete",t)}async function Jl(n,t){return Or(n,"POST","/v1/accounts:lookup",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Do(n){if(n)try{const t=new Date(Number(n));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}async function uA(n,t=!1){const e=ye(n),s=await e.getIdToken(t),i=Ud(s);yt(i&&i.exp&&i.auth_time&&i.iat,e.auth,"internal-error");const r=typeof i.firebase=="object"?i.firebase:void 0,o=r?.sign_in_provider;return{claims:i,token:s,authTime:Do(Yu(i.auth_time)),issuedAtTime:Do(Yu(i.iat)),expirationTime:Do(Yu(i.exp)),signInProvider:o||null,signInSecondFactor:r?.sign_in_second_factor||null}}function Yu(n){return Number(n)*1e3}function Ud(n){const[t,e,s]=n.split(".");if(t===void 0||e===void 0||s===void 0)return Tl("JWT malformed, contained fewer than 3 sections"),null;try{const i=Nb(e);return i?JSON.parse(i):(Tl("Failed to decode base64 JWT payload"),null)}catch(i){return Tl("Caught error parsing JWT payload as JSON",i?.toString()),null}}function jg(n){const t=Ud(n);return yt(t,"internal-error"),yt(typeof t.exp<"u","internal-error"),yt(typeof t.iat<"u","internal-error"),Number(t.exp)-Number(t.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yo(n,t,e=!1){if(e)return t;try{return await t}catch(s){throw s instanceof xs&&hA(s)&&n.auth.currentUser===n&&await n.auth.signOut(),s}}function hA({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dA{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(t){if(t){const e=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),e}else{this.errorBackoff=3e4;const s=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,s)}}schedule(t=!1){if(!this.isRunning)return;const e=this.getInterval(t);this.timerId=setTimeout(async()=>{await this.iteration()},e)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){t?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vh{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=Do(this.lastLoginAt),this.creationTime=Do(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zl(n){const t=n.auth,e=await n.getIdToken(),s=await Yo(n,Jl(t,{idToken:e}));yt(s?.users.length,t,"internal-error");const i=s.users[0];n._notifyReloadListener(i);const r=i.providerUserInfo?.length?nv(i.providerUserInfo):[],o=pA(n.providerData,r),a=n.isAnonymous,l=!(n.email&&i.passwordHash)&&!o?.length,c=a?l:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Vh(i.createdAt,i.lastLoginAt),isAnonymous:c};Object.assign(n,h)}async function fA(n){const t=ye(n);await Zl(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function pA(n,t){return[...n.filter(s=>!t.some(i=>i.providerId===s.providerId)),...t]}function nv(n){return n.map(({providerId:t,...e})=>({providerId:t,uid:e.rawId||"",displayName:e.displayName||null,email:e.email||null,phoneNumber:e.phoneNumber||null,photoURL:e.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gA(n,t){const e=await Zb(n,{},async()=>{const s=ma({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:i,apiKey:r}=n.config,o=await ev(n,i,"/v1/token",`key=${r}`),a=await n._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:s};return n.emulatorConfig&&Dr(n.emulatorConfig.host)&&(l.credentials="include"),Jb.fetch()(o,l)});return{accessToken:e.access_token,expiresIn:e.expires_in,refreshToken:e.refresh_token}}async function mA(n,t){return Or(n,"POST","/v2/accounts:revokeToken",Bc(n,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gr{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){yt(t.idToken,"internal-error"),yt(typeof t.idToken<"u","internal-error"),yt(typeof t.refreshToken<"u","internal-error");const e="expiresIn"in t&&typeof t.expiresIn<"u"?Number(t.expiresIn):jg(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}updateFromIdToken(t){yt(t.length!==0,"internal-error");const e=jg(t);this.updateTokensAndExpiration(t,null,e)}async getToken(t,e=!1){return!e&&this.accessToken&&!this.isExpired?this.accessToken:(yt(this.refreshToken,t,"user-token-expired"),this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(t,e){const{accessToken:s,refreshToken:i,expiresIn:r}=await gA(t,e);this.updateTokensAndExpiration(s,i,Number(r))}updateTokensAndExpiration(t,e,s){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(t,e){const{refreshToken:s,accessToken:i,expirationTime:r}=e,o=new gr;return s&&(yt(typeof s=="string","internal-error",{appName:t}),o.refreshToken=s),i&&(yt(typeof i=="string","internal-error",{appName:t}),o.accessToken=i),r&&(yt(typeof r=="number","internal-error",{appName:t}),o.expirationTime=r),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new gr,this.toJSON())}_performRefresh(){return as("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ps(n,t){yt(typeof n=="string"||typeof n>"u","internal-error",{appName:t})}class wn{constructor({uid:t,auth:e,stsTokenManager:s,...i}){this.providerId="firebase",this.proactiveRefresh=new dA(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=e,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Vh(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(t){const e=await Yo(this,this.stsTokenManager.getToken(this.auth,t));return yt(e,this.auth,"internal-error"),this.accessToken!==e&&(this.accessToken=e,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),e}getIdTokenResult(t){return uA(this,t)}reload(){return fA(this)}_assign(t){this!==t&&(yt(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(e=>({...e})),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const e=new wn({...this,auth:t,stsTokenManager:this.stsTokenManager._clone()});return e.metadata._copy(this.metadata),e}_onReload(t){yt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,e=!1){let s=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),s=!0),e&&await Zl(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(dn(this.auth.app))return Promise.reject(Ks(this.auth));const t=await this.getIdToken();return await Yo(this,cA(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>({...t})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){const s=e.displayName??void 0,i=e.email??void 0,r=e.phoneNumber??void 0,o=e.photoURL??void 0,a=e.tenantId??void 0,l=e._redirectEventId??void 0,c=e.createdAt??void 0,h=e.lastLoginAt??void 0,{uid:d,emailVerified:f,isAnonymous:g,providerData:_,stsTokenManager:b}=e;yt(d&&b,t,"internal-error");const v=gr.fromJSON(this.name,b);yt(typeof d=="string",t,"internal-error"),Ps(s,t.name),Ps(i,t.name),yt(typeof f=="boolean",t,"internal-error"),yt(typeof g=="boolean",t,"internal-error"),Ps(r,t.name),Ps(o,t.name),Ps(a,t.name),Ps(l,t.name),Ps(c,t.name),Ps(h,t.name);const A=new wn({uid:d,auth:t,email:i,emailVerified:f,displayName:s,isAnonymous:g,photoURL:o,phoneNumber:r,tenantId:a,stsTokenManager:v,createdAt:c,lastLoginAt:h});return _&&Array.isArray(_)&&(A.providerData=_.map(C=>({...C}))),l&&(A._redirectEventId=l),A}static async _fromIdTokenResponse(t,e,s=!1){const i=new gr;i.updateFromServerResponse(e);const r=new wn({uid:e.localId,auth:t,stsTokenManager:i,isAnonymous:s});return await Zl(r),r}static async _fromGetAccountInfoResponse(t,e,s){const i=e.users[0];yt(i.localId!==void 0,"internal-error");const r=i.providerUserInfo!==void 0?nv(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!r?.length,a=new gr;a.updateFromIdToken(s);const l=new wn({uid:i.localId,auth:t,stsTokenManager:a,isAnonymous:o}),c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:r,metadata:new Vh(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!r?.length};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hg=new Map;function ls(n){ms(n instanceof Function,"Expected a class definition");let t=Hg.get(n);return t?(ms(t instanceof n,"Instance stored in cache mismatched with class"),t):(t=new n,Hg.set(n,t),t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sv{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,e){this.storage[t]=e}async _get(t){const e=this.storage[t];return e===void 0?null:e}async _remove(t){delete this.storage[t]}_addListener(t,e){}_removeListener(t,e){}}sv.type="NONE";const Wg=sv;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function El(n,t,e){return`firebase:${n}:${t}:${e}`}class mr{constructor(t,e,s){this.persistence=t,this.auth=e,this.userKey=s;const{config:i,name:r}=this.auth;this.fullUserKey=El(this.userKey,i.apiKey,r),this.fullPersistenceKey=El("persistence",i.apiKey,r),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);if(!t)return null;if(typeof t=="string"){const e=await Jl(this.auth,{idToken:t}).catch(()=>{});return e?wn._fromGetAccountInfoResponse(this.auth,e,t):null}return wn._fromJSON(this.auth,t)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const e=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=t,e)return this.setCurrentUser(e)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,e,s="authUser"){if(!e.length)return new mr(ls(Wg),t,s);const i=(await Promise.all(e.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let r=i[0]||ls(Wg);const o=El(s,t.config.apiKey,t.name);let a=null;for(const c of e)try{const h=await c._get(o);if(h){let d;if(typeof h=="string"){const f=await Jl(t,{idToken:h}).catch(()=>{});if(!f)break;d=await wn._fromGetAccountInfoResponse(t,f,h)}else d=wn._fromJSON(t,h);c!==r&&(a=d),r=c;break}}catch{}const l=i.filter(c=>c._shouldAllowMigration);return!r._shouldAllowMigration||!l.length?new mr(r,t,s):(r=l[0],a&&await r._set(o,a.toJSON()),await Promise.all(e.map(async c=>{if(c!==r)try{await c._remove(o)}catch{}})),new mr(r,t,s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qg(n){const t=n.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(av(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(iv(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(cv(t))return"Blackberry";if(uv(t))return"Webos";if(rv(t))return"Safari";if((t.includes("chrome/")||ov(t))&&!t.includes("edge/"))return"Chrome";if(lv(t))return"Android";{const e=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=n.match(e);if(s?.length===2)return s[1]}return"Other"}function iv(n=$e()){return/firefox\//i.test(n)}function rv(n=$e()){const t=n.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function ov(n=$e()){return/crios\//i.test(n)}function av(n=$e()){return/iemobile/i.test(n)}function lv(n=$e()){return/android/i.test(n)}function cv(n=$e()){return/blackberry/i.test(n)}function uv(n=$e()){return/webos/i.test(n)}function $d(n=$e()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function _A(n=$e()){return $d(n)&&!!window.navigator?.standalone}function yA(){return LI()&&document.documentMode===10}function hv(n=$e()){return $d(n)||lv(n)||uv(n)||cv(n)||/windows phone/i.test(n)||av(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dv(n,t=[]){let e;switch(n){case"Browser":e=qg($e());break;case"Worker":e=`${qg($e())}-${n}`;break;default:e=n}const s=t.length?t.join(","):"FirebaseCore-web";return`${e}/JsCore/${Mr}/${s}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bA{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,e){const s=r=>new Promise((o,a)=>{try{const l=t(r);o(l)}catch(l){a(l)}});s.onAbort=e,this.queue.push(s);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const e=[];try{for(const s of this.queue)await s(t),s.onAbort&&e.push(s.onAbort)}catch(s){e.reverse();for(const i of e)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vA(n,t={}){return Or(n,"GET","/v2/passwordPolicy",Bc(n,t))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wA=6;class xA{constructor(t){const e=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=e.minPasswordLength??wA,e.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=e.maxPasswordLength),e.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=e.containsLowercaseCharacter),e.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=e.containsUppercaseCharacter),e.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=e.containsNumericCharacter),e.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=e.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=t.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=t.forceUpgradeOnSignin??!1,this.schemaVersion=t.schemaVersion}validatePassword(t){const e={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,e),this.validatePasswordCharacterOptions(t,e),e.isValid&&(e.isValid=e.meetsMinPasswordLength??!0),e.isValid&&(e.isValid=e.meetsMaxPasswordLength??!0),e.isValid&&(e.isValid=e.containsLowercaseLetter??!0),e.isValid&&(e.isValid=e.containsUppercaseLetter??!0),e.isValid&&(e.isValid=e.containsNumericCharacter??!0),e.isValid&&(e.isValid=e.containsNonAlphanumericCharacter??!0),e}validatePasswordLengthOptions(t,e){const s=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;s&&(e.meetsMinPasswordLength=t.length>=s),i&&(e.meetsMaxPasswordLength=t.length<=i)}validatePasswordCharacterOptions(t,e){this.updatePasswordCharacterOptionsStatuses(e,!1,!1,!1,!1);let s;for(let i=0;i<t.length;i++)s=t.charAt(i),this.updatePasswordCharacterOptionsStatuses(e,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(t,e,s,i,r){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=e)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TA{constructor(t,e,s,i){this.app=t,this.heartbeatServiceProvider=e,this.appCheckServiceProvider=s,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Gg(this),this.idTokenSubscription=new Gg(this),this.beforeStateQueue=new bA(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Xb,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(r=>this._resolvePersistenceManagerAvailable=r)}_initializeWithPersistence(t,e){return e&&(this._popupRedirectResolver=ls(e)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await mr.create(this,t),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(e),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!t)){if(this.currentUser&&t&&this.currentUser.uid===t.uid){this._currentUser._assign(t),await this.currentUser.getIdToken();return}await this._updateCurrentUser(t,!0)}}async initializeCurrentUserFromIdToken(t){try{const e=await Jl(this,{idToken:t}),s=await wn._fromGetAccountInfoResponse(this,e,t);await this.directlySetCurrentUser(s)}catch(e){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",e),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(t){if(dn(this.app)){const r=this.app.settings.authIdToken;return r?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(r).then(o,o))}):this.directlySetCurrentUser(null)}const e=await this.assertedPersistence.getCurrentUser();let s=e,i=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const r=this.redirectUser?._redirectEventId,o=s?._redirectEventId,a=await this.tryRedirectSignIn(t);(!r||r===o)&&a?.user&&(s=a.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(r){s=e,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(r))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return yt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(t){let e=null;try{e=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch{await this._setRedirectUser(null)}return e}async reloadAndSetCurrentUserOrClear(t){try{await Zl(t)}catch(e){if(e?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=iA()}async _delete(){this._deleted=!0}async updateCurrentUser(t){if(dn(this.app))return Promise.reject(Ks(this));const e=t?ye(t):null;return e&&yt(e.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(e&&e._clone(this))}async _updateCurrentUser(t,e=!1){if(!this._deleted)return t&&yt(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),e||await this.beforeStateQueue.runMiddleware(t),this.queue(async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()})}async signOut(){return dn(this.app)?Promise.reject(Ks(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(t){return dn(this.app)?Promise.reject(Ks(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ls(t))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const e=this._getPasswordPolicyInternal();return e.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):e.validatePassword(t)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await vA(this),e=new xA(t);this.tenantId===null?this._projectPasswordPolicy=e:this._tenantPasswordPolicies[this.tenantId]=e}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(t){this._errorFactory=new ga("auth","Firebase",t())}onAuthStateChanged(t,e,s){return this.registerStateListener(this.authStateSubscription,t,e,s)}beforeAuthStateChanged(t,e){return this.beforeStateQueue.pushCallback(t,e)}onIdTokenChanged(t,e,s){return this.registerStateListener(this.idTokenSubscription,t,e,s)}authStateReady(){return new Promise((t,e)=>{if(this.currentUser)t();else{const s=this.onAuthStateChanged(()=>{s(),t()},e)}})}async revokeAccessToken(t){if(this.currentUser){const e=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:e};this.tenantId!=null&&(s.tenantId=this.tenantId),await mA(this,s)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(t,e){const s=await this.getOrInitRedirectPersistenceManager(e);return t===null?s.removeCurrentUser():s.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const e=t&&ls(t)||this._popupRedirectResolver;yt(e,this,"argument-error"),this.redirectPersistenceManager=await mr.create(this,[ls(e._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===t?this._currentUser:this.redirectUser?._redirectEventId===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(t))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const t=this.currentUser?.uid??null;this.lastNotifiedUid!==t&&(this.lastNotifiedUid=t,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,s,i){if(this._deleted)return()=>{};const r=typeof e=="function"?e:e.next.bind(e);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(yt(a,this,"internal-error"),a.then(()=>{o||r(this.currentUser)}),typeof e=="function"){const l=t.addObserver(e,s,i);return()=>{o=!0,l()}}else{const l=t.addObserver(e);return()=>{o=!0,l()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return yt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){!t||this.frameworks.includes(t)||(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=dv(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const e=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();e&&(t["X-Firebase-Client"]=e);const s=await this._getAppCheckToken();return s&&(t["X-Firebase-AppCheck"]=s),t}async _getAppCheckToken(){if(dn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return t?.error&&eA(`Error while retrieving App Check token: ${t.error}`),t?.token}}function ya(n){return ye(n)}class Gg{constructor(t){this.auth=t,this.observer=null,this.addObserver=jI(e=>this.observer=e)}get next(){return yt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let zd={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function EA(n){zd=n}function IA(n){return zd.loadJS(n)}function SA(){return zd.gapiScript}function AA(n){return`__${n}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CA(n,t){const e=Vd(n,"auth");if(e.isInitialized()){const i=e.getImmediate(),r=e.getOptions();if(Vi(r,t??{}))return i;qn(i,"already-initialized")}return e.initialize({options:t})}function PA(n,t){const e=t?.persistence||[],s=(Array.isArray(e)?e:[e]).map(ls);t?.errorMap&&n._updateErrorMap(t.errorMap),n._initializeWithPersistence(s,t?.popupRedirectResolver)}function RA(n,t,e){const s=ya(n);yt(/^https?:\/\//.test(t),s,"invalid-emulator-scheme");const i=!1,r=fv(t),{host:o,port:a}=kA(t),l=a===null?"":`:${a}`,c={url:`${r}//${o}${l}/`},h=Object.freeze({host:o,port:a,protocol:r.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!s._canInitEmulator){yt(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),yt(Vi(c,s.config.emulator)&&Vi(h,s.emulatorConfig),s,"emulator-config-failed");return}s.config.emulator=c,s.emulatorConfig=h,s.settings.appVerificationDisabledForTesting=!0,Dr(o)?($b(`${r}//${o}${l}`),zb("Auth",!0)):DA()}function fv(n){const t=n.indexOf(":");return t<0?"":n.substr(0,t+1)}function kA(n){const t=fv(n),e=/(\/\/)?([^?#/]+)/.exec(n.substr(t.length));if(!e)return{host:"",port:null};const s=e[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(s);if(i){const r=i[1];return{host:r,port:Kg(s.substr(r.length+1))}}else{const[r,o]=s.split(":");return{host:r,port:Kg(o)}}}function Kg(n){if(!n)return null;const t=Number(n);return isNaN(t)?null:t}function DA(){function n(){const t=document.createElement("p"),e=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#b50000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pv{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return as("not implemented")}_getIdTokenResponse(t){return as("not implemented")}_linkToIdToken(t,e){return as("not implemented")}_getReauthenticationResolver(t){return as("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _r(n,t){return tv(n,"POST","/v1/accounts:signInWithIdp",Bc(n,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MA="http://localhost";class Fi extends pv{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new Fi(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):qn("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e=typeof t=="string"?JSON.parse(t):t,{providerId:s,signInMethod:i,...r}=e;if(!s||!i)return null;const o=new Fi(s,i);return o.idToken=r.idToken||void 0,o.accessToken=r.accessToken||void 0,o.secret=r.secret,o.nonce=r.nonce,o.pendingToken=r.pendingToken||null,o}_getIdTokenResponse(t){const e=this.buildRequest();return _r(t,e)}_linkToIdToken(t,e){const s=this.buildRequest();return s.idToken=e,_r(t,s)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,_r(t,e)}buildRequest(){const t={requestUri:MA,returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=ma(e)}return t}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uc{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ba extends Uc{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Os extends ba{constructor(){super("facebook.com")}static credential(t){return Fi._fromParams({providerId:Os.PROVIDER_ID,signInMethod:Os.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return Os.credentialFromTaggedObject(t)}static credentialFromError(t){return Os.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return Os.credential(t.oauthAccessToken)}catch{return null}}}Os.FACEBOOK_SIGN_IN_METHOD="facebook.com";Os.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class On extends ba{constructor(){super("google.com"),this.addScope("profile")}static credential(t,e){return Fi._fromParams({providerId:On.PROVIDER_ID,signInMethod:On.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:e})}static credentialFromResult(t){return On.credentialFromTaggedObject(t)}static credentialFromError(t){return On.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:e,oauthAccessToken:s}=t;if(!e&&!s)return null;try{return On.credential(e,s)}catch{return null}}}On.GOOGLE_SIGN_IN_METHOD="google.com";On.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ls extends ba{constructor(){super("github.com")}static credential(t){return Fi._fromParams({providerId:Ls.PROVIDER_ID,signInMethod:Ls.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return Ls.credentialFromTaggedObject(t)}static credentialFromError(t){return Ls.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return Ls.credential(t.oauthAccessToken)}catch{return null}}}Ls.GITHUB_SIGN_IN_METHOD="github.com";Ls.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vs extends ba{constructor(){super("twitter.com")}static credential(t,e){return Fi._fromParams({providerId:Vs.PROVIDER_ID,signInMethod:Vs.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:e})}static credentialFromResult(t){return Vs.credentialFromTaggedObject(t)}static credentialFromError(t){return Vs.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:e,oauthTokenSecret:s}=t;if(!e||!s)return null;try{return Vs.credential(e,s)}catch{return null}}}Vs.TWITTER_SIGN_IN_METHOD="twitter.com";Vs.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bi{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,e,s,i=!1){const r=await wn._fromIdTokenResponse(t,s,i),o=Yg(s);return new Bi({user:r,providerId:o,_tokenResponse:s,operationType:e})}static async _forOperation(t,e,s){await t._updateTokensIfNecessary(s,!0);const i=Yg(s);return new Bi({user:t,providerId:i,_tokenResponse:s,operationType:e})}}function Yg(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tc extends xs{constructor(t,e,s,i){super(e.code,e.message),this.operationType=s,this.user=i,Object.setPrototypeOf(this,tc.prototype),this.customData={appName:t.name,tenantId:t.tenantId??void 0,_serverResponse:e.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(t,e,s,i){return new tc(t,e,s,i)}}function gv(n,t,e,s){return(t==="reauthenticate"?e._getReauthenticationResolver(n):e._getIdTokenResponse(n)).catch(r=>{throw r.code==="auth/multi-factor-auth-required"?tc._fromErrorAndOperation(n,r,t,s):r})}async function OA(n,t,e=!1){const s=await Yo(n,t._linkToIdToken(n.auth,await n.getIdToken()),e);return Bi._forOperation(n,"link",s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LA(n,t,e=!1){const{auth:s}=n;if(dn(s.app))return Promise.reject(Ks(s));const i="reauthenticate";try{const r=await Yo(n,gv(s,i,t,n),e);yt(r.idToken,s,"internal-error");const o=Ud(r.idToken);yt(o,s,"internal-error");const{sub:a}=o;return yt(n.uid===a,s,"user-mismatch"),Bi._forOperation(n,i,r)}catch(r){throw r?.code==="auth/user-not-found"&&qn(s,"user-mismatch"),r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VA(n,t,e=!1){if(dn(n.app))return Promise.reject(Ks(n));const s="signIn",i=await gv(n,s,t),r=await Bi._fromIdTokenResponse(n,s,i);return e||await n._updateCurrentUser(r.user),r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NA(n,t){return tv(n,"POST","/v1/accounts:signInWithCustomToken",Bc(n,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FA(n,t){if(dn(n.app))return Promise.reject(Ks(n));const e=ya(n),s=await NA(e,{token:t,returnSecureToken:!0}),i=await Bi._fromIdTokenResponse(e,"signIn",s);return await e._updateCurrentUser(i.user),i}function BA(n,t,e,s){return ye(n).onIdTokenChanged(t,e,s)}function UA(n,t,e){return ye(n).beforeAuthStateChanged(t,e)}function mv(n,t,e,s){return ye(n).onAuthStateChanged(t,e,s)}const ec="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _v{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(ec,"1"),this.storage.removeItem(ec),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $A=1e3,zA=10;class yv extends _v{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,e)=>this.onStorageEvent(t,e),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=hv(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const e of Object.keys(this.listeners)){const s=this.storage.getItem(e),i=this.localCache[e];s!==i&&t(e,i,s)}}onStorageEvent(t,e=!1){if(!t.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const s=t.key;e?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(s);!e&&this.localCache[s]===o||this.notifyListeners(s,o)},r=this.storage.getItem(s);yA()&&r!==t.newValue&&t.newValue!==t.oldValue?setTimeout(i,zA):i()}notifyListeners(t,e){this.localCache[t]=e;const s=this.listeners[t];if(s)for(const i of Array.from(s))i(e&&JSON.parse(e))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,e,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:e,newValue:s}),!0)})},$A)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,e){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,e){await super._set(t,e),this.localCache[t]=JSON.stringify(e)}async _get(t){const e=await super._get(t);return this.localCache[t]=JSON.stringify(e),e}async _remove(t){await super._remove(t),delete this.localCache[t]}}yv.type="LOCAL";const jA=yv;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bv extends _v{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,e){}_removeListener(t,e){}}bv.type="SESSION";const vv=bv;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HA(n){return Promise.all(n.map(async t=>{try{return{fulfilled:!0,value:await t}}catch(e){return{fulfilled:!1,reason:e}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $c{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const e=this.receivers.find(i=>i.isListeningto(t));if(e)return e;const s=new $c(t);return this.receivers.push(s),s}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const e=t,{eventId:s,eventType:i,data:r}=e.data,o=this.handlersMap[i];if(!o?.size)return;e.ports[0].postMessage({status:"ack",eventId:s,eventType:i});const a=Array.from(o).map(async c=>c(e.origin,r)),l=await HA(a);e.ports[0].postMessage({status:"done",eventId:s,eventType:i,response:l})}_subscribe(t,e){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(e)}_unsubscribe(t,e){this.handlersMap[t]&&e&&this.handlersMap[t].delete(e),(!e||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}$c.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jd(n="",t=10){let e="";for(let s=0;s<t;s++)e+=Math.floor(Math.random()*10);return n+e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WA{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,e,s=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let r,o;return new Promise((a,l)=>{const c=jd("",20);i.port1.start();const h=setTimeout(()=>{l(new Error("unsupported_event"))},s);o={messageChannel:i,onMessage(d){const f=d;if(f.data.eventId===c)switch(f.data.status){case"ack":clearTimeout(h),r=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(r),a(f.data.response);break;default:clearTimeout(h),clearTimeout(r),l(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:t,eventId:c,data:e},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nn(){return window}function qA(n){Nn().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wv(){return typeof Nn().WorkerGlobalScope<"u"&&typeof Nn().importScripts=="function"}async function GA(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function KA(){return navigator?.serviceWorker?.controller||null}function YA(){return wv()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xv="firebaseLocalStorageDb",XA=1,nc="firebaseLocalStorage",Tv="fbase_key";class va{constructor(t){this.request=t}toPromise(){return new Promise((t,e)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{e(this.request.error)})})}}function zc(n,t){return n.transaction([nc],t?"readwrite":"readonly").objectStore(nc)}function QA(){const n=indexedDB.deleteDatabase(xv);return new va(n).toPromise()}function Nh(){const n=indexedDB.open(xv,XA);return new Promise((t,e)=>{n.addEventListener("error",()=>{e(n.error)}),n.addEventListener("upgradeneeded",()=>{const s=n.result;try{s.createObjectStore(nc,{keyPath:Tv})}catch(i){e(i)}}),n.addEventListener("success",async()=>{const s=n.result;s.objectStoreNames.contains(nc)?t(s):(s.close(),await QA(),t(await Nh()))})})}async function Xg(n,t,e){const s=zc(n,!0).put({[Tv]:t,value:e});return new va(s).toPromise()}async function JA(n,t){const e=zc(n,!1).get(t),s=await new va(e).toPromise();return s===void 0?null:s.value}function Qg(n,t){const e=zc(n,!0).delete(t);return new va(e).toPromise()}const ZA=800,tC=3;class Ev{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Nh(),this.db)}async _withRetries(t){let e=0;for(;;)try{const s=await this._openDb();return await t(s)}catch(s){if(e++>tC)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return wv()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=$c._getInstance(YA()),this.receiver._subscribe("keyChanged",async(t,e)=>({keyProcessed:(await this._poll()).includes(e.key)})),this.receiver._subscribe("ping",async(t,e)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await GA(),!this.activeServiceWorker)return;this.sender=new WA(this.activeServiceWorker);const t=await this.sender._send("ping",{},800);t&&t[0]?.fulfilled&&t[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||KA()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await Nh();return await Xg(t,ec,"1"),await Qg(t,ec),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,e){return this._withPendingWrite(async()=>(await this._withRetries(s=>Xg(s,t,e)),this.localCache[t]=e,this.notifyServiceWorker(t)))}async _get(t){const e=await this._withRetries(s=>JA(s,t));return this.localCache[t]=e,e}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(e=>Qg(e,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){const t=await this._withRetries(i=>{const r=zc(i,!1).getAll();return new va(r).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];const e=[],s=new Set;if(t.length!==0)for(const{fbase_key:i,value:r}of t)s.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(r)&&(this.notifyListeners(i,r),e.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!s.has(i)&&(this.notifyListeners(i,null),e.push(i));return e}notifyListeners(t,e){this.localCache[t]=e;const s=this.listeners[t];if(s)for(const i of Array.from(s))i(e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),ZA)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,e){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Ev.type="LOCAL";const eC=Ev;new _a(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hd(n,t){return t?ls(t):(yt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wd extends pv{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return _r(t,this._buildIdpRequest())}_linkToIdToken(t,e){return _r(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return _r(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function nC(n){return VA(n.auth,new Wd(n),n.bypassAuthState)}function sC(n){const{auth:t,user:e}=n;return yt(e,t,"internal-error"),LA(e,new Wd(n),n.bypassAuthState)}async function iC(n){const{auth:t,user:e}=n;return yt(e,t,"internal-error"),OA(e,new Wd(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iv{constructor(t,e,s,i,r=!1){this.auth=t,this.resolver=s,this.user=i,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){return new Promise(async(t,e)=>{this.pendingPromise={resolve:t,reject:e};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(t){const{urlResponse:e,sessionId:s,postBody:i,tenantId:r,error:o,type:a}=t;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:e,sessionId:s,tenantId:r||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return nC;case"linkViaPopup":case"linkViaRedirect":return iC;case"reauthViaPopup":case"reauthViaRedirect":return sC;default:qn(this.auth,"internal-error")}}resolve(t){ms(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){ms(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rC=new _a(2e3,1e4);async function oC(n,t,e){if(dn(n.app))return Promise.reject(En(n,"operation-not-supported-in-this-environment"));const s=ya(n);Qb(n,t,Uc);const i=Hd(s,e);return new Fs(s,"signInViaPopup",t,i).executeNotNull()}async function aC(n,t,e){const s=ye(n);Qb(s.auth,t,Uc);const i=Hd(s.auth,e);return new Fs(s.auth,"linkViaPopup",t,i,s).executeNotNull()}class Fs extends Iv{constructor(t,e,s,i,r){super(t,e,i,r),this.provider=s,this.authWindow=null,this.pollId=null,Fs.currentPopupAction&&Fs.currentPopupAction.cancel(),Fs.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return yt(t,this.auth,"internal-error"),t}async onExecution(){ms(this.filter.length===1,"Popup operations only handle one event");const t=jd();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(En(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(En(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Fs.currentPopupAction=null}pollUserCancellation(){const t=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(En(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,rC.get())};t()}}Fs.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lC="pendingRedirect",Il=new Map;class cC extends Iv{constructor(t,e,s=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,s),this.eventId=null}async execute(){let t=Il.get(this.auth._key());if(!t){try{const s=await uC(this.resolver,this.auth)?await super.execute():null;t=()=>Promise.resolve(s)}catch(e){t=()=>Promise.reject(e)}Il.set(this.auth._key(),t)}return this.bypassAuthState||Il.set(this.auth._key(),()=>Promise.resolve(null)),t()}async onAuthEvent(t){if(t.type==="signInViaRedirect")return super.onAuthEvent(t);if(t.type==="unknown"){this.resolve(null);return}if(t.eventId){const e=await this.auth._redirectUserForId(t.eventId);if(e)return this.user=e,super.onAuthEvent(t);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function uC(n,t){const e=fC(t),s=dC(n);if(!await s._isAvailable())return!1;const i=await s._get(e)==="true";return await s._remove(e),i}function hC(n,t){Il.set(n._key(),t)}function dC(n){return ls(n._redirectPersistence)}function fC(n){return El(lC,n.config.apiKey,n.name)}async function pC(n,t,e=!1){if(dn(n.app))return Promise.reject(Ks(n));const s=ya(n),i=Hd(s,t),o=await new cC(s,i,e).execute();return o&&!e&&(delete o.user._redirectEventId,await s._persistUserIfCurrent(o.user),await s._setRedirectUser(null,t)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gC=600*1e3;class mC{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(t,s)&&(e=!0,this.sendToConsumer(t,s),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!_C(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){if(t.error&&!Sv(t)){const s=t.error.code?.split("auth/")[1]||"internal-error";e.onError(En(this.auth,s))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const s=e.eventId===null||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&s}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=gC&&this.cachedEventUids.clear(),this.cachedEventUids.has(Jg(t))}saveEventToCache(t){this.cachedEventUids.add(Jg(t)),this.lastProcessedEventTime=Date.now()}}function Jg(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(t=>t).join("-")}function Sv({type:n,error:t}){return n==="unknown"&&t?.code==="auth/no-auth-event"}function _C(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Sv(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yC(n,t={}){return Or(n,"GET","/v1/projects",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bC=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,vC=/^https?/;async function wC(n){if(n.config.emulator)return;const{authorizedDomains:t}=await yC(n);for(const e of t)try{if(xC(e))return}catch{}qn(n,"unauthorized-domain")}function xC(n){const t=Lh(),{protocol:e,hostname:s}=new URL(t);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&s===""?e==="chrome-extension:"&&n.replace("chrome-extension://","")===t.replace("chrome-extension://",""):e==="chrome-extension:"&&o.hostname===s}if(!vC.test(e))return!1;if(bC.test(n))return s===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(s)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TC=new _a(3e4,6e4);function Zg(){const n=Nn().___jsl;if(n?.H){for(const t of Object.keys(n.H))if(n.H[t].r=n.H[t].r||[],n.H[t].L=n.H[t].L||[],n.H[t].r=[...n.H[t].L],n.CP)for(let e=0;e<n.CP.length;e++)n.CP[e]=null}}function EC(n){return new Promise((t,e)=>{function s(){Zg(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Zg(),e(En(n,"network-request-failed"))},timeout:TC.get()})}if(Nn().gapi?.iframes?.Iframe)t(gapi.iframes.getContext());else if(Nn().gapi?.load)s();else{const i=AA("iframefcb");return Nn()[i]=()=>{gapi.load?s():e(En(n,"network-request-failed"))},IA(`${SA()}?onload=${i}`).catch(r=>e(r))}}).catch(t=>{throw Sl=null,t})}let Sl=null;function IC(n){return Sl=Sl||EC(n),Sl}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SC=new _a(5e3,15e3),AC="__/auth/iframe",CC="emulator/auth/iframe",PC={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},RC=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function kC(n){const t=n.config;yt(t.authDomain,n,"auth-domain-config-required");const e=t.emulator?Bd(t,CC):`https://${n.config.authDomain}/${AC}`,s={apiKey:t.apiKey,appName:n.name,v:Mr},i=RC.get(n.config.apiHost);i&&(s.eid=i);const r=n._getFrameworks();return r.length&&(s.fw=r.join(",")),`${e}?${ma(s).slice(1)}`}async function DC(n){const t=await IC(n),e=Nn().gapi;return yt(e,n,"internal-error"),t.open({where:document.body,url:kC(n),messageHandlersFilter:e.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:PC,dontclear:!0},s=>new Promise(async(i,r)=>{await s.restyle({setHideOnLeave:!1});const o=En(n,"network-request-failed"),a=Nn().setTimeout(()=>{r(o)},SC.get());function l(){Nn().clearTimeout(a),i(s)}s.ping(l).then(l,()=>{r(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MC={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},OC=500,LC=600,VC="_blank",NC="http://localhost";class tm{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function FC(n,t,e,s=OC,i=LC){const r=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-s)/2,0).toString();let a="";const l={...MC,width:s.toString(),height:i.toString(),top:r,left:o},c=$e().toLowerCase();e&&(a=ov(c)?VC:e),iv(c)&&(t=t||NC,l.scrollbars="yes");const h=Object.entries(l).reduce((f,[g,_])=>`${f}${g}=${_},`,"");if(_A(c)&&a!=="_self")return BC(t||"",a),new tm(null);const d=window.open(t||"",a,h);yt(d,n,"popup-blocked");try{d.focus()}catch{}return new tm(d)}function BC(n,t){const e=document.createElement("a");e.href=n,e.target=t;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),e.dispatchEvent(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UC="__/auth/handler",$C="emulator/auth/handler",zC=encodeURIComponent("fac");async function em(n,t,e,s,i,r){yt(n.config.authDomain,n,"auth-domain-config-required"),yt(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:e,redirectUrl:s,v:Mr,eventId:i};if(t instanceof Uc){t.setDefaultLanguage(n.languageCode),o.providerId=t.providerId||"",zI(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[h,d]of Object.entries({}))o[h]=d}if(t instanceof ba){const h=t.getScopes().filter(d=>d!=="");h.length>0&&(o.scopes=h.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const h of Object.keys(a))a[h]===void 0&&delete a[h];const l=await n._getAppCheckToken(),c=l?`#${zC}=${encodeURIComponent(l)}`:"";return`${jC(n)}?${ma(a).slice(1)}${c}`}function jC({config:n}){return n.emulator?Bd(n,$C):`https://${n.authDomain}/${UC}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xu="webStorageSupport";class HC{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=vv,this._completeRedirectFn=pC,this._overrideRedirectResult=hC}async _openPopup(t,e,s,i){ms(this.eventManagers[t._key()]?.manager,"_initialize() not called before _openPopup()");const r=await em(t,e,s,Lh(),i);return FC(t,r,jd())}async _openRedirect(t,e,s,i){await this._originValidation(t);const r=await em(t,e,s,Lh(),i);return qA(r),new Promise(()=>{})}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:i,promise:r}=this.eventManagers[e];return i?Promise.resolve(i):(ms(r,"If manager is not set, promise should be"),r)}const s=this.initAndGetManager(t);return this.eventManagers[e]={promise:s},s.catch(()=>{delete this.eventManagers[e]}),s}async initAndGetManager(t){const e=await DC(t),s=new mC(t);return e.register("authEvent",i=>(yt(i?.authEvent,t,"invalid-auth-event"),{status:s.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:s},this.iframes[t._key()]=e,s}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(Xu,{type:Xu},i=>{const r=i?.[0]?.[Xu];r!==void 0&&e(!!r),qn(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=wC(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return hv()||rv()||$d()}}const WC=HC;var nm="@firebase/auth",sm="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qC{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged(s=>{t(s?.stsTokenManager.accessToken||null)});this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);e&&(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){yt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GC(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function KC(n){wr(new Ni("auth",(t,{options:e})=>{const s=t.getProvider("app").getImmediate(),i=t.getProvider("heartbeat"),r=t.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=s.options;yt(o&&!o.includes(":"),"invalid-api-key",{appName:s.name});const l={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:dv(n)},c=new TA(s,i,r,l);return PA(c,e),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,s)=>{t.getProvider("auth-internal").initialize()})),wr(new Ni("auth-internal",t=>{const e=ya(t.getProvider("auth").getImmediate());return(s=>new qC(s))(e)},"PRIVATE").setInstantiationMode("EXPLICIT")),Gs(nm,sm,GC(n)),Gs(nm,sm,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YC=300,XC=Ub("authIdTokenMaxAge")||YC;let im=null;const QC=n=>async t=>{const e=t&&await t.getIdTokenResult(),s=e&&(new Date().getTime()-Date.parse(e.issuedAtTime))/1e3;if(s&&s>XC)return;const i=e?.token;im!==i&&(im=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function Wi(n=qb()){const t=Vd(n,"auth");if(t.isInitialized())return t.getImmediate();const e=CA(n,{popupRedirectResolver:WC,persistence:[eC,jA,vv]}),s=Ub("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const r=new URL(s,location.origin);if(location.origin===r.origin){const o=QC(r.toString());UA(e,o,()=>o(e.currentUser)),BA(e,a=>o(a))}}const i=Fb("auth");return i&&RA(e,`http://${i}`),e}function JC(){return document.getElementsByTagName("head")?.[0]??document}EA({loadJS(n){return new Promise((t,e)=>{const s=document.createElement("script");s.setAttribute("src",n),s.onload=t,s.onerror=i=>{const r=En("internal-error");r.customData=i,e(r)},s.type="text/javascript",s.charset="UTF-8",JC().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});KC("Browser");var rm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ys,Av;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function t(w,y){function x(){}x.prototype=y.prototype,w.D=y.prototype,w.prototype=new x,w.prototype.constructor=w,w.C=function(E,I,P){for(var S=Array(arguments.length-2),rt=2;rt<arguments.length;rt++)S[rt-2]=arguments[rt];return y.prototype[I].apply(E,S)}}function e(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}t(s,e),s.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(w,y,x){x||(x=0);var E=Array(16);if(typeof y=="string")for(var I=0;16>I;++I)E[I]=y.charCodeAt(x++)|y.charCodeAt(x++)<<8|y.charCodeAt(x++)<<16|y.charCodeAt(x++)<<24;else for(I=0;16>I;++I)E[I]=y[x++]|y[x++]<<8|y[x++]<<16|y[x++]<<24;y=w.g[0],x=w.g[1],I=w.g[2];var P=w.g[3],S=y+(P^x&(I^P))+E[0]+3614090360&4294967295;y=x+(S<<7&4294967295|S>>>25),S=P+(I^y&(x^I))+E[1]+3905402710&4294967295,P=y+(S<<12&4294967295|S>>>20),S=I+(x^P&(y^x))+E[2]+606105819&4294967295,I=P+(S<<17&4294967295|S>>>15),S=x+(y^I&(P^y))+E[3]+3250441966&4294967295,x=I+(S<<22&4294967295|S>>>10),S=y+(P^x&(I^P))+E[4]+4118548399&4294967295,y=x+(S<<7&4294967295|S>>>25),S=P+(I^y&(x^I))+E[5]+1200080426&4294967295,P=y+(S<<12&4294967295|S>>>20),S=I+(x^P&(y^x))+E[6]+2821735955&4294967295,I=P+(S<<17&4294967295|S>>>15),S=x+(y^I&(P^y))+E[7]+4249261313&4294967295,x=I+(S<<22&4294967295|S>>>10),S=y+(P^x&(I^P))+E[8]+1770035416&4294967295,y=x+(S<<7&4294967295|S>>>25),S=P+(I^y&(x^I))+E[9]+2336552879&4294967295,P=y+(S<<12&4294967295|S>>>20),S=I+(x^P&(y^x))+E[10]+4294925233&4294967295,I=P+(S<<17&4294967295|S>>>15),S=x+(y^I&(P^y))+E[11]+2304563134&4294967295,x=I+(S<<22&4294967295|S>>>10),S=y+(P^x&(I^P))+E[12]+1804603682&4294967295,y=x+(S<<7&4294967295|S>>>25),S=P+(I^y&(x^I))+E[13]+4254626195&4294967295,P=y+(S<<12&4294967295|S>>>20),S=I+(x^P&(y^x))+E[14]+2792965006&4294967295,I=P+(S<<17&4294967295|S>>>15),S=x+(y^I&(P^y))+E[15]+1236535329&4294967295,x=I+(S<<22&4294967295|S>>>10),S=y+(I^P&(x^I))+E[1]+4129170786&4294967295,y=x+(S<<5&4294967295|S>>>27),S=P+(x^I&(y^x))+E[6]+3225465664&4294967295,P=y+(S<<9&4294967295|S>>>23),S=I+(y^x&(P^y))+E[11]+643717713&4294967295,I=P+(S<<14&4294967295|S>>>18),S=x+(P^y&(I^P))+E[0]+3921069994&4294967295,x=I+(S<<20&4294967295|S>>>12),S=y+(I^P&(x^I))+E[5]+3593408605&4294967295,y=x+(S<<5&4294967295|S>>>27),S=P+(x^I&(y^x))+E[10]+38016083&4294967295,P=y+(S<<9&4294967295|S>>>23),S=I+(y^x&(P^y))+E[15]+3634488961&4294967295,I=P+(S<<14&4294967295|S>>>18),S=x+(P^y&(I^P))+E[4]+3889429448&4294967295,x=I+(S<<20&4294967295|S>>>12),S=y+(I^P&(x^I))+E[9]+568446438&4294967295,y=x+(S<<5&4294967295|S>>>27),S=P+(x^I&(y^x))+E[14]+3275163606&4294967295,P=y+(S<<9&4294967295|S>>>23),S=I+(y^x&(P^y))+E[3]+4107603335&4294967295,I=P+(S<<14&4294967295|S>>>18),S=x+(P^y&(I^P))+E[8]+1163531501&4294967295,x=I+(S<<20&4294967295|S>>>12),S=y+(I^P&(x^I))+E[13]+2850285829&4294967295,y=x+(S<<5&4294967295|S>>>27),S=P+(x^I&(y^x))+E[2]+4243563512&4294967295,P=y+(S<<9&4294967295|S>>>23),S=I+(y^x&(P^y))+E[7]+1735328473&4294967295,I=P+(S<<14&4294967295|S>>>18),S=x+(P^y&(I^P))+E[12]+2368359562&4294967295,x=I+(S<<20&4294967295|S>>>12),S=y+(x^I^P)+E[5]+4294588738&4294967295,y=x+(S<<4&4294967295|S>>>28),S=P+(y^x^I)+E[8]+2272392833&4294967295,P=y+(S<<11&4294967295|S>>>21),S=I+(P^y^x)+E[11]+1839030562&4294967295,I=P+(S<<16&4294967295|S>>>16),S=x+(I^P^y)+E[14]+4259657740&4294967295,x=I+(S<<23&4294967295|S>>>9),S=y+(x^I^P)+E[1]+2763975236&4294967295,y=x+(S<<4&4294967295|S>>>28),S=P+(y^x^I)+E[4]+1272893353&4294967295,P=y+(S<<11&4294967295|S>>>21),S=I+(P^y^x)+E[7]+4139469664&4294967295,I=P+(S<<16&4294967295|S>>>16),S=x+(I^P^y)+E[10]+3200236656&4294967295,x=I+(S<<23&4294967295|S>>>9),S=y+(x^I^P)+E[13]+681279174&4294967295,y=x+(S<<4&4294967295|S>>>28),S=P+(y^x^I)+E[0]+3936430074&4294967295,P=y+(S<<11&4294967295|S>>>21),S=I+(P^y^x)+E[3]+3572445317&4294967295,I=P+(S<<16&4294967295|S>>>16),S=x+(I^P^y)+E[6]+76029189&4294967295,x=I+(S<<23&4294967295|S>>>9),S=y+(x^I^P)+E[9]+3654602809&4294967295,y=x+(S<<4&4294967295|S>>>28),S=P+(y^x^I)+E[12]+3873151461&4294967295,P=y+(S<<11&4294967295|S>>>21),S=I+(P^y^x)+E[15]+530742520&4294967295,I=P+(S<<16&4294967295|S>>>16),S=x+(I^P^y)+E[2]+3299628645&4294967295,x=I+(S<<23&4294967295|S>>>9),S=y+(I^(x|~P))+E[0]+4096336452&4294967295,y=x+(S<<6&4294967295|S>>>26),S=P+(x^(y|~I))+E[7]+1126891415&4294967295,P=y+(S<<10&4294967295|S>>>22),S=I+(y^(P|~x))+E[14]+2878612391&4294967295,I=P+(S<<15&4294967295|S>>>17),S=x+(P^(I|~y))+E[5]+4237533241&4294967295,x=I+(S<<21&4294967295|S>>>11),S=y+(I^(x|~P))+E[12]+1700485571&4294967295,y=x+(S<<6&4294967295|S>>>26),S=P+(x^(y|~I))+E[3]+2399980690&4294967295,P=y+(S<<10&4294967295|S>>>22),S=I+(y^(P|~x))+E[10]+4293915773&4294967295,I=P+(S<<15&4294967295|S>>>17),S=x+(P^(I|~y))+E[1]+2240044497&4294967295,x=I+(S<<21&4294967295|S>>>11),S=y+(I^(x|~P))+E[8]+1873313359&4294967295,y=x+(S<<6&4294967295|S>>>26),S=P+(x^(y|~I))+E[15]+4264355552&4294967295,P=y+(S<<10&4294967295|S>>>22),S=I+(y^(P|~x))+E[6]+2734768916&4294967295,I=P+(S<<15&4294967295|S>>>17),S=x+(P^(I|~y))+E[13]+1309151649&4294967295,x=I+(S<<21&4294967295|S>>>11),S=y+(I^(x|~P))+E[4]+4149444226&4294967295,y=x+(S<<6&4294967295|S>>>26),S=P+(x^(y|~I))+E[11]+3174756917&4294967295,P=y+(S<<10&4294967295|S>>>22),S=I+(y^(P|~x))+E[2]+718787259&4294967295,I=P+(S<<15&4294967295|S>>>17),S=x+(P^(I|~y))+E[9]+3951481745&4294967295,w.g[0]=w.g[0]+y&4294967295,w.g[1]=w.g[1]+(I+(S<<21&4294967295|S>>>11))&4294967295,w.g[2]=w.g[2]+I&4294967295,w.g[3]=w.g[3]+P&4294967295}s.prototype.u=function(w,y){y===void 0&&(y=w.length);for(var x=y-this.blockSize,E=this.B,I=this.h,P=0;P<y;){if(I==0)for(;P<=x;)i(this,w,P),P+=this.blockSize;if(typeof w=="string"){for(;P<y;)if(E[I++]=w.charCodeAt(P++),I==this.blockSize){i(this,E),I=0;break}}else for(;P<y;)if(E[I++]=w[P++],I==this.blockSize){i(this,E),I=0;break}}this.h=I,this.o+=y},s.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var y=1;y<w.length-8;++y)w[y]=0;var x=8*this.o;for(y=w.length-8;y<w.length;++y)w[y]=x&255,x/=256;for(this.u(w),w=Array(16),y=x=0;4>y;++y)for(var E=0;32>E;E+=8)w[x++]=this.g[y]>>>E&255;return w};function r(w,y){var x=a;return Object.prototype.hasOwnProperty.call(x,w)?x[w]:x[w]=y(w)}function o(w,y){this.h=y;for(var x=[],E=!0,I=w.length-1;0<=I;I--){var P=w[I]|0;E&&P==y||(x[I]=P,E=!1)}this.g=x}var a={};function l(w){return-128<=w&&128>w?r(w,function(y){return new o([y|0],0>y?-1:0)}):new o([w|0],0>w?-1:0)}function c(w){if(isNaN(w)||!isFinite(w))return d;if(0>w)return v(c(-w));for(var y=[],x=1,E=0;w>=x;E++)y[E]=w/x|0,x*=4294967296;return new o(y,0)}function h(w,y){if(w.length==0)throw Error("number format error: empty string");if(y=y||10,2>y||36<y)throw Error("radix out of range: "+y);if(w.charAt(0)=="-")return v(h(w.substring(1),y));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var x=c(Math.pow(y,8)),E=d,I=0;I<w.length;I+=8){var P=Math.min(8,w.length-I),S=parseInt(w.substring(I,I+P),y);8>P?(P=c(Math.pow(y,P)),E=E.j(P).add(c(S))):(E=E.j(x),E=E.add(c(S)))}return E}var d=l(0),f=l(1),g=l(16777216);n=o.prototype,n.m=function(){if(b(this))return-v(this).m();for(var w=0,y=1,x=0;x<this.g.length;x++){var E=this.i(x);w+=(0<=E?E:4294967296+E)*y,y*=4294967296}return w},n.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(_(this))return"0";if(b(this))return"-"+v(this).toString(w);for(var y=c(Math.pow(w,6)),x=this,E="";;){var I=k(x,y).g;x=A(x,I.j(y));var P=((0<x.g.length?x.g[0]:x.h)>>>0).toString(w);if(x=I,_(x))return P+E;for(;6>P.length;)P="0"+P;E=P+E}},n.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function _(w){if(w.h!=0)return!1;for(var y=0;y<w.g.length;y++)if(w.g[y]!=0)return!1;return!0}function b(w){return w.h==-1}n.l=function(w){return w=A(this,w),b(w)?-1:_(w)?0:1};function v(w){for(var y=w.g.length,x=[],E=0;E<y;E++)x[E]=~w.g[E];return new o(x,~w.h).add(f)}n.abs=function(){return b(this)?v(this):this},n.add=function(w){for(var y=Math.max(this.g.length,w.g.length),x=[],E=0,I=0;I<=y;I++){var P=E+(this.i(I)&65535)+(w.i(I)&65535),S=(P>>>16)+(this.i(I)>>>16)+(w.i(I)>>>16);E=S>>>16,P&=65535,S&=65535,x[I]=S<<16|P}return new o(x,x[x.length-1]&-2147483648?-1:0)};function A(w,y){return w.add(v(y))}n.j=function(w){if(_(this)||_(w))return d;if(b(this))return b(w)?v(this).j(v(w)):v(v(this).j(w));if(b(w))return v(this.j(v(w)));if(0>this.l(g)&&0>w.l(g))return c(this.m()*w.m());for(var y=this.g.length+w.g.length,x=[],E=0;E<2*y;E++)x[E]=0;for(E=0;E<this.g.length;E++)for(var I=0;I<w.g.length;I++){var P=this.i(E)>>>16,S=this.i(E)&65535,rt=w.i(I)>>>16,it=w.i(I)&65535;x[2*E+2*I]+=S*it,C(x,2*E+2*I),x[2*E+2*I+1]+=P*it,C(x,2*E+2*I+1),x[2*E+2*I+1]+=S*rt,C(x,2*E+2*I+1),x[2*E+2*I+2]+=P*rt,C(x,2*E+2*I+2)}for(E=0;E<y;E++)x[E]=x[2*E+1]<<16|x[2*E];for(E=y;E<2*y;E++)x[E]=0;return new o(x,0)};function C(w,y){for(;(w[y]&65535)!=w[y];)w[y+1]+=w[y]>>>16,w[y]&=65535,y++}function O(w,y){this.g=w,this.h=y}function k(w,y){if(_(y))throw Error("division by zero");if(_(w))return new O(d,d);if(b(w))return y=k(v(w),y),new O(v(y.g),v(y.h));if(b(y))return y=k(w,v(y)),new O(v(y.g),y.h);if(30<w.g.length){if(b(w)||b(y))throw Error("slowDivide_ only works with positive integers.");for(var x=f,E=y;0>=E.l(w);)x=D(x),E=D(E);var I=N(x,1),P=N(E,1);for(E=N(E,2),x=N(x,2);!_(E);){var S=P.add(E);0>=S.l(w)&&(I=I.add(x),P=S),E=N(E,1),x=N(x,1)}return y=A(w,I.j(y)),new O(I,y)}for(I=d;0<=w.l(y);){for(x=Math.max(1,Math.floor(w.m()/y.m())),E=Math.ceil(Math.log(x)/Math.LN2),E=48>=E?1:Math.pow(2,E-48),P=c(x),S=P.j(y);b(S)||0<S.l(w);)x-=E,P=c(x),S=P.j(y);_(P)&&(P=f),I=I.add(P),w=A(w,S)}return new O(I,w)}n.A=function(w){return k(this,w).h},n.and=function(w){for(var y=Math.max(this.g.length,w.g.length),x=[],E=0;E<y;E++)x[E]=this.i(E)&w.i(E);return new o(x,this.h&w.h)},n.or=function(w){for(var y=Math.max(this.g.length,w.g.length),x=[],E=0;E<y;E++)x[E]=this.i(E)|w.i(E);return new o(x,this.h|w.h)},n.xor=function(w){for(var y=Math.max(this.g.length,w.g.length),x=[],E=0;E<y;E++)x[E]=this.i(E)^w.i(E);return new o(x,this.h^w.h)};function D(w){for(var y=w.g.length+1,x=[],E=0;E<y;E++)x[E]=w.i(E)<<1|w.i(E-1)>>>31;return new o(x,w.h)}function N(w,y){var x=y>>5;y%=32;for(var E=w.g.length-x,I=[],P=0;P<E;P++)I[P]=0<y?w.i(P+x)>>>y|w.i(P+x+1)<<32-y:w.i(P+x);return new o(I,w.h)}s.prototype.digest=s.prototype.v,s.prototype.reset=s.prototype.s,s.prototype.update=s.prototype.u,Av=s,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=h,Ys=o}).apply(typeof rm<"u"?rm:typeof self<"u"?self:typeof window<"u"?window:{});var tl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Cv,po,Pv,Al,Fh,Rv,kv,Dv;(function(){var n,t=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,p,m){return u==Array.prototype||u==Object.prototype||(u[p]=m.value),u};function e(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof tl=="object"&&tl];for(var p=0;p<u.length;++p){var m=u[p];if(m&&m.Math==Math)return m}throw Error("Cannot find global object")}var s=e(this);function i(u,p){if(p)t:{var m=s;u=u.split(".");for(var T=0;T<u.length-1;T++){var V=u[T];if(!(V in m))break t;m=m[V]}u=u[u.length-1],T=m[u],p=p(T),p!=T&&p!=null&&t(m,u,{configurable:!0,writable:!0,value:p})}}function r(u,p){u instanceof String&&(u+="");var m=0,T=!1,V={next:function(){if(!T&&m<u.length){var F=m++;return{value:p(F,u[F]),done:!1}}return T=!0,{done:!0,value:void 0}}};return V[Symbol.iterator]=function(){return V},V}i("Array.prototype.values",function(u){return u||function(){return r(this,function(p,m){return m})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(u){var p=typeof u;return p=p!="object"?p:u?Array.isArray(u)?"array":p:"null",p=="array"||p=="object"&&typeof u.length=="number"}function c(u){var p=typeof u;return p=="object"&&u!=null||p=="function"}function h(u,p,m){return u.call.apply(u.bind,arguments)}function d(u,p,m){if(!u)throw Error();if(2<arguments.length){var T=Array.prototype.slice.call(arguments,2);return function(){var V=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(V,T),u.apply(p,V)}}return function(){return u.apply(p,arguments)}}function f(u,p,m){return f=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:d,f.apply(null,arguments)}function g(u,p){var m=Array.prototype.slice.call(arguments,1);return function(){var T=m.slice();return T.push.apply(T,arguments),u.apply(this,T)}}function _(u,p){function m(){}m.prototype=p.prototype,u.aa=p.prototype,u.prototype=new m,u.prototype.constructor=u,u.Qb=function(T,V,F){for(var J=Array(arguments.length-2),jt=2;jt<arguments.length;jt++)J[jt-2]=arguments[jt];return p.prototype[V].apply(T,J)}}function b(u){const p=u.length;if(0<p){const m=Array(p);for(let T=0;T<p;T++)m[T]=u[T];return m}return[]}function v(u,p){for(let m=1;m<arguments.length;m++){const T=arguments[m];if(l(T)){const V=u.length||0,F=T.length||0;u.length=V+F;for(let J=0;J<F;J++)u[V+J]=T[J]}else u.push(T)}}class A{constructor(p,m){this.i=p,this.j=m,this.h=0,this.g=null}get(){let p;return 0<this.h?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function C(u){return/^[\s\xa0]*$/.test(u)}function O(){var u=a.navigator;return u&&(u=u.userAgent)?u:""}function k(u){return k[" "](u),u}k[" "]=function(){};var D=O().indexOf("Gecko")!=-1&&!(O().toLowerCase().indexOf("webkit")!=-1&&O().indexOf("Edge")==-1)&&!(O().indexOf("Trident")!=-1||O().indexOf("MSIE")!=-1)&&O().indexOf("Edge")==-1;function N(u,p,m){for(const T in u)p.call(m,u[T],T,u)}function w(u,p){for(const m in u)p.call(void 0,u[m],m,u)}function y(u){const p={};for(const m in u)p[m]=u[m];return p}const x="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function E(u,p){let m,T;for(let V=1;V<arguments.length;V++){T=arguments[V];for(m in T)u[m]=T[m];for(let F=0;F<x.length;F++)m=x[F],Object.prototype.hasOwnProperty.call(T,m)&&(u[m]=T[m])}}function I(u){var p=1;u=u.split(":");const m=[];for(;0<p&&u.length;)m.push(u.shift()),p--;return u.length&&m.push(u.join(":")),m}function P(u){a.setTimeout(()=>{throw u},0)}function S(){var u=K;let p=null;return u.g&&(p=u.g,u.g=u.g.next,u.g||(u.h=null),p.next=null),p}class rt{constructor(){this.h=this.g=null}add(p,m){const T=it.get();T.set(p,m),this.h?this.h.next=T:this.g=T,this.h=T}}var it=new A(()=>new dt,u=>u.reset());class dt{constructor(){this.next=this.g=this.h=null}set(p,m){this.h=p,this.g=m,this.next=null}reset(){this.next=this.g=this.h=null}}let ot,H=!1,K=new rt,X=()=>{const u=a.Promise.resolve(void 0);ot=()=>{u.then(ht)}};var ht=()=>{for(var u;u=S();){try{u.h.call(u.g)}catch(m){P(m)}var p=it;p.j(u),100>p.h&&(p.h++,u.next=p.g,p.g=u)}H=!1};function St(){this.s=this.s,this.C=this.C}St.prototype.s=!1,St.prototype.ma=function(){this.s||(this.s=!0,this.N())},St.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function bt(u,p){this.type=u,this.g=this.target=p,this.defaultPrevented=!1}bt.prototype.h=function(){this.defaultPrevented=!0};var Nt=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var u=!1,p=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const m=()=>{};a.addEventListener("test",m,p),a.removeEventListener("test",m,p)}catch{}return u}();function be(u,p){if(bt.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var m=this.type=u.type,T=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=p,p=u.relatedTarget){if(D){t:{try{k(p.nodeName);var V=!0;break t}catch{}V=!1}V||(p=null)}}else m=="mouseover"?p=u.fromElement:m=="mouseout"&&(p=u.toElement);this.relatedTarget=p,T?(this.clientX=T.clientX!==void 0?T.clientX:T.pageX,this.clientY=T.clientY!==void 0?T.clientY:T.pageY,this.screenX=T.screenX||0,this.screenY=T.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:oe[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&be.aa.h.call(this)}}_(be,bt);var oe={2:"touch",3:"pen",4:"mouse"};be.prototype.h=function(){be.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var Xn="closure_listenable_"+(1e6*Math.random()|0),zr=0;function Da(u,p,m,T,V){this.listener=u,this.proxy=null,this.src=p,this.type=m,this.capture=!!T,this.ha=V,this.key=++zr,this.da=this.fa=!1}function Sn(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function jr(u){this.src=u,this.g={},this.h=0}jr.prototype.add=function(u,p,m,T,V){var F=u.toString();u=this.g[F],u||(u=this.g[F]=[],this.h++);var J=L(u,p,T,V);return-1<J?(p=u[J],m||(p.fa=!1)):(p=new Da(p,this.src,F,!!T,V),p.fa=m,u.push(p)),p};function R(u,p){var m=p.type;if(m in u.g){var T=u.g[m],V=Array.prototype.indexOf.call(T,p,void 0),F;(F=0<=V)&&Array.prototype.splice.call(T,V,1),F&&(Sn(p),u.g[m].length==0&&(delete u.g[m],u.h--))}}function L(u,p,m,T){for(var V=0;V<u.length;++V){var F=u[V];if(!F.da&&F.listener==p&&F.capture==!!m&&F.ha==T)return V}return-1}var B="closure_lm_"+(1e6*Math.random()|0),W={};function z(u,p,m,T,V){if(Array.isArray(p)){for(var F=0;F<p.length;F++)z(u,p[F],m,T,V);return null}return m=_t(m),u&&u[Xn]?u.K(p,m,c(T)?!!T.capture:!1,V):j(u,p,m,!1,T,V)}function j(u,p,m,T,V,F){if(!p)throw Error("Invalid event type");var J=c(V)?!!V.capture:!!V,jt=Z(u);if(jt||(u[B]=jt=new jr(u)),m=jt.add(p,m,T,J,F),m.proxy)return m;if(T=tt(),m.proxy=T,T.src=u,T.listener=m,u.addEventListener)Nt||(V=J),V===void 0&&(V=!1),u.addEventListener(p.toString(),T,V);else if(u.attachEvent)u.attachEvent(G(p.toString()),T);else if(u.addListener&&u.removeListener)u.addListener(T);else throw Error("addEventListener and attachEvent are unavailable.");return m}function tt(){function u(m){return p.call(u.src,u.listener,m)}const p=ct;return u}function Q(u,p,m,T,V){if(Array.isArray(p))for(var F=0;F<p.length;F++)Q(u,p[F],m,T,V);else T=c(T)?!!T.capture:!!T,m=_t(m),u&&u[Xn]?(u=u.i,p=String(p).toString(),p in u.g&&(F=u.g[p],m=L(F,m,T,V),-1<m&&(Sn(F[m]),Array.prototype.splice.call(F,m,1),F.length==0&&(delete u.g[p],u.h--)))):u&&(u=Z(u))&&(p=u.g[p.toString()],u=-1,p&&(u=L(p,m,T,V)),(m=-1<u?p[u]:null)&&Y(m))}function Y(u){if(typeof u!="number"&&u&&!u.da){var p=u.src;if(p&&p[Xn])R(p.i,u);else{var m=u.type,T=u.proxy;p.removeEventListener?p.removeEventListener(m,T,u.capture):p.detachEvent?p.detachEvent(G(m),T):p.addListener&&p.removeListener&&p.removeListener(T),(m=Z(p))?(R(m,u),m.h==0&&(m.src=null,p[B]=null)):Sn(u)}}}function G(u){return u in W?W[u]:W[u]="on"+u}function ct(u,p){if(u.da)u=!0;else{p=new be(p,this);var m=u.listener,T=u.ha||u.src;u.fa&&Y(u),u=m.call(T,p)}return u}function Z(u){return u=u[B],u instanceof jr?u:null}var at="__closure_events_fn_"+(1e9*Math.random()>>>0);function _t(u){return typeof u=="function"?u:(u[at]||(u[at]=function(p){return u.handleEvent(p)}),u[at])}function ft(){St.call(this),this.i=new jr(this),this.M=this,this.F=null}_(ft,St),ft.prototype[Xn]=!0,ft.prototype.removeEventListener=function(u,p,m,T){Q(this,u,p,m,T)};function Tt(u,p){var m,T=u.F;if(T)for(m=[];T;T=T.F)m.push(T);if(u=u.M,T=p.type||p,typeof p=="string")p=new bt(p,u);else if(p instanceof bt)p.target=p.target||u;else{var V=p;p=new bt(T,u),E(p,V)}if(V=!0,m)for(var F=m.length-1;0<=F;F--){var J=p.g=m[F];V=Mt(J,T,!0,p)&&V}if(J=p.g=u,V=Mt(J,T,!0,p)&&V,V=Mt(J,T,!1,p)&&V,m)for(F=0;F<m.length;F++)J=p.g=m[F],V=Mt(J,T,!1,p)&&V}ft.prototype.N=function(){if(ft.aa.N.call(this),this.i){var u=this.i,p;for(p in u.g){for(var m=u.g[p],T=0;T<m.length;T++)Sn(m[T]);delete u.g[p],u.h--}}this.F=null},ft.prototype.K=function(u,p,m,T){return this.i.add(String(u),p,!1,m,T)},ft.prototype.L=function(u,p,m,T){return this.i.add(String(u),p,!0,m,T)};function Mt(u,p,m,T){if(p=u.i.g[String(p)],!p)return!0;p=p.concat();for(var V=!0,F=0;F<p.length;++F){var J=p[F];if(J&&!J.da&&J.capture==m){var jt=J.listener,Te=J.ha||J.src;J.fa&&R(u.i,J),V=jt.call(Te,T)!==!1&&V}}return V&&!T.defaultPrevented}function ve(u,p,m){if(typeof u=="function")m&&(u=f(u,m));else if(u&&typeof u.handleEvent=="function")u=f(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(p)?-1:a.setTimeout(u,p||0)}function we(u){u.g=ve(()=>{u.g=null,u.i&&(u.i=!1,we(u))},u.l);const p=u.h;u.h=null,u.m.apply(null,p)}class cn extends St{constructor(p,m){super(),this.m=p,this.l=m,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:we(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ce(u){St.call(this),this.h=u,this.g={}}_(Ce,St);var Is=[];function Hr(u){N(u.g,function(p,m){this.g.hasOwnProperty(m)&&Y(p)},u),u.g={}}Ce.prototype.N=function(){Ce.aa.N.call(this),Hr(this)},Ce.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var xe=a.JSON.stringify,un=a.JSON.parse,Ma=class{stringify(u){return a.JSON.stringify(u,void 0)}parse(u){return a.JSON.parse(u,void 0)}};function Yi(){}Yi.prototype.h=null;function cp(u){return u.h||(u.h=u.i())}function up(){}var Wr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function vu(){bt.call(this,"d")}_(vu,bt);function wu(){bt.call(this,"c")}_(wu,bt);var pi={},hp=null;function Oa(){return hp=hp||new ft}pi.La="serverreachability";function dp(u){bt.call(this,pi.La,u)}_(dp,bt);function qr(u){const p=Oa();Tt(p,new dp(p))}pi.STAT_EVENT="statevent";function fp(u,p){bt.call(this,pi.STAT_EVENT,u),this.stat=p}_(fp,bt);function je(u){const p=Oa();Tt(p,new fp(p,u))}pi.Ma="timingevent";function pp(u,p){bt.call(this,pi.Ma,u),this.size=p}_(pp,bt);function Gr(u,p){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){u()},p)}function Kr(){this.g=!0}Kr.prototype.xa=function(){this.g=!1};function wx(u,p,m,T,V,F){u.info(function(){if(u.g)if(F)for(var J="",jt=F.split("&"),Te=0;Te<jt.length;Te++){var Lt=jt[Te].split("=");if(1<Lt.length){var Pe=Lt[0];Lt=Lt[1];var Re=Pe.split("_");J=2<=Re.length&&Re[1]=="type"?J+(Pe+"="+Lt+"&"):J+(Pe+"=redacted&")}}else J=null;else J=F;return"XMLHTTP REQ ("+T+") [attempt "+V+"]: "+p+`
`+m+`
`+J})}function xx(u,p,m,T,V,F,J){u.info(function(){return"XMLHTTP RESP ("+T+") [ attempt "+V+"]: "+p+`
`+m+`
`+F+" "+J})}function Xi(u,p,m,T){u.info(function(){return"XMLHTTP TEXT ("+p+"): "+Ex(u,m)+(T?" "+T:"")})}function Tx(u,p){u.info(function(){return"TIMEOUT: "+p})}Kr.prototype.info=function(){};function Ex(u,p){if(!u.g)return p;if(!p)return null;try{var m=JSON.parse(p);if(m){for(u=0;u<m.length;u++)if(Array.isArray(m[u])){var T=m[u];if(!(2>T.length)){var V=T[1];if(Array.isArray(V)&&!(1>V.length)){var F=V[0];if(F!="noop"&&F!="stop"&&F!="close")for(var J=1;J<V.length;J++)V[J]=""}}}}return xe(m)}catch{return p}}var La={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},gp={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},xu;function Va(){}_(Va,Yi),Va.prototype.g=function(){return new XMLHttpRequest},Va.prototype.i=function(){return{}},xu=new Va;function Ss(u,p,m,T){this.j=u,this.i=p,this.l=m,this.R=T||1,this.U=new Ce(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new mp}function mp(){this.i=null,this.g="",this.h=!1}var _p={},Tu={};function Eu(u,p,m){u.L=1,u.v=Ua(Qn(p)),u.m=m,u.P=!0,yp(u,null)}function yp(u,p){u.F=Date.now(),Na(u),u.A=Qn(u.v);var m=u.A,T=u.R;Array.isArray(T)||(T=[String(T)]),Dp(m.i,"t",T),u.C=0,m=u.j.J,u.h=new mp,u.g=Xp(u.j,m?p:null,!u.m),0<u.O&&(u.M=new cn(f(u.Y,u,u.g),u.O)),p=u.U,m=u.g,T=u.ca;var V="readystatechange";Array.isArray(V)||(V&&(Is[0]=V.toString()),V=Is);for(var F=0;F<V.length;F++){var J=z(m,V[F],T||p.handleEvent,!1,p.h||p);if(!J)break;p.g[J.key]=J}p=u.H?y(u.H):{},u.m?(u.u||(u.u="POST"),p["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,p)):(u.u="GET",u.g.ea(u.A,u.u,null,p)),qr(),wx(u.i,u.u,u.A,u.l,u.R,u.m)}Ss.prototype.ca=function(u){u=u.target;const p=this.M;p&&Jn(u)==3?p.j():this.Y(u)},Ss.prototype.Y=function(u){try{if(u==this.g)t:{const Re=Jn(this.g);var p=this.g.Ba();const Zi=this.g.Z();if(!(3>Re)&&(Re!=3||this.g&&(this.h.h||this.g.oa()||Bp(this.g)))){this.J||Re!=4||p==7||(p==8||0>=Zi?qr(3):qr(2)),Iu(this);var m=this.g.Z();this.X=m;e:if(bp(this)){var T=Bp(this.g);u="";var V=T.length,F=Jn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){gi(this),Yr(this);var J="";break e}this.h.i=new a.TextDecoder}for(p=0;p<V;p++)this.h.h=!0,u+=this.h.i.decode(T[p],{stream:!(F&&p==V-1)});T.length=0,this.h.g+=u,this.C=0,J=this.h.g}else J=this.g.oa();if(this.o=m==200,xx(this.i,this.u,this.A,this.l,this.R,Re,m),this.o){if(this.T&&!this.K){e:{if(this.g){var jt,Te=this.g;if((jt=Te.g?Te.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!C(jt)){var Lt=jt;break e}}Lt=null}if(m=Lt)Xi(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Su(this,m);else{this.o=!1,this.s=3,je(12),gi(this),Yr(this);break t}}if(this.P){m=!0;let _n;for(;!this.J&&this.C<J.length;)if(_n=Ix(this,J),_n==Tu){Re==4&&(this.s=4,je(14),m=!1),Xi(this.i,this.l,null,"[Incomplete Response]");break}else if(_n==_p){this.s=4,je(15),Xi(this.i,this.l,J,"[Invalid Chunk]"),m=!1;break}else Xi(this.i,this.l,_n,null),Su(this,_n);if(bp(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Re!=4||J.length!=0||this.h.h||(this.s=1,je(16),m=!1),this.o=this.o&&m,!m)Xi(this.i,this.l,J,"[Invalid Chunked Response]"),gi(this),Yr(this);else if(0<J.length&&!this.W){this.W=!0;var Pe=this.j;Pe.g==this&&Pe.ba&&!Pe.M&&(Pe.j.info("Great, no buffering proxy detected. Bytes received: "+J.length),Du(Pe),Pe.M=!0,je(11))}}else Xi(this.i,this.l,J,null),Su(this,J);Re==4&&gi(this),this.o&&!this.J&&(Re==4?qp(this.j,this):(this.o=!1,Na(this)))}else zx(this.g),m==400&&0<J.indexOf("Unknown SID")?(this.s=3,je(12)):(this.s=0,je(13)),gi(this),Yr(this)}}}catch{}finally{}};function bp(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function Ix(u,p){var m=u.C,T=p.indexOf(`
`,m);return T==-1?Tu:(m=Number(p.substring(m,T)),isNaN(m)?_p:(T+=1,T+m>p.length?Tu:(p=p.slice(T,T+m),u.C=T+m,p)))}Ss.prototype.cancel=function(){this.J=!0,gi(this)};function Na(u){u.S=Date.now()+u.I,vp(u,u.I)}function vp(u,p){if(u.B!=null)throw Error("WatchDog timer not null");u.B=Gr(f(u.ba,u),p)}function Iu(u){u.B&&(a.clearTimeout(u.B),u.B=null)}Ss.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(Tx(this.i,this.A),this.L!=2&&(qr(),je(17)),gi(this),this.s=2,Yr(this)):vp(this,this.S-u)};function Yr(u){u.j.G==0||u.J||qp(u.j,u)}function gi(u){Iu(u);var p=u.M;p&&typeof p.ma=="function"&&p.ma(),u.M=null,Hr(u.U),u.g&&(p=u.g,u.g=null,p.abort(),p.ma())}function Su(u,p){try{var m=u.j;if(m.G!=0&&(m.g==u||Au(m.h,u))){if(!u.K&&Au(m.h,u)&&m.G==3){try{var T=m.Da.g.parse(p)}catch{T=null}if(Array.isArray(T)&&T.length==3){var V=T;if(V[0]==0){t:if(!m.u){if(m.g)if(m.g.F+3e3<u.F)qa(m),Ha(m);else break t;ku(m),je(18)}}else m.za=V[1],0<m.za-m.T&&37500>V[2]&&m.F&&m.v==0&&!m.C&&(m.C=Gr(f(m.Za,m),6e3));if(1>=Tp(m.h)&&m.ca){try{m.ca()}catch{}m.ca=void 0}}else _i(m,11)}else if((u.K||m.g==u)&&qa(m),!C(p))for(V=m.Da.g.parse(p),p=0;p<V.length;p++){let Lt=V[p];if(m.T=Lt[0],Lt=Lt[1],m.G==2)if(Lt[0]=="c"){m.K=Lt[1],m.ia=Lt[2];const Pe=Lt[3];Pe!=null&&(m.la=Pe,m.j.info("VER="+m.la));const Re=Lt[4];Re!=null&&(m.Aa=Re,m.j.info("SVER="+m.Aa));const Zi=Lt[5];Zi!=null&&typeof Zi=="number"&&0<Zi&&(T=1.5*Zi,m.L=T,m.j.info("backChannelRequestTimeoutMs_="+T)),T=m;const _n=u.g;if(_n){const Ka=_n.g?_n.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ka){var F=T.h;F.g||Ka.indexOf("spdy")==-1&&Ka.indexOf("quic")==-1&&Ka.indexOf("h2")==-1||(F.j=F.l,F.g=new Set,F.h&&(Cu(F,F.h),F.h=null))}if(T.D){const Mu=_n.g?_n.g.getResponseHeader("X-HTTP-Session-Id"):null;Mu&&(T.ya=Mu,Qt(T.I,T.D,Mu))}}m.G=3,m.l&&m.l.ua(),m.ba&&(m.R=Date.now()-u.F,m.j.info("Handshake RTT: "+m.R+"ms")),T=m;var J=u;if(T.qa=Yp(T,T.J?T.ia:null,T.W),J.K){Ep(T.h,J);var jt=J,Te=T.L;Te&&(jt.I=Te),jt.B&&(Iu(jt),Na(jt)),T.g=J}else Hp(T);0<m.i.length&&Wa(m)}else Lt[0]!="stop"&&Lt[0]!="close"||_i(m,7);else m.G==3&&(Lt[0]=="stop"||Lt[0]=="close"?Lt[0]=="stop"?_i(m,7):Ru(m):Lt[0]!="noop"&&m.l&&m.l.ta(Lt),m.v=0)}}qr(4)}catch{}}var Sx=class{constructor(u,p){this.g=u,this.map=p}};function wp(u){this.l=u||10,a.PerformanceNavigationTiming?(u=a.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function xp(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function Tp(u){return u.h?1:u.g?u.g.size:0}function Au(u,p){return u.h?u.h==p:u.g?u.g.has(p):!1}function Cu(u,p){u.g?u.g.add(p):u.h=p}function Ep(u,p){u.h&&u.h==p?u.h=null:u.g&&u.g.has(p)&&u.g.delete(p)}wp.prototype.cancel=function(){if(this.i=Ip(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function Ip(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let p=u.i;for(const m of u.g.values())p=p.concat(m.D);return p}return b(u.i)}function Ax(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(l(u)){for(var p=[],m=u.length,T=0;T<m;T++)p.push(u[T]);return p}p=[],m=0;for(T in u)p[m++]=u[T];return p}function Cx(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(l(u)||typeof u=="string"){var p=[];u=u.length;for(var m=0;m<u;m++)p.push(m);return p}p=[],m=0;for(const T in u)p[m++]=T;return p}}}function Sp(u,p){if(u.forEach&&typeof u.forEach=="function")u.forEach(p,void 0);else if(l(u)||typeof u=="string")Array.prototype.forEach.call(u,p,void 0);else for(var m=Cx(u),T=Ax(u),V=T.length,F=0;F<V;F++)p.call(void 0,T[F],m&&m[F],u)}var Ap=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Px(u,p){if(u){u=u.split("&");for(var m=0;m<u.length;m++){var T=u[m].indexOf("="),V=null;if(0<=T){var F=u[m].substring(0,T);V=u[m].substring(T+1)}else F=u[m];p(F,V?decodeURIComponent(V.replace(/\+/g," ")):"")}}}function mi(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof mi){this.h=u.h,Fa(this,u.j),this.o=u.o,this.g=u.g,Ba(this,u.s),this.l=u.l;var p=u.i,m=new Jr;m.i=p.i,p.g&&(m.g=new Map(p.g),m.h=p.h),Cp(this,m),this.m=u.m}else u&&(p=String(u).match(Ap))?(this.h=!1,Fa(this,p[1]||"",!0),this.o=Xr(p[2]||""),this.g=Xr(p[3]||"",!0),Ba(this,p[4]),this.l=Xr(p[5]||"",!0),Cp(this,p[6]||"",!0),this.m=Xr(p[7]||"")):(this.h=!1,this.i=new Jr(null,this.h))}mi.prototype.toString=function(){var u=[],p=this.j;p&&u.push(Qr(p,Pp,!0),":");var m=this.g;return(m||p=="file")&&(u.push("//"),(p=this.o)&&u.push(Qr(p,Pp,!0),"@"),u.push(encodeURIComponent(String(m)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m=this.s,m!=null&&u.push(":",String(m))),(m=this.l)&&(this.g&&m.charAt(0)!="/"&&u.push("/"),u.push(Qr(m,m.charAt(0)=="/"?Dx:kx,!0))),(m=this.i.toString())&&u.push("?",m),(m=this.m)&&u.push("#",Qr(m,Ox)),u.join("")};function Qn(u){return new mi(u)}function Fa(u,p,m){u.j=m?Xr(p,!0):p,u.j&&(u.j=u.j.replace(/:$/,""))}function Ba(u,p){if(p){if(p=Number(p),isNaN(p)||0>p)throw Error("Bad port number "+p);u.s=p}else u.s=null}function Cp(u,p,m){p instanceof Jr?(u.i=p,Lx(u.i,u.h)):(m||(p=Qr(p,Mx)),u.i=new Jr(p,u.h))}function Qt(u,p,m){u.i.set(p,m)}function Ua(u){return Qt(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function Xr(u,p){return u?p?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function Qr(u,p,m){return typeof u=="string"?(u=encodeURI(u).replace(p,Rx),m&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function Rx(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var Pp=/[#\/\?@]/g,kx=/[#\?:]/g,Dx=/[#\?]/g,Mx=/[#\?@]/g,Ox=/#/g;function Jr(u,p){this.h=this.g=null,this.i=u||null,this.j=!!p}function As(u){u.g||(u.g=new Map,u.h=0,u.i&&Px(u.i,function(p,m){u.add(decodeURIComponent(p.replace(/\+/g," ")),m)}))}n=Jr.prototype,n.add=function(u,p){As(this),this.i=null,u=Qi(this,u);var m=this.g.get(u);return m||this.g.set(u,m=[]),m.push(p),this.h+=1,this};function Rp(u,p){As(u),p=Qi(u,p),u.g.has(p)&&(u.i=null,u.h-=u.g.get(p).length,u.g.delete(p))}function kp(u,p){return As(u),p=Qi(u,p),u.g.has(p)}n.forEach=function(u,p){As(this),this.g.forEach(function(m,T){m.forEach(function(V){u.call(p,V,T,this)},this)},this)},n.na=function(){As(this);const u=Array.from(this.g.values()),p=Array.from(this.g.keys()),m=[];for(let T=0;T<p.length;T++){const V=u[T];for(let F=0;F<V.length;F++)m.push(p[T])}return m},n.V=function(u){As(this);let p=[];if(typeof u=="string")kp(this,u)&&(p=p.concat(this.g.get(Qi(this,u))));else{u=Array.from(this.g.values());for(let m=0;m<u.length;m++)p=p.concat(u[m])}return p},n.set=function(u,p){return As(this),this.i=null,u=Qi(this,u),kp(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[p]),this.h+=1,this},n.get=function(u,p){return u?(u=this.V(u),0<u.length?String(u[0]):p):p};function Dp(u,p,m){Rp(u,p),0<m.length&&(u.i=null,u.g.set(Qi(u,p),b(m)),u.h+=m.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],p=Array.from(this.g.keys());for(var m=0;m<p.length;m++){var T=p[m];const F=encodeURIComponent(String(T)),J=this.V(T);for(T=0;T<J.length;T++){var V=F;J[T]!==""&&(V+="="+encodeURIComponent(String(J[T]))),u.push(V)}}return this.i=u.join("&")};function Qi(u,p){return p=String(p),u.j&&(p=p.toLowerCase()),p}function Lx(u,p){p&&!u.j&&(As(u),u.i=null,u.g.forEach(function(m,T){var V=T.toLowerCase();T!=V&&(Rp(this,T),Dp(this,V,m))},u)),u.j=p}function Vx(u,p){const m=new Kr;if(a.Image){const T=new Image;T.onload=g(Cs,m,"TestLoadImage: loaded",!0,p,T),T.onerror=g(Cs,m,"TestLoadImage: error",!1,p,T),T.onabort=g(Cs,m,"TestLoadImage: abort",!1,p,T),T.ontimeout=g(Cs,m,"TestLoadImage: timeout",!1,p,T),a.setTimeout(function(){T.ontimeout&&T.ontimeout()},1e4),T.src=u}else p(!1)}function Nx(u,p){const m=new Kr,T=new AbortController,V=setTimeout(()=>{T.abort(),Cs(m,"TestPingServer: timeout",!1,p)},1e4);fetch(u,{signal:T.signal}).then(F=>{clearTimeout(V),F.ok?Cs(m,"TestPingServer: ok",!0,p):Cs(m,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(V),Cs(m,"TestPingServer: error",!1,p)})}function Cs(u,p,m,T,V){try{V&&(V.onload=null,V.onerror=null,V.onabort=null,V.ontimeout=null),T(m)}catch{}}function Fx(){this.g=new Ma}function Bx(u,p,m){const T=m||"";try{Sp(u,function(V,F){let J=V;c(V)&&(J=xe(V)),p.push(T+F+"="+encodeURIComponent(J))})}catch(V){throw p.push(T+"type="+encodeURIComponent("_badmap")),V}}function $a(u){this.l=u.Ub||null,this.j=u.eb||!1}_($a,Yi),$a.prototype.g=function(){return new za(this.l,this.j)},$a.prototype.i=function(u){return function(){return u}}({});function za(u,p){ft.call(this),this.D=u,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}_(za,ft),n=za.prototype,n.open=function(u,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=p,this.readyState=1,to(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const p={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(p.body=u),(this.D||a).fetch(new Request(this.A,p)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Zr(this)),this.readyState=0},n.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,to(this)),this.g&&(this.readyState=3,to(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Mp(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function Mp(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}n.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var p=u.value?u.value:new Uint8Array(0);(p=this.v.decode(p,{stream:!u.done}))&&(this.response=this.responseText+=p)}u.done?Zr(this):to(this),this.readyState==3&&Mp(this)}},n.Ra=function(u){this.g&&(this.response=this.responseText=u,Zr(this))},n.Qa=function(u){this.g&&(this.response=u,Zr(this))},n.ga=function(){this.g&&Zr(this)};function Zr(u){u.readyState=4,u.l=null,u.j=null,u.v=null,to(u)}n.setRequestHeader=function(u,p){this.u.append(u,p)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],p=this.h.entries();for(var m=p.next();!m.done;)m=m.value,u.push(m[0]+": "+m[1]),m=p.next();return u.join(`\r
`)};function to(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(za.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function Op(u){let p="";return N(u,function(m,T){p+=T,p+=":",p+=m,p+=`\r
`}),p}function Pu(u,p,m){t:{for(T in m){var T=!1;break t}T=!0}T||(m=Op(m),typeof u=="string"?m!=null&&encodeURIComponent(String(m)):Qt(u,p,m))}function se(u){ft.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}_(se,ft);var Ux=/^https?$/i,$x=["POST","PUT"];n=se.prototype,n.Ha=function(u){this.J=u},n.ea=function(u,p,m,T){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);p=p?p.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():xu.g(),this.v=this.o?cp(this.o):cp(xu),this.g.onreadystatechange=f(this.Ea,this);try{this.B=!0,this.g.open(p,String(u),!0),this.B=!1}catch(F){Lp(this,F);return}if(u=m||"",m=new Map(this.headers),T)if(Object.getPrototypeOf(T)===Object.prototype)for(var V in T)m.set(V,T[V]);else if(typeof T.keys=="function"&&typeof T.get=="function")for(const F of T.keys())m.set(F,T.get(F));else throw Error("Unknown input type for opt_headers: "+String(T));T=Array.from(m.keys()).find(F=>F.toLowerCase()=="content-type"),V=a.FormData&&u instanceof a.FormData,!(0<=Array.prototype.indexOf.call($x,p,void 0))||T||V||m.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[F,J]of m)this.g.setRequestHeader(F,J);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Fp(this),this.u=!0,this.g.send(u),this.u=!1}catch(F){Lp(this,F)}};function Lp(u,p){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=p,u.m=5,Vp(u),ja(u)}function Vp(u){u.A||(u.A=!0,Tt(u,"complete"),Tt(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,Tt(this,"complete"),Tt(this,"abort"),ja(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ja(this,!0)),se.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Np(this):this.bb())},n.bb=function(){Np(this)};function Np(u){if(u.h&&typeof o<"u"&&(!u.v[1]||Jn(u)!=4||u.Z()!=2)){if(u.u&&Jn(u)==4)ve(u.Ea,0,u);else if(Tt(u,"readystatechange"),Jn(u)==4){u.h=!1;try{const J=u.Z();t:switch(J){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break t;default:p=!1}var m;if(!(m=p)){var T;if(T=J===0){var V=String(u.D).match(Ap)[1]||null;!V&&a.self&&a.self.location&&(V=a.self.location.protocol.slice(0,-1)),T=!Ux.test(V?V.toLowerCase():"")}m=T}if(m)Tt(u,"complete"),Tt(u,"success");else{u.m=6;try{var F=2<Jn(u)?u.g.statusText:""}catch{F=""}u.l=F+" ["+u.Z()+"]",Vp(u)}}finally{ja(u)}}}}function ja(u,p){if(u.g){Fp(u);const m=u.g,T=u.v[0]?()=>{}:null;u.g=null,u.v=null,p||Tt(u,"ready");try{m.onreadystatechange=T}catch{}}}function Fp(u){u.I&&(a.clearTimeout(u.I),u.I=null)}n.isActive=function(){return!!this.g};function Jn(u){return u.g?u.g.readyState:0}n.Z=function(){try{return 2<Jn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(u){if(this.g){var p=this.g.responseText;return u&&p.indexOf(u)==0&&(p=p.substring(u.length)),un(p)}};function Bp(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function zx(u){const p={};u=(u.g&&2<=Jn(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let T=0;T<u.length;T++){if(C(u[T]))continue;var m=I(u[T]);const V=m[0];if(m=m[1],typeof m!="string")continue;m=m.trim();const F=p[V]||[];p[V]=F,F.push(m)}w(p,function(T){return T.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function eo(u,p,m){return m&&m.internalChannelParams&&m.internalChannelParams[u]||p}function Up(u){this.Aa=0,this.i=[],this.j=new Kr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=eo("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=eo("baseRetryDelayMs",5e3,u),this.cb=eo("retryDelaySeedMs",1e4,u),this.Wa=eo("forwardChannelMaxRetries",2,u),this.wa=eo("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new wp(u&&u.concurrentRequestLimit),this.Da=new Fx,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Up.prototype,n.la=8,n.G=1,n.connect=function(u,p,m,T){je(0),this.W=u,this.H=p||{},m&&T!==void 0&&(this.H.OSID=m,this.H.OAID=T),this.F=this.X,this.I=Yp(this,null,this.W),Wa(this)};function Ru(u){if($p(u),u.G==3){var p=u.U++,m=Qn(u.I);if(Qt(m,"SID",u.K),Qt(m,"RID",p),Qt(m,"TYPE","terminate"),no(u,m),p=new Ss(u,u.j,p),p.L=2,p.v=Ua(Qn(m)),m=!1,a.navigator&&a.navigator.sendBeacon)try{m=a.navigator.sendBeacon(p.v.toString(),"")}catch{}!m&&a.Image&&(new Image().src=p.v,m=!0),m||(p.g=Xp(p.j,null),p.g.ea(p.v)),p.F=Date.now(),Na(p)}Kp(u)}function Ha(u){u.g&&(Du(u),u.g.cancel(),u.g=null)}function $p(u){Ha(u),u.u&&(a.clearTimeout(u.u),u.u=null),qa(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&a.clearTimeout(u.s),u.s=null)}function Wa(u){if(!xp(u.h)&&!u.s){u.s=!0;var p=u.Ga;ot||X(),H||(ot(),H=!0),K.add(p,u),u.B=0}}function jx(u,p){return Tp(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=p.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=Gr(f(u.Ga,u,p),Gp(u,u.B)),u.B++,!0)}n.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const V=new Ss(this,this.j,u);let F=this.o;if(this.S&&(F?(F=y(F),E(F,this.S)):F=this.S),this.m!==null||this.O||(V.H=F,F=null),this.P)t:{for(var p=0,m=0;m<this.i.length;m++){e:{var T=this.i[m];if("__data__"in T.map&&(T=T.map.__data__,typeof T=="string")){T=T.length;break e}T=void 0}if(T===void 0)break;if(p+=T,4096<p){p=m;break t}if(p===4096||m===this.i.length-1){p=m+1;break t}}p=1e3}else p=1e3;p=jp(this,V,p),m=Qn(this.I),Qt(m,"RID",u),Qt(m,"CVER",22),this.D&&Qt(m,"X-HTTP-Session-Id",this.D),no(this,m),F&&(this.O?p="headers="+encodeURIComponent(String(Op(F)))+"&"+p:this.m&&Pu(m,this.m,F)),Cu(this.h,V),this.Ua&&Qt(m,"TYPE","init"),this.P?(Qt(m,"$req",p),Qt(m,"SID","null"),V.T=!0,Eu(V,m,null)):Eu(V,m,p),this.G=2}}else this.G==3&&(u?zp(this,u):this.i.length==0||xp(this.h)||zp(this))};function zp(u,p){var m;p?m=p.l:m=u.U++;const T=Qn(u.I);Qt(T,"SID",u.K),Qt(T,"RID",m),Qt(T,"AID",u.T),no(u,T),u.m&&u.o&&Pu(T,u.m,u.o),m=new Ss(u,u.j,m,u.B+1),u.m===null&&(m.H=u.o),p&&(u.i=p.D.concat(u.i)),p=jp(u,m,1e3),m.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),Cu(u.h,m),Eu(m,T,p)}function no(u,p){u.H&&N(u.H,function(m,T){Qt(p,T,m)}),u.l&&Sp({},function(m,T){Qt(p,T,m)})}function jp(u,p,m){m=Math.min(u.i.length,m);var T=u.l?f(u.l.Na,u.l,u):null;t:{var V=u.i;let F=-1;for(;;){const J=["count="+m];F==-1?0<m?(F=V[0].g,J.push("ofs="+F)):F=0:J.push("ofs="+F);let jt=!0;for(let Te=0;Te<m;Te++){let Lt=V[Te].g;const Pe=V[Te].map;if(Lt-=F,0>Lt)F=Math.max(0,V[Te].g-100),jt=!1;else try{Bx(Pe,J,"req"+Lt+"_")}catch{T&&T(Pe)}}if(jt){T=J.join("&");break t}}}return u=u.i.splice(0,m),p.D=u,T}function Hp(u){if(!u.g&&!u.u){u.Y=1;var p=u.Fa;ot||X(),H||(ot(),H=!0),K.add(p,u),u.v=0}}function ku(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=Gr(f(u.Fa,u),Gp(u,u.v)),u.v++,!0)}n.Fa=function(){if(this.u=null,Wp(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=Gr(f(this.ab,this),u)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,je(10),Ha(this),Wp(this))};function Du(u){u.A!=null&&(a.clearTimeout(u.A),u.A=null)}function Wp(u){u.g=new Ss(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var p=Qn(u.qa);Qt(p,"RID","rpc"),Qt(p,"SID",u.K),Qt(p,"AID",u.T),Qt(p,"CI",u.F?"0":"1"),!u.F&&u.ja&&Qt(p,"TO",u.ja),Qt(p,"TYPE","xmlhttp"),no(u,p),u.m&&u.o&&Pu(p,u.m,u.o),u.L&&(u.g.I=u.L);var m=u.g;u=u.ia,m.L=1,m.v=Ua(Qn(p)),m.m=null,m.P=!0,yp(m,u)}n.Za=function(){this.C!=null&&(this.C=null,Ha(this),ku(this),je(19))};function qa(u){u.C!=null&&(a.clearTimeout(u.C),u.C=null)}function qp(u,p){var m=null;if(u.g==p){qa(u),Du(u),u.g=null;var T=2}else if(Au(u.h,p))m=p.D,Ep(u.h,p),T=1;else return;if(u.G!=0){if(p.o)if(T==1){m=p.m?p.m.length:0,p=Date.now()-p.F;var V=u.B;T=Oa(),Tt(T,new pp(T,m)),Wa(u)}else Hp(u);else if(V=p.s,V==3||V==0&&0<p.X||!(T==1&&jx(u,p)||T==2&&ku(u)))switch(m&&0<m.length&&(p=u.h,p.i=p.i.concat(m)),V){case 1:_i(u,5);break;case 4:_i(u,10);break;case 3:_i(u,6);break;default:_i(u,2)}}}function Gp(u,p){let m=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(m*=2),m*p}function _i(u,p){if(u.j.info("Error code "+p),p==2){var m=f(u.fb,u),T=u.Xa;const V=!T;T=new mi(T||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Fa(T,"https"),Ua(T),V?Vx(T.toString(),m):Nx(T.toString(),m)}else je(2);u.G=0,u.l&&u.l.sa(p),Kp(u),$p(u)}n.fb=function(u){u?(this.j.info("Successfully pinged google.com"),je(2)):(this.j.info("Failed to ping google.com"),je(1))};function Kp(u){if(u.G=0,u.ka=[],u.l){const p=Ip(u.h);(p.length!=0||u.i.length!=0)&&(v(u.ka,p),v(u.ka,u.i),u.h.i.length=0,b(u.i),u.i.length=0),u.l.ra()}}function Yp(u,p,m){var T=m instanceof mi?Qn(m):new mi(m);if(T.g!="")p&&(T.g=p+"."+T.g),Ba(T,T.s);else{var V=a.location;T=V.protocol,p=p?p+"."+V.hostname:V.hostname,V=+V.port;var F=new mi(null);T&&Fa(F,T),p&&(F.g=p),V&&Ba(F,V),m&&(F.l=m),T=F}return m=u.D,p=u.ya,m&&p&&Qt(T,m,p),Qt(T,"VER",u.la),no(u,T),T}function Xp(u,p,m){if(p&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return p=u.Ca&&!u.pa?new se(new $a({eb:m})):new se(u.pa),p.Ha(u.J),p}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Qp(){}n=Qp.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Ga(){}Ga.prototype.g=function(u,p){return new en(u,p)};function en(u,p){ft.call(this),this.g=new Up(p),this.l=u,this.h=p&&p.messageUrlParams||null,u=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(u?u["X-WebChannel-Content-Type"]=p.messageContentType:u={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.va&&(u?u["X-WebChannel-Client-Profile"]=p.va:u={"X-WebChannel-Client-Profile":p.va}),this.g.S=u,(u=p&&p.Sb)&&!C(u)&&(this.g.m=u),this.v=p&&p.supportsCrossDomainXhr||!1,this.u=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!C(p)&&(this.g.D=p,u=this.h,u!==null&&p in u&&(u=this.h,p in u&&delete u[p])),this.j=new Ji(this)}_(en,ft),en.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},en.prototype.close=function(){Ru(this.g)},en.prototype.o=function(u){var p=this.g;if(typeof u=="string"){var m={};m.__data__=u,u=m}else this.u&&(m={},m.__data__=xe(u),u=m);p.i.push(new Sx(p.Ya++,u)),p.G==3&&Wa(p)},en.prototype.N=function(){this.g.l=null,delete this.j,Ru(this.g),delete this.g,en.aa.N.call(this)};function Jp(u){vu.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var p=u.__sm__;if(p){t:{for(const m in p){u=m;break t}u=void 0}(this.i=u)&&(u=this.i,p=p!==null&&u in p?p[u]:void 0),this.data=p}else this.data=u}_(Jp,vu);function Zp(){wu.call(this),this.status=1}_(Zp,wu);function Ji(u){this.g=u}_(Ji,Qp),Ji.prototype.ua=function(){Tt(this.g,"a")},Ji.prototype.ta=function(u){Tt(this.g,new Jp(u))},Ji.prototype.sa=function(u){Tt(this.g,new Zp)},Ji.prototype.ra=function(){Tt(this.g,"b")},Ga.prototype.createWebChannel=Ga.prototype.g,en.prototype.send=en.prototype.o,en.prototype.open=en.prototype.m,en.prototype.close=en.prototype.close,Dv=function(){return new Ga},kv=function(){return Oa()},Rv=pi,Fh={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},La.NO_ERROR=0,La.TIMEOUT=8,La.HTTP_ERROR=6,Al=La,gp.COMPLETE="complete",Pv=gp,up.EventType=Wr,Wr.OPEN="a",Wr.CLOSE="b",Wr.ERROR="c",Wr.MESSAGE="d",ft.prototype.listen=ft.prototype.K,po=up,se.prototype.listenOnce=se.prototype.L,se.prototype.getLastError=se.prototype.Ka,se.prototype.getLastErrorCode=se.prototype.Ba,se.prototype.getStatus=se.prototype.Z,se.prototype.getResponseJson=se.prototype.Oa,se.prototype.getResponseText=se.prototype.oa,se.prototype.send=se.prototype.ea,se.prototype.setWithCredentials=se.prototype.Ha,Cv=se}).apply(typeof tl<"u"?tl:typeof self<"u"?self:typeof window<"u"?window:{});const om="@firebase/firestore",am="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Me{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Me.UNAUTHENTICATED=new Me(null),Me.GOOGLE_CREDENTIALS=new Me("google-credentials-uid"),Me.FIRST_PARTY=new Me("first-party-uid"),Me.MOCK_USER=new Me("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Lr="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ui=new Od("@firebase/firestore");function rr(){return Ui.logLevel}function nt(n,...t){if(Ui.logLevel<=Pt.DEBUG){const e=t.map(qd);Ui.debug(`Firestore (${Lr}): ${n}`,...e)}}function _s(n,...t){if(Ui.logLevel<=Pt.ERROR){const e=t.map(qd);Ui.error(`Firestore (${Lr}): ${n}`,...e)}}function xr(n,...t){if(Ui.logLevel<=Pt.WARN){const e=t.map(qd);Ui.warn(`Firestore (${Lr}): ${n}`,...e)}}function qd(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(e){return JSON.stringify(e)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gt(n,t,e){let s="Unexpected state";typeof t=="string"?s=t:e=t,Mv(n,s,e)}function Mv(n,t,e){let s=`FIRESTORE (${Lr}) INTERNAL ASSERTION FAILED: ${t} (ID: ${n.toString(16)})`;if(e!==void 0)try{s+=" CONTEXT: "+JSON.stringify(e)}catch{s+=" CONTEXT: "+e}throw _s(s),new Error(s)}function $t(n,t,e,s){let i="Unexpected state";typeof e=="string"?i=e:s=e,n||Mv(t,i,s)}function xt(n,t){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class et extends xs{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ds{constructor(){this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ov{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class ZC{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable(()=>e(Me.UNAUTHENTICATED))}shutdown(){}}class t1{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable(()=>e(this.token.user))}shutdown(){this.changeListener=null}}class e1{constructor(t){this.t=t,this.currentUser=Me.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){$t(this.o===void 0,42304);let s=this.i;const i=l=>this.i!==s?(s=this.i,e(l)):Promise.resolve();let r=new ds;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new ds,t.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=r;t.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},a=l=>{nt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(nt("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new ds)}},0),o()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then(s=>this.i!==t?(nt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?($t(typeof s.accessToken=="string",31837,{l:s}),new Ov(s.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return $t(t===null||typeof t=="string",2055,{h:t}),new Me(t)}}class n1{constructor(t,e,s){this.P=t,this.T=e,this.I=s,this.type="FirstParty",this.user=Me.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const t=this.R();return t&&this.A.set("Authorization",t),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class s1{constructor(t,e,s){this.P=t,this.T=e,this.I=s}getToken(){return Promise.resolve(new n1(this.P,this.T,this.I))}start(t,e){t.enqueueRetryable(()=>e(Me.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class lm{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class i1{constructor(t,e){this.V=e,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,dn(t)&&t.settings.appCheckToken&&(this.p=t.settings.appCheckToken)}start(t,e){$t(this.o===void 0,3512);const s=r=>{r.error!=null&&nt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${r.error.message}`);const o=r.token!==this.m;return this.m=r.token,nt("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?e(r.token):Promise.resolve()};this.o=r=>{t.enqueueRetryable(()=>s(r))};const i=r=>{nt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=r,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(r=>i(r)),setTimeout(()=>{if(!this.appCheck){const r=this.V.getImmediate({optional:!0});r?i(r):nt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new lm(this.p));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(e=>e?($t(typeof e.token=="string",44558,{tokenResult:e}),this.m=e.token,new lm(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r1(n){const t=typeof self<"u"&&(self.crypto||self.msCrypto),e=new Uint8Array(n);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(e);else for(let s=0;s<n;s++)e[s]=Math.floor(256*Math.random());return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gd{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const i=r1(40);for(let r=0;r<i.length;++r)s.length<20&&i[r]<e&&(s+=t.charAt(i[r]%62))}return s}}function Rt(n,t){return n<t?-1:n>t?1:0}function Bh(n,t){const e=Math.min(n.length,t.length);for(let s=0;s<e;s++){const i=n.charAt(s),r=t.charAt(s);if(i!==r)return Qu(i)===Qu(r)?Rt(i,r):Qu(i)?1:-1}return Rt(n.length,t.length)}const o1=55296,a1=57343;function Qu(n){const t=n.charCodeAt(0);return t>=o1&&t<=a1}function Tr(n,t,e){return n.length===t.length&&n.every((s,i)=>e(s,t[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cm="__name__";class kn{constructor(t,e,s){e===void 0?e=0:e>t.length&&gt(637,{offset:e,range:t.length}),s===void 0?s=t.length-e:s>t.length-e&&gt(1746,{length:s,range:t.length-e}),this.segments=t,this.offset=e,this.len=s}get length(){return this.len}isEqual(t){return kn.comparator(this,t)===0}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof kn?t.forEach(s=>{e.push(s)}):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,s=this.limit();e<s;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const s=Math.min(t.length,e.length);for(let i=0;i<s;i++){const r=kn.compareSegments(t.get(i),e.get(i));if(r!==0)return r}return Rt(t.length,e.length)}static compareSegments(t,e){const s=kn.isNumericId(t),i=kn.isNumericId(e);return s&&!i?-1:!s&&i?1:s&&i?kn.extractNumericId(t).compare(kn.extractNumericId(e)):Bh(t,e)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return Ys.fromString(t.substring(4,t.length-2))}}class Wt extends kn{construct(t,e,s){return new Wt(t,e,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const e=[];for(const s of t){if(s.indexOf("//")>=0)throw new et(U.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);e.push(...s.split("/").filter(i=>i.length>0))}return new Wt(e)}static emptyPath(){return new Wt([])}}const l1=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Se extends kn{construct(t,e,s){return new Se(t,e,s)}static isValidIdentifier(t){return l1.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Se.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===cm}static keyField(){return new Se([cm])}static fromServerFormat(t){const e=[];let s="",i=0;const r=()=>{if(s.length===0)throw new et(U.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(s),s=""};let o=!1;for(;i<t.length;){const a=t[i];if(a==="\\"){if(i+1===t.length)throw new et(U.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const l=t[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new et(U.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);s+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(s+=a,i++):(r(),i++)}if(r(),o)throw new et(U.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Se(e)}static emptyPath(){return new Se([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ut{constructor(t){this.path=t}static fromPath(t){return new ut(Wt.fromString(t))}static fromName(t){return new ut(Wt.fromString(t).popFirst(5))}static empty(){return new ut(Wt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&Wt.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,e){return Wt.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new ut(new Wt(t.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kd(n,t,e){if(!e)throw new et(U.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${t}.`)}function c1(n,t,e,s){if(t===!0&&s===!0)throw new et(U.INVALID_ARGUMENT,`${n} and ${e} cannot be used together.`)}function um(n){if(!ut.isDocumentKey(n))throw new et(U.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function hm(n){if(ut.isDocumentKey(n))throw new et(U.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Lv(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function jc(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const t=function(s){return s.constructor?s.constructor.name:null}(n);return t?`a custom ${t} object`:"an object"}}return typeof n=="function"?"a function":gt(12329,{type:typeof n})}function qe(n,t){if("_delegate"in n&&(n=n._delegate),!(n instanceof t)){if(t.name===n.constructor.name)throw new et(U.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const e=jc(n);throw new et(U.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${e}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function he(n,t){const e={typeString:n};return t&&(e.value=t),e}function wa(n,t){if(!Lv(n))throw new et(U.INVALID_ARGUMENT,"JSON must be an object");let e;for(const s in t)if(t[s]){const i=t[s].typeString,r="value"in t[s]?{value:t[s].value}:void 0;if(!(s in n)){e=`JSON missing required field: '${s}'`;break}const o=n[s];if(i&&typeof o!==i){e=`JSON field '${s}' must be a ${i}.`;break}if(r!==void 0&&o!==r.value){e=`Expected '${s}' field to equal '${r.value}'`;break}}if(e)throw new et(U.INVALID_ARGUMENT,e);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dm=-62135596800,fm=1e6;class qt{static now(){return qt.fromMillis(Date.now())}static fromDate(t){return qt.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),s=Math.floor((t-1e3*e)*fm);return new qt(e,s)}constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new et(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new et(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<dm)throw new et(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new et(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/fm}_compareTo(t){return this.seconds===t.seconds?Rt(this.nanoseconds,t.nanoseconds):Rt(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:qt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(t){if(wa(t,qt._jsonSchema))return new qt(t.seconds,t.nanoseconds)}valueOf(){const t=this.seconds-dm;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}qt._jsonSchemaVersion="firestore/timestamp/1.0",qt._jsonSchema={type:he("string",qt._jsonSchemaVersion),seconds:he("number"),nanoseconds:he("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vt{static fromTimestamp(t){return new vt(t)}static min(){return new vt(new qt(0,0))}static max(){return new vt(new qt(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xo=-1;function u1(n,t){const e=n.toTimestamp().seconds,s=n.toTimestamp().nanoseconds+1,i=vt.fromTimestamp(s===1e9?new qt(e+1,0):new qt(e,s));return new ei(i,ut.empty(),t)}function h1(n){return new ei(n.readTime,n.key,Xo)}class ei{constructor(t,e,s){this.readTime=t,this.documentKey=e,this.largestBatchId=s}static min(){return new ei(vt.min(),ut.empty(),Xo)}static max(){return new ei(vt.max(),ut.empty(),Xo)}}function d1(n,t){let e=n.readTime.compareTo(t.readTime);return e!==0?e:(e=ut.comparator(n.documentKey,t.documentKey),e!==0?e:Rt(n.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f1="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class p1{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vr(n){if(n.code!==U.FAILED_PRECONDITION||n.message!==f1)throw n;nt("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ${constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&gt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new $((s,i)=>{this.nextCallback=r=>{this.wrapSuccess(t,r).next(s,i)},this.catchCallback=r=>{this.wrapFailure(e,r).next(s,i)}})}toPromise(){return new Promise((t,e)=>{this.next(t,e)})}wrapUserFunction(t){try{const e=t();return e instanceof $?e:$.resolve(e)}catch(e){return $.reject(e)}}wrapSuccess(t,e){return t?this.wrapUserFunction(()=>t(e)):$.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction(()=>t(e)):$.reject(e)}static resolve(t){return new $((e,s)=>{e(t)})}static reject(t){return new $((e,s)=>{s(t)})}static waitFor(t){return new $((e,s)=>{let i=0,r=0,o=!1;t.forEach(a=>{++i,a.next(()=>{++r,o&&r===i&&e()},l=>s(l))}),o=!0,r===i&&e()})}static or(t){let e=$.resolve(!1);for(const s of t)e=e.next(i=>i?$.resolve(i):s());return e}static forEach(t,e){const s=[];return t.forEach((i,r)=>{s.push(e.call(this,i,r))}),this.waitFor(s)}static mapArray(t,e){return new $((s,i)=>{const r=t.length,o=new Array(r);let a=0;for(let l=0;l<r;l++){const c=l;e(t[c]).next(h=>{o[c]=h,++a,a===r&&s(o)},h=>i(h))}})}static doWhile(t,e){return new $((s,i)=>{const r=()=>{t()===!0?e().next(()=>{r()},i):s()};r()})}}function g1(n){const t=n.match(/Android ([\d.]+)/i),e=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(e)}function Nr(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hc{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=s=>this.ae(s),this.ue=s=>e.writeSequenceNumber(s))}ae(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ue&&this.ue(t),t}}Hc.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yd=-1;function Wc(n){return n==null}function sc(n){return n===0&&1/n==-1/0}function m1(n){return typeof n=="number"&&Number.isInteger(n)&&!sc(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vv="";function _1(n){let t="";for(let e=0;e<n.length;e++)t.length>0&&(t=pm(t)),t=y1(n.get(e),t);return pm(t)}function y1(n,t){let e=t;const s=n.length;for(let i=0;i<s;i++){const r=n.charAt(i);switch(r){case"\0":e+="";break;case Vv:e+="";break;default:e+=r}}return e}function pm(n){return n+Vv+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gm(n){let t=0;for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t++;return t}function ci(n,t){for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t(e,n[e])}function Nv(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ne{constructor(t,e){this.comparator=t,this.root=e||Ee.EMPTY}insert(t,e){return new ne(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,Ee.BLACK,null,null))}remove(t){return new ne(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Ee.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const s=this.comparator(t,e.key);if(s===0)return e.value;s<0?e=e.left:s>0&&(e=e.right)}return null}indexOf(t){let e=0,s=this.root;for(;!s.isEmpty();){const i=this.comparator(t,s.key);if(i===0)return e+s.left.size;i<0?s=s.left:(e+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((e,s)=>(t(e,s),!1))}toString(){const t=[];return this.inorderTraversal((e,s)=>(t.push(`${e}:${s}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new el(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new el(this.root,t,this.comparator,!1)}getReverseIterator(){return new el(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new el(this.root,t,this.comparator,!0)}}class el{constructor(t,e,s,i){this.isReverse=i,this.nodeStack=[];let r=1;for(;!t.isEmpty();)if(r=e?s(t.key,e):1,e&&i&&(r*=-1),r<0)t=this.isReverse?t.left:t.right;else{if(r===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class Ee{constructor(t,e,s,i,r){this.key=t,this.value=e,this.color=s??Ee.RED,this.left=i??Ee.EMPTY,this.right=r??Ee.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,s,i,r){return new Ee(t??this.key,e??this.value,s??this.color,i??this.left,r??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,s){let i=this;const r=s(t,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(t,e,s),null):r===0?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,s)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Ee.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let s,i=this;if(e(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),e(t,i.key)===0){if(i.right.isEmpty())return Ee.EMPTY;s=i.right.min(),i=i.copy(s.key,s.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,Ee.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,Ee.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw gt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw gt(14113,{key:this.key,value:this.value});const t=this.left.check();if(t!==this.right.check())throw gt(27949);return t+(this.isRed()?0:1)}}Ee.EMPTY=null,Ee.RED=!0,Ee.BLACK=!1;Ee.EMPTY=new class{constructor(){this.size=0}get key(){throw gt(57766)}get value(){throw gt(16141)}get color(){throw gt(16727)}get left(){throw gt(29726)}get right(){throw gt(36894)}copy(t,e,s,i,r){return this}insert(t,e,s){return new Ee(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ge{constructor(t){this.comparator=t,this.data=new ne(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((e,s)=>(t(e),!1))}forEachInRange(t,e){const s=this.data.getIteratorFrom(t[0]);for(;s.hasNext();){const i=s.getNext();if(this.comparator(i.key,t[1])>=0)return;e(i.key)}}forEachWhile(t,e){let s;for(s=e!==void 0?this.data.getIteratorFrom(e):this.data.getIterator();s.hasNext();)if(!t(s.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new mm(this.data.getIterator())}getIteratorFrom(t){return new mm(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach(s=>{e=e.add(s)}),e}isEqual(t){if(!(t instanceof ge)||this.size!==t.size)return!1;const e=this.data.getIterator(),s=t.data.getIterator();for(;e.hasNext();){const i=e.getNext().key,r=s.getNext().key;if(this.comparator(i,r)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(e=>{t.push(e)}),t}toString(){const t=[];return this.forEach(e=>t.push(e)),"SortedSet("+t.toString()+")"}copy(t){const e=new ge(this.comparator);return e.data=t,e}}class mm{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class an{constructor(t){this.fields=t,t.sort(Se.comparator)}static empty(){return new an([])}unionWith(t){let e=new ge(Se.comparator);for(const s of this.fields)e=e.add(s);for(const s of t)e=e.add(s);return new an(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return Tr(this.fields,t.fields,(e,s)=>e.isEqual(s))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fv extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ae{constructor(t){this.binaryString=t}static fromBase64String(t){const e=function(i){try{return atob(i)}catch(r){throw typeof DOMException<"u"&&r instanceof DOMException?new Fv("Invalid base64 string: "+r):r}}(t);return new Ae(e)}static fromUint8Array(t){const e=function(i){let r="";for(let o=0;o<i.length;++o)r+=String.fromCharCode(i[o]);return r}(t);return new Ae(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(e){return btoa(e)}(this.binaryString)}toUint8Array(){return function(e){const s=new Uint8Array(e.length);for(let i=0;i<e.length;i++)s[i]=e.charCodeAt(i);return s}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return Rt(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Ae.EMPTY_BYTE_STRING=new Ae("");const b1=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ni(n){if($t(!!n,39018),typeof n=="string"){let t=0;const e=b1.exec(n);if($t(!!e,46558,{timestamp:n}),e[1]){let i=e[1];i=(i+"000000000").substr(0,9),t=Number(i)}const s=new Date(n);return{seconds:Math.floor(s.getTime()/1e3),nanos:t}}return{seconds:ae(n.seconds),nanos:ae(n.nanos)}}function ae(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function si(n){return typeof n=="string"?Ae.fromBase64String(n):Ae.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bv="server_timestamp",Uv="__type__",$v="__previous_value__",zv="__local_write_time__";function Xd(n){return(n?.mapValue?.fields||{})[Uv]?.stringValue===Bv}function qc(n){const t=n.mapValue.fields[$v];return Xd(t)?qc(t):t}function Qo(n){const t=ni(n.mapValue.fields[zv].timestampValue);return new qt(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v1{constructor(t,e,s,i,r,o,a,l,c,h){this.databaseId=t,this.appId=e,this.persistenceKey=s,this.host=i,this.ssl=r,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=h}}const ic="(default)";class Jo{constructor(t,e){this.projectId=t,this.database=e||ic}static empty(){return new Jo("","")}get isDefaultDatabase(){return this.database===ic}isEqual(t){return t instanceof Jo&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jv="__type__",w1="__max__",nl={mapValue:{}},Hv="__vector__",rc="value";function ii(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Xd(n)?4:T1(n)?9007199254740991:x1(n)?10:11:gt(28295,{value:n})}function Gn(n,t){if(n===t)return!0;const e=ii(n);if(e!==ii(t))return!1;switch(e){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===t.booleanValue;case 4:return Qo(n).isEqual(Qo(t));case 3:return function(i,r){if(typeof i.timestampValue=="string"&&typeof r.timestampValue=="string"&&i.timestampValue.length===r.timestampValue.length)return i.timestampValue===r.timestampValue;const o=ni(i.timestampValue),a=ni(r.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,t);case 5:return n.stringValue===t.stringValue;case 6:return function(i,r){return si(i.bytesValue).isEqual(si(r.bytesValue))}(n,t);case 7:return n.referenceValue===t.referenceValue;case 8:return function(i,r){return ae(i.geoPointValue.latitude)===ae(r.geoPointValue.latitude)&&ae(i.geoPointValue.longitude)===ae(r.geoPointValue.longitude)}(n,t);case 2:return function(i,r){if("integerValue"in i&&"integerValue"in r)return ae(i.integerValue)===ae(r.integerValue);if("doubleValue"in i&&"doubleValue"in r){const o=ae(i.doubleValue),a=ae(r.doubleValue);return o===a?sc(o)===sc(a):isNaN(o)&&isNaN(a)}return!1}(n,t);case 9:return Tr(n.arrayValue.values||[],t.arrayValue.values||[],Gn);case 10:case 11:return function(i,r){const o=i.mapValue.fields||{},a=r.mapValue.fields||{};if(gm(o)!==gm(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Gn(o[l],a[l])))return!1;return!0}(n,t);default:return gt(52216,{left:n})}}function Zo(n,t){return(n.values||[]).find(e=>Gn(e,t))!==void 0}function Er(n,t){if(n===t)return 0;const e=ii(n),s=ii(t);if(e!==s)return Rt(e,s);switch(e){case 0:case 9007199254740991:return 0;case 1:return Rt(n.booleanValue,t.booleanValue);case 2:return function(r,o){const a=ae(r.integerValue||r.doubleValue),l=ae(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(n,t);case 3:return _m(n.timestampValue,t.timestampValue);case 4:return _m(Qo(n),Qo(t));case 5:return Bh(n.stringValue,t.stringValue);case 6:return function(r,o){const a=si(r),l=si(o);return a.compareTo(l)}(n.bytesValue,t.bytesValue);case 7:return function(r,o){const a=r.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){const h=Rt(a[c],l[c]);if(h!==0)return h}return Rt(a.length,l.length)}(n.referenceValue,t.referenceValue);case 8:return function(r,o){const a=Rt(ae(r.latitude),ae(o.latitude));return a!==0?a:Rt(ae(r.longitude),ae(o.longitude))}(n.geoPointValue,t.geoPointValue);case 9:return ym(n.arrayValue,t.arrayValue);case 10:return function(r,o){const a=r.fields||{},l=o.fields||{},c=a[rc]?.arrayValue,h=l[rc]?.arrayValue,d=Rt(c?.values?.length||0,h?.values?.length||0);return d!==0?d:ym(c,h)}(n.mapValue,t.mapValue);case 11:return function(r,o){if(r===nl.mapValue&&o===nl.mapValue)return 0;if(r===nl.mapValue)return 1;if(o===nl.mapValue)return-1;const a=r.fields||{},l=Object.keys(a),c=o.fields||{},h=Object.keys(c);l.sort(),h.sort();for(let d=0;d<l.length&&d<h.length;++d){const f=Bh(l[d],h[d]);if(f!==0)return f;const g=Er(a[l[d]],c[h[d]]);if(g!==0)return g}return Rt(l.length,h.length)}(n.mapValue,t.mapValue);default:throw gt(23264,{he:e})}}function _m(n,t){if(typeof n=="string"&&typeof t=="string"&&n.length===t.length)return Rt(n,t);const e=ni(n),s=ni(t),i=Rt(e.seconds,s.seconds);return i!==0?i:Rt(e.nanos,s.nanos)}function ym(n,t){const e=n.values||[],s=t.values||[];for(let i=0;i<e.length&&i<s.length;++i){const r=Er(e[i],s[i]);if(r)return r}return Rt(e.length,s.length)}function Ir(n){return Uh(n)}function Uh(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(e){const s=ni(e);return`time(${s.seconds},${s.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(e){return si(e).toBase64()}(n.bytesValue):"referenceValue"in n?function(e){return ut.fromName(e).toString()}(n.referenceValue):"geoPointValue"in n?function(e){return`geo(${e.latitude},${e.longitude})`}(n.geoPointValue):"arrayValue"in n?function(e){let s="[",i=!0;for(const r of e.values||[])i?i=!1:s+=",",s+=Uh(r);return s+"]"}(n.arrayValue):"mapValue"in n?function(e){const s=Object.keys(e.fields||{}).sort();let i="{",r=!0;for(const o of s)r?r=!1:i+=",",i+=`${o}:${Uh(e.fields[o])}`;return i+"}"}(n.mapValue):gt(61005,{value:n})}function Cl(n){switch(ii(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=qc(n);return t?16+Cl(t):16;case 5:return 2*n.stringValue.length;case 6:return si(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(s){return(s.values||[]).reduce((i,r)=>i+Cl(r),0)}(n.arrayValue);case 10:case 11:return function(s){let i=0;return ci(s.fields,(r,o)=>{i+=r.length+Cl(o)}),i}(n.mapValue);default:throw gt(13486,{value:n})}}function bm(n,t){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${t.path.canonicalString()}`}}function $h(n){return!!n&&"integerValue"in n}function Qd(n){return!!n&&"arrayValue"in n}function vm(n){return!!n&&"nullValue"in n}function wm(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Pl(n){return!!n&&"mapValue"in n}function x1(n){return(n?.mapValue?.fields||{})[jv]?.stringValue===Hv}function Mo(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const t={mapValue:{fields:{}}};return ci(n.mapValue.fields,(e,s)=>t.mapValue.fields[e]=Mo(s)),t}if(n.arrayValue){const t={arrayValue:{values:[]}};for(let e=0;e<(n.arrayValue.values||[]).length;++e)t.arrayValue.values[e]=Mo(n.arrayValue.values[e]);return t}return{...n}}function T1(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===w1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Je{constructor(t){this.value=t}static empty(){return new Je({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let s=0;s<t.length-1;++s)if(e=(e.mapValue.fields||{})[t.get(s)],!Pl(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Mo(e)}setAll(t){let e=Se.emptyPath(),s={},i=[];t.forEach((o,a)=>{if(!e.isImmediateParentOf(a)){const l=this.getFieldsMap(e);this.applyChanges(l,s,i),s={},i=[],e=a.popLast()}o?s[a.lastSegment()]=Mo(o):i.push(a.lastSegment())});const r=this.getFieldsMap(e);this.applyChanges(r,s,i)}delete(t){const e=this.field(t.popLast());Pl(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return Gn(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let s=0;s<t.length;++s){let i=e.mapValue.fields[t.get(s)];Pl(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},e.mapValue.fields[t.get(s)]=i),e=i}return e.mapValue.fields}applyChanges(t,e,s){ci(e,(i,r)=>t[i]=r);for(const i of s)delete t[i]}clone(){return new Je(Mo(this.value))}}function Wv(n){const t=[];return ci(n.fields,(e,s)=>{const i=new Se([e]);if(Pl(s)){const r=Wv(s.mapValue).fields;if(r.length===0)t.push(i);else for(const o of r)t.push(i.child(o))}else t.push(i)}),new an(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ve{constructor(t,e,s,i,r,o,a){this.key=t,this.documentType=e,this.version=s,this.readTime=i,this.createTime=r,this.data=o,this.documentState=a}static newInvalidDocument(t){return new Ve(t,0,vt.min(),vt.min(),vt.min(),Je.empty(),0)}static newFoundDocument(t,e,s,i){return new Ve(t,1,e,vt.min(),s,i,0)}static newNoDocument(t,e){return new Ve(t,2,e,vt.min(),vt.min(),Je.empty(),0)}static newUnknownDocument(t,e){return new Ve(t,3,e,vt.min(),vt.min(),Je.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(vt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Je.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Je.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=vt.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof Ve&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Ve(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oc{constructor(t,e){this.position=t,this.inclusive=e}}function xm(n,t,e){let s=0;for(let i=0;i<n.position.length;i++){const r=t[i],o=n.position[i];if(r.field.isKeyField()?s=ut.comparator(ut.fromName(o.referenceValue),e.key):s=Er(o,e.data.field(r.field)),r.dir==="desc"&&(s*=-1),s!==0)break}return s}function Tm(n,t){if(n===null)return t===null;if(t===null||n.inclusive!==t.inclusive||n.position.length!==t.position.length)return!1;for(let e=0;e<n.position.length;e++)if(!Gn(n.position[e],t.position[e]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ac{constructor(t,e="asc"){this.field=t,this.dir=e}}function E1(n,t){return n.dir===t.dir&&n.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qv{}class ue extends qv{constructor(t,e,s){super(),this.field=t,this.op=e,this.value=s}static create(t,e,s){return t.isKeyField()?e==="in"||e==="not-in"?this.createKeyFieldInFilter(t,e,s):new S1(t,e,s):e==="array-contains"?new P1(t,s):e==="in"?new R1(t,s):e==="not-in"?new k1(t,s):e==="array-contains-any"?new D1(t,s):new ue(t,e,s)}static createKeyFieldInFilter(t,e,s){return e==="in"?new A1(t,s):new C1(t,s)}matches(t){const e=t.data.field(this.field);return this.op==="!="?e!==null&&e.nullValue===void 0&&this.matchesComparison(Er(e,this.value)):e!==null&&ii(this.value)===ii(e)&&this.matchesComparison(Er(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return gt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class In extends qv{constructor(t,e){super(),this.filters=t,this.op=e,this.Pe=null}static create(t,e){return new In(t,e)}matches(t){return Gv(this)?this.filters.find(e=>!e.matches(t))===void 0:this.filters.find(e=>e.matches(t))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((t,e)=>t.concat(e.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Gv(n){return n.op==="and"}function Kv(n){return I1(n)&&Gv(n)}function I1(n){for(const t of n.filters)if(t instanceof In)return!1;return!0}function zh(n){if(n instanceof ue)return n.field.canonicalString()+n.op.toString()+Ir(n.value);if(Kv(n))return n.filters.map(t=>zh(t)).join(",");{const t=n.filters.map(e=>zh(e)).join(",");return`${n.op}(${t})`}}function Yv(n,t){return n instanceof ue?function(s,i){return i instanceof ue&&s.op===i.op&&s.field.isEqual(i.field)&&Gn(s.value,i.value)}(n,t):n instanceof In?function(s,i){return i instanceof In&&s.op===i.op&&s.filters.length===i.filters.length?s.filters.reduce((r,o,a)=>r&&Yv(o,i.filters[a]),!0):!1}(n,t):void gt(19439)}function Xv(n){return n instanceof ue?function(e){return`${e.field.canonicalString()} ${e.op} ${Ir(e.value)}`}(n):n instanceof In?function(e){return e.op.toString()+" {"+e.getFilters().map(Xv).join(" ,")+"}"}(n):"Filter"}class S1 extends ue{constructor(t,e,s){super(t,e,s),this.key=ut.fromName(s.referenceValue)}matches(t){const e=ut.comparator(t.key,this.key);return this.matchesComparison(e)}}class A1 extends ue{constructor(t,e){super(t,"in",e),this.keys=Qv("in",e)}matches(t){return this.keys.some(e=>e.isEqual(t.key))}}class C1 extends ue{constructor(t,e){super(t,"not-in",e),this.keys=Qv("not-in",e)}matches(t){return!this.keys.some(e=>e.isEqual(t.key))}}function Qv(n,t){return(t.arrayValue?.values||[]).map(e=>ut.fromName(e.referenceValue))}class P1 extends ue{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return Qd(e)&&Zo(e.arrayValue,this.value)}}class R1 extends ue{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return e!==null&&Zo(this.value.arrayValue,e)}}class k1 extends ue{constructor(t,e){super(t,"not-in",e)}matches(t){if(Zo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return e!==null&&e.nullValue===void 0&&!Zo(this.value.arrayValue,e)}}class D1 extends ue{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!Qd(e)||!e.arrayValue.values)&&e.arrayValue.values.some(s=>Zo(this.value.arrayValue,s))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M1{constructor(t,e=null,s=[],i=[],r=null,o=null,a=null){this.path=t,this.collectionGroup=e,this.orderBy=s,this.filters=i,this.limit=r,this.startAt=o,this.endAt=a,this.Te=null}}function Em(n,t=null,e=[],s=[],i=null,r=null,o=null){return new M1(n,t,e,s,i,r,o)}function Jd(n){const t=xt(n);if(t.Te===null){let e=t.path.canonicalString();t.collectionGroup!==null&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(s=>zh(s)).join(","),e+="|ob:",e+=t.orderBy.map(s=>function(r){return r.field.canonicalString()+r.dir}(s)).join(","),Wc(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(s=>Ir(s)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(s=>Ir(s)).join(",")),t.Te=e}return t.Te}function Zd(n,t){if(n.limit!==t.limit||n.orderBy.length!==t.orderBy.length)return!1;for(let e=0;e<n.orderBy.length;e++)if(!E1(n.orderBy[e],t.orderBy[e]))return!1;if(n.filters.length!==t.filters.length)return!1;for(let e=0;e<n.filters.length;e++)if(!Yv(n.filters[e],t.filters[e]))return!1;return n.collectionGroup===t.collectionGroup&&!!n.path.isEqual(t.path)&&!!Tm(n.startAt,t.startAt)&&Tm(n.endAt,t.endAt)}function jh(n){return ut.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fr{constructor(t,e=null,s=[],i=[],r=null,o="F",a=null,l=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=s,this.filters=i,this.limit=r,this.limitType=o,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function O1(n,t,e,s,i,r,o,a){return new Fr(n,t,e,s,i,r,o,a)}function Gc(n){return new Fr(n)}function Im(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Jv(n){return n.collectionGroup!==null}function Oo(n){const t=xt(n);if(t.Ie===null){t.Ie=[];const e=new Set;for(const r of t.explicitOrderBy)t.Ie.push(r),e.add(r.field.canonicalString());const s=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new ge(Se.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(t).forEach(r=>{e.has(r.canonicalString())||r.isKeyField()||t.Ie.push(new ac(r,s))}),e.has(Se.keyField().canonicalString())||t.Ie.push(new ac(Se.keyField(),s))}return t.Ie}function Fn(n){const t=xt(n);return t.Ee||(t.Ee=L1(t,Oo(n))),t.Ee}function L1(n,t){if(n.limitType==="F")return Em(n.path,n.collectionGroup,t,n.filters,n.limit,n.startAt,n.endAt);{t=t.map(i=>{const r=i.dir==="desc"?"asc":"desc";return new ac(i.field,r)});const e=n.endAt?new oc(n.endAt.position,n.endAt.inclusive):null,s=n.startAt?new oc(n.startAt.position,n.startAt.inclusive):null;return Em(n.path,n.collectionGroup,t,n.filters,n.limit,e,s)}}function Hh(n,t){const e=n.filters.concat([t]);return new Fr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),e,n.limit,n.limitType,n.startAt,n.endAt)}function Wh(n,t,e){return new Fr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),t,e,n.startAt,n.endAt)}function Kc(n,t){return Zd(Fn(n),Fn(t))&&n.limitType===t.limitType}function Zv(n){return`${Jd(Fn(n))}|lt:${n.limitType}`}function or(n){return`Query(target=${function(e){let s=e.path.canonicalString();return e.collectionGroup!==null&&(s+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(s+=`, filters: [${e.filters.map(i=>Xv(i)).join(", ")}]`),Wc(e.limit)||(s+=", limit: "+e.limit),e.orderBy.length>0&&(s+=`, orderBy: [${e.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),e.startAt&&(s+=", startAt: ",s+=e.startAt.inclusive?"b:":"a:",s+=e.startAt.position.map(i=>Ir(i)).join(",")),e.endAt&&(s+=", endAt: ",s+=e.endAt.inclusive?"a:":"b:",s+=e.endAt.position.map(i=>Ir(i)).join(",")),`Target(${s})`}(Fn(n))}; limitType=${n.limitType})`}function Yc(n,t){return t.isFoundDocument()&&function(s,i){const r=i.key.path;return s.collectionGroup!==null?i.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(r):ut.isDocumentKey(s.path)?s.path.isEqual(r):s.path.isImmediateParentOf(r)}(n,t)&&function(s,i){for(const r of Oo(s))if(!r.field.isKeyField()&&i.data.field(r.field)===null)return!1;return!0}(n,t)&&function(s,i){for(const r of s.filters)if(!r.matches(i))return!1;return!0}(n,t)&&function(s,i){return!(s.startAt&&!function(o,a,l){const c=xm(o,a,l);return o.inclusive?c<=0:c<0}(s.startAt,Oo(s),i)||s.endAt&&!function(o,a,l){const c=xm(o,a,l);return o.inclusive?c>=0:c>0}(s.endAt,Oo(s),i))}(n,t)}function V1(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function t0(n){return(t,e)=>{let s=!1;for(const i of Oo(n)){const r=N1(i,t,e);if(r!==0)return r;s=s||i.field.isKeyField()}return 0}}function N1(n,t,e){const s=n.field.isKeyField()?ut.comparator(t.key,e.key):function(r,o,a){const l=o.data.field(r),c=a.data.field(r);return l!==null&&c!==null?Er(l,c):gt(42886)}(n.field,t,e);switch(n.dir){case"asc":return s;case"desc":return-1*s;default:return gt(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qi{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),s=this.inner[e];if(s!==void 0){for(const[i,r]of s)if(this.equalsFn(i,t))return r}}has(t){return this.get(t)!==void 0}set(t,e){const s=this.mapKeyFn(t),i=this.inner[s];if(i===void 0)return this.inner[s]=[[t,e]],void this.innerSize++;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],t))return void(i[r]=[t,e]);i.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),s=this.inner[e];if(s===void 0)return!1;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],t))return s.length===1?delete this.inner[e]:s.splice(i,1),this.innerSize--,!0;return!1}forEach(t){ci(this.inner,(e,s)=>{for(const[i,r]of s)t(i,r)})}isEmpty(){return Nv(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F1=new ne(ut.comparator);function ys(){return F1}const e0=new ne(ut.comparator);function go(...n){let t=e0;for(const e of n)t=t.insert(e.key,e);return t}function n0(n){let t=e0;return n.forEach((e,s)=>t=t.insert(e,s.overlayedDocument)),t}function Pi(){return Lo()}function s0(){return Lo()}function Lo(){return new qi(n=>n.toString(),(n,t)=>n.isEqual(t))}const B1=new ne(ut.comparator),U1=new ge(ut.comparator);function kt(...n){let t=U1;for(const e of n)t=t.add(e);return t}const $1=new ge(Rt);function z1(){return $1}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tf(n,t){if(n.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:sc(t)?"-0":t}}function i0(n){return{integerValue:""+n}}function r0(n,t){return m1(t)?i0(t):tf(n,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xc{constructor(){this._=void 0}}function j1(n,t,e){return n instanceof lc?function(i,r){const o={fields:{[Uv]:{stringValue:Bv},[zv]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return r&&Xd(r)&&(r=qc(r)),r&&(o.fields[$v]=r),{mapValue:o}}(e,t):n instanceof ta?a0(n,t):n instanceof ea?l0(n,t):function(i,r){const o=o0(i,r),a=Sm(o)+Sm(i.Ae);return $h(o)&&$h(i.Ae)?i0(a):tf(i.serializer,a)}(n,t)}function H1(n,t,e){return n instanceof ta?a0(n,t):n instanceof ea?l0(n,t):e}function o0(n,t){return n instanceof na?function(s){return $h(s)||function(r){return!!r&&"doubleValue"in r}(s)}(t)?t:{integerValue:0}:null}class lc extends Xc{}class ta extends Xc{constructor(t){super(),this.elements=t}}function a0(n,t){const e=c0(t);for(const s of n.elements)e.some(i=>Gn(i,s))||e.push(s);return{arrayValue:{values:e}}}class ea extends Xc{constructor(t){super(),this.elements=t}}function l0(n,t){let e=c0(t);for(const s of n.elements)e=e.filter(i=>!Gn(i,s));return{arrayValue:{values:e}}}class na extends Xc{constructor(t,e){super(),this.serializer=t,this.Ae=e}}function Sm(n){return ae(n.integerValue||n.doubleValue)}function c0(n){return Qd(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W1{constructor(t,e){this.field=t,this.transform=e}}function q1(n,t){return n.field.isEqual(t.field)&&function(s,i){return s instanceof ta&&i instanceof ta||s instanceof ea&&i instanceof ea?Tr(s.elements,i.elements,Gn):s instanceof na&&i instanceof na?Gn(s.Ae,i.Ae):s instanceof lc&&i instanceof lc}(n.transform,t.transform)}class G1{constructor(t,e){this.version=t,this.transformResults=e}}class gn{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new gn}static exists(t){return new gn(void 0,t)}static updateTime(t){return new gn(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function Rl(n,t){return n.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(n.updateTime):n.exists===void 0||n.exists===t.isFoundDocument()}class Qc{}function u0(n,t){if(!n.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return n.isNoDocument()?new ef(n.key,gn.none()):new xa(n.key,n.data,gn.none());{const e=n.data,s=Je.empty();let i=new ge(Se.comparator);for(let r of t.fields)if(!i.has(r)){let o=e.field(r);o===null&&r.length>1&&(r=r.popLast(),o=e.field(r)),o===null?s.delete(r):s.set(r,o),i=i.add(r)}return new ui(n.key,s,new an(i.toArray()),gn.none())}}function K1(n,t,e){n instanceof xa?function(i,r,o){const a=i.value.clone(),l=Cm(i.fieldTransforms,r,o.transformResults);a.setAll(l),r.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,t,e):n instanceof ui?function(i,r,o){if(!Rl(i.precondition,r))return void r.convertToUnknownDocument(o.version);const a=Cm(i.fieldTransforms,r,o.transformResults),l=r.data;l.setAll(h0(i)),l.setAll(a),r.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(n,t,e):function(i,r,o){r.convertToNoDocument(o.version).setHasCommittedMutations()}(0,t,e)}function Vo(n,t,e,s){return n instanceof xa?function(r,o,a,l){if(!Rl(r.precondition,o))return a;const c=r.value.clone(),h=Pm(r.fieldTransforms,l,o);return c.setAll(h),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(n,t,e,s):n instanceof ui?function(r,o,a,l){if(!Rl(r.precondition,o))return a;const c=Pm(r.fieldTransforms,l,o),h=o.data;return h.setAll(h0(r)),h.setAll(c),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(r.fieldMask.fields).unionWith(r.fieldTransforms.map(d=>d.field))}(n,t,e,s):function(r,o,a){return Rl(r.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,t,e)}function Y1(n,t){let e=null;for(const s of n.fieldTransforms){const i=t.data.field(s.field),r=o0(s.transform,i||null);r!=null&&(e===null&&(e=Je.empty()),e.set(s.field,r))}return e||null}function Am(n,t){return n.type===t.type&&!!n.key.isEqual(t.key)&&!!n.precondition.isEqual(t.precondition)&&!!function(s,i){return s===void 0&&i===void 0||!(!s||!i)&&Tr(s,i,(r,o)=>q1(r,o))}(n.fieldTransforms,t.fieldTransforms)&&(n.type===0?n.value.isEqual(t.value):n.type!==1||n.data.isEqual(t.data)&&n.fieldMask.isEqual(t.fieldMask))}class xa extends Qc{constructor(t,e,s,i=[]){super(),this.key=t,this.value=e,this.precondition=s,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class ui extends Qc{constructor(t,e,s,i,r=[]){super(),this.key=t,this.data=e,this.fieldMask=s,this.precondition=i,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function h0(n){const t=new Map;return n.fieldMask.fields.forEach(e=>{if(!e.isEmpty()){const s=n.data.field(e);t.set(e,s)}}),t}function Cm(n,t,e){const s=new Map;$t(n.length===e.length,32656,{Re:e.length,Ve:n.length});for(let i=0;i<e.length;i++){const r=n[i],o=r.transform,a=t.data.field(r.field);s.set(r.field,H1(o,a,e[i]))}return s}function Pm(n,t,e){const s=new Map;for(const i of n){const r=i.transform,o=e.data.field(i.field);s.set(i.field,j1(r,o,t))}return s}class ef extends Qc{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class X1 extends Qc{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q1{constructor(t,e,s,i){this.batchId=t,this.localWriteTime=e,this.baseMutations=s,this.mutations=i}applyToRemoteDocument(t,e){const s=e.mutationResults;for(let i=0;i<this.mutations.length;i++){const r=this.mutations[i];r.key.isEqual(t.key)&&K1(r,t,s[i])}}applyToLocalView(t,e){for(const s of this.baseMutations)s.key.isEqual(t.key)&&(e=Vo(s,t,e,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(t.key)&&(e=Vo(s,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const s=s0();return this.mutations.forEach(i=>{const r=t.get(i.key),o=r.overlayedDocument;let a=this.applyToLocalView(o,r.mutatedFields);a=e.has(i.key)?null:a;const l=u0(o,a);l!==null&&s.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(vt.min())}),s}keys(){return this.mutations.reduce((t,e)=>t.add(e.key),kt())}isEqual(t){return this.batchId===t.batchId&&Tr(this.mutations,t.mutations,(e,s)=>Am(e,s))&&Tr(this.baseMutations,t.baseMutations,(e,s)=>Am(e,s))}}class nf{constructor(t,e,s,i){this.batch=t,this.commitVersion=e,this.mutationResults=s,this.docVersions=i}static from(t,e,s){$t(t.mutations.length===s.length,58842,{me:t.mutations.length,fe:s.length});let i=function(){return B1}();const r=t.mutations;for(let o=0;o<r.length;o++)i=i.insert(r[o].key,s[o].version);return new nf(t,e,s,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J1{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z1{constructor(t,e){this.count=t,this.unchangedNames=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ce,Ot;function tP(n){switch(n){case U.OK:return gt(64938);case U.CANCELLED:case U.UNKNOWN:case U.DEADLINE_EXCEEDED:case U.RESOURCE_EXHAUSTED:case U.INTERNAL:case U.UNAVAILABLE:case U.UNAUTHENTICATED:return!1;case U.INVALID_ARGUMENT:case U.NOT_FOUND:case U.ALREADY_EXISTS:case U.PERMISSION_DENIED:case U.FAILED_PRECONDITION:case U.ABORTED:case U.OUT_OF_RANGE:case U.UNIMPLEMENTED:case U.DATA_LOSS:return!0;default:return gt(15467,{code:n})}}function d0(n){if(n===void 0)return _s("GRPC error has no .code"),U.UNKNOWN;switch(n){case ce.OK:return U.OK;case ce.CANCELLED:return U.CANCELLED;case ce.UNKNOWN:return U.UNKNOWN;case ce.DEADLINE_EXCEEDED:return U.DEADLINE_EXCEEDED;case ce.RESOURCE_EXHAUSTED:return U.RESOURCE_EXHAUSTED;case ce.INTERNAL:return U.INTERNAL;case ce.UNAVAILABLE:return U.UNAVAILABLE;case ce.UNAUTHENTICATED:return U.UNAUTHENTICATED;case ce.INVALID_ARGUMENT:return U.INVALID_ARGUMENT;case ce.NOT_FOUND:return U.NOT_FOUND;case ce.ALREADY_EXISTS:return U.ALREADY_EXISTS;case ce.PERMISSION_DENIED:return U.PERMISSION_DENIED;case ce.FAILED_PRECONDITION:return U.FAILED_PRECONDITION;case ce.ABORTED:return U.ABORTED;case ce.OUT_OF_RANGE:return U.OUT_OF_RANGE;case ce.UNIMPLEMENTED:return U.UNIMPLEMENTED;case ce.DATA_LOSS:return U.DATA_LOSS;default:return gt(39323,{code:n})}}(Ot=ce||(ce={}))[Ot.OK=0]="OK",Ot[Ot.CANCELLED=1]="CANCELLED",Ot[Ot.UNKNOWN=2]="UNKNOWN",Ot[Ot.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ot[Ot.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ot[Ot.NOT_FOUND=5]="NOT_FOUND",Ot[Ot.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ot[Ot.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ot[Ot.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ot[Ot.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ot[Ot.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ot[Ot.ABORTED=10]="ABORTED",Ot[Ot.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ot[Ot.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ot[Ot.INTERNAL=13]="INTERNAL",Ot[Ot.UNAVAILABLE=14]="UNAVAILABLE",Ot[Ot.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eP(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nP=new Ys([4294967295,4294967295],0);function Rm(n){const t=eP().encode(n),e=new Av;return e.update(t),new Uint8Array(e.digest())}function km(n){const t=new DataView(n.buffer),e=t.getUint32(0,!0),s=t.getUint32(4,!0),i=t.getUint32(8,!0),r=t.getUint32(12,!0);return[new Ys([e,s],0),new Ys([i,r],0)]}class sf{constructor(t,e,s){if(this.bitmap=t,this.padding=e,this.hashCount=s,e<0||e>=8)throw new mo(`Invalid padding: ${e}`);if(s<0)throw new mo(`Invalid hash count: ${s}`);if(t.length>0&&this.hashCount===0)throw new mo(`Invalid hash count: ${s}`);if(t.length===0&&e!==0)throw new mo(`Invalid padding when bitmap length is 0: ${e}`);this.ge=8*t.length-e,this.pe=Ys.fromNumber(this.ge)}ye(t,e,s){let i=t.add(e.multiply(Ys.fromNumber(s)));return i.compare(nP)===1&&(i=new Ys([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(this.ge===0)return!1;const e=Rm(t),[s,i]=km(e);for(let r=0;r<this.hashCount;r++){const o=this.ye(s,i,r);if(!this.we(o))return!1}return!0}static create(t,e,s){const i=t%8==0?0:8-t%8,r=new Uint8Array(Math.ceil(t/8)),o=new sf(r,i,e);return s.forEach(a=>o.insert(a)),o}insert(t){if(this.ge===0)return;const e=Rm(t),[s,i]=km(e);for(let r=0;r<this.hashCount;r++){const o=this.ye(s,i,r);this.Se(o)}}Se(t){const e=Math.floor(t/8),s=t%8;this.bitmap[e]|=1<<s}}class mo extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jc{constructor(t,e,s,i,r){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=s,this.documentUpdates=i,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(t,e,s){const i=new Map;return i.set(t,Ta.createSynthesizedTargetChangeForCurrentChange(t,e,s)),new Jc(vt.min(),i,new ne(Rt),ys(),kt())}}class Ta{constructor(t,e,s,i,r){this.resumeToken=t,this.current=e,this.addedDocuments=s,this.modifiedDocuments=i,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(t,e,s){return new Ta(s,e,kt(),kt(),kt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kl{constructor(t,e,s,i){this.be=t,this.removedTargetIds=e,this.key=s,this.De=i}}class f0{constructor(t,e){this.targetId=t,this.Ce=e}}class p0{constructor(t,e,s=Ae.EMPTY_BYTE_STRING,i=null){this.state=t,this.targetIds=e,this.resumeToken=s,this.cause=i}}class Dm{constructor(){this.ve=0,this.Fe=Mm(),this.Me=Ae.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(t){t.approximateByteSize()>0&&(this.Oe=!0,this.Me=t)}ke(){let t=kt(),e=kt(),s=kt();return this.Fe.forEach((i,r)=>{switch(r){case 0:t=t.add(i);break;case 2:e=e.add(i);break;case 1:s=s.add(i);break;default:gt(38017,{changeType:r})}}),new Ta(this.Me,this.xe,t,e,s)}qe(){this.Oe=!1,this.Fe=Mm()}Qe(t,e){this.Oe=!0,this.Fe=this.Fe.insert(t,e)}$e(t){this.Oe=!0,this.Fe=this.Fe.remove(t)}Ue(){this.ve+=1}Ke(){this.ve-=1,$t(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class sP{constructor(t){this.Ge=t,this.ze=new Map,this.je=ys(),this.Je=sl(),this.He=sl(),this.Ye=new ne(Rt)}Ze(t){for(const e of t.be)t.De&&t.De.isFoundDocument()?this.Xe(e,t.De):this.et(e,t.key,t.De);for(const e of t.removedTargetIds)this.et(e,t.key,t.De)}tt(t){this.forEachTarget(t,e=>{const s=this.nt(e);switch(t.state){case 0:this.rt(e)&&s.Le(t.resumeToken);break;case 1:s.Ke(),s.Ne||s.qe(),s.Le(t.resumeToken);break;case 2:s.Ke(),s.Ne||this.removeTarget(e);break;case 3:this.rt(e)&&(s.We(),s.Le(t.resumeToken));break;case 4:this.rt(e)&&(this.it(e),s.Le(t.resumeToken));break;default:gt(56790,{state:t.state})}})}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.ze.forEach((s,i)=>{this.rt(i)&&e(i)})}st(t){const e=t.targetId,s=t.Ce.count,i=this.ot(e);if(i){const r=i.target;if(jh(r))if(s===0){const o=new ut(r.path);this.et(e,o,Ve.newNoDocument(o,vt.min()))}else $t(s===1,20013,{expectedCount:s});else{const o=this._t(e);if(o!==s){const a=this.ut(t),l=a?this.ct(a,t,o):1;if(l!==0){this.it(e);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(e,c)}}}}}ut(t){const e=t.Ce.unchangedNames;if(!e||!e.bits)return null;const{bits:{bitmap:s="",padding:i=0},hashCount:r=0}=e;let o,a;try{o=si(s).toUint8Array()}catch(l){if(l instanceof Fv)return xr("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new sf(o,i,r)}catch(l){return xr(l instanceof mo?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(t,e,s){return e.Ce.count===s-this.Pt(t,e.targetId)?0:2}Pt(t,e){const s=this.Ge.getRemoteKeysForTarget(e);let i=0;return s.forEach(r=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${r.path.canonicalString()}`;t.mightContain(a)||(this.et(e,r,null),i++)}),i}Tt(t){const e=new Map;this.ze.forEach((r,o)=>{const a=this.ot(o);if(a){if(r.current&&jh(a.target)){const l=new ut(a.target.path);this.It(l).has(o)||this.Et(o,l)||this.et(o,l,Ve.newNoDocument(l,t))}r.Be&&(e.set(o,r.ke()),r.qe())}});let s=kt();this.He.forEach((r,o)=>{let a=!0;o.forEachWhile(l=>{const c=this.ot(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(s=s.add(r))}),this.je.forEach((r,o)=>o.setReadTime(t));const i=new Jc(t,e,this.Ye,this.je,s);return this.je=ys(),this.Je=sl(),this.He=sl(),this.Ye=new ne(Rt),i}Xe(t,e){if(!this.rt(t))return;const s=this.Et(t,e.key)?2:0;this.nt(t).Qe(e.key,s),this.je=this.je.insert(e.key,e),this.Je=this.Je.insert(e.key,this.It(e.key).add(t)),this.He=this.He.insert(e.key,this.dt(e.key).add(t))}et(t,e,s){if(!this.rt(t))return;const i=this.nt(t);this.Et(t,e)?i.Qe(e,1):i.$e(e),this.He=this.He.insert(e,this.dt(e).delete(t)),this.He=this.He.insert(e,this.dt(e).add(t)),s&&(this.je=this.je.insert(e,s))}removeTarget(t){this.ze.delete(t)}_t(t){const e=this.nt(t).ke();return this.Ge.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}Ue(t){this.nt(t).Ue()}nt(t){let e=this.ze.get(t);return e||(e=new Dm,this.ze.set(t,e)),e}dt(t){let e=this.He.get(t);return e||(e=new ge(Rt),this.He=this.He.insert(t,e)),e}It(t){let e=this.Je.get(t);return e||(e=new ge(Rt),this.Je=this.Je.insert(t,e)),e}rt(t){const e=this.ot(t)!==null;return e||nt("WatchChangeAggregator","Detected inactive target",t),e}ot(t){const e=this.ze.get(t);return e&&e.Ne?null:this.Ge.At(t)}it(t){this.ze.set(t,new Dm),this.Ge.getRemoteKeysForTarget(t).forEach(e=>{this.et(t,e,null)})}Et(t,e){return this.Ge.getRemoteKeysForTarget(t).has(e)}}function sl(){return new ne(ut.comparator)}function Mm(){return new ne(ut.comparator)}const iP={asc:"ASCENDING",desc:"DESCENDING"},rP={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},oP={and:"AND",or:"OR"};class aP{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function qh(n,t){return n.useProto3Json||Wc(t)?t:{value:t}}function cc(n,t){return n.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function g0(n,t){return n.useProto3Json?t.toBase64():t.toUint8Array()}function lP(n,t){return cc(n,t.toTimestamp())}function Bn(n){return $t(!!n,49232),vt.fromTimestamp(function(e){const s=ni(e);return new qt(s.seconds,s.nanos)}(n))}function rf(n,t){return Gh(n,t).canonicalString()}function Gh(n,t){const e=function(i){return new Wt(["projects",i.projectId,"databases",i.database])}(n).child("documents");return t===void 0?e:e.child(t)}function m0(n){const t=Wt.fromString(n);return $t(w0(t),10190,{key:t.toString()}),t}function Kh(n,t){return rf(n.databaseId,t.path)}function Ju(n,t){const e=m0(t);if(e.get(1)!==n.databaseId.projectId)throw new et(U.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+n.databaseId.projectId);if(e.get(3)!==n.databaseId.database)throw new et(U.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+n.databaseId.database);return new ut(y0(e))}function _0(n,t){return rf(n.databaseId,t)}function cP(n){const t=m0(n);return t.length===4?Wt.emptyPath():y0(t)}function Yh(n){return new Wt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function y0(n){return $t(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Om(n,t,e){return{name:Kh(n,t),fields:e.value.mapValue.fields}}function uP(n,t){let e;if("targetChange"in t){t.targetChange;const s=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:gt(39313,{state:c})}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],r=function(c,h){return c.useProto3Json?($t(h===void 0||typeof h=="string",58123),Ae.fromBase64String(h||"")):($t(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),Ae.fromUint8Array(h||new Uint8Array))}(n,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(c){const h=c.code===void 0?U.UNKNOWN:d0(c.code);return new et(h,c.message||"")}(o);e=new p0(s,i,r,a||null)}else if("documentChange"in t){t.documentChange;const s=t.documentChange;s.document,s.document.name,s.document.updateTime;const i=Ju(n,s.document.name),r=Bn(s.document.updateTime),o=s.document.createTime?Bn(s.document.createTime):vt.min(),a=new Je({mapValue:{fields:s.document.fields}}),l=Ve.newFoundDocument(i,r,o,a),c=s.targetIds||[],h=s.removedTargetIds||[];e=new kl(c,h,l.key,l)}else if("documentDelete"in t){t.documentDelete;const s=t.documentDelete;s.document;const i=Ju(n,s.document),r=s.readTime?Bn(s.readTime):vt.min(),o=Ve.newNoDocument(i,r),a=s.removedTargetIds||[];e=new kl([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const s=t.documentRemove;s.document;const i=Ju(n,s.document),r=s.removedTargetIds||[];e=new kl([],r,i,null)}else{if(!("filter"in t))return gt(11601,{Rt:t});{t.filter;const s=t.filter;s.targetId;const{count:i=0,unchangedNames:r}=s,o=new Z1(i,r),a=s.targetId;e=new f0(a,o)}}return e}function hP(n,t){let e;if(t instanceof xa)e={update:Om(n,t.key,t.value)};else if(t instanceof ef)e={delete:Kh(n,t.key)};else if(t instanceof ui)e={update:Om(n,t.key,t.data),updateMask:vP(t.fieldMask)};else{if(!(t instanceof X1))return gt(16599,{Vt:t.type});e={verify:Kh(n,t.key)}}return t.fieldTransforms.length>0&&(e.updateTransforms=t.fieldTransforms.map(s=>function(r,o){const a=o.transform;if(a instanceof lc)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof ta)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof ea)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof na)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw gt(20930,{transform:o.transform})}(0,s))),t.precondition.isNone||(e.currentDocument=function(i,r){return r.updateTime!==void 0?{updateTime:lP(i,r.updateTime)}:r.exists!==void 0?{exists:r.exists}:gt(27497)}(n,t.precondition)),e}function dP(n,t){return n&&n.length>0?($t(t!==void 0,14353),n.map(e=>function(i,r){let o=i.updateTime?Bn(i.updateTime):Bn(r);return o.isEqual(vt.min())&&(o=Bn(r)),new G1(o,i.transformResults||[])}(e,t))):[]}function fP(n,t){return{documents:[_0(n,t.path)]}}function pP(n,t){const e={structuredQuery:{}},s=t.path;let i;t.collectionGroup!==null?(i=s,e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=s.popLast(),e.structuredQuery.from=[{collectionId:s.lastSegment()}]),e.parent=_0(n,i);const r=function(c){if(c.length!==0)return v0(In.create(c,"and"))}(t.filters);r&&(e.structuredQuery.where=r);const o=function(c){if(c.length!==0)return c.map(h=>function(f){return{field:ar(f.field),direction:_P(f.dir)}}(h))}(t.orderBy);o&&(e.structuredQuery.orderBy=o);const a=qh(n,t.limit);return a!==null&&(e.structuredQuery.limit=a),t.startAt&&(e.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(t.startAt)),t.endAt&&(e.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(t.endAt)),{ft:e,parent:i}}function gP(n){let t=cP(n.parent);const e=n.structuredQuery,s=e.from?e.from.length:0;let i=null;if(s>0){$t(s===1,65062);const h=e.from[0];h.allDescendants?i=h.collectionId:t=t.child(h.collectionId)}let r=[];e.where&&(r=function(d){const f=b0(d);return f instanceof In&&Kv(f)?f.getFilters():[f]}(e.where));let o=[];e.orderBy&&(o=function(d){return d.map(f=>function(_){return new ac(lr(_.field),function(v){switch(v){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(_.direction))}(f))}(e.orderBy));let a=null;e.limit&&(a=function(d){let f;return f=typeof d=="object"?d.value:d,Wc(f)?null:f}(e.limit));let l=null;e.startAt&&(l=function(d){const f=!!d.before,g=d.values||[];return new oc(g,f)}(e.startAt));let c=null;return e.endAt&&(c=function(d){const f=!d.before,g=d.values||[];return new oc(g,f)}(e.endAt)),O1(t,i,o,r,a,"F",l,c)}function mP(n,t){const e=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return gt(28987,{purpose:i})}}(t.purpose);return e==null?null:{"goog-listen-tags":e}}function b0(n){return n.unaryFilter!==void 0?function(e){switch(e.unaryFilter.op){case"IS_NAN":const s=lr(e.unaryFilter.field);return ue.create(s,"==",{doubleValue:NaN});case"IS_NULL":const i=lr(e.unaryFilter.field);return ue.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=lr(e.unaryFilter.field);return ue.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=lr(e.unaryFilter.field);return ue.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return gt(61313);default:return gt(60726)}}(n):n.fieldFilter!==void 0?function(e){return ue.create(lr(e.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return gt(58110);default:return gt(50506)}}(e.fieldFilter.op),e.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(e){return In.create(e.compositeFilter.filters.map(s=>b0(s)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return gt(1026)}}(e.compositeFilter.op))}(n):gt(30097,{filter:n})}function _P(n){return iP[n]}function yP(n){return rP[n]}function bP(n){return oP[n]}function ar(n){return{fieldPath:n.canonicalString()}}function lr(n){return Se.fromServerFormat(n.fieldPath)}function v0(n){return n instanceof ue?function(e){if(e.op==="=="){if(wm(e.value))return{unaryFilter:{field:ar(e.field),op:"IS_NAN"}};if(vm(e.value))return{unaryFilter:{field:ar(e.field),op:"IS_NULL"}}}else if(e.op==="!="){if(wm(e.value))return{unaryFilter:{field:ar(e.field),op:"IS_NOT_NAN"}};if(vm(e.value))return{unaryFilter:{field:ar(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ar(e.field),op:yP(e.op),value:e.value}}}(n):n instanceof In?function(e){const s=e.getFilters().map(i=>v0(i));return s.length===1?s[0]:{compositeFilter:{op:bP(e.op),filters:s}}}(n):gt(54877,{filter:n})}function vP(n){const t=[];return n.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function w0(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bs{constructor(t,e,s,i,r=vt.min(),o=vt.min(),a=Ae.EMPTY_BYTE_STRING,l=null){this.target=t,this.targetId=e,this.purpose=s,this.sequenceNumber=i,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(t){return new Bs(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,e){return new Bs(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new Bs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new Bs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wP{constructor(t){this.yt=t}}function xP(n){const t=gP({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Wh(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TP{constructor(){this.Cn=new EP}addToCollectionParentIndex(t,e){return this.Cn.add(e),$.resolve()}getCollectionParents(t,e){return $.resolve(this.Cn.getEntries(e))}addFieldIndex(t,e){return $.resolve()}deleteFieldIndex(t,e){return $.resolve()}deleteAllFieldIndexes(t){return $.resolve()}createTargetIndexes(t,e){return $.resolve()}getDocumentsMatchingTarget(t,e){return $.resolve(null)}getIndexType(t,e){return $.resolve(0)}getFieldIndexes(t,e){return $.resolve([])}getNextCollectionGroupToUpdate(t){return $.resolve(null)}getMinOffset(t,e){return $.resolve(ei.min())}getMinOffsetFromCollectionGroup(t,e){return $.resolve(ei.min())}updateCollectionGroup(t,e,s){return $.resolve()}updateIndexEntries(t,e){return $.resolve()}}class EP{constructor(){this.index={}}add(t){const e=t.lastSegment(),s=t.popLast(),i=this.index[e]||new ge(Wt.comparator),r=!i.has(s);return this.index[e]=i.add(s),r}has(t){const e=t.lastSegment(),s=t.popLast(),i=this.index[e];return i&&i.has(s)}getEntries(t){return(this.index[t]||new ge(Wt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lm={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},x0=41943040;class Xe{static withCacheSize(t){return new Xe(t,Xe.DEFAULT_COLLECTION_PERCENTILE,Xe.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,e,s){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Xe.DEFAULT_COLLECTION_PERCENTILE=10,Xe.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Xe.DEFAULT=new Xe(x0,Xe.DEFAULT_COLLECTION_PERCENTILE,Xe.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Xe.DISABLED=new Xe(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr{constructor(t){this.ar=t}next(){return this.ar+=2,this.ar}static ur(){return new Sr(0)}static cr(){return new Sr(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vm="LruGarbageCollector",IP=1048576;function Nm([n,t],[e,s]){const i=Rt(n,e);return i===0?Rt(t,s):i}class SP{constructor(t){this.Ir=t,this.buffer=new ge(Nm),this.Er=0}dr(){return++this.Er}Ar(t){const e=[t,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(e);else{const s=this.buffer.last();Nm(e,s)<0&&(this.buffer=this.buffer.delete(s).add(e))}}get maxValue(){return this.buffer.last()[0]}}class AP{constructor(t,e,s){this.garbageCollector=t,this.asyncQueue=e,this.localStore=s,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(t){nt(Vm,`Garbage collection scheduled in ${t}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){Nr(e)?nt(Vm,"Ignoring IndexedDB error during garbage collection: ",e):await Vr(e)}await this.Vr(3e5)})}}class CP{constructor(t,e){this.mr=t,this.params=e}calculateTargetCount(t,e){return this.mr.gr(t).next(s=>Math.floor(e/100*s))}nthSequenceNumber(t,e){if(e===0)return $.resolve(Hc.ce);const s=new SP(e);return this.mr.forEachTarget(t,i=>s.Ar(i.sequenceNumber)).next(()=>this.mr.pr(t,i=>s.Ar(i))).next(()=>s.maxValue)}removeTargets(t,e,s){return this.mr.removeTargets(t,e,s)}removeOrphanedDocuments(t,e){return this.mr.removeOrphanedDocuments(t,e)}collect(t,e){return this.params.cacheSizeCollectionThreshold===-1?(nt("LruGarbageCollector","Garbage collection skipped; disabled"),$.resolve(Lm)):this.getCacheSize(t).next(s=>s<this.params.cacheSizeCollectionThreshold?(nt("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Lm):this.yr(t,e))}getCacheSize(t){return this.mr.getCacheSize(t)}yr(t,e){let s,i,r,o,a,l,c;const h=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(nt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),i=this.params.maximumSequenceNumbersToCollect):i=d,o=Date.now(),this.nthSequenceNumber(t,i))).next(d=>(s=d,a=Date.now(),this.removeTargets(t,s,e))).next(d=>(r=d,l=Date.now(),this.removeOrphanedDocuments(t,s))).next(d=>(c=Date.now(),rr()<=Pt.DEBUG&&nt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${r} targets in `+(l-a)+`ms
	Removed ${d} documents in `+(c-l)+`ms
Total Duration: ${c-h}ms`),$.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:r,documentsRemoved:d})))}}function PP(n,t){return new CP(n,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RP{constructor(){this.changes=new qi(t=>t.toString(),(t,e)=>t.isEqual(e)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,Ve.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const s=this.changes.get(e);return s!==void 0?$.resolve(s):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kP{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DP{constructor(t,e,s,i){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=s,this.indexManager=i}getDocument(t,e){let s=null;return this.documentOverlayCache.getOverlay(t,e).next(i=>(s=i,this.remoteDocumentCache.getEntry(t,e))).next(i=>(s!==null&&Vo(s.mutation,i,an.empty(),qt.now()),i))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next(s=>this.getLocalViewOfDocuments(t,s,kt()).next(()=>s))}getLocalViewOfDocuments(t,e,s=kt()){const i=Pi();return this.populateOverlays(t,i,e).next(()=>this.computeViews(t,e,i,s).next(r=>{let o=go();return r.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(t,e){const s=Pi();return this.populateOverlays(t,s,e).next(()=>this.computeViews(t,e,s,kt()))}populateOverlays(t,e,s){const i=[];return s.forEach(r=>{e.has(r)||i.push(r)}),this.documentOverlayCache.getOverlays(t,i).next(r=>{r.forEach((o,a)=>{e.set(o,a)})})}computeViews(t,e,s,i){let r=ys();const o=Lo(),a=function(){return Lo()}();return e.forEach((l,c)=>{const h=s.get(c.key);i.has(c.key)&&(h===void 0||h.mutation instanceof ui)?r=r.insert(c.key,c):h!==void 0?(o.set(c.key,h.mutation.getFieldMask()),Vo(h.mutation,c,h.mutation.getFieldMask(),qt.now())):o.set(c.key,an.empty())}),this.recalculateAndSaveOverlays(t,r).next(l=>(l.forEach((c,h)=>o.set(c,h)),e.forEach((c,h)=>a.set(c,new kP(h,o.get(c)??null))),a))}recalculateAndSaveOverlays(t,e){const s=Lo();let i=new ne((o,a)=>o-a),r=kt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=e.get(l);if(c===null)return;let h=s.get(l)||an.empty();h=a.applyToLocalView(c,h),s.set(l,h);const d=(i.get(a.batchId)||kt()).add(l);i=i.insert(a.batchId,d)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,h=l.value,d=s0();h.forEach(f=>{if(!r.has(f)){const g=u0(e.get(f),s.get(f));g!==null&&d.set(f,g),r=r.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(t,c,d))}return $.waitFor(o)}).next(()=>s)}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next(s=>this.recalculateAndSaveOverlays(t,s))}getDocumentsMatchingQuery(t,e,s,i){return function(o){return ut.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):Jv(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,s,i):this.getDocumentsMatchingCollectionQuery(t,e,s,i)}getNextDocuments(t,e,s,i){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,s,i).next(r=>{const o=i-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,s.largestBatchId,i-r.size):$.resolve(Pi());let a=Xo,l=r;return o.next(c=>$.forEach(c,(h,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),r.get(h)?$.resolve():this.remoteDocumentCache.getEntry(t,h).next(f=>{l=l.insert(h,f)}))).next(()=>this.populateOverlays(t,c,r)).next(()=>this.computeViews(t,l,c,kt())).next(h=>({batchId:a,changes:n0(h)})))})}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new ut(e)).next(s=>{let i=go();return s.isFoundDocument()&&(i=i.insert(s.key,s)),i})}getDocumentsMatchingCollectionGroupQuery(t,e,s,i){const r=e.collectionGroup;let o=go();return this.indexManager.getCollectionParents(t,r).next(a=>$.forEach(a,l=>{const c=function(d,f){return new Fr(f,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(e,l.child(r));return this.getDocumentsMatchingCollectionQuery(t,c,s,i).next(h=>{h.forEach((d,f)=>{o=o.insert(d,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(t,e,s,i){let r;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,s.largestBatchId).next(o=>(r=o,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,s,r,i))).next(o=>{r.forEach((l,c)=>{const h=c.getKey();o.get(h)===null&&(o=o.insert(h,Ve.newInvalidDocument(h)))});let a=go();return o.forEach((l,c)=>{const h=r.get(l);h!==void 0&&Vo(h.mutation,c,an.empty(),qt.now()),Yc(e,c)&&(a=a.insert(l,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MP{constructor(t){this.serializer=t,this.Lr=new Map,this.kr=new Map}getBundleMetadata(t,e){return $.resolve(this.Lr.get(e))}saveBundleMetadata(t,e){return this.Lr.set(e.id,function(i){return{id:i.id,version:i.version,createTime:Bn(i.createTime)}}(e)),$.resolve()}getNamedQuery(t,e){return $.resolve(this.kr.get(e))}saveNamedQuery(t,e){return this.kr.set(e.name,function(i){return{name:i.name,query:xP(i.bundledQuery),readTime:Bn(i.readTime)}}(e)),$.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OP{constructor(){this.overlays=new ne(ut.comparator),this.qr=new Map}getOverlay(t,e){return $.resolve(this.overlays.get(e))}getOverlays(t,e){const s=Pi();return $.forEach(e,i=>this.getOverlay(t,i).next(r=>{r!==null&&s.set(i,r)})).next(()=>s)}saveOverlays(t,e,s){return s.forEach((i,r)=>{this.St(t,e,r)}),$.resolve()}removeOverlaysForBatchId(t,e,s){const i=this.qr.get(s);return i!==void 0&&(i.forEach(r=>this.overlays=this.overlays.remove(r)),this.qr.delete(s)),$.resolve()}getOverlaysForCollection(t,e,s){const i=Pi(),r=e.length+1,o=new ut(e.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!e.isPrefixOf(c.path))break;c.path.length===r&&l.largestBatchId>s&&i.set(l.getKey(),l)}return $.resolve(i)}getOverlaysForCollectionGroup(t,e,s,i){let r=new ne((c,h)=>c-h);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===e&&c.largestBatchId>s){let h=r.get(c.largestBatchId);h===null&&(h=Pi(),r=r.insert(c.largestBatchId,h)),h.set(c.getKey(),c)}}const a=Pi(),l=r.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,h)=>a.set(c,h)),!(a.size()>=i)););return $.resolve(a)}St(t,e,s){const i=this.overlays.get(s.key);if(i!==null){const o=this.qr.get(i.largestBatchId).delete(s.key);this.qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(s.key,new J1(e,s));let r=this.qr.get(e);r===void 0&&(r=kt(),this.qr.set(e,r)),this.qr.set(e,r.add(s.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LP{constructor(){this.sessionToken=Ae.EMPTY_BYTE_STRING}getSessionToken(t){return $.resolve(this.sessionToken)}setSessionToken(t,e){return this.sessionToken=e,$.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class of{constructor(){this.Qr=new ge(me.$r),this.Ur=new ge(me.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(t,e){const s=new me(t,e);this.Qr=this.Qr.add(s),this.Ur=this.Ur.add(s)}Wr(t,e){t.forEach(s=>this.addReference(s,e))}removeReference(t,e){this.Gr(new me(t,e))}zr(t,e){t.forEach(s=>this.removeReference(s,e))}jr(t){const e=new ut(new Wt([])),s=new me(e,t),i=new me(e,t+1),r=[];return this.Ur.forEachInRange([s,i],o=>{this.Gr(o),r.push(o.key)}),r}Jr(){this.Qr.forEach(t=>this.Gr(t))}Gr(t){this.Qr=this.Qr.delete(t),this.Ur=this.Ur.delete(t)}Hr(t){const e=new ut(new Wt([])),s=new me(e,t),i=new me(e,t+1);let r=kt();return this.Ur.forEachInRange([s,i],o=>{r=r.add(o.key)}),r}containsKey(t){const e=new me(t,0),s=this.Qr.firstAfterOrEqual(e);return s!==null&&t.isEqual(s.key)}}class me{constructor(t,e){this.key=t,this.Yr=e}static $r(t,e){return ut.comparator(t.key,e.key)||Rt(t.Yr,e.Yr)}static Kr(t,e){return Rt(t.Yr,e.Yr)||ut.comparator(t.key,e.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VP{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.tr=1,this.Zr=new ge(me.$r)}checkEmpty(t){return $.resolve(this.mutationQueue.length===0)}addMutationBatch(t,e,s,i){const r=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Q1(r,e,s,i);this.mutationQueue.push(o);for(const a of i)this.Zr=this.Zr.add(new me(a.key,r)),this.indexManager.addToCollectionParentIndex(t,a.key.path.popLast());return $.resolve(o)}lookupMutationBatch(t,e){return $.resolve(this.Xr(e))}getNextMutationBatchAfterBatchId(t,e){const s=e+1,i=this.ei(s),r=i<0?0:i;return $.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return $.resolve(this.mutationQueue.length===0?Yd:this.tr-1)}getAllMutationBatches(t){return $.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const s=new me(e,0),i=new me(e,Number.POSITIVE_INFINITY),r=[];return this.Zr.forEachInRange([s,i],o=>{const a=this.Xr(o.Yr);r.push(a)}),$.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(t,e){let s=new ge(Rt);return e.forEach(i=>{const r=new me(i,0),o=new me(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([r,o],a=>{s=s.add(a.Yr)})}),$.resolve(this.ti(s))}getAllMutationBatchesAffectingQuery(t,e){const s=e.path,i=s.length+1;let r=s;ut.isDocumentKey(r)||(r=r.child(""));const o=new me(new ut(r),0);let a=new ge(Rt);return this.Zr.forEachWhile(l=>{const c=l.key.path;return!!s.isPrefixOf(c)&&(c.length===i&&(a=a.add(l.Yr)),!0)},o),$.resolve(this.ti(a))}ti(t){const e=[];return t.forEach(s=>{const i=this.Xr(s);i!==null&&e.push(i)}),e}removeMutationBatch(t,e){$t(this.ni(e.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Zr;return $.forEach(e.mutations,i=>{const r=new me(i.key,e.batchId);return s=s.delete(r),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)}).next(()=>{this.Zr=s})}ir(t){}containsKey(t,e){const s=new me(e,0),i=this.Zr.firstAfterOrEqual(s);return $.resolve(e.isEqual(i&&i.key))}performConsistencyCheck(t){return this.mutationQueue.length,$.resolve()}ni(t,e){return this.ei(t)}ei(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Xr(t){const e=this.ei(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NP{constructor(t){this.ri=t,this.docs=function(){return new ne(ut.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const s=e.key,i=this.docs.get(s),r=i?i.size:0,o=this.ri(e);return this.docs=this.docs.insert(s,{document:e.mutableCopy(),size:o}),this.size+=o-r,this.indexManager.addToCollectionParentIndex(t,s.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const s=this.docs.get(e);return $.resolve(s?s.document.mutableCopy():Ve.newInvalidDocument(e))}getEntries(t,e){let s=ys();return e.forEach(i=>{const r=this.docs.get(i);s=s.insert(i,r?r.document.mutableCopy():Ve.newInvalidDocument(i))}),$.resolve(s)}getDocumentsMatchingQuery(t,e,s,i){let r=ys();const o=e.path,a=new ut(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:h}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||d1(h1(h),s)<=0||(i.has(h.key)||Yc(e,h))&&(r=r.insert(h.key,h.mutableCopy()))}return $.resolve(r)}getAllFromCollectionGroup(t,e,s,i){gt(9500)}ii(t,e){return $.forEach(this.docs,s=>e(s))}newChangeBuffer(t){return new FP(this)}getSize(t){return $.resolve(this.size)}}class FP extends RP{constructor(t){super(),this.Nr=t}applyChanges(t){const e=[];return this.changes.forEach((s,i)=>{i.isValidDocument()?e.push(this.Nr.addEntry(t,i)):this.Nr.removeEntry(s)}),$.waitFor(e)}getFromCache(t,e){return this.Nr.getEntry(t,e)}getAllFromCache(t,e){return this.Nr.getEntries(t,e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BP{constructor(t){this.persistence=t,this.si=new qi(e=>Jd(e),Zd),this.lastRemoteSnapshotVersion=vt.min(),this.highestTargetId=0,this.oi=0,this._i=new of,this.targetCount=0,this.ai=Sr.ur()}forEachTarget(t,e){return this.si.forEach((s,i)=>e(i)),$.resolve()}getLastRemoteSnapshotVersion(t){return $.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return $.resolve(this.oi)}allocateTargetId(t){return this.highestTargetId=this.ai.next(),$.resolve(this.highestTargetId)}setTargetsMetadata(t,e,s){return s&&(this.lastRemoteSnapshotVersion=s),e>this.oi&&(this.oi=e),$.resolve()}Pr(t){this.si.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.ai=new Sr(e),this.highestTargetId=e),t.sequenceNumber>this.oi&&(this.oi=t.sequenceNumber)}addTargetData(t,e){return this.Pr(e),this.targetCount+=1,$.resolve()}updateTargetData(t,e){return this.Pr(e),$.resolve()}removeTargetData(t,e){return this.si.delete(e.target),this._i.jr(e.targetId),this.targetCount-=1,$.resolve()}removeTargets(t,e,s){let i=0;const r=[];return this.si.forEach((o,a)=>{a.sequenceNumber<=e&&s.get(a.targetId)===null&&(this.si.delete(o),r.push(this.removeMatchingKeysForTargetId(t,a.targetId)),i++)}),$.waitFor(r).next(()=>i)}getTargetCount(t){return $.resolve(this.targetCount)}getTargetData(t,e){const s=this.si.get(e)||null;return $.resolve(s)}addMatchingKeys(t,e,s){return this._i.Wr(e,s),$.resolve()}removeMatchingKeys(t,e,s){this._i.zr(e,s);const i=this.persistence.referenceDelegate,r=[];return i&&e.forEach(o=>{r.push(i.markPotentiallyOrphaned(t,o))}),$.waitFor(r)}removeMatchingKeysForTargetId(t,e){return this._i.jr(e),$.resolve()}getMatchingKeysForTargetId(t,e){const s=this._i.Hr(e);return $.resolve(s)}containsKey(t,e){return $.resolve(this._i.containsKey(e))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T0{constructor(t,e){this.ui={},this.overlays={},this.ci=new Hc(0),this.li=!1,this.li=!0,this.hi=new LP,this.referenceDelegate=t(this),this.Pi=new BP(this),this.indexManager=new TP,this.remoteDocumentCache=function(i){return new NP(i)}(s=>this.referenceDelegate.Ti(s)),this.serializer=new wP(e),this.Ii=new MP(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new OP,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let s=this.ui[t.toKey()];return s||(s=new VP(e,this.referenceDelegate),this.ui[t.toKey()]=s),s}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(t,e,s){nt("MemoryPersistence","Starting transaction:",t);const i=new UP(this.ci.next());return this.referenceDelegate.Ei(),s(i).next(r=>this.referenceDelegate.di(i).next(()=>r)).toPromise().then(r=>(i.raiseOnCommittedEvent(),r))}Ai(t,e){return $.or(Object.values(this.ui).map(s=>()=>s.containsKey(t,e)))}}class UP extends p1{constructor(t){super(),this.currentSequenceNumber=t}}class af{constructor(t){this.persistence=t,this.Ri=new of,this.Vi=null}static mi(t){return new af(t)}get fi(){if(this.Vi)return this.Vi;throw gt(60996)}addReference(t,e,s){return this.Ri.addReference(s,e),this.fi.delete(s.toString()),$.resolve()}removeReference(t,e,s){return this.Ri.removeReference(s,e),this.fi.add(s.toString()),$.resolve()}markPotentiallyOrphaned(t,e){return this.fi.add(e.toString()),$.resolve()}removeTarget(t,e){this.Ri.jr(e.targetId).forEach(i=>this.fi.add(i.toString()));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(t,e.targetId).next(i=>{i.forEach(r=>this.fi.add(r.toString()))}).next(()=>s.removeTargetData(t,e))}Ei(){this.Vi=new Set}di(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return $.forEach(this.fi,s=>{const i=ut.fromPath(s);return this.gi(t,i).next(r=>{r||e.removeEntry(i,vt.min())})}).next(()=>(this.Vi=null,e.apply(t)))}updateLimboDocument(t,e){return this.gi(t,e).next(s=>{s?this.fi.delete(e.toString()):this.fi.add(e.toString())})}Ti(t){return 0}gi(t,e){return $.or([()=>$.resolve(this.Ri.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ai(t,e)])}}class uc{constructor(t,e){this.persistence=t,this.pi=new qi(s=>_1(s.path),(s,i)=>s.isEqual(i)),this.garbageCollector=PP(this,e)}static mi(t,e){return new uc(t,e)}Ei(){}di(t){return $.resolve()}forEachTarget(t,e){return this.persistence.getTargetCache().forEachTarget(t,e)}gr(t){const e=this.wr(t);return this.persistence.getTargetCache().getTargetCount(t).next(s=>e.next(i=>s+i))}wr(t){let e=0;return this.pr(t,s=>{e++}).next(()=>e)}pr(t,e){return $.forEach(this.pi,(s,i)=>this.br(t,s,i).next(r=>r?$.resolve():e(i)))}removeTargets(t,e,s){return this.persistence.getTargetCache().removeTargets(t,e,s)}removeOrphanedDocuments(t,e){let s=0;const i=this.persistence.getRemoteDocumentCache(),r=i.newChangeBuffer();return i.ii(t,o=>this.br(t,o,e).next(a=>{a||(s++,r.removeEntry(o,vt.min()))})).next(()=>r.apply(t)).next(()=>s)}markPotentiallyOrphaned(t,e){return this.pi.set(e,t.currentSequenceNumber),$.resolve()}removeTarget(t,e){const s=e.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,s)}addReference(t,e,s){return this.pi.set(s,t.currentSequenceNumber),$.resolve()}removeReference(t,e,s){return this.pi.set(s,t.currentSequenceNumber),$.resolve()}updateLimboDocument(t,e){return this.pi.set(e,t.currentSequenceNumber),$.resolve()}Ti(t){let e=t.key.toString().length;return t.isFoundDocument()&&(e+=Cl(t.data.value)),e}br(t,e,s){return $.or([()=>this.persistence.Ai(t,e),()=>this.persistence.getTargetCache().containsKey(t,e),()=>{const i=this.pi.get(e);return $.resolve(i!==void 0&&i>s)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lf{constructor(t,e,s,i){this.targetId=t,this.fromCache=e,this.Es=s,this.ds=i}static As(t,e){let s=kt(),i=kt();for(const r of e.docChanges)switch(r.type){case 0:s=s.add(r.doc.key);break;case 1:i=i.add(r.doc.key)}return new lf(t,e.fromCache,s,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $P{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zP{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return VI()?8:g1($e())>0?6:4}()}initialize(t,e){this.ps=t,this.indexManager=e,this.Rs=!0}getDocumentsMatchingQuery(t,e,s,i){const r={result:null};return this.ys(t,e).next(o=>{r.result=o}).next(()=>{if(!r.result)return this.ws(t,e,i,s).next(o=>{r.result=o})}).next(()=>{if(r.result)return;const o=new $P;return this.Ss(t,e,o).next(a=>{if(r.result=a,this.Vs)return this.bs(t,e,o,a.size)})}).next(()=>r.result)}bs(t,e,s,i){return s.documentReadCount<this.fs?(rr()<=Pt.DEBUG&&nt("QueryEngine","SDK will not create cache indexes for query:",or(e),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),$.resolve()):(rr()<=Pt.DEBUG&&nt("QueryEngine","Query:",or(e),"scans",s.documentReadCount,"local documents and returns",i,"documents as results."),s.documentReadCount>this.gs*i?(rr()<=Pt.DEBUG&&nt("QueryEngine","The SDK decides to create cache indexes for query:",or(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,Fn(e))):$.resolve())}ys(t,e){if(Im(e))return $.resolve(null);let s=Fn(e);return this.indexManager.getIndexType(t,s).next(i=>i===0?null:(e.limit!==null&&i===1&&(e=Wh(e,null,"F"),s=Fn(e)),this.indexManager.getDocumentsMatchingTarget(t,s).next(r=>{const o=kt(...r);return this.ps.getDocuments(t,o).next(a=>this.indexManager.getMinOffset(t,s).next(l=>{const c=this.Ds(e,a);return this.Cs(e,c,o,l.readTime)?this.ys(t,Wh(e,null,"F")):this.vs(t,c,e,l)}))})))}ws(t,e,s,i){return Im(e)||i.isEqual(vt.min())?$.resolve(null):this.ps.getDocuments(t,s).next(r=>{const o=this.Ds(e,r);return this.Cs(e,o,s,i)?$.resolve(null):(rr()<=Pt.DEBUG&&nt("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),or(e)),this.vs(t,o,e,u1(i,Xo)).next(a=>a))})}Ds(t,e){let s=new ge(t0(t));return e.forEach((i,r)=>{Yc(t,r)&&(s=s.add(r))}),s}Cs(t,e,s,i){if(t.limit===null)return!1;if(s.size!==e.size)return!0;const r=t.limitType==="F"?e.last():e.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(i)>0)}Ss(t,e,s){return rr()<=Pt.DEBUG&&nt("QueryEngine","Using full collection scan to execute query:",or(e)),this.ps.getDocumentsMatchingQuery(t,e,ei.min(),s)}vs(t,e,s,i){return this.ps.getDocumentsMatchingQuery(t,s,i).next(r=>(e.forEach(o=>{r=r.insert(o.key,o)}),r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cf="LocalStore",jP=3e8;class HP{constructor(t,e,s,i){this.persistence=t,this.Fs=e,this.serializer=i,this.Ms=new ne(Rt),this.xs=new qi(r=>Jd(r),Zd),this.Os=new Map,this.Ns=t.getRemoteDocumentCache(),this.Pi=t.getTargetCache(),this.Ii=t.getBundleCache(),this.Bs(s)}Bs(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new DP(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",e=>t.collect(e,this.Ms))}}function WP(n,t,e,s){return new HP(n,t,e,s)}async function E0(n,t){const e=xt(n);return await e.persistence.runTransaction("Handle user change","readonly",s=>{let i;return e.mutationQueue.getAllMutationBatches(s).next(r=>(i=r,e.Bs(t),e.mutationQueue.getAllMutationBatches(s))).next(r=>{const o=[],a=[];let l=kt();for(const c of i){o.push(c.batchId);for(const h of c.mutations)l=l.add(h.key)}for(const c of r){a.push(c.batchId);for(const h of c.mutations)l=l.add(h.key)}return e.localDocuments.getDocuments(s,l).next(c=>({Ls:c,removedBatchIds:o,addedBatchIds:a}))})})}function qP(n,t){const e=xt(n);return e.persistence.runTransaction("Acknowledge batch","readwrite-primary",s=>{const i=t.batch.keys(),r=e.Ns.newChangeBuffer({trackRemovals:!0});return function(a,l,c,h){const d=c.batch,f=d.keys();let g=$.resolve();return f.forEach(_=>{g=g.next(()=>h.getEntry(l,_)).next(b=>{const v=c.docVersions.get(_);$t(v!==null,48541),b.version.compareTo(v)<0&&(d.applyToRemoteDocument(b,c),b.isValidDocument()&&(b.setReadTime(c.commitVersion),h.addEntry(b)))})}),g.next(()=>a.mutationQueue.removeMutationBatch(l,d))}(e,s,t,r).next(()=>r.apply(s)).next(()=>e.mutationQueue.performConsistencyCheck(s)).next(()=>e.documentOverlayCache.removeOverlaysForBatchId(s,i,t.batch.batchId)).next(()=>e.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,function(a){let l=kt();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l}(t))).next(()=>e.localDocuments.getDocuments(s,i))})}function I0(n){const t=xt(n);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Pi.getLastRemoteSnapshotVersion(e))}function GP(n,t){const e=xt(n),s=t.snapshotVersion;let i=e.Ms;return e.persistence.runTransaction("Apply remote event","readwrite-primary",r=>{const o=e.Ns.newChangeBuffer({trackRemovals:!0});i=e.Ms;const a=[];t.targetChanges.forEach((h,d)=>{const f=i.get(d);if(!f)return;a.push(e.Pi.removeMatchingKeys(r,h.removedDocuments,d).next(()=>e.Pi.addMatchingKeys(r,h.addedDocuments,d)));let g=f.withSequenceNumber(r.currentSequenceNumber);t.targetMismatches.get(d)!==null?g=g.withResumeToken(Ae.EMPTY_BYTE_STRING,vt.min()).withLastLimboFreeSnapshotVersion(vt.min()):h.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(h.resumeToken,s)),i=i.insert(d,g),function(b,v,A){return b.resumeToken.approximateByteSize()===0||v.snapshotVersion.toMicroseconds()-b.snapshotVersion.toMicroseconds()>=jP?!0:A.addedDocuments.size+A.modifiedDocuments.size+A.removedDocuments.size>0}(f,g,h)&&a.push(e.Pi.updateTargetData(r,g))});let l=ys(),c=kt();if(t.documentUpdates.forEach(h=>{t.resolvedLimboDocuments.has(h)&&a.push(e.persistence.referenceDelegate.updateLimboDocument(r,h))}),a.push(KP(r,o,t.documentUpdates).next(h=>{l=h.ks,c=h.qs})),!s.isEqual(vt.min())){const h=e.Pi.getLastRemoteSnapshotVersion(r).next(d=>e.Pi.setTargetsMetadata(r,r.currentSequenceNumber,s));a.push(h)}return $.waitFor(a).next(()=>o.apply(r)).next(()=>e.localDocuments.getLocalViewOfDocuments(r,l,c)).next(()=>l)}).then(r=>(e.Ms=i,r))}function KP(n,t,e){let s=kt(),i=kt();return e.forEach(r=>s=s.add(r)),t.getEntries(n,s).next(r=>{let o=ys();return e.forEach((a,l)=>{const c=r.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(vt.min())?(t.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(t.addEntry(l),o=o.insert(a,l)):nt(cf,"Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{ks:o,qs:i}})}function YP(n,t){const e=xt(n);return e.persistence.runTransaction("Get next mutation batch","readonly",s=>(t===void 0&&(t=Yd),e.mutationQueue.getNextMutationBatchAfterBatchId(s,t)))}function XP(n,t){const e=xt(n);return e.persistence.runTransaction("Allocate target","readwrite",s=>{let i;return e.Pi.getTargetData(s,t).next(r=>r?(i=r,$.resolve(i)):e.Pi.allocateTargetId(s).next(o=>(i=new Bs(t,o,"TargetPurposeListen",s.currentSequenceNumber),e.Pi.addTargetData(s,i).next(()=>i))))}).then(s=>{const i=e.Ms.get(s.targetId);return(i===null||s.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(e.Ms=e.Ms.insert(s.targetId,s),e.xs.set(t,s.targetId)),s})}async function Xh(n,t,e){const s=xt(n),i=s.Ms.get(t),r=e?"readwrite":"readwrite-primary";try{e||await s.persistence.runTransaction("Release target",r,o=>s.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!Nr(o))throw o;nt(cf,`Failed to update sequence numbers for target ${t}: ${o}`)}s.Ms=s.Ms.remove(t),s.xs.delete(i.target)}function Fm(n,t,e){const s=xt(n);let i=vt.min(),r=kt();return s.persistence.runTransaction("Execute query","readwrite",o=>function(l,c,h){const d=xt(l),f=d.xs.get(h);return f!==void 0?$.resolve(d.Ms.get(f)):d.Pi.getTargetData(c,h)}(s,o,Fn(t)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,s.Pi.getMatchingKeysForTargetId(o,a.targetId).next(l=>{r=l})}).next(()=>s.Fs.getDocumentsMatchingQuery(o,t,e?i:vt.min(),e?r:kt())).next(a=>(QP(s,V1(t),a),{documents:a,Qs:r})))}function QP(n,t,e){let s=n.Os.get(t)||vt.min();e.forEach((i,r)=>{r.readTime.compareTo(s)>0&&(s=r.readTime)}),n.Os.set(t,s)}class Bm{constructor(){this.activeTargetIds=z1()}zs(t){this.activeTargetIds=this.activeTargetIds.add(t)}js(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Gs(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class JP{constructor(){this.Mo=new Bm,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,s){}addLocalQueryTarget(t,e=!0){return e&&this.Mo.zs(t),this.xo[t]||"not-current"}updateQueryState(t,e,s){this.xo[t]=e}removeLocalQueryTarget(t){this.Mo.js(t)}isLocalQueryTarget(t){return this.Mo.activeTargetIds.has(t)}clearQueryState(t){delete this.xo[t]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(t){return this.Mo.activeTargetIds.has(t)}start(){return this.Mo=new Bm,Promise.resolve()}handleUserChange(t,e,s){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZP{Oo(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Um="ConnectivityMonitor";class $m{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(t){this.qo.push(t)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){nt(Um,"Network connectivity changed: AVAILABLE");for(const t of this.qo)t(0)}ko(){nt(Um,"Network connectivity changed: UNAVAILABLE");for(const t of this.qo)t(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let il=null;function Qh(){return il===null?il=function(){return 268435456+Math.round(2147483648*Math.random())}():il++,"0x"+il.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zu="RestConnection",tR={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class eR{get $o(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=e+"://"+t.host,this.Ko=`projects/${s}/databases/${i}`,this.Wo=this.databaseId.database===ic?`project_id=${s}`:`project_id=${s}&database_id=${i}`}Go(t,e,s,i,r){const o=Qh(),a=this.zo(t,e.toUriEncodedString());nt(Zu,`Sending RPC '${t}' ${o}:`,a,s);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,i,r);const{host:c}=new URL(a),h=Dr(c);return this.Jo(t,a,l,s,h).then(d=>(nt(Zu,`Received RPC '${t}' ${o}: `,d),d),d=>{throw xr(Zu,`RPC '${t}' ${o} failed with error: `,d,"url: ",a,"request:",s),d})}Ho(t,e,s,i,r,o){return this.Go(t,e,s,i,r)}jo(t,e,s){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Lr}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach((i,r)=>t[r]=i),s&&s.headers.forEach((i,r)=>t[r]=i)}zo(t,e){const s=tR[t];return`${this.Uo}/v1/${e}:${s}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nR{constructor(t){this.Yo=t.Yo,this.Zo=t.Zo}Xo(t){this.e_=t}t_(t){this.n_=t}r_(t){this.i_=t}onMessage(t){this.s_=t}close(){this.Zo()}send(t){this.Yo(t)}o_(){this.e_()}__(){this.n_()}a_(t){this.i_(t)}u_(t){this.s_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ke="WebChannelConnection";class sR extends eR{constructor(t){super(t),this.c_=[],this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Jo(t,e,s,i,r){const o=Qh();return new Promise((a,l)=>{const c=new Cv;c.setWithCredentials(!0),c.listenOnce(Pv.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Al.NO_ERROR:const d=c.getResponseJson();nt(ke,`XHR for RPC '${t}' ${o} received:`,JSON.stringify(d)),a(d);break;case Al.TIMEOUT:nt(ke,`RPC '${t}' ${o} timed out`),l(new et(U.DEADLINE_EXCEEDED,"Request time out"));break;case Al.HTTP_ERROR:const f=c.getStatus();if(nt(ke,`RPC '${t}' ${o} failed with status:`,f,"response text:",c.getResponseText()),f>0){let g=c.getResponseJson();Array.isArray(g)&&(g=g[0]);const _=g?.error;if(_&&_.status&&_.message){const b=function(A){const C=A.toLowerCase().replace(/_/g,"-");return Object.values(U).indexOf(C)>=0?C:U.UNKNOWN}(_.status);l(new et(b,_.message))}else l(new et(U.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new et(U.UNAVAILABLE,"Connection failed."));break;default:gt(9055,{l_:t,streamId:o,h_:c.getLastErrorCode(),P_:c.getLastError()})}}finally{nt(ke,`RPC '${t}' ${o} completed.`)}});const h=JSON.stringify(i);nt(ke,`RPC '${t}' ${o} sending request:`,i),c.send(e,"POST",h,s,15)})}T_(t,e,s){const i=Qh(),r=[this.Uo,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=Dv(),a=kv(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,e,s),l.encodeInitMessageHeaders=!0;const h=r.join("");nt(ke,`Creating RPC '${t}' stream ${i}: ${h}`,l);const d=o.createWebChannel(h,l);this.I_(d);let f=!1,g=!1;const _=new nR({Yo:v=>{g?nt(ke,`Not sending because RPC '${t}' stream ${i} is closed:`,v):(f||(nt(ke,`Opening RPC '${t}' stream ${i} transport.`),d.open(),f=!0),nt(ke,`RPC '${t}' stream ${i} sending:`,v),d.send(v))},Zo:()=>d.close()}),b=(v,A,C)=>{v.listen(A,O=>{try{C(O)}catch(k){setTimeout(()=>{throw k},0)}})};return b(d,po.EventType.OPEN,()=>{g||(nt(ke,`RPC '${t}' stream ${i} transport opened.`),_.o_())}),b(d,po.EventType.CLOSE,()=>{g||(g=!0,nt(ke,`RPC '${t}' stream ${i} transport closed`),_.a_(),this.E_(d))}),b(d,po.EventType.ERROR,v=>{g||(g=!0,xr(ke,`RPC '${t}' stream ${i} transport errored. Name:`,v.name,"Message:",v.message),_.a_(new et(U.UNAVAILABLE,"The operation could not be completed")))}),b(d,po.EventType.MESSAGE,v=>{if(!g){const A=v.data[0];$t(!!A,16349);const C=A,O=C?.error||C[0]?.error;if(O){nt(ke,`RPC '${t}' stream ${i} received error:`,O);const k=O.status;let D=function(y){const x=ce[y];if(x!==void 0)return d0(x)}(k),N=O.message;D===void 0&&(D=U.INTERNAL,N="Unknown error status: "+k+" with message "+O.message),g=!0,_.a_(new et(D,N)),d.close()}else nt(ke,`RPC '${t}' stream ${i} received:`,A),_.u_(A)}}),b(a,Rv.STAT_EVENT,v=>{v.stat===Fh.PROXY?nt(ke,`RPC '${t}' stream ${i} detected buffering proxy`):v.stat===Fh.NOPROXY&&nt(ke,`RPC '${t}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{_.__()},0),_}terminate(){this.c_.forEach(t=>t.close()),this.c_=[]}I_(t){this.c_.push(t)}E_(t){this.c_=this.c_.filter(e=>e===t)}}function th(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zc(n){return new aP(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S0{constructor(t,e,s=1e3,i=1.5,r=6e4){this.Mi=t,this.timerId=e,this.d_=s,this.A_=i,this.R_=r,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(t){this.cancel();const e=Math.floor(this.V_+this.y_()),s=Math.max(0,Date.now()-this.f_),i=Math.max(0,e-s);i>0&&nt("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${e} ms, last attempt: ${s} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),t())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zm="PersistentStream";class A0{constructor(t,e,s,i,r,o,a,l){this.Mi=t,this.S_=s,this.b_=i,this.connection=r,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new S0(t,e)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(t){this.Q_(),this.stream.send(t)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(t,e){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,t!==4?this.M_.reset():e&&e.code===U.RESOURCE_EXHAUSTED?(_s(e.toString()),_s("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):e&&e.code===U.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.r_(e)}K_(){}auth(){this.state=1;const t=this.W_(this.D_),e=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([s,i])=>{this.D_===e&&this.G_(s,i)},s=>{t(()=>{const i=new et(U.UNKNOWN,"Fetching auth token failed: "+s.message);return this.z_(i)})})}G_(t,e){const s=this.W_(this.D_);this.stream=this.j_(t,e),this.stream.Xo(()=>{s(()=>this.listener.Xo())}),this.stream.t_(()=>{s(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{s(()=>this.z_(i))}),this.stream.onMessage(i=>{s(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(t){return nt(zm,`close with error: ${t}`),this.stream=null,this.close(4,t)}W_(t){return e=>{this.Mi.enqueueAndForget(()=>this.D_===t?e():(nt(zm,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class iR extends A0{constructor(t,e,s,i,r,o){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,s,i,o),this.serializer=r}j_(t,e){return this.connection.T_("Listen",t,e)}J_(t){return this.onNext(t)}onNext(t){this.M_.reset();const e=uP(this.serializer,t),s=function(r){if(!("targetChange"in r))return vt.min();const o=r.targetChange;return o.targetIds&&o.targetIds.length?vt.min():o.readTime?Bn(o.readTime):vt.min()}(t);return this.listener.H_(e,s)}Y_(t){const e={};e.database=Yh(this.serializer),e.addTarget=function(r,o){let a;const l=o.target;if(a=jh(l)?{documents:fP(r,l)}:{query:pP(r,l).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=g0(r,o.resumeToken);const c=qh(r,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(vt.min())>0){a.readTime=cc(r,o.snapshotVersion.toTimestamp());const c=qh(r,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,t);const s=mP(this.serializer,t);s&&(e.labels=s),this.q_(e)}Z_(t){const e={};e.database=Yh(this.serializer),e.removeTarget=t,this.q_(e)}}class rR extends A0{constructor(t,e,s,i,r,o){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,s,i,o),this.serializer=r}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(t,e){return this.connection.T_("Write",t,e)}J_(t){return $t(!!t.streamToken,31322),this.lastStreamToken=t.streamToken,$t(!t.writeResults||t.writeResults.length===0,55816),this.listener.ta()}onNext(t){$t(!!t.streamToken,12678),this.lastStreamToken=t.streamToken,this.M_.reset();const e=dP(t.writeResults,t.commitTime),s=Bn(t.commitTime);return this.listener.na(s,e)}ra(){const t={};t.database=Yh(this.serializer),this.q_(t)}ea(t){const e={streamToken:this.lastStreamToken,writes:t.map(s=>hP(this.serializer,s))};this.q_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oR{}class aR extends oR{constructor(t,e,s,i){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=s,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new et(U.FAILED_PRECONDITION,"The client has already been terminated.")}Go(t,e,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,o])=>this.connection.Go(t,Gh(e,s),i,r,o)).catch(r=>{throw r.name==="FirebaseError"?(r.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new et(U.UNKNOWN,r.toString())})}Ho(t,e,s,i,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Ho(t,Gh(e,s),i,o,a,r)).catch(o=>{throw o.name==="FirebaseError"?(o.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new et(U.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class lR{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(t){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.ca("Offline")))}set(t){this.Pa(),this.oa=0,t==="Online"&&(this.aa=!1),this.ca(t)}ca(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}la(t){const e=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(_s(e),this.aa=!1):nt("OnlineStateTracker",e)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $i="RemoteStore";class cR{constructor(t,e,s,i,r){this.localStore=t,this.datastore=e,this.asyncQueue=s,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=r,this.Aa.Oo(o=>{s.enqueueAndForget(async()=>{Gi(this)&&(nt($i,"Restarting streams for network reachability change."),await async function(l){const c=xt(l);c.Ea.add(4),await Ea(c),c.Ra.set("Unknown"),c.Ea.delete(4),await tu(c)}(this))})}),this.Ra=new lR(s,i)}}async function tu(n){if(Gi(n))for(const t of n.da)await t(!0)}async function Ea(n){for(const t of n.da)await t(!1)}function C0(n,t){const e=xt(n);e.Ia.has(t.targetId)||(e.Ia.set(t.targetId,t),ff(e)?df(e):Br(e).O_()&&hf(e,t))}function uf(n,t){const e=xt(n),s=Br(e);e.Ia.delete(t),s.O_()&&P0(e,t),e.Ia.size===0&&(s.O_()?s.L_():Gi(e)&&e.Ra.set("Unknown"))}function hf(n,t){if(n.Va.Ue(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(vt.min())>0){const e=n.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(e)}Br(n).Y_(t)}function P0(n,t){n.Va.Ue(t),Br(n).Z_(t)}function df(n){n.Va=new sP({getRemoteKeysForTarget:t=>n.remoteSyncer.getRemoteKeysForTarget(t),At:t=>n.Ia.get(t)||null,ht:()=>n.datastore.serializer.databaseId}),Br(n).start(),n.Ra.ua()}function ff(n){return Gi(n)&&!Br(n).x_()&&n.Ia.size>0}function Gi(n){return xt(n).Ea.size===0}function R0(n){n.Va=void 0}async function uR(n){n.Ra.set("Online")}async function hR(n){n.Ia.forEach((t,e)=>{hf(n,t)})}async function dR(n,t){R0(n),ff(n)?(n.Ra.ha(t),df(n)):n.Ra.set("Unknown")}async function fR(n,t,e){if(n.Ra.set("Online"),t instanceof p0&&t.state===2&&t.cause)try{await async function(i,r){const o=r.cause;for(const a of r.targetIds)i.Ia.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.Ia.delete(a),i.Va.removeTarget(a))}(n,t)}catch(s){nt($i,"Failed to remove targets %s: %s ",t.targetIds.join(","),s),await hc(n,s)}else if(t instanceof kl?n.Va.Ze(t):t instanceof f0?n.Va.st(t):n.Va.tt(t),!e.isEqual(vt.min()))try{const s=await I0(n.localStore);e.compareTo(s)>=0&&await function(r,o){const a=r.Va.Tt(o);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const h=r.Ia.get(c);h&&r.Ia.set(c,h.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,c)=>{const h=r.Ia.get(l);if(!h)return;r.Ia.set(l,h.withResumeToken(Ae.EMPTY_BYTE_STRING,h.snapshotVersion)),P0(r,l);const d=new Bs(h.target,l,c,h.sequenceNumber);hf(r,d)}),r.remoteSyncer.applyRemoteEvent(a)}(n,e)}catch(s){nt($i,"Failed to raise snapshot:",s),await hc(n,s)}}async function hc(n,t,e){if(!Nr(t))throw t;n.Ea.add(1),await Ea(n),n.Ra.set("Offline"),e||(e=()=>I0(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{nt($i,"Retrying IndexedDB access"),await e(),n.Ea.delete(1),await tu(n)})}function k0(n,t){return t().catch(e=>hc(n,e,t))}async function eu(n){const t=xt(n),e=ri(t);let s=t.Ta.length>0?t.Ta[t.Ta.length-1].batchId:Yd;for(;pR(t);)try{const i=await YP(t.localStore,s);if(i===null){t.Ta.length===0&&e.L_();break}s=i.batchId,gR(t,i)}catch(i){await hc(t,i)}D0(t)&&M0(t)}function pR(n){return Gi(n)&&n.Ta.length<10}function gR(n,t){n.Ta.push(t);const e=ri(n);e.O_()&&e.X_&&e.ea(t.mutations)}function D0(n){return Gi(n)&&!ri(n).x_()&&n.Ta.length>0}function M0(n){ri(n).start()}async function mR(n){ri(n).ra()}async function _R(n){const t=ri(n);for(const e of n.Ta)t.ea(e.mutations)}async function yR(n,t,e){const s=n.Ta.shift(),i=nf.from(s,t,e);await k0(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),await eu(n)}async function bR(n,t){t&&ri(n).X_&&await async function(s,i){if(function(o){return tP(o)&&o!==U.ABORTED}(i.code)){const r=s.Ta.shift();ri(s).B_(),await k0(s,()=>s.remoteSyncer.rejectFailedWrite(r.batchId,i)),await eu(s)}}(n,t),D0(n)&&M0(n)}async function jm(n,t){const e=xt(n);e.asyncQueue.verifyOperationInProgress(),nt($i,"RemoteStore received new credentials");const s=Gi(e);e.Ea.add(3),await Ea(e),s&&e.Ra.set("Unknown"),await e.remoteSyncer.handleCredentialChange(t),e.Ea.delete(3),await tu(e)}async function vR(n,t){const e=xt(n);t?(e.Ea.delete(2),await tu(e)):t||(e.Ea.add(2),await Ea(e),e.Ra.set("Unknown"))}function Br(n){return n.ma||(n.ma=function(e,s,i){const r=xt(e);return r.sa(),new iR(s,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,i)}(n.datastore,n.asyncQueue,{Xo:uR.bind(null,n),t_:hR.bind(null,n),r_:dR.bind(null,n),H_:fR.bind(null,n)}),n.da.push(async t=>{t?(n.ma.B_(),ff(n)?df(n):n.Ra.set("Unknown")):(await n.ma.stop(),R0(n))})),n.ma}function ri(n){return n.fa||(n.fa=function(e,s,i){const r=xt(e);return r.sa(),new rR(s,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,i)}(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:mR.bind(null,n),r_:bR.bind(null,n),ta:_R.bind(null,n),na:yR.bind(null,n)}),n.da.push(async t=>{t?(n.fa.B_(),await eu(n)):(await n.fa.stop(),n.Ta.length>0&&(nt($i,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))})),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pf{constructor(t,e,s,i,r){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=s,this.op=i,this.removalCallback=r,this.deferred=new ds,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,e,s,i,r){const o=Date.now()+s,a=new pf(t,e,o,i,r);return a.start(s),a}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new et(U.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function gf(n,t){if(_s("AsyncQueue",`${t}: ${n}`),Nr(n))return new et(U.UNAVAILABLE,`${t}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yr{static emptySet(t){return new yr(t.comparator)}constructor(t){this.comparator=t?(e,s)=>t(e,s)||ut.comparator(e.key,s.key):(e,s)=>ut.comparator(e.key,s.key),this.keyedMap=go(),this.sortedSet=new ne(this.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((e,s)=>(t(e),!1))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof yr)||this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),s=t.sortedSet.getIterator();for(;e.hasNext();){const i=e.getNext().key,r=s.getNext().key;if(!i.isEqual(r))return!1}return!0}toString(){const t=[];return this.forEach(e=>{t.push(e.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,e){const s=new yr;return s.comparator=this.comparator,s.keyedMap=t,s.sortedSet=e,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hm{constructor(){this.ga=new ne(ut.comparator)}track(t){const e=t.doc.key,s=this.ga.get(e);s?t.type!==0&&s.type===3?this.ga=this.ga.insert(e,t):t.type===3&&s.type!==1?this.ga=this.ga.insert(e,{type:s.type,doc:t.doc}):t.type===2&&s.type===2?this.ga=this.ga.insert(e,{type:2,doc:t.doc}):t.type===2&&s.type===0?this.ga=this.ga.insert(e,{type:0,doc:t.doc}):t.type===1&&s.type===0?this.ga=this.ga.remove(e):t.type===1&&s.type===2?this.ga=this.ga.insert(e,{type:1,doc:s.doc}):t.type===0&&s.type===1?this.ga=this.ga.insert(e,{type:2,doc:t.doc}):gt(63341,{Rt:t,pa:s}):this.ga=this.ga.insert(e,t)}ya(){const t=[];return this.ga.inorderTraversal((e,s)=>{t.push(s)}),t}}class Ar{constructor(t,e,s,i,r,o,a,l,c){this.query=t,this.docs=e,this.oldDocs=s,this.docChanges=i,this.mutatedKeys=r,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(t,e,s,i,r){const o=[];return e.forEach(a=>{o.push({type:0,doc:a})}),new Ar(t,e,yr.emptySet(e),o,s,i,!0,!1,r)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Kc(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,s=t.docChanges;if(e.length!==s.length)return!1;for(let i=0;i<e.length;i++)if(e[i].type!==s[i].type||!e[i].doc.isEqual(s[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wR{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(t=>t.Da())}}class xR{constructor(){this.queries=Wm(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(e,s){const i=xt(e),r=i.queries;i.queries=Wm(),r.forEach((o,a)=>{for(const l of a.Sa)l.onError(s)})})(this,new et(U.ABORTED,"Firestore shutting down"))}}function Wm(){return new qi(n=>Zv(n),Kc)}async function mf(n,t){const e=xt(n);let s=3;const i=t.query;let r=e.queries.get(i);r?!r.ba()&&t.Da()&&(s=2):(r=new wR,s=t.Da()?0:1);try{switch(s){case 0:r.wa=await e.onListen(i,!0);break;case 1:r.wa=await e.onListen(i,!1);break;case 2:await e.onFirstRemoteStoreListen(i)}}catch(o){const a=gf(o,`Initialization of query '${or(t.query)}' failed`);return void t.onError(a)}e.queries.set(i,r),r.Sa.push(t),t.va(e.onlineState),r.wa&&t.Fa(r.wa)&&yf(e)}async function _f(n,t){const e=xt(n),s=t.query;let i=3;const r=e.queries.get(s);if(r){const o=r.Sa.indexOf(t);o>=0&&(r.Sa.splice(o,1),r.Sa.length===0?i=t.Da()?0:1:!r.ba()&&t.Da()&&(i=2))}switch(i){case 0:return e.queries.delete(s),e.onUnlisten(s,!0);case 1:return e.queries.delete(s),e.onUnlisten(s,!1);case 2:return e.onLastRemoteStoreUnlisten(s);default:return}}function TR(n,t){const e=xt(n);let s=!1;for(const i of t){const r=i.query,o=e.queries.get(r);if(o){for(const a of o.Sa)a.Fa(i)&&(s=!0);o.wa=i}}s&&yf(e)}function ER(n,t,e){const s=xt(n),i=s.queries.get(t);if(i)for(const r of i.Sa)r.onError(e);s.queries.delete(t)}function yf(n){n.Ca.forEach(t=>{t.next()})}var Jh,qm;(qm=Jh||(Jh={})).Ma="default",qm.Cache="cache";class bf{constructor(t,e,s){this.query=t,this.xa=e,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=s||{}}Fa(t){if(!this.options.includeMetadataChanges){const s=[];for(const i of t.docChanges)i.type!==3&&s.push(i);t=new Ar(t.query,t.docs,t.oldDocs,s,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.Oa?this.Ba(t)&&(this.xa.next(t),e=!0):this.La(t,this.onlineState)&&(this.ka(t),e=!0),this.Na=t,e}onError(t){this.xa.error(t)}va(t){this.onlineState=t;let e=!1;return this.Na&&!this.Oa&&this.La(this.Na,t)&&(this.ka(this.Na),e=!0),e}La(t,e){if(!t.fromCache||!this.Da())return!0;const s=e!=="Offline";return(!this.options.qa||!s)&&(!t.docs.isEmpty()||t.hasCachedResults||e==="Offline")}Ba(t){if(t.docChanges.length>0)return!0;const e=this.Na&&this.Na.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&this.options.includeMetadataChanges===!0}ka(t){t=Ar.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.Oa=!0,this.xa.next(t)}Da(){return this.options.source!==Jh.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O0{constructor(t){this.key=t}}class L0{constructor(t){this.key=t}}class IR{constructor(t,e){this.query=t,this.Ya=e,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=kt(),this.mutatedKeys=kt(),this.eu=t0(t),this.tu=new yr(this.eu)}get nu(){return this.Ya}ru(t,e){const s=e?e.iu:new Hm,i=e?e.tu:this.tu;let r=e?e.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((h,d)=>{const f=i.get(h),g=Yc(this.query,d)?d:null,_=!!f&&this.mutatedKeys.has(f.key),b=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let v=!1;f&&g?f.data.isEqual(g.data)?_!==b&&(s.track({type:3,doc:g}),v=!0):this.su(f,g)||(s.track({type:2,doc:g}),v=!0,(l&&this.eu(g,l)>0||c&&this.eu(g,c)<0)&&(a=!0)):!f&&g?(s.track({type:0,doc:g}),v=!0):f&&!g&&(s.track({type:1,doc:f}),v=!0,(l||c)&&(a=!0)),v&&(g?(o=o.add(g),r=b?r.add(h):r.delete(h)):(o=o.delete(h),r=r.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),r=r.delete(h.key),s.track({type:1,doc:h})}return{tu:o,iu:s,Cs:a,mutatedKeys:r}}su(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,s,i){const r=this.tu;this.tu=t.tu,this.mutatedKeys=t.mutatedKeys;const o=t.iu.ya();o.sort((h,d)=>function(g,_){const b=v=>{switch(v){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return gt(20277,{Rt:v})}};return b(g)-b(_)}(h.type,d.type)||this.eu(h.doc,d.doc)),this.ou(s),i=i??!1;const a=e&&!i?this._u():[],l=this.Xa.size===0&&this.current&&!i?1:0,c=l!==this.Za;return this.Za=l,o.length!==0||c?{snapshot:new Ar(this.query,t.tu,r,o,t.mutatedKeys,l===0,c,!1,!!s&&s.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Hm,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(t){return!this.Ya.has(t)&&!!this.tu.has(t)&&!this.tu.get(t).hasLocalMutations}ou(t){t&&(t.addedDocuments.forEach(e=>this.Ya=this.Ya.add(e)),t.modifiedDocuments.forEach(e=>{}),t.removedDocuments.forEach(e=>this.Ya=this.Ya.delete(e)),this.current=t.current)}_u(){if(!this.current)return[];const t=this.Xa;this.Xa=kt(),this.tu.forEach(s=>{this.uu(s.key)&&(this.Xa=this.Xa.add(s.key))});const e=[];return t.forEach(s=>{this.Xa.has(s)||e.push(new L0(s))}),this.Xa.forEach(s=>{t.has(s)||e.push(new O0(s))}),e}cu(t){this.Ya=t.Qs,this.Xa=kt();const e=this.ru(t.documents);return this.applyChanges(e,!0)}lu(){return Ar.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const vf="SyncEngine";class SR{constructor(t,e,s){this.query=t,this.targetId=e,this.view=s}}class AR{constructor(t){this.key=t,this.hu=!1}}class CR{constructor(t,e,s,i,r,o){this.localStore=t,this.remoteStore=e,this.eventManager=s,this.sharedClientState=i,this.currentUser=r,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new qi(a=>Zv(a),Kc),this.Iu=new Map,this.Eu=new Set,this.du=new ne(ut.comparator),this.Au=new Map,this.Ru=new of,this.Vu={},this.mu=new Map,this.fu=Sr.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function PR(n,t,e=!0){const s=$0(n);let i;const r=s.Tu.get(t);return r?(s.sharedClientState.addLocalQueryTarget(r.targetId),i=r.view.lu()):i=await V0(s,t,e,!0),i}async function RR(n,t){const e=$0(n);await V0(e,t,!0,!1)}async function V0(n,t,e,s){const i=await XP(n.localStore,Fn(t)),r=i.targetId,o=n.sharedClientState.addLocalQueryTarget(r,e);let a;return s&&(a=await kR(n,t,r,o==="current",i.resumeToken)),n.isPrimaryClient&&e&&C0(n.remoteStore,i),a}async function kR(n,t,e,s,i){n.pu=(d,f,g)=>async function(b,v,A,C){let O=v.view.ru(A);O.Cs&&(O=await Fm(b.localStore,v.query,!1).then(({documents:w})=>v.view.ru(w,O)));const k=C&&C.targetChanges.get(v.targetId),D=C&&C.targetMismatches.get(v.targetId)!=null,N=v.view.applyChanges(O,b.isPrimaryClient,k,D);return Km(b,v.targetId,N.au),N.snapshot}(n,d,f,g);const r=await Fm(n.localStore,t,!0),o=new IR(t,r.Qs),a=o.ru(r.documents),l=Ta.createSynthesizedTargetChangeForCurrentChange(e,s&&n.onlineState!=="Offline",i),c=o.applyChanges(a,n.isPrimaryClient,l);Km(n,e,c.au);const h=new SR(t,e,o);return n.Tu.set(t,h),n.Iu.has(e)?n.Iu.get(e).push(t):n.Iu.set(e,[t]),c.snapshot}async function DR(n,t,e){const s=xt(n),i=s.Tu.get(t),r=s.Iu.get(i.targetId);if(r.length>1)return s.Iu.set(i.targetId,r.filter(o=>!Kc(o,t))),void s.Tu.delete(t);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(i.targetId),s.sharedClientState.isActiveQueryTarget(i.targetId)||await Xh(s.localStore,i.targetId,!1).then(()=>{s.sharedClientState.clearQueryState(i.targetId),e&&uf(s.remoteStore,i.targetId),Zh(s,i.targetId)}).catch(Vr)):(Zh(s,i.targetId),await Xh(s.localStore,i.targetId,!0))}async function MR(n,t){const e=xt(n),s=e.Tu.get(t),i=e.Iu.get(s.targetId);e.isPrimaryClient&&i.length===1&&(e.sharedClientState.removeLocalQueryTarget(s.targetId),uf(e.remoteStore,s.targetId))}async function OR(n,t,e){const s=$R(n);try{const i=await function(o,a){const l=xt(o),c=qt.now(),h=a.reduce((g,_)=>g.add(_.key),kt());let d,f;return l.persistence.runTransaction("Locally write mutations","readwrite",g=>{let _=ys(),b=kt();return l.Ns.getEntries(g,h).next(v=>{_=v,_.forEach((A,C)=>{C.isValidDocument()||(b=b.add(A))})}).next(()=>l.localDocuments.getOverlayedDocuments(g,_)).next(v=>{d=v;const A=[];for(const C of a){const O=Y1(C,d.get(C.key).overlayedDocument);O!=null&&A.push(new ui(C.key,O,Wv(O.value.mapValue),gn.exists(!0)))}return l.mutationQueue.addMutationBatch(g,c,A,a)}).next(v=>{f=v;const A=v.applyToLocalDocumentSet(d,b);return l.documentOverlayCache.saveOverlays(g,v.batchId,A)})}).then(()=>({batchId:f.batchId,changes:n0(d)}))}(s.localStore,t);s.sharedClientState.addPendingMutation(i.batchId),function(o,a,l){let c=o.Vu[o.currentUser.toKey()];c||(c=new ne(Rt)),c=c.insert(a,l),o.Vu[o.currentUser.toKey()]=c}(s,i.batchId,e),await Ia(s,i.changes),await eu(s.remoteStore)}catch(i){const r=gf(i,"Failed to persist write");e.reject(r)}}async function N0(n,t){const e=xt(n);try{const s=await GP(e.localStore,t);t.targetChanges.forEach((i,r)=>{const o=e.Au.get(r);o&&($t(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.hu=!0:i.modifiedDocuments.size>0?$t(o.hu,14607):i.removedDocuments.size>0&&($t(o.hu,42227),o.hu=!1))}),await Ia(e,s,t)}catch(s){await Vr(s)}}function Gm(n,t,e){const s=xt(n);if(s.isPrimaryClient&&e===0||!s.isPrimaryClient&&e===1){const i=[];s.Tu.forEach((r,o)=>{const a=o.view.va(t);a.snapshot&&i.push(a.snapshot)}),function(o,a){const l=xt(o);l.onlineState=a;let c=!1;l.queries.forEach((h,d)=>{for(const f of d.Sa)f.va(a)&&(c=!0)}),c&&yf(l)}(s.eventManager,t),i.length&&s.Pu.H_(i),s.onlineState=t,s.isPrimaryClient&&s.sharedClientState.setOnlineState(t)}}async function LR(n,t,e){const s=xt(n);s.sharedClientState.updateQueryState(t,"rejected",e);const i=s.Au.get(t),r=i&&i.key;if(r){let o=new ne(ut.comparator);o=o.insert(r,Ve.newNoDocument(r,vt.min()));const a=kt().add(r),l=new Jc(vt.min(),new Map,new ne(Rt),o,a);await N0(s,l),s.du=s.du.remove(r),s.Au.delete(t),wf(s)}else await Xh(s.localStore,t,!1).then(()=>Zh(s,t,e)).catch(Vr)}async function VR(n,t){const e=xt(n),s=t.batch.batchId;try{const i=await qP(e.localStore,t);B0(e,s,null),F0(e,s),e.sharedClientState.updateMutationState(s,"acknowledged"),await Ia(e,i)}catch(i){await Vr(i)}}async function NR(n,t,e){const s=xt(n);try{const i=await function(o,a){const l=xt(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let h;return l.mutationQueue.lookupMutationBatch(c,a).next(d=>($t(d!==null,37113),h=d.keys(),l.mutationQueue.removeMutationBatch(c,d))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,h,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,h)).next(()=>l.localDocuments.getDocuments(c,h))})}(s.localStore,t);B0(s,t,e),F0(s,t),s.sharedClientState.updateMutationState(t,"rejected",e),await Ia(s,i)}catch(i){await Vr(i)}}function F0(n,t){(n.mu.get(t)||[]).forEach(e=>{e.resolve()}),n.mu.delete(t)}function B0(n,t,e){const s=xt(n);let i=s.Vu[s.currentUser.toKey()];if(i){const r=i.get(t);r&&(e?r.reject(e):r.resolve(),i=i.remove(t)),s.Vu[s.currentUser.toKey()]=i}}function Zh(n,t,e=null){n.sharedClientState.removeLocalQueryTarget(t);for(const s of n.Iu.get(t))n.Tu.delete(s),e&&n.Pu.yu(s,e);n.Iu.delete(t),n.isPrimaryClient&&n.Ru.jr(t).forEach(s=>{n.Ru.containsKey(s)||U0(n,s)})}function U0(n,t){n.Eu.delete(t.path.canonicalString());const e=n.du.get(t);e!==null&&(uf(n.remoteStore,e),n.du=n.du.remove(t),n.Au.delete(e),wf(n))}function Km(n,t,e){for(const s of e)s instanceof O0?(n.Ru.addReference(s.key,t),FR(n,s)):s instanceof L0?(nt(vf,"Document no longer in limbo: "+s.key),n.Ru.removeReference(s.key,t),n.Ru.containsKey(s.key)||U0(n,s.key)):gt(19791,{wu:s})}function FR(n,t){const e=t.key,s=e.path.canonicalString();n.du.get(e)||n.Eu.has(s)||(nt(vf,"New document in limbo: "+e),n.Eu.add(s),wf(n))}function wf(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const t=n.Eu.values().next().value;n.Eu.delete(t);const e=new ut(Wt.fromString(t)),s=n.fu.next();n.Au.set(s,new AR(e)),n.du=n.du.insert(e,s),C0(n.remoteStore,new Bs(Fn(Gc(e.path)),s,"TargetPurposeLimboResolution",Hc.ce))}}async function Ia(n,t,e){const s=xt(n),i=[],r=[],o=[];s.Tu.isEmpty()||(s.Tu.forEach((a,l)=>{o.push(s.pu(l,t,e).then(c=>{if((c||e)&&s.isPrimaryClient){const h=c?!c.fromCache:e?.targetChanges.get(l.targetId)?.current;s.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(c){i.push(c);const h=lf.As(l.targetId,c);r.push(h)}}))}),await Promise.all(o),s.Pu.H_(i),await async function(l,c){const h=xt(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>$.forEach(c,f=>$.forEach(f.Es,g=>h.persistence.referenceDelegate.addReference(d,f.targetId,g)).next(()=>$.forEach(f.ds,g=>h.persistence.referenceDelegate.removeReference(d,f.targetId,g)))))}catch(d){if(!Nr(d))throw d;nt(cf,"Failed to update sequence numbers: "+d)}for(const d of c){const f=d.targetId;if(!d.fromCache){const g=h.Ms.get(f),_=g.snapshotVersion,b=g.withLastLimboFreeSnapshotVersion(_);h.Ms=h.Ms.insert(f,b)}}}(s.localStore,r))}async function BR(n,t){const e=xt(n);if(!e.currentUser.isEqual(t)){nt(vf,"User change. New user:",t.toKey());const s=await E0(e.localStore,t);e.currentUser=t,function(r,o){r.mu.forEach(a=>{a.forEach(l=>{l.reject(new et(U.CANCELLED,o))})}),r.mu.clear()}(e,"'waitForPendingWrites' promise is rejected due to a user change."),e.sharedClientState.handleUserChange(t,s.removedBatchIds,s.addedBatchIds),await Ia(e,s.Ls)}}function UR(n,t){const e=xt(n),s=e.Au.get(t);if(s&&s.hu)return kt().add(s.key);{let i=kt();const r=e.Iu.get(t);if(!r)return i;for(const o of r){const a=e.Tu.get(o);i=i.unionWith(a.view.nu)}return i}}function $0(n){const t=xt(n);return t.remoteStore.remoteSyncer.applyRemoteEvent=N0.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=UR.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=LR.bind(null,t),t.Pu.H_=TR.bind(null,t.eventManager),t.Pu.yu=ER.bind(null,t.eventManager),t}function $R(n){const t=xt(n);return t.remoteStore.remoteSyncer.applySuccessfulWrite=VR.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=NR.bind(null,t),t}class dc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=Zc(t.databaseInfo.databaseId),this.sharedClientState=this.Du(t),this.persistence=this.Cu(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Fu(t,this.localStore),this.indexBackfillerScheduler=this.Mu(t,this.localStore)}Fu(t,e){return null}Mu(t,e){return null}vu(t){return WP(this.persistence,new zP,t.initialUser,this.serializer)}Cu(t){return new T0(af.mi,this.serializer)}Du(t){return new JP}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}dc.provider={build:()=>new dc};class zR extends dc{constructor(t){super(),this.cacheSizeBytes=t}Fu(t,e){$t(this.persistence.referenceDelegate instanceof uc,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new AP(s,t.asyncQueue,e)}Cu(t){const e=this.cacheSizeBytes!==void 0?Xe.withCacheSize(this.cacheSizeBytes):Xe.DEFAULT;return new T0(s=>uc.mi(s,e),this.serializer)}}class td{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>Gm(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=BR.bind(null,this.syncEngine),await vR(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return function(){return new xR}()}createDatastore(t){const e=Zc(t.databaseInfo.databaseId),s=function(r){return new sR(r)}(t.databaseInfo);return function(r,o,a,l){return new aR(r,o,a,l)}(t.authCredentials,t.appCheckCredentials,s,e)}createRemoteStore(t){return function(s,i,r,o,a){return new cR(s,i,r,o,a)}(this.localStore,this.datastore,t.asyncQueue,e=>Gm(this.syncEngine,e,0),function(){return $m.v()?new $m:new ZP}())}createSyncEngine(t,e){return function(i,r,o,a,l,c,h){const d=new CR(i,r,o,a,l,c);return h&&(d.gu=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}async terminate(){await async function(e){const s=xt(e);nt($i,"RemoteStore shutting down."),s.Ea.add(5),await Ea(s),s.Aa.shutdown(),s.Ra.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}td.provider={build:()=>new td};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xf{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.Ou(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.Ou(this.observer.error,t):_s("Uncaught Error in snapshot listener:",t.toString()))}Nu(){this.muted=!0}Ou(t,e){setTimeout(()=>{this.muted||t(e)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oi="FirestoreClient";class jR{constructor(t,e,s,i,r){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=s,this.databaseInfo=i,this.user=Me.UNAUTHENTICATED,this.clientId=Gd.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=r,this.authCredentials.start(s,async o=>{nt(oi,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(s,o=>(nt(oi,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new ds;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const s=gf(e,"Failed to shutdown persistence");t.reject(s)}}),t.promise}}async function eh(n,t){n.asyncQueue.verifyOperationInProgress(),nt(oi,"Initializing OfflineComponentProvider");const e=n.configuration;await t.initialize(e);let s=e.initialUser;n.setCredentialChangeListener(async i=>{s.isEqual(i)||(await E0(t.localStore,i),s=i)}),t.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=t}async function Ym(n,t){n.asyncQueue.verifyOperationInProgress();const e=await HR(n);nt(oi,"Initializing OnlineComponentProvider"),await t.initialize(e,n.configuration),n.setCredentialChangeListener(s=>jm(t.remoteStore,s)),n.setAppCheckTokenChangeListener((s,i)=>jm(t.remoteStore,i)),n._onlineComponents=t}async function HR(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){nt(oi,"Using user provided OfflineComponentProvider");try{await eh(n,n._uninitializedComponentsProvider._offline)}catch(t){const e=t;if(!function(i){return i.name==="FirebaseError"?i.code===U.FAILED_PRECONDITION||i.code===U.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(e))throw e;xr("Error using user provided cache. Falling back to memory cache: "+e),await eh(n,new dc)}}else nt(oi,"Using default OfflineComponentProvider"),await eh(n,new zR(void 0));return n._offlineComponents}async function z0(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(nt(oi,"Using user provided OnlineComponentProvider"),await Ym(n,n._uninitializedComponentsProvider._online)):(nt(oi,"Using default OnlineComponentProvider"),await Ym(n,new td))),n._onlineComponents}function WR(n){return z0(n).then(t=>t.syncEngine)}async function fc(n){const t=await z0(n),e=t.eventManager;return e.onListen=PR.bind(null,t.syncEngine),e.onUnlisten=DR.bind(null,t.syncEngine),e.onFirstRemoteStoreListen=RR.bind(null,t.syncEngine),e.onLastRemoteStoreUnlisten=MR.bind(null,t.syncEngine),e}function qR(n,t,e={}){const s=new ds;return n.asyncQueue.enqueueAndForget(async()=>function(r,o,a,l,c){const h=new xf({next:f=>{h.Nu(),o.enqueueAndForget(()=>_f(r,d));const g=f.docs.has(a);!g&&f.fromCache?c.reject(new et(U.UNAVAILABLE,"Failed to get document because the client is offline.")):g&&f.fromCache&&l&&l.source==="server"?c.reject(new et(U.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(f)},error:f=>c.reject(f)}),d=new bf(Gc(a.path),h,{includeMetadataChanges:!0,qa:!0});return mf(r,d)}(await fc(n),n.asyncQueue,t,e,s)),s.promise}function GR(n,t,e={}){const s=new ds;return n.asyncQueue.enqueueAndForget(async()=>function(r,o,a,l,c){const h=new xf({next:f=>{h.Nu(),o.enqueueAndForget(()=>_f(r,d)),f.fromCache&&l.source==="server"?c.reject(new et(U.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(f)},error:f=>c.reject(f)}),d=new bf(a,h,{includeMetadataChanges:!0,qa:!0});return mf(r,d)}(await fc(n),n.asyncQueue,t,e,s)),s.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j0(n){const t={};return n.timeoutSeconds!==void 0&&(t.timeoutSeconds=n.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xm=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H0="firestore.googleapis.com",Qm=!0;class Jm{constructor(t){if(t.host===void 0){if(t.ssl!==void 0)throw new et(U.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=H0,this.ssl=Qm}else this.host=t.host,this.ssl=t.ssl??Qm;if(this.isUsingEmulator=t.emulatorOptions!==void 0,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=x0;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<IP)throw new et(U.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}c1("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=j0(t.experimentalLongPollingOptions??{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new et(U.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new et(U.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new et(U.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(s,i){return s.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Sa{constructor(t,e,s,i){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=s,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Jm({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new et(U.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new et(U.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Jm(t),this._emulatorOptions=t.emulatorOptions||{},t.credentials!==void 0&&(this._authCredentials=function(s){if(!s)return new ZC;switch(s.type){case"firstParty":return new s1(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new et(U.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const s=Xm.get(e);s&&(nt("ComponentProvider","Removing Datastore"),Xm.delete(e),s.terminate())}(this),Promise.resolve()}}function KR(n,t,e,s={}){n=qe(n,Sa);const i=Dr(t),r=n._getSettings(),o={...r,emulatorOptions:n._getEmulatorOptions()},a=`${t}:${e}`;i&&($b(`https://${a}`),zb("Firestore",!0)),r.host!==H0&&r.host!==a&&xr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...r,host:a,ssl:i,emulatorOptions:s};if(!Vi(l,o)&&(n._setSettings(l),s.mockUserToken)){let c,h;if(typeof s.mockUserToken=="string")c=s.mockUserToken,h=Me.MOCK_USER;else{c=AI(s.mockUserToken,n._app?.options.projectId);const d=s.mockUserToken.sub||s.mockUserToken.user_id;if(!d)throw new et(U.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new Me(d)}n._authCredentials=new t1(new Ov(c,h))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hi{constructor(t,e,s){this.converter=e,this._query=s,this.type="query",this.firestore=t}withConverter(t){return new hi(this.firestore,t,this._query)}}class ie{constructor(t,e,s){this.converter=e,this._key=s,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Xs(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new ie(this.firestore,t,this._key)}toJSON(){return{type:ie._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(t,e,s){if(wa(e,ie._jsonSchema))return new ie(t,s||null,new ut(Wt.fromString(e.referencePath)))}}ie._jsonSchemaVersion="firestore/documentReference/1.0",ie._jsonSchema={type:he("string",ie._jsonSchemaVersion),referencePath:he("string")};class Xs extends hi{constructor(t,e,s){super(t,e,Gc(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new ie(this.firestore,null,new ut(t))}withConverter(t){return new Xs(this.firestore,t,this._path)}}function W0(n,t,...e){if(n=ye(n),Kd("collection","path",t),n instanceof Sa){const s=Wt.fromString(t,...e);return hm(s),new Xs(n,null,s)}{if(!(n instanceof ie||n instanceof Xs))throw new et(U.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(Wt.fromString(t,...e));return hm(s),new Xs(n.firestore,null,s)}}function YR(n,t){if(n=qe(n,Sa),Kd("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new et(U.INVALID_ARGUMENT,`Invalid collection ID '${t}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new hi(n,null,function(s){return new Fr(Wt.emptyPath(),s)}(t))}function ln(n,t,...e){if(n=ye(n),arguments.length===1&&(t=Gd.newId()),Kd("doc","path",t),n instanceof Sa){const s=Wt.fromString(t,...e);return um(s),new ie(n,null,new ut(s))}{if(!(n instanceof ie||n instanceof Xs))throw new et(U.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(Wt.fromString(t,...e));return um(s),new ie(n.firestore,n instanceof Xs?n.converter:null,new ut(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zm="AsyncQueue";class t_{constructor(t=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new S0(this,"async_queue_retry"),this._c=()=>{const s=th();s&&nt(Zm,"Visibility state changed to "+s.visibilityState),this.M_.w_()},this.ac=t;const e=th();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.uc(),this.cc(t)}enterRestrictedMode(t){if(!this.ec){this.ec=!0,this.sc=t||!1;const e=th();e&&typeof e.removeEventListener=="function"&&e.removeEventListener("visibilitychange",this._c)}}enqueue(t){if(this.uc(),this.ec)return new Promise(()=>{});const e=new ds;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise)).then(()=>e.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Xu.push(t),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(t){if(!Nr(t))throw t;nt(Zm,"Operation failed with retryable error: "+t)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(t){const e=this.ac.then(()=>(this.rc=!0,t().catch(s=>{throw this.nc=s,this.rc=!1,_s("INTERNAL UNHANDLED ERROR: ",e_(s)),s}).then(s=>(this.rc=!1,s))));return this.ac=e,e}enqueueAfterDelay(t,e,s){this.uc(),this.oc.indexOf(t)>-1&&(e=0);const i=pf.createAndSchedule(this,t,e,s,r=>this.hc(r));return this.tc.push(i),i}uc(){this.nc&&gt(47125,{Pc:e_(this.nc)})}verifyOperationInProgress(){}async Tc(){let t;do t=this.ac,await t;while(t!==this.ac)}Ic(t){for(const e of this.tc)if(e.timerId===t)return!0;return!1}Ec(t){return this.Tc().then(()=>{this.tc.sort((e,s)=>e.targetTimeMs-s.targetTimeMs);for(const e of this.tc)if(e.skipDelay(),t!=="all"&&e.timerId===t)break;return this.Tc()})}dc(t){this.oc.push(t)}hc(t){const e=this.tc.indexOf(t);this.tc.splice(e,1)}}function e_(n){let t=n.message||"";return n.stack&&(t=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n_(n){return function(e,s){if(typeof e!="object"||e===null)return!1;const i=e;for(const r of s)if(r in i&&typeof i[r]=="function")return!0;return!1}(n,["next","error","complete"])}class bs extends Sa{constructor(t,e,s,i){super(t,e,s,i),this.type="firestore",this._queue=new t_,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new t_(t),this._firestoreClient=void 0,await t}}}function Ur(n,t){const e=typeof n=="object"?n:qb(),s=typeof n=="string"?n:ic,i=Vd(e,"firestore").getImmediate({identifier:s});if(!i._initialized){const r=II("firestore");r&&KR(i,...r)}return i}function nu(n){if(n._terminated)throw new et(U.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||XR(n),n._firestoreClient}function XR(n){const t=n._freezeSettings(),e=function(i,r,o,a){return new v1(i,r,o,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,j0(a.experimentalLongPollingOptions),a.useFetchStreams,a.isUsingEmulator)}(n._databaseId,n._app?.options.appId||"",n._persistenceKey,t);n._componentsProvider||t.localCache?._offlineComponentProvider&&t.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:t.localCache._offlineComponentProvider,_online:t.localCache._onlineComponentProvider}),n._firestoreClient=new jR(n._authCredentials,n._appCheckCredentials,n._queue,e,n._componentsProvider&&function(i){const r=i?._online.build();return{_offline:i?._offline.build(r),_online:r}}(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fn{constructor(t){this._byteString=t}static fromBase64String(t){try{return new fn(Ae.fromBase64String(t))}catch(e){throw new et(U.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(t){return new fn(Ae.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}toJSON(){return{type:fn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(t){if(wa(t,fn._jsonSchema))return fn.fromBase64String(t.bytes)}}fn._jsonSchemaVersion="firestore/bytes/1.0",fn._jsonSchema={type:he("string",fn._jsonSchemaVersion),bytes:he("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class su{constructor(...t){for(let e=0;e<t.length;++e)if(t[e].length===0)throw new et(U.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Se(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iu{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Un{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new et(U.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new et(U.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}_compareTo(t){return Rt(this._lat,t._lat)||Rt(this._long,t._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Un._jsonSchemaVersion}}static fromJSON(t){if(wa(t,Un._jsonSchema))return new Un(t.latitude,t.longitude)}}Un._jsonSchemaVersion="firestore/geoPoint/1.0",Un._jsonSchema={type:he("string",Un._jsonSchemaVersion),latitude:he("number"),longitude:he("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $n{constructor(t){this._values=(t||[]).map(e=>e)}toArray(){return this._values.map(t=>t)}isEqual(t){return function(s,i){if(s.length!==i.length)return!1;for(let r=0;r<s.length;++r)if(s[r]!==i[r])return!1;return!0}(this._values,t._values)}toJSON(){return{type:$n._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(t){if(wa(t,$n._jsonSchema)){if(Array.isArray(t.vectorValues)&&t.vectorValues.every(e=>typeof e=="number"))return new $n(t.vectorValues);throw new et(U.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}$n._jsonSchemaVersion="firestore/vectorValue/1.0",$n._jsonSchema={type:he("string",$n._jsonSchemaVersion),vectorValues:he("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QR=/^__.*__$/;class JR{constructor(t,e,s){this.data=t,this.fieldMask=e,this.fieldTransforms=s}toMutation(t,e){return this.fieldMask!==null?new ui(t,this.data,this.fieldMask,e,this.fieldTransforms):new xa(t,this.data,e,this.fieldTransforms)}}class q0{constructor(t,e,s){this.data=t,this.fieldMask=e,this.fieldTransforms=s}toMutation(t,e){return new ui(t,this.data,this.fieldMask,e,this.fieldTransforms)}}function G0(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw gt(40011,{Ac:n})}}class Tf{constructor(t,e,s,i,r,o){this.settings=t,this.databaseId=e,this.serializer=s,this.ignoreUndefinedProperties=i,r===void 0&&this.Rc(),this.fieldTransforms=r||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(t){return new Tf({...this.settings,...t},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(t){const e=this.path?.child(t),s=this.Vc({path:e,fc:!1});return s.gc(t),s}yc(t){const e=this.path?.child(t),s=this.Vc({path:e,fc:!1});return s.Rc(),s}wc(t){return this.Vc({path:void 0,fc:!0})}Sc(t){return pc(t,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(t){return this.fieldMask.find(e=>t.isPrefixOf(e))!==void 0||this.fieldTransforms.find(e=>t.isPrefixOf(e.field))!==void 0}Rc(){if(this.path)for(let t=0;t<this.path.length;t++)this.gc(this.path.get(t))}gc(t){if(t.length===0)throw this.Sc("Document fields must not be empty");if(G0(this.Ac)&&QR.test(t))throw this.Sc('Document fields cannot begin and end with "__"')}}class ZR{constructor(t,e,s){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=s||Zc(t)}Cc(t,e,s,i=!1){return new Tf({Ac:t,methodName:e,Dc:s,path:Se.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ru(n){const t=n._freezeSettings(),e=Zc(n._databaseId);return new ZR(n._databaseId,!!t.ignoreUndefinedProperties,e)}function K0(n,t,e,s,i,r={}){const o=n.Cc(r.merge||r.mergeFields?2:0,t,e,i);If("Data must be an object, but it was:",o,s);const a=Y0(s,o);let l,c;if(r.merge)l=new an(o.fieldMask),c=o.fieldTransforms;else if(r.mergeFields){const h=[];for(const d of r.mergeFields){const f=ed(t,d,e);if(!o.contains(f))throw new et(U.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);Q0(h,f)||h.push(f)}l=new an(h),c=o.fieldTransforms.filter(d=>l.covers(d.field))}else l=null,c=o.fieldTransforms;return new JR(new Je(a),l,c)}class ou extends iu{_toFieldTransform(t){if(t.Ac!==2)throw t.Ac===1?t.Sc(`${this._methodName}() can only appear at the top level of your update data`):t.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof ou}}class Ef extends iu{constructor(t,e){super(t),this.Fc=e}_toFieldTransform(t){const e=new na(t.serializer,r0(t.serializer,this.Fc));return new W1(t.path,e)}isEqual(t){return t instanceof Ef&&this.Fc===t.Fc}}function tk(n,t,e,s){const i=n.Cc(1,t,e);If("Data must be an object, but it was:",i,s);const r=[],o=Je.empty();ci(s,(l,c)=>{const h=Sf(t,l,e);c=ye(c);const d=i.yc(h);if(c instanceof ou)r.push(h);else{const f=Aa(c,d);f!=null&&(r.push(h),o.set(h,f))}});const a=new an(r);return new q0(o,a,i.fieldTransforms)}function ek(n,t,e,s,i,r){const o=n.Cc(1,t,e),a=[ed(t,s,e)],l=[i];if(r.length%2!=0)throw new et(U.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<r.length;f+=2)a.push(ed(t,r[f])),l.push(r[f+1]);const c=[],h=Je.empty();for(let f=a.length-1;f>=0;--f)if(!Q0(c,a[f])){const g=a[f];let _=l[f];_=ye(_);const b=o.yc(g);if(_ instanceof ou)c.push(g);else{const v=Aa(_,b);v!=null&&(c.push(g),h.set(g,v))}}const d=new an(c);return new q0(h,d,o.fieldTransforms)}function nk(n,t,e,s=!1){return Aa(e,n.Cc(s?4:3,t))}function Aa(n,t){if(X0(n=ye(n)))return If("Unsupported field value:",t,n),Y0(n,t);if(n instanceof iu)return function(s,i){if(!G0(i.Ac))throw i.Sc(`${s._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${s._methodName}() is not currently supported inside arrays`);const r=s._toFieldTransform(i);r&&i.fieldTransforms.push(r)}(n,t),null;if(n===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),n instanceof Array){if(t.settings.fc&&t.Ac!==4)throw t.Sc("Nested arrays are not supported");return function(s,i){const r=[];let o=0;for(const a of s){let l=Aa(a,i.wc(o));l==null&&(l={nullValue:"NULL_VALUE"}),r.push(l),o++}return{arrayValue:{values:r}}}(n,t)}return function(s,i){if((s=ye(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return r0(i.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const r=qt.fromDate(s);return{timestampValue:cc(i.serializer,r)}}if(s instanceof qt){const r=new qt(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:cc(i.serializer,r)}}if(s instanceof Un)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof fn)return{bytesValue:g0(i.serializer,s._byteString)};if(s instanceof ie){const r=i.databaseId,o=s.firestore._databaseId;if(!o.isEqual(r))throw i.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:rf(s.firestore._databaseId||i.databaseId,s._key.path)}}if(s instanceof $n)return function(o,a){return{mapValue:{fields:{[jv]:{stringValue:Hv},[rc]:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw a.Sc("VectorValues must only contain numeric values.");return tf(a.serializer,c)})}}}}}}(s,i);throw i.Sc(`Unsupported field value: ${jc(s)}`)}(n,t)}function Y0(n,t){const e={};return Nv(n)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):ci(n,(s,i)=>{const r=Aa(i,t.mc(s));r!=null&&(e[s]=r)}),{mapValue:{fields:e}}}function X0(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof qt||n instanceof Un||n instanceof fn||n instanceof ie||n instanceof iu||n instanceof $n)}function If(n,t,e){if(!X0(e)||!Lv(e)){const s=jc(e);throw s==="an object"?t.Sc(n+" a custom object"):t.Sc(n+" "+s)}}function ed(n,t,e){if((t=ye(t))instanceof su)return t._internalPath;if(typeof t=="string")return Sf(n,t);throw pc("Field path arguments must be of type string or ",n,!1,void 0,e)}const sk=new RegExp("[~\\*/\\[\\]]");function Sf(n,t,e){if(t.search(sk)>=0)throw pc(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,e);try{return new su(...t.split("."))._internalPath}catch{throw pc(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,e)}}function pc(n,t,e,s,i){const r=s&&!s.isEmpty(),o=i!==void 0;let a=`Function ${t}() called with invalid data`;e&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(r||o)&&(l+=" (found",r&&(l+=` in field ${s}`),o&&(l+=` in document ${i}`),l+=")"),new et(U.INVALID_ARGUMENT,a+n+l)}function Q0(n,t){return n.some(e=>e.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J0{constructor(t,e,s,i,r){this._firestore=t,this._userDataWriter=e,this._key=s,this._document=i,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new ie(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new ik(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(Z0("DocumentSnapshot.get",t));if(e!==null)return this._userDataWriter.convertValue(e)}}}class ik extends J0{data(){return super.data()}}function Z0(n,t){return typeof t=="string"?Sf(n,t):t instanceof su?t._internalPath:t._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tw(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new et(U.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Af{}class rk extends Af{}function ew(n,t,...e){let s=[];t instanceof Af&&s.push(t),s=s.concat(e),function(r){const o=r.filter(l=>l instanceof Pf).length,a=r.filter(l=>l instanceof Cf).length;if(o>1||o>0&&a>0)throw new et(U.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(s);for(const i of s)n=i._apply(n);return n}class Cf extends rk{constructor(t,e,s){super(),this._field=t,this._op=e,this._value=s,this.type="where"}static _create(t,e,s){return new Cf(t,e,s)}_apply(t){const e=this._parse(t);return nw(t._query,e),new hi(t.firestore,t.converter,Hh(t._query,e))}_parse(t){const e=ru(t.firestore);return function(r,o,a,l,c,h,d){let f;if(c.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new et(U.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){i_(d,h);const _=[];for(const b of d)_.push(s_(l,r,b));f={arrayValue:{values:_}}}else f=s_(l,r,d)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||i_(d,h),f=nk(a,o,d,h==="in"||h==="not-in");return ue.create(c,h,f)}(t._query,"where",e,t.firestore._databaseId,this._field,this._op,this._value)}}class Pf extends Af{constructor(t,e){super(),this.type=t,this._queryConstraints=e}static _create(t,e){return new Pf(t,e)}_parse(t){const e=this._queryConstraints.map(s=>s._parse(t)).filter(s=>s.getFilters().length>0);return e.length===1?e[0]:In.create(e,this._getOperator())}_apply(t){const e=this._parse(t);return e.getFilters().length===0?t:(function(i,r){let o=i;const a=r.getFlattenedFilters();for(const l of a)nw(o,l),o=Hh(o,l)}(t._query,e),new hi(t.firestore,t.converter,Hh(t._query,e)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function s_(n,t,e){if(typeof(e=ye(e))=="string"){if(e==="")throw new et(U.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Jv(t)&&e.indexOf("/")!==-1)throw new et(U.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${e}' contains a '/' character.`);const s=t.path.child(Wt.fromString(e));if(!ut.isDocumentKey(s))throw new et(U.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return bm(n,new ut(s))}if(e instanceof ie)return bm(n,e._key);throw new et(U.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${jc(e)}.`)}function i_(n,t){if(!Array.isArray(n)||n.length===0)throw new et(U.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function nw(n,t){const e=function(i,r){for(const o of i)for(const a of o.getFlattenedFilters())if(r.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(e!==null)throw e===t.op?new et(U.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new et(U.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${e.toString()}' filters.`)}class ok{convertValue(t,e="none"){switch(ii(t)){case 0:return null;case 1:return t.booleanValue;case 2:return ae(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(si(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 11:return this.convertObject(t.mapValue,e);case 10:return this.convertVectorValue(t.mapValue);default:throw gt(62114,{value:t})}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t,e="none"){const s={};return ci(t,(i,r)=>{s[i]=this.convertValue(r,e)}),s}convertVectorValue(t){const e=t.fields?.[rc].arrayValue?.values?.map(s=>ae(s.doubleValue));return new $n(e)}convertGeoPoint(t){return new Un(ae(t.latitude),ae(t.longitude))}convertArray(t,e){return(t.values||[]).map(s=>this.convertValue(s,e))}convertServerTimestamp(t,e){switch(e){case"previous":const s=qc(t);return s==null?null:this.convertValue(s,e);case"estimate":return this.convertTimestamp(Qo(t));default:return null}}convertTimestamp(t){const e=ni(t);return new qt(e.seconds,e.nanos)}convertDocumentKey(t,e){const s=Wt.fromString(t);$t(w0(s),9688,{name:t});const i=new Jo(s.get(1),s.get(3)),r=new ut(s.popFirst(5));return i.isEqual(e)||_s(`Document ${r} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sw(n,t,e){let s;return s=n?e&&(e.merge||e.mergeFields)?n.toFirestore(t,e):n.toFirestore(t):t,s}class _o{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class ki extends J0{constructor(t,e,s,i,r,o){super(t,e,s,i,o),this._firestore=t,this._firestoreImpl=t,this.metadata=r}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new Dl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const s=this._document.data.field(Z0("DocumentSnapshot.get",t));if(s!==null)return this._userDataWriter.convertValue(s,e.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new et(U.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t=this._document,e={};return e.type=ki._jsonSchemaVersion,e.bundle="",e.bundleSource="DocumentSnapshot",e.bundleName=this._key.toString(),!t||!t.isValidDocument()||!t.isFoundDocument()?e:(this._userDataWriter.convertObjectMap(t.data.value.mapValue.fields,"previous"),e.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),e)}}ki._jsonSchemaVersion="firestore/documentSnapshot/1.0",ki._jsonSchema={type:he("string",ki._jsonSchemaVersion),bundleSource:he("string","DocumentSnapshot"),bundleName:he("string"),bundle:he("string")};class Dl extends ki{data(t={}){return super.data(t)}}class Di{constructor(t,e,s,i){this._firestore=t,this._userDataWriter=e,this._snapshot=i,this.metadata=new _o(i.hasPendingWrites,i.fromCache),this.query=s}get docs(){const t=[];return this.forEach(e=>t.push(e)),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,e){this._snapshot.docs.forEach(s=>{t.call(e,new Dl(this._firestore,this._userDataWriter,s.key,s,new _o(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new et(U.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(i,r){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const l=new Dl(i._firestore,i._userDataWriter,a.doc.key,a.doc,new _o(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>r||a.type!==3).map(a=>{const l=new Dl(i._firestore,i._userDataWriter,a.doc.key,a.doc,new _o(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,h=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:ak(a.type),doc:l,oldIndex:c,newIndex:h}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new et(U.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t={};t.type=Di._jsonSchemaVersion,t.bundleSource="QuerySnapshot",t.bundleName=Gd.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const e=[],s=[],i=[];return this.docs.forEach(r=>{r._document!==null&&(e.push(r._document),s.push(this._userDataWriter.convertObjectMap(r._document.data.value.mapValue.fields,"previous")),i.push(r.ref.path))}),t.bundle=(this._firestore,this.query._query,t.bundleName,"NOT SUPPORTED"),t}}function ak(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return gt(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function au(n){n=qe(n,ie);const t=qe(n.firestore,bs);return qR(nu(t),n._key).then(e=>iw(t,n,e))}Di._jsonSchemaVersion="firestore/querySnapshot/1.0",Di._jsonSchema={type:he("string",Di._jsonSchemaVersion),bundleSource:he("string","QuerySnapshot"),bundleName:he("string"),bundle:he("string")};class Rf extends ok{constructor(t){super(),this.firestore=t}convertBytes(t){return new fn(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new ie(this.firestore,null,e)}}function lk(n){n=qe(n,hi);const t=qe(n.firestore,bs),e=nu(t),s=new Rf(t);return tw(n._query),GR(e,n._query).then(i=>new Di(t,s,n,i))}function sa(n,t,e){n=qe(n,ie);const s=qe(n.firestore,bs),i=sw(n.converter,t,e);return lu(s,[K0(ru(s),"setDoc",n._key,i,n.converter!==null,e).toMutation(n._key,gn.none())])}function nd(n,t,e,...s){n=qe(n,ie);const i=qe(n.firestore,bs),r=ru(i);let o;return o=typeof(t=ye(t))=="string"||t instanceof su?ek(r,"updateDoc",n._key,t,e,s):tk(r,"updateDoc",n._key,t),lu(i,[o.toMutation(n._key,gn.exists(!0))])}function ck(n){return lu(qe(n.firestore,bs),[new ef(n._key,gn.none())])}function uk(n,t){const e=qe(n.firestore,bs),s=ln(n),i=sw(n.converter,t);return lu(e,[K0(ru(n.firestore),"addDoc",s._key,i,n.converter!==null,{}).toMutation(s._key,gn.exists(!1))]).then(()=>s)}function hk(n,...t){n=ye(n);let e={includeMetadataChanges:!1,source:"default"},s=0;typeof t[s]!="object"||n_(t[s])||(e=t[s++]);const i={includeMetadataChanges:e.includeMetadataChanges,source:e.source};if(n_(t[s])){const l=t[s];t[s]=l.next?.bind(l),t[s+1]=l.error?.bind(l),t[s+2]=l.complete?.bind(l)}let r,o,a;if(n instanceof ie)o=qe(n.firestore,bs),a=Gc(n._key.path),r={next:l=>{t[s]&&t[s](iw(o,n,l))},error:t[s+1],complete:t[s+2]};else{const l=qe(n,hi);o=qe(l.firestore,bs),a=l._query;const c=new Rf(o);r={next:h=>{t[s]&&t[s](new Di(o,c,l,h))},error:t[s+1],complete:t[s+2]},tw(n._query)}return function(c,h,d,f){const g=new xf(f),_=new bf(h,g,d);return c.asyncQueue.enqueueAndForget(async()=>mf(await fc(c),_)),()=>{g.Nu(),c.asyncQueue.enqueueAndForget(async()=>_f(await fc(c),_))}}(nu(o),a,i,r)}function lu(n,t){return function(s,i){const r=new ds;return s.asyncQueue.enqueueAndForget(async()=>OR(await WR(s),i,r)),r.promise}(nu(n),t)}function iw(n,t,e){const s=e.docs.get(t._key),i=new Rf(n);return new ki(n,i,t._key,s,new _o(e.hasPendingWrites,e.fromCache),t.converter)}function rw(n){return new Ef("increment",n)}(function(t,e=!0){(function(i){Lr=i})(Mr),wr(new Ni("firestore",(s,{instanceIdentifier:i,options:r})=>{const o=s.getProvider("app").getImmediate(),a=new bs(new e1(s.getProvider("auth-internal")),new i1(o,s.getProvider("app-check-internal")),function(c,h){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new et(U.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Jo(c.options.projectId,h)}(o,i),o);return r={useFetchStreams:e,...r},a._setSettings(r),a},"PUBLIC").setMultipleInstances(!0)),Gs(om,am,t),Gs(om,am,"esm2020")})();const gc="/the-arcane-scholar-s-legacy/assets/logo-DcNi1i-0.svg",Kn=(n,t)=>{const e=n.__vccOpts||n;for(const[s,i]of t)e[s]=i;return e},dk={class:"flex flex-col items-center justify-center h-screen bg-white p-4 sm:p-6 md:p-8"},fk={class:"flex flex-col space-y-4 w-full max-w-sm"},pk={key:0,class:"mt-12 flex flex-col items-center justify-center text-gray-600"},gk={key:1,class:"mt-6 text-red-600 bg-red-100 p-3 rounded-md"},mk={__name:"LoginScreen",emits:["successfulLogin"],setup(n,{emit:t}){const e=At(!1),s=At(null),i=t,r=async()=>{e.value=!0,s.value=null;try{const o=Wi(),a=new On,c=(await oC(o,a)).user;console.log("Google Login successful:",c),await new Promise(h=>setTimeout(h,2e3)),i("successfulLogin",c)}catch(o){console.error("Google Login error:",o),s.value=`Google Login failed: ${o.message}`}finally{e.value=!1}};return(o,a)=>(st(),lt("div",dk,[a[2]||(a[2]=M("h1",{class:"text-3xl sm:text-4xl font-bold text-black mb-6 text-center"},"The Arcane Scholars Legacy",-1)),M("div",fk,[e.value?fe("",!0):(st(),lt("button",{key:0,onClick:r,class:"bg-black hover:bg-gray-800 text-white font-bold py-3 px-6 rounded-lg shadow-md transition duration-300 ease-in-out flex items-center justify-center text-lg"},a[0]||(a[0]=[M("img",{src:"https://www.google.com/favicon.ico",alt:"Google Logo",class:"h-7 w-7 mr-3"},null,-1),bn(" Sign in with Google ",-1)])))]),e.value?(st(),lt("div",pk,a[1]||(a[1]=[M("img",{src:gc,alt:"The Arcane Scholar's Legacy",class:"h-24 w-24 mb-4 animate-bounce"},null,-1),M("p",{class:"text-xl font-medium"},"Authenticating and Loading...",-1)]))):fe("",!0),s.value?(st(),lt("div",gk,[M("p",null,pt(s.value),1)])):fe("",!0)]))}},_k=Kn(mk,[["__scopeId","data-v-0517aee5"]]),yk={class:"flex flex-col items-center justify-center h-screen w-full bg-white text-gray-800 p-4 sm:p-6 md:p-8 overflow-y-auto"},bk={key:0,class:"mt-4 text-gray-600"},vk={key:1,class:"mt-4 text-red-600 bg-red-100 p-3 rounded-md"},wk={key:2,class:"w-full max-w-lg bg-gray-100 p-6 rounded-lg shadow-lg border border-gray-200 text-center"},xk={key:3,class:"w-full max-w-3xl bg-gray-50 p-6 rounded-xl shadow-2xl border border-gray-200"},Tk=["innerHTML"],Ek={class:"space-y-4"},Ik={key:1,class:"space-y-4 mt-6"},Sk=["disabled"],Ak={key:4,class:"w-full max-w-3xl bg-gray-50 p-6 rounded-xl shadow-2xl border border-gray-200"},Ck=["innerHTML"],Pk={class:"space-y-4"},Rk={key:1,class:"space-y-4 mt-6"},kk=["disabled"],Dk={key:5,class:"w-full max-w-3xl bg-gray-50 p-6 rounded-xl shadow-2xl border border-gray-200"},Mk={class:"text-sm text-gray-600 mb-4 italic"},Ok={class:"text-sm text-gray-600 mb-4 italic"},Lk={key:0,class:"text-gray-500"},Vk={key:1},Nk={key:2,class:"text-red-500"},Fk=["disabled"],Bk={__name:"CharacterManager",emits:["character-created","return-to-select"],setup(n,{emit:t}){const e=t,s=Wi(),i=Ur(),r=typeof __app_id<"u"?__app_id:"default-app-id",o=At(!1),a=At(null),l=At("chapter1"),c=At({chapter1:"",chapter2:""}),h=At(!1),d=At({name:"",faction:"",specialty:"",knowledge:0,resources:{},research:{},prestige:0,skillPoints:0,location:"Unknown"}),f=At({name:"",loading:!1,fetched:!1}),g=async k=>{if(!f.value.fetched){try{const D=ln(i,`artifacts/${r}/users/${k}/profile/user_data`),N=await au(D);if(N.exists()&&N.data().location){f.value.name=N.data().location,f.value.fetched=!0,d.value.location=f.value.name,console.log("Location loaded from profile:",f.value.name);return}}catch(D){console.error("Error reading user profile location:",D)}f.value.loading=!0;try{const D=await fetch("https://api.ip-api.com/json/?fields=city,regionName,country");if(!D.ok)throw new Error("Failed to fetch location data");const N=await D.json();let w="Unknown";N.city&&N.city!==""?w=N.city:N.regionName&&N.regionName!==""?w=N.regionName:N.country&&N.country!==""&&(w=N.country),f.value.name=w,d.value.location=w,f.value.fetched=!0;const y=ln(i,`artifacts/${r}/users/${k}/profile/user_data`);await sa(y,{location:w},{merge:!0})}catch(D){console.error("Location API error:",D),f.value.name="Unknown",d.value.location="Unknown"}finally{f.value.loading=!1}}},_=k=>{if(!k)return"";const N=k.replace(/</g,"&lt;").replace(/>/g,"&gt;").split(`
`);let w="",y=!1,x=[];const E=()=>{if(x.length===0)return;let I='<div class="overflow-x-auto my-4"><table class="min-w-full divide-y divide-gray-300 border border-gray-300 rounded-lg">';const S=x[0].replace(/^\||\|$/g,"").split("|").map(rt=>rt.trim());if(S.length>0&&(I+='<thead class="bg-gray-200">',I+="<tr>",S.forEach(rt=>{let it=rt;it=it.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>"),it=it.replace(/\*(.*?)\*/g,"<em>$1</em>"),it=it.replace(/_(.*?)_/g,"<em>$1</em>"),I+=`<th scope="col" class="px-3 py-2 text-left text-xs font-medium text-gray-700 uppercase tracking-wider">${it}</th>`}),I+="</tr>",I+="</thead>"),x.length>1){I+='<tbody class="divide-y divide-gray-200">';for(let rt=2;rt<x.length;rt++){const dt=x[rt].replace(/^\||\|$/g,"").split("|").map(ot=>ot.trim());dt.length===S.length&&(I+='<tr class="bg-white hover:bg-gray-50">',dt.forEach(ot=>{let H=ot;H=H.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>"),H=H.replace(/\*(.*?)\*/g,"<em>$1</em>"),H=H.replace(/_(.*?)_/g,"<em>$1</em>"),I+=`<td class="px-3 py-2 whitespace-nowrap text-sm text-gray-800">${H}</td>`}),I+="</tr>")}I+="</tbody>"}I+="</table></div>",w+=I,x=[]};return N.forEach(I=>{let P=I.trim();if(P.includes("|")&&!P.startsWith("#")){const it=P.match(/\|[:-]*\|/);if(x.length===0&&it)x.push(P);else if(x.length>0||P.startsWith("|")){y&&(w+="</ul>",y=!1),x.push(P);return}}if(x.length>0&&E(),P.length===0){y&&(w+="</ul>",y=!1);return}if(P.startsWith("###")){w+=`<h3 class="text-xl font-bold text-gray-800 mt-4 mb-2">${P.substring(3).trim()}</h3>`;return}if(P.startsWith("##")){w+=`<h2 class="text-2xl font-serif text-black mt-6 mb-3 border-b border-gray-300 pb-1">${P.substring(2).trim()}</h2>`;return}if(P.startsWith("#")){w+=`<h1 class="text-3xl font-serif text-black mt-8 mb-4">${P.substring(1).trim()}</h1>`;return}if(P==="---"){y&&(w+="</ul>",y=!1),w+='<hr class="my-6 border-gray-300">';return}if(P.startsWith("* ")||P.startsWith("- ")){y||(w+='<ul class="list-disc ml-6 space-y-1 mb-4">',y=!0);let it=P.substring(2).trim();it=it.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>"),it=it.replace(/\*(.*?)\*/g,"<em>$1</em>"),it=it.replace(/_(.*?)_/g,"<em>$1</em>"),w+=`<li>${it}</li>`;return}y&&(w+="</ul>",y=!1);let rt=P;rt=rt.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>"),rt=rt.replace(/\*(.*?)\*/g,"<em>$1</em>"),rt=rt.replace(/_(.*?)_/g,"<em>$1</em>"),w+=`<p class="mb-4">${rt}</p>`}),y&&(w+="</ul>"),x.length>0&&E(),w},b=async()=>{try{const k=await fetch("/the-arcane-scholar-s-legacy/Chapter1.md");if(!k.ok)throw new Error("Failed to fetch Chapter1.md.");const D=await k.text();c.value.chapter1=_(D),console.log("Successfully read and parsed Chapter1.md.");const N=await fetch("/the-arcane-scholar-s-legacy/Chapter2.md");if(!N.ok)throw new Error("Failed to fetch Chapter2.md.");const w=await N.text();c.value.chapter2=_(w),console.log("Successfully read and parsed Chapter2.md."),h.value=!0}catch(k){console.error("Error fetching lore:",k),a.value=`Failed to load game lore (${k.message}). Ensure Chapter1.md and Chapter2.md exist.`}};kr(()=>{b(),s.currentUser&&g(s.currentUser.uid)});const v=k=>{d.value.faction=k},A=k=>{d.value.specialty=k},C=()=>{l.value==="factionSelect"?l.value="chapter2":l.value==="specialtySelect"&&(l.value="nameAssign")},O=async()=>{const k=s.currentUser?.uid;if(!k){a.value="User not authenticated. Please log in again.";return}if(!d.value.name){a.value="Please enter a name for your scholar.";return}o.value=!0,a.value=null;try{const D=W0(i,`artifacts/${r}/users/${k}/characters`);d.value.location=f.value.name||"Unknown";const N=await uk(D,d.value),w=ln(i,`artifacts/${r}/users/${k}/profile/user_data`);await nd(w,{characterCount:rw(1)},{merge:!0});const y=ln(i,`artifacts/${r}/public/data/leaderboard`,N.id),x={name:d.value.name,prestige:d.value.prestige,faction:d.value.faction,specialty:d.value.specialty,location:d.value.location,userId:k};await sa(y,x,{merge:!0}),console.log("New character created with ID:",N.id),e("character-created",N.id)}catch(D){console.error("Error creating character:",D),D.message.includes("permission denied")||D.message.includes("unauthorized")?a.value="Creation failed: You have reached the maximum limit of 4 characters. Please delete one to continue.":a.value=`Failed to create character: ${D.message}`}finally{o.value=!1}};return(k,D)=>(st(),lt("div",yk,[D[17]||(D[17]=M("h2",{class:"text-4xl font-serif text-black mb-8 text-center leading-tight"},"Forge Your Legacy",-1)),D[18]||(D[18]=M("img",{src:gc,alt:"The Arcane Scholar's Legacy",class:"h-24 w-24 mb-4 animate-bounce"},null,-1)),o.value?(st(),lt("div",bk,"Loaading...")):fe("",!0),a.value?(st(),lt("div",vk,pt(a.value),1)):fe("",!0),h.value?l.value==="chapter1"||l.value==="factionSelect"?(st(),lt("div",xk,[D[11]||(D[11]=M("h3",{class:"text-2xl font-serif text-black mb-4 border-b border-gray-300 pb-2"},"Chapter 1: The First Whisper",-1)),M("div",{innerHTML:c.value.chapter1,class:"text-lg text-gray-800 leading-relaxed mb-6 max-h-80 overflow-y-auto markdown-content"},null,8,Tk),M("div",Ek,[l.value==="chapter1"?(st(),lt("button",{key:0,onClick:D[0]||(D[0]=N=>l.value="factionSelect"),class:"w-full py-3 px-4 rounded-lg text-xl font-bold bg-black hover:bg-gray-800 text-white shadow-lg transition-all duration-200 ease-in-out"}," Continue to Faction Selection ")):fe("",!0),l.value==="factionSelect"?(st(),lt("div",Ik,[M("button",{onClick:D[1]||(D[1]=N=>v("Lumen")),class:q(["w-full py-3 px-4 rounded-lg text-xl font-bold transition-all duration-200 ease-in-out",d.value.faction==="Lumen"?"bg-black text-white shadow-xl":"bg-gray-200 hover:bg-gray-300 text-black"])}," Select Lumen ",2),M("button",{onClick:D[2]||(D[2]=N=>v("Umbra")),class:q(["w-full py-3 px-4 rounded-lg text-xl font-bold transition-all duration-200 ease-in-out",d.value.faction==="Umbra"?"bg-black text-white shadow-xl":"bg-gray-200 hover:bg-gray-300 text-black"])}," Select Umbra ",2),M("button",{onClick:C,disabled:!d.value.faction,class:"w-full py-3 px-4 rounded-lg text-xl font-bold bg-black hover:bg-gray-800 text-white shadow-lg transition-all duration-200 ease-in-out disabled:opacity-50 disabled:cursor-not-allowed"}," Proceed ",8,Sk),M("button",{onClick:D[3]||(D[3]=N=>l.value="chapter1"),class:"w-full py-2 px-4 rounded-lg text-sm bg-gray-600 hover:bg-gray-700 text-white transition-all duration-200 ease-in-out"}," Go Back ")])):fe("",!0)])])):l.value==="chapter2"||l.value==="specialtySelect"?(st(),lt("div",Ak,[D[12]||(D[12]=M("h3",{class:"text-2xl font-serif text-black mb-4 border-b border-gray-300 pb-2"},"Chapter 2: The Second Whisper",-1)),M("div",{innerHTML:c.value.chapter2,class:"text-lg text-gray-800 leading-relaxed mb-6 max-h-80 overflow-y-auto markdown-content"},null,8,Ck),M("div",Pk,[l.value==="chapter2"?(st(),lt("button",{key:0,onClick:D[4]||(D[4]=N=>l.value="specialtySelect"),class:"w-full py-3 px-4 rounded-lg text-xl font-bold bg-black hover:bg-gray-800 text-white shadow-lg transition-all duration-200 ease-in-out"}," Continue to Specialty Selection ")):fe("",!0),l.value==="specialtySelect"?(st(),lt("div",Rk,[M("button",{onClick:D[5]||(D[5]=N=>A("Arcane")),class:q(["w-full py-3 px-4 rounded-lg text-xl font-bold transition-all duration-200 ease-in-out",d.value.specialty==="Arcane"?"bg-black text-white shadow-xl":"bg-gray-200 hover:bg-gray-300 text-black"])}," Select Arcane ",2),M("button",{onClick:D[6]||(D[6]=N=>A("Alchemist")),class:q(["w-full py-3 px-4 rounded-lg text-xl font-bold transition-all duration-200 ease-in-out",d.value.specialty==="Alchemist"?"bg-black text-white shadow-xl":"bg-gray-200 hover:bg-gray-300 text-black"])}," Select Alchemist ",2),M("button",{onClick:C,disabled:!d.value.specialty,class:"w-full py-3 px-4 rounded-lg text-xl font-bold bg-black hover:bg-gray-800 text-white shadow-lg transition-all duration-200 ease-in-out disabled:opacity-50 disabled:cursor-not-allowed"}," Proceed ",8,kk),M("button",{onClick:D[7]||(D[7]=N=>l.value="chapter1"),class:"w-full py-2 px-4 rounded-lg text-sm bg-gray-600 hover:bg-gray-700 text-white transition-all duration-200 ease-in-out"}," Go Back ")])):fe("",!0)])])):l.value==="nameAssign"?(st(),lt("div",Dk,[D[15]||(D[15]=M("h3",{class:"text-2xl font-serif text-black mb-4 border-b border-gray-300 pb-2"},"Assign Your Scholar Name",-1)),D[16]||(D[16]=M("p",{class:"text-lg text-gray-700 mb-4"}," Name your scholar, choose wisely as this name will define your legacy. ",-1)),M("p",Mk," Faction: "+pt(d.value.faction)+" | Specialty: "+pt(d.value.specialty),1),M("p",Ok,[D[13]||(D[13]=bn(" Current Location: ",-1)),f.value.loading?(st(),lt("span",Lk,"Detecting location...")):f.value.name?(st(),lt("span",Vk,pt(f.value.name),1)):(st(),lt("span",Nk,"Location Unknown (This will be 'Unknown' on the global leaderboards)"))]),M("form",{onSubmit:Ob(O,["prevent"]),class:"space-y-4"},[M("div",null,[D[14]||(D[14]=M("label",{for:"characterName",class:"block text-lg text-gray-700 mb-2"},"Scholar's Name:",-1)),Ns(M("input",{id:"characterName","onUpdate:modelValue":D[8]||(D[8]=N=>d.value.name=N),type:"text",required:"",class:"w-full p-3 rounded-lg bg-white text-black border border-gray-300 focus:outline-none focus:ring-2 focus:ring-black",placeholder:"Enter a name"},null,512),[[cI,d.value.name]])]),M("button",{type:"submit",disabled:!d.value.name||o.value,class:"w-full py-3 px-4 rounded-lg text-xl font-bold bg-black hover:bg-gray-800 text-white shadow-lg transition-all duration-200 ease-in-out disabled:opacity-50 disabled:cursor-not-allowed"}," Forge Legacy ",8,Fk)],32),M("button",{onClick:D[9]||(D[9]=N=>l.value="specialtySelect"),class:"w-full py-2 px-4 mt-4 rounded-lg text-sm bg-gray-600 hover:bg-gray-700 text-white transition-all duration-200 ease-in-out"}," Go Back ")])):fe("",!0):(st(),lt("div",wk,D[10]||(D[10]=[M("p",{class:"text-lg text-gray-700"},"Loading lore...",-1)])))]))}},Uk={class:"flex flex-col items-center justify-center min-h-screen w-full bg-white text-gray-800 font-sans p-6"},$k={class:"bg-gray-50 p-8 rounded-xl shadow-lg border border-gray-200 w-full max-w-2xl"},zk={class:"bg-gray-100 p-6 rounded-lg shadow-inner mb-8"},jk={key:0,class:"text-center text-lg text-red-600 font-bold mb-3 p-2 rounded-lg bg-red-100"},Hk=["disabled"],Wk={class:"bg-gray-100 p-6 rounded-lg shadow-inner"},qk={class:"text-2xl font-serif text-black mb-4 border-b border-gray-300 pb-2"},Gk={key:0,class:"text-center text-sm text-gray-600 italic"},Kk={key:1,class:"space-y-4"},Yk=["onClick"],Xk={class:"text-2xl font-bold text-black"},Qk={class:"text-sm text-gray-600"},Jk=["onClick"],Zk={key:0,class:"fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center p-4 z-50"},tD={key:1,class:"fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center p-4 z-50"},eD={class:"bg-red-100 p-8 rounded-xl shadow-2xl border border-red-200 w-full max-w-sm text-center"},nD={class:"text-red-800 mb-6"},oo=4,sD={__name:"CharacterSelectionView",emits:["characterSelected","startNewCharacterCreation"],setup(n,{emit:t}){const e=t,s=At([]),i=At(0),r=At(!1),o=At(null),a=At(!1),l=At(""),c=Wi(),h=Ur(),d=typeof __app_id<"u"?__app_id:"default-app-id",f=async C=>{if(C)try{const O=ln(h,`artifacts/${d}/users/${C}/profile/user_data`),k=await au(O);k.exists()?i.value=k.data().characterCount||0:(await sa(O,{characterCount:0},{merge:!0}),i.value=0),console.log(`Character count loaded: ${i.value}`)}catch(O){console.error("Error fetching or initializing user profile:",O)}},g=async C=>{if(C)try{const O=W0(h,`artifacts/${d}/users/${C}/characters`),k=ew(O),D=await lk(k);s.value=D.docs.map(w=>({id:w.id,...w.data()})),i.value=s.value.length;const N=ln(h,`artifacts/${d}/users/${C}/profile/user_data`);await nd(N,{characterCount:s.value.length},{merge:!0})}catch(O){console.error("Error fetching characters:",O),l.value="Failed to load characters. Please check your connection.",a.value=!0}},_=C=>{e("characterSelected",C)},b=C=>{o.value=C,r.value=!0},v=()=>{r.value=!1,o.value=null},A=async()=>{const C=c.currentUser?.uid;if(!(!C||!o.value))try{const O=ln(h,`artifacts/${d}/users/${C}/characters`,o.value);await ck(O);const k=ln(h,`artifacts/${d}/users/${C}/profile/user_data`);await nd(k,{characterCount:rw(-1)},{merge:!0}),console.log("Character deleted successfully and count decremented."),r.value=!1,o.value=null,await g(C)}catch(O){console.error("Error deleting character:",O),l.value=`Failed to delete character: ${O.message}`,a.value=!0}};return kr(()=>{mv(c,async C=>{C&&(await f(C.uid),await g(C.uid))})}),(C,O)=>(st(),lt("div",Uk,[M("div",$k,[O[2]||(O[2]=M("h2",{class:"text-4xl font-serif text-black mb-6 text-center"},"Your Scholars",-1)),M("div",zk,[i.value>=oo?(st(),lt("p",jk," Limit Reached ("+pt(oo)+" Max): Delete a scholar to forge a new legacy. ")):fe("",!0),M("button",{onClick:O[0]||(O[0]=k=>e("startNewCharacterCreation")),disabled:i.value>=oo,class:q(["w-full py-3 px-4 rounded-lg text-xl font-bold text-white shadow-lg transition-all duration-200 ease-in-out",i.value>=oo?"bg-gray-500 cursor-not-allowed":"bg-black hover:bg-gray-800"])}," Forge a New Legacy ",10,Hk)]),M("div",Wk,[M("h3",qk," Continue Your Legacy ("+pt(s.value.length)+" / "+pt(oo)+") ",1),s.value.length===0?(st(),lt("p",Gk," No scholars found. Forge your first one above! ")):(st(),lt("ul",Kk,[(st(!0),lt(Qe,null,Wo(s.value,k=>(st(),lt("li",{key:k.id,class:"flex items-center justify-between bg-white p-4 rounded-lg shadow-md transition duration-200 ease-in-out hover:bg-gray-50 border border-gray-200"},[M("div",{onClick:D=>_(k.id),class:"flex-grow cursor-pointer"},[M("h3",Xk,pt(k.name),1),M("p",Qk," Faction: "+pt(k.faction)+" | Specialty: "+pt(k.specialty),1)],8,Yk),M("button",{onClick:Ob(D=>b(k.id),["stop"]),class:"ml-4 bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg shadow-md transition duration-200 ease-in-out"}," Delete ",8,Jk)]))),128))]))])]),r.value?(st(),lt("div",Zk,[M("div",{class:"bg-white p-8 rounded-xl shadow-2xl border border-gray-200 w-full max-w-md text-center"},[O[3]||(O[3]=M("h3",{class:"text-2xl font-bold text-black mb-4"},"Confirm Deletion",-1)),O[4]||(O[4]=M("p",{class:"text-gray-700 mb-6"},"Are you sure you want to delete this scholar? This action cannot be undone.",-1)),M("div",{class:"flex justify-center space-x-4"},[M("button",{onClick:A,class:"bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-6 rounded-lg"},"Delete"),M("button",{onClick:v,class:"bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-6 rounded-lg"},"Cancel")])])])):fe("",!0),a.value?(st(),lt("div",tD,[M("div",eD,[O[5]||(O[5]=M("h3",{class:"text-2xl font-bold text-red-700 mb-4"},"Error",-1)),M("p",nD,pt(l.value),1),M("button",{onClick:O[1]||(O[1]=k=>a.value=!1),class:"bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-6 rounded-lg"},"Close")])])):fe("",!0)]))}},iD=Kn(sD,[["__scopeId","data-v-2f726bfd"]]),rD={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},oD={class:"flex items-center space-x-3"},aD={class:"flex-1"},lD={class:"flex items-center space-x-3"},cD={class:"flex-1"},uD={class:"flex items-center space-x-3"},hD={class:"flex-1"},dD={__name:"AchievementsSection",props:{themeClasses:{type:Object,required:!0,default:()=>({primaryBg:"bg-white",primaryText:"text-black",accentBorder:"border-gray-400",sidebarBg:"bg-gray-100",activeMenuBg:"bg-gray-300"})}},setup(n){const t=n;return(e,s)=>(st(),lt("div",{class:q(["mt-10 pt-6 border-t",t.themeClasses.accentBorder])},[M("h3",{class:q(["text-3xl font-serif mb-6 text-center",[t.themeClasses.primaryText]])}," Achievements ",2),M("div",rD,[M("div",{class:q(["p-4 rounded-lg border shadow-inner",[t.themeClasses.sidebarBg,t.themeClasses.accentBorder]]),title:"Unlocked: 2025-11-14"},[M("div",oD,[s[0]||(s[0]=M("span",{class:"text-3xl"},"",-1)),M("div",aD,[M("h4",{class:q(["text-lg font-bold",t.themeClasses.primaryText])}," Forge a Legacy ",2),M("p",{class:q(["text-sm italic",t.themeClasses.primaryText])},' "Name Your Character." ',2)])])],2),M("div",{class:q(["p-4 rounded-lg border shadow-inner opacity-70",[t.themeClasses.sidebarBg,t.themeClasses.accentBorder]])},[M("div",lD,[s[1]||(s[1]=M("span",{class:"text-3xl"},"",-1)),M("div",cD,[M("h4",{class:q(["text-lg font-bold",t.themeClasses.primaryText])}," Novice Scholar ",2),M("p",{class:q(["text-sm italic",t.themeClasses.primaryText])},` "Click 'Generate Knowledge' 100 times." `,2)])]),M("div",{class:q(["w-full rounded-full h-2.5 mt-2",n.themeClasses.primaryBg])},[M("div",{class:q([n.themeClasses.activeMenuBg,"h-2.5 rounded-full"]),style:{width:"45%"},title:"45 / 100"},null,2)],2)],2),M("div",{class:q(["p-4 rounded-lg border shadow-inner opacity-40",[t.themeClasses.sidebarBg,t.themeClasses.accentBorder]])},[M("div",uD,[s[2]||(s[2]=M("span",{class:"text-3xl"},"",-1)),M("div",hD,[M("h4",{class:q(["text-lg font-bold",t.themeClasses.primaryText])}," ??? ",2),M("p",{class:q(["text-sm italic",t.themeClasses.primaryText])},' "Advance to Prestige 1." ',2)])])],2)])],2))}},fD=Kn(dD,[["__scopeId","data-v-a12dcc17"]]),pD=["onClick"],gD={class:"flex flex-col items-center justify-center space-y-6 mt-8"},mD={class:"font-bold"},_D={key:0},yD={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-6"},bD={key:0},vD=["onClick","disabled"],wD={key:0,class:"mt-8 text-center"},xD={class:"flex items-start space-x-6"},TD={class:"flex flex-col items-center w-28 flex-shrink-0"},ED=["title"],ID={class:"flex-grow"},SD={class:"font-semibold"},AD={class:"font-semibold"},CD={class:"font-semibold"},PD={__name:"SanctumView",props:{knowledge:{type:Number,required:!0},passiveKnowledgeGain:{type:Number,required:!0},multiplierTiers:{type:Array,required:!0},characterDetails:{type:Object,required:!0},currentTierIndex:{type:Number,required:!0},themeClasses:{type:Object,required:!0,default:()=>({primaryBg:"bg-gray-950",primaryText:"text-yellow-300",accentBorder:"border-yellow-600",sidebarBg:"bg-violet-950",activeMenuBg:"bg-green-800",activeMenuText:"text-white"})}},emits:["generate-knowledge","buy-multiplier","advance-tier"],setup(n,{emit:t}){const e=n,s=t,i=At("generator"),r=[{id:"generator",name:"Primary Resource Generator"},{id:"character",name:"Character Overview"},{id:"achievements",name:"Achievements"}],o=h=>{if(h==null)return"0.00";h=Number(h);const d=[{value:1e12,symbol:"T"},{value:1e9,symbol:"B"},{value:1e6,symbol:"M"},{value:1e3,symbol:"K"}];for(let f=0;f<d.length;f++){const{value:g,symbol:_}=d[f];if(Math.abs(h)>=g){const b=h/g;let v;return b<10?v=b.toFixed(3):b<100?v=b.toFixed(2):v=b.toFixed(1),v+_}}return h.toFixed(2)},a=Ln(()=>e.multiplierTiers[e.currentTierIndex]),l=Ln(()=>{const h=a.value;if(!h)return!1;const d=h.multipliers.every(g=>g.level===g.maxLevel),f=e.multiplierTiers[e.currentTierIndex+1];return d&&f}),c=(h,d)=>{const f=e.multiplierTiers[h]?.multipliers[d];return f?f.baseCost*Math.pow(f.costMultiplier,f.level):1/0};return(h,d)=>(st(),lt("section",{class:q([e.themeClasses.primaryText,e.themeClasses.accentBorder,e.themeClasses.primaryBg,"p-6 rounded-lg shadow-xl border"])},[M("div",{class:q(["flex flex-wrap border-b mb-6",e.themeClasses.accentBorder])},[(st(),lt(Qe,null,Wo(r,f=>M("button",{key:f.id,onClick:g=>i.value=f.id,class:q(["py-2 px-4 text-lg font-semibold transition-colors duration-200",i.value===f.id?["border-b-4",e.themeClasses.activeMenuBg,e.themeClasses.activeMenuText]:[e.themeClasses.primaryText,"opacity-70 hover:opacity-100 hover:border-b-2",e.themeClasses.accentBorder]])},pt(f.name),11,pD)),64))],2),Ns(M("div",null,[M("h2",{class:q(["text-3xl font-serif mb-6 pb-2 border-b",[e.themeClasses.primaryText,e.themeClasses.accentBorder]])}," Primary Resource Generator ",2),M("div",gD,[M("span",{class:q(["text-4xl sm:text-5xl font-bold mb-4",e.themeClasses.primaryText])}," Current Knowledge: "+pt(o(n.knowledge)),3),M("button",{onClick:d[0]||(d[0]=f=>s("generate-knowledge")),class:q([e.themeClasses.activeMenuBg,"text-white font-bold py-4 px-8 rounded-full text-2xl shadow-lg transition duration-300 ease-in-out transform hover:scale-105 hover:opacity-80"])}," Generate Knowledge ",2),M("p",{class:q(["text-sm mt-2",e.themeClasses.primaryText])},"Click to harness raw arcane energy and convert it into Knowledge.",2),M("p",{class:q(["text-xl mt-4",e.themeClasses.primaryText])},[d[2]||(d[2]=bn(" Passive Knowledge Gain: ",-1)),M("span",mD,pt(o(n.passiveKnowledgeGain)),1),d[3]||(d[3]=bn(" / second ",-1))],2)]),M("div",{class:q(["mt-10 pt-6 border-t",e.themeClasses.accentBorder])},[a.value?(st(),lt("div",_D,[M("h4",{class:q(["text-3xl font-serif mb-6 text-center",[e.themeClasses.primaryText]])},pt(a.value.name),3),M("div",yD,[(st(!0),lt(Qe,null,Wo(a.value.multipliers,(f,g)=>(st(),lt("div",{key:`multiplier-${e.currentTierIndex}-${g}`,class:q(["p-4 rounded-lg border shadow-md flex flex-col",[e.themeClasses.primaryBg,e.themeClasses.accentBorder]])},[M("h4",{class:q(["text-xl mb-2",e.themeClasses.primaryText])},pt(f.name)+" (Level "+pt(f.level)+" / "+pt(f.maxLevel)+") ",3),M("p",{class:q(["text-sm mb-2",e.themeClasses.primaryText])},[bn(" Current effect: +"+pt(o(f.baseEffect*Math.pow(f.effectMultiplier,f.level>0?f.level-1:0)))+" knowledge/s ",1),f.level>0&&f.level<f.maxLevel?(st(),lt("span",bD,"(Next: +"+pt(o(f.baseEffect*Math.pow(f.effectMultiplier,f.level)))+" knowledge/s)",1)):fe("",!0)],2),M("p",{class:q(["text-sm mb-4",e.themeClasses.primaryText])},[bn(" Cost for next level ("+pt(f.level+1)+"): ",1),M("span",{class:q(["font-bold",e.themeClasses.primaryText])},pt(o(c(e.currentTierIndex,g)))+" Knowledge",3)],2),f.level<f.maxLevel?(st(),lt("button",{key:0,onClick:_=>s("buy-multiplier",{tierIndex:e.currentTierIndex,multiplierIndex:g}),disabled:n.knowledge<c(e.currentTierIndex,g),class:q([e.themeClasses.activeMenuBg,"mt-auto text-white py-2 px-4 rounded-md text-base font-bold transition duration-300 ease-in-out",n.knowledge<c(e.currentTierIndex,g)?"opacity-50 cursor-not-allowed":""])}," Buy Upgrade (Level "+pt(f.level+1)+") ",11,vD)):(st(),lt("div",{key:1,class:q(["mt-auto text-center py-2 rounded-md font-bold text-base shadow-inner",[e.themeClasses.activeMenuBg,e.themeClasses.primaryText,"bg-opacity-80"]])}," Max Level Reached  ",2))],2))),128))]),l.value?(st(),lt("div",wD,[M("button",{onClick:d[1]||(d[1]=f=>s("advance-tier")),class:q(["py-3 px-6 rounded-lg text-xl font-bold transition duration-300 ease-in-out transform hover:scale-105",e.themeClasses.activeMenuBg,e.themeClasses.primaryText])}," Go to Next Tier: "+pt(e.multiplierTiers[e.currentTierIndex+1].name)+"  ",3)])):fe("",!0)])):(st(),lt("div",{key:1,class:q(["text-center p-4 rounded-lg border border-dashed",[e.themeClasses.sidebarBg,e.themeClasses.accentBorder,e.themeClasses.primaryText]])},d[4]||(d[4]=[M("p",{class:"italic"},"Loading Arcane Data...",-1)]),2))],2)],512),[[$u,i.value==="generator"]]),Ns(M("div",null,[M("h2",{class:q(["text-3xl font-serif mb-6 pb-2 border-b",[e.themeClasses.primaryText,e.themeClasses.accentBorder]])}," Character Overview ",2),M("div",xD,[M("div",TD,[M("div",{class:q(["w-24 h-24 sm:w-28 sm:h-28 border-2 rounded-lg shadow-inner flex items-center justify-center",[e.themeClasses.primaryBg,e.themeClasses.accentBorder]])},[M("span",{class:q([e.themeClasses.primaryText,"text-sm italic opacity-70"])},"Avatar",2)],2),M("h3",{class:q(["mt-2 text-lg font-bold text-center truncate w-full",e.themeClasses.primaryText]),title:n.characterDetails.name},pt(n.characterDetails.name),11,ED),M("p",{class:q(["text-sm",e.themeClasses.primaryText])},"Prestige: "+pt(n.characterDetails.prestige),3)]),M("div",ID,[M("p",{class:q(["text-lg",e.themeClasses.primaryText])}," Welcome back, Scholar. The whispers of ancient knowledge await your command. ",2),M("div",{class:q(["mt-4 p-4 rounded-lg border",e.themeClasses.accentBorder])},[M("h4",{class:q(["text-xl font-bold mb-2",e.themeClasses.primaryText])},"Character Stats",2),M("p",{class:q(e.themeClasses.primaryText)},[d[5]||(d[5]=bn("Faction: ",-1)),M("span",SD,pt(n.characterDetails.faction||"N/A"),1)],2),M("p",{class:q(e.themeClasses.primaryText)},[d[6]||(d[6]=bn("Specialty: ",-1)),M("span",AD,pt(n.characterDetails.specialty||"N/A"),1)],2),M("p",{class:q(e.themeClasses.primaryText)},[d[7]||(d[7]=bn("Location: ",-1)),M("span",CD,pt(n.characterDetails.location||"Sanctum"),1)],2)],2)])])],512),[[$u,i.value==="character"]]),Ns(M("div",null,[M("h2",{class:q(["text-3xl font-serif mb-6 pb-2 border-b",[e.themeClasses.primaryText,e.themeClasses.accentBorder]])}," Achievements ",2),Fe(fD,{"theme-classes":e.themeClasses},null,8,["theme-classes"])],512),[[$u,i.value==="achievements"]])],2))}},RD=Kn(PD,[["__scopeId","data-v-3798c445"]]),kD={__name:"ResearchView",props:{themeClasses:{type:Object,required:!0,default:()=>({primaryBg:"bg-gray-950",primaryText:"text-yellow-300",accentBorder:"border-yellow-600",sidebarBg:"bg-violet-950",activeMenuBg:"bg-green-800"})}},setup(n){const t=n,{themeClasses:e}=t;return console.log("ResearchView: Component loaded."),(s,i)=>(st(),lt("section",{class:q([Ut(e).sidebarBg,Ut(e).primaryText,Ut(e).accentBorder,"p-6 rounded-lg shadow-xl border"])},[M("h2",{class:q(["text-3xl font-serif mb-6 border-b pb-3",[Ut(e).primaryText,Ut(e).accentBorder]])}," Research ",2),M("p",{class:q(["text-lg",Ut(e).primaryText])}," Uncover forgotten spells and ancient technologies. ",2),M("p",{class:q(["text-sm mt-4",Ut(e).primaryText])},"This section will contain various research projects, their costs, and effects.",2)],2))}},DD=Kn(kD,[["__scopeId","data-v-675a273d"]]),MD={__name:"ExpeditionsView",props:{themeClasses:{type:Object,required:!0,default:()=>({primaryBg:"bg-gray-950",primaryText:"text-yellow-300",accentBorder:"border-yellow-600",sidebarBg:"bg-violet-950",activeMenuBg:"bg-green-800"})}},setup(n){const t=n,{themeClasses:e}=t;return console.log("ExpeditionsView: Component loaded."),(s,i)=>(st(),lt("section",{class:q([Ut(e).primaryBg,Ut(e).primaryText,Ut(e).accentBorder,"p-6 rounded-lg shadow-xl border"])},[M("h2",{class:q(["text-3xl font-serif mb-6 border-b pb-3",[Ut(e).primaryText,Ut(e).accentBorder]])}," Expeditions ",2),M("p",{class:q(["text-lg",Ut(e).primaryText])}," Send your scholars on perilous journeys to retrieve rare artifacts and knowledge. ",2),M("p",{class:q(["text-sm mt-4",Ut(e).primaryText])},"Manage your expeditions, track their progress, and claim rewards here.",2)],2))}},OD=Kn(MD,[["__scopeId","data-v-9c681b39"]]),LD={__name:"InventoryView",props:{themeClasses:{type:Object,required:!0,default:()=>({primaryBg:"bg-white",primaryText:"text-black",headerBg:"bg-gray-800",headerText:"text-white",accentBorder:"border-gray-400",sidebarBg:"bg-gray-100",activeMenuBg:"bg-gray-300",activeMenuText:"text-black",shadowColor:"shadow-gray-500/30",buttonBg:"bg-blue-600",buttonText:"text-white",buttonHover:"hover:bg-blue-700",buttonSecondaryBg:"bg-gray-500",buttonSecondaryText:"text-white",buttonSecondaryHover:"hover:bg-gray-600",buttonUrgentBg:"bg-red-600",buttonUrgentText:"text-white",buttonUrgentHover:"hover:bg-red-700"})}},setup(n){const t=n,{themeClasses:e}=t;return console.log("InventoryView: Component loaded."),(s,i)=>(st(),lt("section",{class:q([Ut(e).primaryBg,Ut(e).primaryText,Ut(e).accentBorder,"p-6 rounded-lg shadow-xl border",Ut(e).shadowColor])},[M("h2",{class:q(["text-3xl font-serif mb-6 border-b pb-3",[Ut(e).primaryText,Ut(e).accentBorder]])}," Inventory ",2),M("p",{class:q(["text-lg",Ut(e).primaryText])}," Behold your collected treasures and resources. ",2),M("p",{class:q(["text-sm mt-4",Ut(e).primaryText])},"This section will display all your acquired items, resources, and their quantities.",2)],2))}},VD=Kn(LD,[["__scopeId","data-v-6b6782e6"]]),ND={__name:"SkillTreeView",props:{themeClasses:{type:Object,required:!0,default:()=>({primaryBg:"bg-gray-950",primaryText:"text-yellow-300",accentBorder:"border-yellow-600",sidebarBg:"bg-violet-950",activeMenuBg:"bg-green-800"})}},setup(n){const t=n,{themeClasses:e}=t;return console.log("SkillTreeView: Component loaded."),(s,i)=>(st(),lt("section",{class:q([Ut(e).primaryBg,Ut(e).primaryText,Ut(e).accentBorder,"p-6 rounded-lg shadow-xl border"])},[M("h2",{class:q(["text-3xl font-serif mb-6 border-b pb-3",[Ut(e).primaryText,Ut(e).accentBorder]])}," Skill Tree ",2),M("p",{class:q(["text-lg",Ut(e).primaryText])}," Forge your destiny by mastering powerful skills and abilities. ",2),M("p",{class:q(["text-sm mt-4",Ut(e).primaryText])},"Invest your hard-earned skill points to unlock new capabilities and enhance existing ones.",2)],2))}},FD=Kn(ND,[["__scopeId","data-v-20e61295"]]),BD={class:"flex items-center space-x-2"},UD={class:"flex items-center space-x-2"},$D={class:"flex items-center space-x-2"},zD={class:"flex items-center space-x-2 ml-auto"},jD={key:2,class:"text-lg text-red-500 bg-red-100 p-4 rounded-lg text-center"},HD={key:4,class:"overflow-x-auto"},WD={class:"px-4 py-4 whitespace-nowrap text-sm font-medium"},qD={class:"px-4 py-4 whitespace-nowrap text-sm font-bold"},GD={class:"px-4 py-4 whitespace-nowrap text-sm font-medium"},KD={class:"px-4 py-4 whitespace-nowrap text-sm"},YD={class:"px-4 py-4 whitespace-nowrap text-sm"},XD={class:"px-4 py-4 whitespace-nowrap text-sm"},QD={class:"px-4 py-4 whitespace-nowrap text-sm"},JD={class:"px-4 py-4 whitespace-nowrap text-xs"},ZD={__name:"ClassificationView",props:{themeClasses:{type:Object,required:!0,default:()=>({primaryBg:"bg-white",primaryText:"text-black",headerBg:"bg-gray-800",headerText:"text-white",accentBorder:"border-gray-400",sidebarBg:"bg-gray-100",activeMenuBg:"bg-gray-300",activeMenuText:"text-black",shadowColor:"shadow-gray-500/30",buttonBg:"bg-blue-600",buttonText:"text-white",buttonHover:"hover:bg-blue-700",buttonSecondaryBg:"bg-gray-500",buttonSecondaryText:"text-white",buttonSecondaryHover:"hover:bg-gray-600",buttonUrgentBg:"bg-red-600",buttonUrgentText:"text-white",buttonUrgentHover:"hover:bg-red-700"})}},setup(n){const t=n,e={prestige:3,tierSum:2,count:1},s=typeof __app_id<"u"?__app_id:"default-app-id",i=Ur(),r=Wi();let o;const a=At([]),l=At({}),c=At(!0),h=At(null),d=At(""),f=At(""),g=At(""),_=At("prestige"),b=At("desc"),v=Ln(()=>{const w=t.themeClasses.primaryBg.includes("black")||t.themeClasses.primaryBg.includes("332c30"),y=w?"#FFFFFF":"#333333";return{scales:{x:{beginAtZero:!0,max:100,stacked:!0,title:{display:!0,text:"Percentage Dominance (%)",color:y},ticks:{color:y},grid:{color:w?"#555":"#ddd"}},y:{stacked:!0,ticks:{color:y},grid:{color:w?"#555":"#ddd"}}},responsive:!0,maintainAspectRatio:!1,height:"100px",indexAxis:"y",plugins:{tooltip:{callbacks:{label:x=>x.dataset.label+": "+x.parsed.x.toFixed(2)+"%"}},legend:{position:"bottom",labels:{color:y}}}}}),A=async w=>{if(l.value[w])return l.value[w];try{const y=ln(i,`artifacts/${s}/users/${w}/profile/user_data`),x=await au(y);if(x.exists()){const E=x.data(),I={userName:E.username||E.name||"Anonymous Scholar",userLocation:E.location||null};return l.value[w]=I,I}}catch(y){console.warn(`Could not fetch profile for user ${w}:`,y.message)}return l.value[w]={userName:"Missing Profile",userLocation:null},l.value[w]},C=()=>{if(!r.currentUser){h.value="You must be logged in to view the Classification.",c.value=!1;return}const w=YR(i,"leaderboard"),y=ew(w);c.value=!0,h.value=null,o=hk(y,async x=>{try{const E=[],I=new Set;x.forEach(rt=>{const it=rt.data();E.push({id:rt.id,currentTierIndex:it.currentTierIndex||0,...it}),it.userId&&I.add(it.userId)});const P=Array.from(I).map(rt=>A(rt));await Promise.all(P);const S=E.map(rt=>({...rt,userName:l.value[rt.userId]?.userName||"Unknown Player",userLocation:l.value[rt.userId]?.userLocation||null}));a.value=S}catch(E){console.error("Error processing leaderboard snapshot or profiles:",E),h.value="Failed to process data from the server."}finally{c.value=!1}},x=>{console.error("Error fetching leaderboard:",x),h.value=`Access Denied or Connection Error: ${x.message}`,c.value=!1})},O=()=>{b.value=b.value==="desc"?"asc":"desc"},k=Ln(()=>{const y=[...a.value.filter(x=>{if(d.value&&x.faction!==d.value||f.value&&x.specialty!==f.value)return!1;const E=x.location||"",I=g.value;return!(I&&E!==I)})];return y.sort((x,E)=>{const I=x[_.value],P=E[_.value];if(_.value==="prestige"||_.value==="currentTierIndex"){const rt=(I||0)-(P||0);return b.value==="asc"?rt:-rt}const S=(I||"").localeCompare(P||"");return b.value==="asc"?S:-S}),y}),D=Ln(()=>{const w={Lumen:{count:0,tierSum:0,prestigeSum:0},Umbra:{count:0,tierSum:0,prestigeSum:0},Other:{count:0,tierSum:0,prestigeSum:0}};return k.value.forEach(y=>{const x=(y.currentTierIndex||0)+1,E=y.prestige||0,I=y.faction==="Lumen"||y.faction==="Umbra"?y.faction:"Other";w[I].count++,w[I].tierSum+=x,w[I].prestigeSum+=E}),w}),N=Ln(()=>{const w=D.value,y=e,x=X=>X.prestigeSum*y.prestige+X.tierSum*y.tierSum+X.count*y.count,E=x(w.Lumen),I=x(w.Umbra),P=x(w.Other),S=E+I+P;if(S===0)return[];const rt=E/S*100,it=I/S*100,dt=P/S*100,ot=t.themeClasses.factionLumenColor||"#13c2eb",H=t.themeClasses.factionUmbraColor||"#611462",K=[{name:"Lumen",data:[["Total Weighted Dominance",Math.round(rt*100)/100]],backgroundColor:ot},{name:"Umbra",data:[["Total Weighted Dominance",Math.round(it*100)/100]],backgroundColor:H}];return dt>.01&&K.push({name:"Other/Unassigned",data:[["Total Weighted Dominance",Math.round(dt*100)/100]],backgroundColor:"#6b7280"}),K});return kr(()=>{const w=r.onAuthStateChanged(y=>{w(),y?C():(c.value=!1,h.value="You must be logged in to view the Classification.")})}),Oc(()=>{o&&(o(),console.log("ClassificationView: Firestore listener unsubscribed."))}),(w,y)=>{const x=XT("bar-chart");return st(),lt("section",{class:q([n.themeClasses.primaryBg,n.themeClasses.primaryText,n.themeClasses.accentBorder,"p-6 rounded-lg shadow-xl border overflow-auto h-full",n.themeClasses.shadowColor])},[M("h2",{class:q(["text-3xl font-serif mb-6 border-b pb-3",[n.themeClasses.primaryText,n.themeClasses.accentBorder]])}," Classification: Global Scholars ",2),M("p",{class:q(["text-sm mt-4 mb-4",n.themeClasses.primaryText])}," View the global rankings of all scholars. Use the controls below to filter and sort the data. ",2),!c.value&&!h.value?(st(),lt("div",{key:0,class:q(["mb-8 p-4 rounded-lg border",n.themeClasses.accentBorder])},[y[5]||(y[5]=M("h3",{class:"text-xl font-bold mb-4"},"Composite Faction Dominance (Percentage)",-1)),M("div",{class:q([n.themeClasses.sidebarBg,n.themeClasses.primaryText,"p-6 rounded-lg shadow-inner"])},[y[4]||(y[4]=M("h4",{class:"text-lg font-semibold mb-4"},"Total Weighted Dominance (Prestige 3x, Tier Sum 2x, Count 1x)",-1)),Fe(x,{data:N.value,options:v.value},null,8,["data","options"])],2),M("p",{class:q(["text-xs mt-4",n.themeClasses.primaryText])}," *Dominance is calculated based on a composite score: (Prestige x3) + (Tier Sum x2) + (Scholar Count x1). Data reflects the current filters applied. ",2)],2)):fe("",!0),M("div",{class:q(["flex flex-wrap gap-4 mb-6 p-4 rounded-lg border",[n.themeClasses.accentBorder,n.themeClasses.sidebarBg]])},[M("div",BD,[y[7]||(y[7]=M("label",{for:"filter-faction",class:"font-bold text-sm"},"Faction:",-1)),Ns(M("select",{id:"filter-faction","onUpdate:modelValue":y[0]||(y[0]=E=>d.value=E),class:q(["p-2 rounded-md shadow-inner text-sm",[n.themeClasses.primaryBg,n.themeClasses.primaryText,n.themeClasses.accentBorder,"border"]])},y[6]||(y[6]=[M("option",{value:""},"All Factions",-1),M("option",{value:"Lumen"},"Lumen",-1),M("option",{value:"Umbra"},"Umbra",-1)]),2),[[Ja,d.value]])]),M("div",UD,[y[9]||(y[9]=M("label",{for:"filter-specialty",class:"font-bold text-sm"},"Specialty:",-1)),Ns(M("select",{id:"filter-specialty","onUpdate:modelValue":y[1]||(y[1]=E=>f.value=E),class:q(["p-2 rounded-md shadow-inner text-sm",[n.themeClasses.primaryBg,n.themeClasses.primaryText,n.themeClasses.accentBorder,"border"]])},y[8]||(y[8]=[M("option",{value:""},"All Specialties",-1),M("option",{value:"Arcane"},"Arcane",-1),M("option",{value:"Alchemist"},"Alchemist",-1)]),2),[[Ja,f.value]])]),M("div",$D,[y[11]||(y[11]=M("label",{for:"filter-location",class:"font-bold text-sm"},"Location:",-1)),Ns(M("select",{id:"filter-location","onUpdate:modelValue":y[2]||(y[2]=E=>g.value=E),class:q(["p-2 rounded-md shadow-inner text-sm",[n.themeClasses.primaryBg,n.themeClasses.primaryText,n.themeClasses.accentBorder,"border"]])},y[10]||(y[10]=[gg('<option value="" data-v-9cdba474>All Locations</option><option value="Aethelgard" data-v-9cdba474>Aethelgard</option><option value="The Shadow Wastes" data-v-9cdba474>The Shadow Wastes</option><option value="Great Library" data-v-9cdba474>Great Library</option><option value="The Citadel" data-v-9cdba474>The Citadel</option><option value="Hidden Village" data-v-9cdba474>Hidden Village</option>',6)]),2),[[Ja,g.value]])]),M("div",zD,[y[13]||(y[13]=M("label",{for:"sort-by",class:"font-bold text-sm"},"Sort By:",-1)),Ns(M("select",{id:"sort-by","onUpdate:modelValue":y[3]||(y[3]=E=>_.value=E),class:q(["p-2 rounded-md shadow-inner text-sm",[n.themeClasses.primaryBg,n.themeClasses.primaryText,n.themeClasses.accentBorder,"border"]])},y[12]||(y[12]=[gg('<option value="prestige" data-v-9cdba474>Prestige (Default)</option><option value="currentTierIndex" data-v-9cdba474>Tier</option><option value="name" data-v-9cdba474>Name</option><option value="faction" data-v-9cdba474>Faction</option><option value="specialty" data-v-9cdba474>Specialty</option><option value="location" data-v-9cdba474>Location</option>',6)]),2),[[Ja,_.value]])]),M("button",{onClick:O,class:q(["py-2 px-3 rounded-md text-sm font-bold shadow-md transition duration-200",[b.value==="desc"?n.themeClasses.buttonUrgentBg:n.themeClasses.buttonBg,b.value==="desc"?n.themeClasses.buttonUrgentText:n.themeClasses.buttonText,b.value==="desc"?n.themeClasses.buttonUrgentHover:n.themeClasses.buttonHover]])}," Sort: "+pt(b.value==="desc"?"High to Low ()":"Low to High ()"),3)],2),c.value?(st(),lt("div",{key:1,class:q(["text-lg p-4 text-center",n.themeClasses.primaryText])},"Loading global rankings...",2)):h.value?(st(),lt("div",jD,"Error fetching rankings: "+pt(h.value),1)):k.value.length===0?(st(),lt("div",{key:3,class:q(["text-lg p-4 text-center rounded-lg",n.themeClasses.primaryText])}," No scholars found matching the current filters. ",2)):(st(),lt("div",HD,[M("table",{class:q(["min-w-full divide-y",n.themeClasses.accentBorder])},[M("thead",{class:q([n.themeClasses.headerBg,n.themeClasses.headerText])},y[14]||(y[14]=[M("tr",null,[M("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider"},"#"),M("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider"},"Player"),M("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider"},"Name"),M("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider"},"Prestige"),M("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider"},"Tier"),M("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider"},"Faction"),M("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider"},"Specialty"),M("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider"},"Location")],-1)]),2),M("tbody",{class:q(["divide-y",n.themeClasses.accentBorder])},[(st(!0),lt(Qe,null,Wo(k.value,(E,I)=>(st(),lt("tr",{key:E.id,class:q(["transition duration-150 ease-in-out",[n.themeClasses.sidebarBg,"hover:opacity-80"]])},[M("td",WD,pt(I+1),1),M("td",qD,pt(E.userName||"Loading..."),1),M("td",GD,pt(E.name),1),M("td",KD,pt(E.prestige),1),M("td",YD,pt((E.currentTierIndex||0)+1),1),M("td",XD,pt(E.faction),1),M("td",QD,pt(E.specialty),1),M("td",JD,pt(E.location||E.userLocation||"Unknown"),1)],2))),128))],2)],2)]))],2)}}},tM=Kn(ZD,[["__scopeId","data-v-9cdba474"]]),eM=["title"],nM={class:"lg:hidden flex items-center space-x-2"},sM={class:"truncate text-lg"},iM={class:"hidden lg:flex items-center space-x-3"},rM={class:"truncate"},oM={class:"flex items-center justify-end ml-auto flex-shrink-0"},aM={class:"flex items-center space-x-1 sm:space-x-2 lg:space-x-3"},lM={class:"flex items-center space-x-1",title:"Prestige"},cM={class:"font-bold text-base lg:text-xl min-w-[3rem] lg:min-w-[4rem] text-right"},uM={class:"flex items-center space-x-1",title:"Skill Points"},hM={class:"font-bold text-base lg:text-xl min-w-[3rem] lg:min-w-[4rem] text-right"},dM={class:"flex items-center space-x-1",title:"Knowledge"},fM={class:"font-bold text-base lg:text-xl min-w-[3rem] lg:min-w-[4rem] text-right"},pM={class:"flex items-center space-x-1 sm:space-x-2 lg:space-x-3 ml-2 lg:ml-4"},gM=["disabled"],mM={class:"hidden lg:inline ml-2"},_M=["onClick","title"],yM={class:"text-3xl lg:text-3xl flex-shrink-0"},bM={__name:"MainGameComponent",props:{userId:{type:String,required:!0},characterId:{type:String,required:!0}},emits:["returnToCharacterSelect"],setup(n,{emit:t}){const e=n,s=t,i=At(0),r=At(0),o=At({name:"",faction:"",specialty:"",prestige:0,location:""}),a=At([]),l=At("sanctum"),c=At(!1),h=At(0),d=At(0),f=Wi(),g=Ur(),_=typeof __app_id<"u"?__app_id:"default-app-id",b=H=>{if(H==null)return"0.00";H=Number(H);const K=[{value:1e12,symbol:"T"},{value:1e9,symbol:"B"},{value:1e6,symbol:"M"},{value:1e3,symbol:"K"}];for(let X=0;X<K.length;X++){const{value:ht,symbol:St}=K[X];if(Math.abs(H)>=ht){const bt=H/ht;let Nt;return bt<10?Nt=bt.toFixed(2):bt<100?Nt=bt.toFixed(1):Nt=Math.floor(bt).toString(),Nt=Nt.replace(/\.00$/,"").replace(/(\.\d)0$/,"$1"),Nt+St}}return H.toFixed(2)},v=Ln(()=>{const{faction:H,specialty:K}=o.value;let X={primaryBg:"bg-white",primaryText:"text-black",headerBg:"bg-gray-800",headerText:"text-white",accentBorder:"border-gray-400",sidebarBg:"bg-gray-100",activeMenuBg:"bg-blue-600",activeMenuText:"text-white",shadowColor:"shadow-gray-500/30",buttonBg:"bg-blue-600",buttonText:"text-white",buttonHover:"hover:bg-blue-700",buttonSecondaryBg:"bg-gray-500",buttonSecondaryText:"text-white",buttonSecondaryHover:"hover:bg-gray-600",buttonUrgentBg:"bg-red-600",buttonUrgentText:"text-white",buttonUrgentHover:"hover:bg-red-700"};return H==="Lumen"?K==="Alchemist"?X={primaryBg:"bg-white",primaryText:"text-[#7d6b5b]",headerBg:"bg-[#13c2eb]",headerText:"text-white",accentBorder:"border-[#bd895b]",sidebarBg:"bg-gray-50",activeMenuBg:"bg-[#fc963a]",activeMenuText:"text-white",shadowColor:"shadow-[#13c2eb]/30",buttonBg:"bg-[#fc963a]",buttonText:"text-white",buttonHover:"hover:bg-[#e0862a]",buttonSecondaryBg:"bg-[#7d6b5b]",buttonSecondaryText:"text-white",buttonSecondaryHover:"hover:bg-[#6b5a4a]",buttonUrgentBg:"bg-red-600",buttonUrgentText:"text-white",buttonUrgentHover:"hover:bg-red-700"}:K==="Arcane"&&(X={primaryBg:"bg-white",primaryText:"text-[#5b6c7d]",headerBg:"bg-[#eea221]",headerText:"text-white",accentBorder:"border-[#a78d5e]",sidebarBg:"bg-gray-50",activeMenuBg:"bg-[#3a98fc]",activeMenuText:"text-white",shadowColor:"shadow-[#3a98fc]/30",buttonBg:"bg-[#3a98fc]",buttonText:"text-white",buttonHover:"hover:bg-[#3386DF]",buttonSecondaryBg:"bg-[#5b8abd]",buttonSecondaryText:"text-white",buttonSecondaryHover:"hover:bg-[#4a77a8]",buttonUrgentBg:"bg-red-600",buttonUrgentText:"text-white",buttonUrgentHover:"hover:bg-red-700"}):H==="Umbra"&&(K==="Alchemist"?X={primaryBg:"bg-[#332c30]",primaryText:"text-gray-200",headerBg:"bg-[#55cd4a]",headerText:"text-black",accentBorder:"border-[#704460]",sidebarBg:"bg-[#4a3d44]",activeMenuBg:"bg-[#b03f85]",activeMenuText:"text-white",shadowColor:"shadow-[#b03f85]/30",buttonBg:"bg-[#b03f85]",buttonText:"text-white",buttonHover:"hover:bg-[#93356F]",buttonSecondaryBg:"bg-[#704460]",buttonSecondaryText:"text-white",buttonSecondaryHover:"hover:bg-[#5f3951]",buttonUrgentBg:"bg-red-500",buttonUrgentText:"text-white",buttonUrgentHover:"hover:bg-red-600"}:K==="Arcane"&&(X={primaryBg:"bg-[#2a3b29]",primaryText:"text-gray-100",headerBg:"bg-[#611462]",headerText:"text-[#82fc3a]",accentBorder:"border-[#a65ea6]",sidebarBg:"bg-[#4d5c4c]",activeMenuBg:"bg-[#82fc3a]",activeMenuText:"text-black",shadowColor:"shadow-[#82fc3a]/30",buttonBg:"bg-[#82fc3a]",buttonText:"text-black",buttonHover:"hover:bg-[#73e334]",buttonSecondaryBg:"bg-[#687d5b]",buttonSecondaryText:"text-white",buttonSecondaryHover:"hover:bg-[#56684a]",buttonUrgentBg:"bg-red-500",buttonUrgentText:"text-white",buttonUrgentHover:"hover:bg-red-600"})),X}),A=Ln(()=>1+o.value.prestige*.1),C=H=>{const{faction:K,specialty:X}=o.value;let ht=["Novice Whispers","Apprentice Glyphs","Adept's Tomes","Mystic Runes","Etheric Weavings","Celestial Charts","Planar Bindings","Chronomancer's Texts","Abjurer's Wards","Transmuter's Circles","Grandmaster's Codex","Archmage's Grimoire","Aetheric Formulas","Cosmic Inscriptions","Reality Equations","Void Manuscripts","Primordial Truths","Ascendant Doctrines","God-Hand Schematics","Nexus of All Knowledge"];return K==="Lumen"?X==="Arcane"?ht=["Solar Inscriptions","Starfire Studies","Aetheric Lumina","Ascendant Cantrips","Chalice of Radiance","Empyrean Scrolls","Divine Geometry","Sunsong Orbs","Sanctified Wards","Radiant Transcriptions","The Holy Codex","High Archon's Primer","Light-Form Formulas","Cosmic Alignment","Edicts of Truth","Ethereal Scripts","Primal Genesis","Edicts of the Source","Schema of Creation","Heart of the Cosmos"]:X==="Alchemist"&&(ht=["Bright Concoctions","Verdant Formulas","Golden Retorts","Elixirs of Life","Vials of Purity","Reagent Catalysts","Alchemical Transmutations","Crystals of Growth","Stable Solutions","The Great Work","Philosopher's Stone","Magnum Opus","Homunculus Formulas","Symphony of Elements","Apothecary's Vault","True Essences","Materia Prima","The Unbreakable Bond","Perfect Synthesis","Wellspring of Vitality"]):K==="Umbra"&&(X==="Arcane"?ht=["Shadowed Whispers","Nocturnal Glyphs","Voidweaver Texts","Ebon Incantations","Sepulchral Weavings","Forbidden Scrolls","The Black Geometry","Moonshard Orbs","Cursed Wards","Malefic Transcriptions","The Shadow Codex","Necromancer's Grimoire","Dark Matter Formulas","Cosmic Discord","Equations of Decay","Void Manuscripts","Primal Entropy","Doctrines of the End","Schema of Annihilation","Heart of the Void"]:X==="Alchemist"&&(ht=["Crimson Brews","Corrupted Essences","Blackened Crucibles","Tinctures of Dread","Sanguine Phials","Venomous Catalysts","Vile Transmutations","Crystals of Stasis","Unstable Solutions","The Lesser Work","Blood Stone","Abyss Opus","Gargoyle Formulas","Dissonant Elements","Poisoner's Vault","Dark Essences","Materia Tenebrae","The Broken Bond","Failed Synthesis","Wellspring of Pestilence"])),ht[H]||`Esoteric Tier ${H+1}`},O=()=>{const{faction:H,specialty:K}=o.value;let X=["Conduits","Scrolls","Crystals","Orbs"];return H==="Lumen"?K==="Arcane"?X=["Light Channels","Sunstone Tablets","Prismatic Focus","Aether Orbs"]:K==="Alchemist"&&(X=["Flow Regulators","Reagent Formulas","Growth Crystals","Stabilizing Orbs"]):H==="Umbra"&&(K==="Arcane"?X=["Shadow Conduits","Ebon Runes","Void Shards","Lunar Orbs"]:K==="Alchemist"&&(X=["Corrupting Vents","Necrotic Pages","Binding Agents","Decay Orbs"])),X},k=()=>{const H=[],K=O(),X=A.value;for(let ht=0;ht<20;ht++){const St=Math.pow(1.8,ht),bt=Math.pow(8,ht),Nt=20+ht*20;H.push({name:`Tier ${ht+1}: ${C(ht)}`,unlocked:ht===0,multipliers:K.map((be,oe)=>({level:0,maxLevel:Nt,baseCost:(10+oe*40)*bt,costMultiplier:1.09+ht*.01,baseEffect:(.1+oe*.4)*St*X,effectMultiplier:1.1+ht*.005,name:be}))})}return H},D=Ln(()=>{let H=0;return a.value.forEach(K=>{K.unlocked&&K.multipliers.forEach(X=>{X.level>0&&(H+=X.baseEffect*Math.pow(X.effectMultiplier,X.level-1))})}),H}),N=()=>{i.value+=D.value||1},w=(H,K)=>{const X=a.value[H]?.multipliers[K];return X?X.baseCost/A.value*Math.pow(X.costMultiplier,X.level):1/0},y=({tierIndex:H,multiplierIndex:K})=>{const X=a.value[H],ht=X?.multipliers[K];if(!ht||ht.level>=ht.maxLevel)return;const St=w(H,K);i.value>=St&&(i.value-=St,ht.level+=1,ht.level===ht.maxLevel&&X.multipliers.every(Nt=>Nt.level===Nt.maxLevel)&&a.value[H+1]&&(a.value[H+1].unlocked=!0),I())},x=()=>{o.value.prestige+=1,o.value.prestige>0&&o.value.prestige%10===0&&(d.value+=1),i.value=0,r.value=0,h.value=0,a.value=k(),I()},E=()=>{const H=a.value[h.value],K=a.value[h.value+1];!H||!H.multipliers.every(X=>X.level===X.maxLevel)||(K?a.value[h.value+1].unlocked&&(h.value+=1,I()):x())},I=async()=>{if(c.value=!0,!f.currentUser||!e.characterId)return;const H=f.currentUser.uid,K=ln(g,`artifacts/${_}/users/${H}/characters`,e.characterId),X=ln(g,`artifacts/${_}/public/data/leaderboard`,e.characterId),ht={knowledge:i.value,prestige:o.value.prestige,currentTierIndex:h.value,multiplierTiers:a.value.map(bt=>({unlocked:bt.unlocked,levels:bt.multipliers.map(Nt=>Nt.level)})),skillPoints:d.value,lastSaved:qt.now()},St={name:o.value.name,prestige:o.value.prestige,faction:o.value.faction,specialty:o.value.specialty,location:o.value.location,userId:H,currentTierIndex:h.value,lastUpdated:qt.now()};try{await sa(K,ht,{merge:!0}),await sa(X,St,{merge:!0})}catch(bt){console.error("Error saving game progress:",bt)}finally{c.value=!1}},P=async()=>{if(!f.currentUser||!e.characterId)return;const H=ln(g,`artifacts/${_}/users/${f.currentUser.uid}/characters`,e.characterId);try{const K=await au(H);if(K.exists()){const X=K.data();o.value.name=X.name||"Scholar",o.value.faction=X.faction||"",o.value.specialty=X.specialty||"",o.value.prestige=X.prestige||0,o.value.location=X.location||"",d.value=X.skillPoints||0,h.value=X.currentTierIndex||0;const ht=k();X.multiplierTiers&&X.multiplierTiers.forEach((bt,Nt)=>{ht[Nt]&&(ht[Nt].unlocked=bt.unlocked,bt.levels.forEach((be,oe)=>{ht[Nt].multipliers[oe]&&(ht[Nt].multipliers[oe].level=be)}))}),a.value=ht;const St=X.knowledge||0;if(X.lastSaved&&D.value>0){const bt=(new Date().getTime()-X.lastSaved.toDate().getTime())/1e3;i.value=bt>0?St+bt*D.value:St}else i.value=St;r.value=i.value}else a.value=k(),i.value=0,r.value=0,h.value=0,d.value=0}catch(K){console.error("Error loading game progress:",K),a.value=k()}};let S=null;Po(i,H=>{S&&cancelAnimationFrame(S);const K=()=>{const X=H-r.value,ht=X/20;Math.abs(X)<.01?(r.value=H,S=null):(r.value+=ht,S=requestAnimationFrame(K))};K()});const rt=async()=>{await I(),await f.signOut()},it=async()=>{await I(),s("returnToCharacterSelect")};let dt=null;kr(()=>{P(),dt=setInterval(()=>{D.value>0&&(i.value+=D.value)},1e3)}),Oc(async()=>{dt&&clearInterval(dt),S&&cancelAnimationFrame(S),await I()});const ot=[{id:"sanctum",name:"Sanctum / Home",icon:""},{id:"research",name:"Research",icon:""},{id:"expeditions",name:"Expeditions",icon:""},{id:"inventory",name:"Inventory",icon:""},{id:"skill-tree",name:"Skill Tree",icon:""},{id:"classification",name:"Classification",icon:""}];return(H,K)=>(st(),lt("div",{class:q([v.value.primaryBg,v.value.primaryText,"flex flex-col h-screen w-full font-sans overflow-hidden"])},[M("header",{class:q([v.value.headerBg,v.value.headerText,"shadow-lg border-b",v.value.accentBorder,v.value.shadowColor,"flex flex-nowrap items-center justify-between p-2 z-20"])},[M("h1",{class:"text-xl lg:text-3xl font-serif tracking-wide text-left truncate flex items-center space-x-2 flex-shrink min-w-0",title:`The Arcane Scholars Legacy || ${o.value.name}`},[M("span",nM,[K[0]||(K[0]=M("img",{src:gc,alt:"The Arcane Scholar's Legacy",class:"h-8 w-8"},null,-1)),M("span",sM,pt(o.value.name),1)]),M("span",iM,[K[1]||(K[1]=M("img",{src:gc,alt:"The Arcane Scholar's Legacy",class:"h-10 w-10"},null,-1)),M("span",rM,"The Arcane Scholars Legacy || "+pt(o.value.name),1)])],8,eM),M("div",oM,[M("div",aM,[M("span",lM,[K[2]||(K[2]=M("span",{class:"text-lg lg:text-xl"},"",-1)),M("span",cM,pt(o.value.prestige),1),K[3]||(K[3]=M("span",{class:"hidden lg:inline text-sm lg:text-lg ml-1"},"Prestige",-1))]),M("span",uM,[K[4]||(K[4]=M("span",{class:"text-lg lg:text-xl"},"",-1)),M("span",hM,pt(d.value),1),K[5]||(K[5]=M("span",{class:"hidden lg:inline text-sm lg:text-lg ml-1"},"Skill Points",-1))]),M("span",dM,[K[6]||(K[6]=M("span",{class:"text-lg lg:text-xl"},"",-1)),M("span",fM,pt(b(r.value)),1),K[7]||(K[7]=M("span",{class:"hidden lg:inline text-sm lg:text-lg ml-1"},"Knowledge",-1))])]),M("div",pM,[M("button",{onClick:I,disabled:c.value,class:q([v.value.buttonBg,v.value.buttonText,v.value.buttonHover,"font-bold p-2 lg:py-2 lg:px-4 text-sm lg:text-base rounded-md lg:rounded-lg shadow-md transition duration-300 ease-in-out flex items-center justify-center",c.value?"opacity-50 cursor-not-allowed":""]),title:"Save Game"},[K[8]||(K[8]=M("span",{class:"text-xl lg:text-base"},"",-1)),M("span",mM,pt(c.value?"Saving...":"Save"),1)],10,gM),M("button",{onClick:it,class:q([v.value.buttonSecondaryBg,v.value.buttonSecondaryText,v.value.buttonSecondaryHover,"font-bold p-2 lg:py-2 lg:px-4 text-sm lg:text-base rounded-md lg:rounded-lg shadow-md transition duration-300 ease-in-out flex items-center justify-center"]),title:"Back to Select"},K[9]||(K[9]=[M("span",{class:"text-xl lg:text-base"},"",-1),M("span",{class:"hidden lg:inline ml-2"},"Back",-1)]),2),M("button",{onClick:rt,class:q([v.value.buttonUrgentBg,v.value.buttonUrgentText,v.value.buttonUrgentHover,"font-bold p-2 lg:py-2 lg:px-4 text-sm lg:text-base rounded-md lg:rounded-lg shadow-md transition duration-300 ease-in-out flex items-center justify-center"]),title:"Log Out"},K[10]||(K[10]=[M("span",{class:"text-xl lg:text-base"},"",-1),M("span",{class:"hidden lg:inline ml-2"},"Log Out",-1)]),2)])])],2),M("main",{class:q(["flex-1 p-6 overflow-y-auto custom-scrollbar pb-24 lg:pb-6",v.value.primaryBg])},[l.value==="sanctum"?(st(),vn(RD,{key:0,knowledge:i.value,multiplierTiers:a.value,passiveKnowledgeGain:D.value,characterDetails:o.value,"theme-classes":v.value,currentTierIndex:h.value,onGenerateKnowledge:N,onBuyMultiplier:y,onAdvanceTier:E},null,8,["knowledge","multiplierTiers","passiveKnowledgeGain","characterDetails","theme-classes","currentTierIndex"])):l.value==="research"?(st(),vn(DD,{key:1,"theme-classes":v.value},null,8,["theme-classes"])):l.value==="expeditions"?(st(),vn(OD,{key:2,"theme-classes":v.value},null,8,["theme-classes"])):l.value==="inventory"?(st(),vn(VD,{key:3,"theme-classes":v.value},null,8,["theme-classes"])):l.value==="skill-tree"?(st(),vn(FD,{key:4,"theme-classes":v.value},null,8,["theme-classes"])):l.value==="classification"?(st(),vn(tM,{key:5,class:q([v.value.primaryBg,"h-full"]),"theme-classes":v.value},null,8,["class","theme-classes"])):fe("",!0)],2),M("nav",{class:q([v.value.headerBg,v.value.accentBorder,"fixed bottom-0 left-0 right-0 lg:left-1/2 lg:-translate-x-1/2 lg:right-auto lg:bottom-4","flex items-center justify-around lg:justify-center","p-1 lg:p-3","space-x-0 lg:space-x-2","lg:rounded-full shadow-2xl border z-50"])},[(st(),lt(Qe,null,Wo(ot,X=>M("button",{key:X.id,onClick:ht=>l.value=X.id,class:q(["relative group rounded-full transition-all duration-200 ease-in-out","transform hover:scale-110","w-14 h-14 flex items-center justify-center lg:w-auto lg:h-auto lg:p-3",l.value===X.id?[v.value.activeMenuBg,v.value.activeMenuText,"scale-110 shadow-inner"]:[v.value.headerText,"opacity-70 hover:opacity-100"]]),title:X.name},[M("span",yM,pt(X.icon),1),M("span",{class:q([v.value.sidebarBg,v.value.primaryText,"absolute bottom-full mb-2 left-1/2 -translate-x-1/2","px-3 py-1 rounded-md text-sm font-medium shadow-lg","transition-all duration-150 scale-0 group-hover:scale-100 origin-bottom"])},pt(X.name),3)],10,_M)),64))],2)],2))}},vM=Kn(bM,[["__scopeId","data-v-f229b127"]]),wM={id:"app"},xM={key:0,class:"flex items-center justify-center h-screen w-full bg-gray-950 text-yellow-300 text-3xl font-serif"},TM={key:1,class:"flex flex-col items-center justify-center h-screen w-full bg-white text-gray-800 p-8"},EM={key:0,class:"mt-6 text-red-600 bg-red-100 p-3 rounded-md"},IM={key:2},SM={__name:"App",setup(n){const t=Wi();Ur();const e=At(null),s=At(!1),i=At(null),r=At("loading"),o=At(null);kr(()=>{mv(t,f=>{e.value=f,s.value=!0,console.log("App.vue: Auth state changed. User:",f?f.uid:"None"),console.log("App.vue: Is app ready?",s.value),f&&console.log("App.vue: Is user anonymous?",f.isAnonymous)})}),Po([e,s,i],([f,g,_])=>{g&&(f?f.isAnonymous?r.value="accountUpgrade":_?r.value="game":r.value="characterSelection":r.value="login")});const a=async()=>{if(o.value=null,!t.currentUser||!t.currentUser.isAnonymous){o.value="No anonymous account found to link.";return}try{const f=new On,g=await aC(t.currentUser,f);console.log("Account linked successfully!",g.user)}catch(f){console.error("Error linking account:",f),f.code==="auth/credential-already-in-use"?o.value="This Google account is already linked to another scholar. Please use a different Google account.":o.value=`Failed to link account: ${f.message}`}},l=f=>{i.value=f,r.value="game",console.log("App.vue: Character selected with ID:",f)},c=()=>{r.value="characterCreation",console.log("App.vue: Starting new character creation. `currentView` is now:",r.value)},h=f=>{i.value=f,r.value="game",console.log("App.vue: New character created with ID:",f)},d=()=>{i.value=null,r.value="characterSelection",console.log("App.vue: Returning to character selection.")};return(f,g)=>(st(),lt("div",wM,[s.value?r.value==="accountUpgrade"?(st(),lt("div",TM,[g[1]||(g[1]=M("h2",{class:"text-3xl font-serif text-black mb-4"},"Account Update Required",-1)),g[2]||(g[2]=M("p",{class:"text-lg text-gray-700 mb-8 max-w-lg text-center"}," To protect your progress, please link your anonymous account to a Google account. This is a one-time process. ",-1)),M("button",{onClick:a,class:"bg-black hover:bg-gray-800 text-white font-bold py-3 px-6 rounded-lg shadow-md transition duration-300 ease-in-out flex items-center justify-center text-lg"},g[0]||(g[0]=[M("img",{src:"https://www.google.com/favicon.ico",alt:"Google Logo",class:"h-7 w-7 mr-3"},null,-1),bn(" Link with Google ",-1)])),o.value?(st(),lt("p",EM,pt(o.value),1)):fe("",!0)])):(st(),lt("div",IM,[r.value==="login"?(st(),vn(_k,{key:0})):r.value==="characterSelection"?(st(),vn(iD,{key:`selection-${e.value.uid}`,onCharacterSelected:l,onStartNewCharacterCreation:c})):r.value==="characterCreation"?(st(),vn(Bk,{key:`creation-${e.value.uid}`,onCharacterCreated:h,onReturnToSelect:d})):r.value==="game"?(st(),vn(vM,{key:`game-${i.value}`,userId:e.value.uid,characterId:i.value,onReturnToCharacterSelect:d},null,8,["userId","characterId"])):fe("",!0)])):(st(),lt("div",xM," Loading... "))]))}};/*!
 * Chartkick.js v5.0.1
 * Create beautiful charts with one line of JavaScript
 * https://github.com/ankane/chartkick.js
 * MIT License
 */function Qs(n){return Object.prototype.toString.call(n)==="[object Array]"}function kf(n){return n instanceof Function}function Ml(n){return Object.prototype.toString.call(n)==="[object Object]"&&!kf(n)&&n instanceof Object}function sd(n,t){for(var e in t)e!=="__proto__"&&(Ml(t[e])||Qs(t[e])?(Ml(t[e])&&!Ml(n[e])&&(n[e]={}),Qs(t[e])&&!Qs(n[e])&&(n[e]=[]),sd(n[e],t[e])):t[e]!==void 0&&(n[e]=t[e]))}function ee(n,t){var e={};return sd(e,n),sd(e,t),e}var AM=/^(\d\d\d\d)(?:-)?(\d\d)(?:-)?(\d\d)$/i;function CM(n){for(var t=0;t<n.length;t++)for(var e=n[t].data,s=0;s<e.length;s++)if(e[s][1]<0)return!0;return!1}function vs(n){return""+n}function zn(n){return parseFloat(n)}function Mn(n){if(n instanceof Date)return n;if(typeof n=="number")return new Date(n*1e3);var t=vs(n),e=t.match(AM);if(e){var s=parseInt(e[1],10),i=parseInt(e[2],10)-1,r=parseInt(e[3],10);return new Date(s,i,r)}else{var o=t.replace(/ /,"T").replace(" ","").replace("UTC","Z");return new Date(Date.parse(o)||t)}}function Df(n){if(Qs(n))return n;var t=[];for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&t.push([e,n[e]]);return t}function Ca(n,t,e,s,i,r,o,a){return function(l,c,h){var d=l.data,f=ee({},n);return f=ee(f,h||{}),(l.singleSeriesFormat||"legend"in c)&&t(f,c.legend,l.singleSeriesFormat),c.title&&e(f,c.title),"min"in c?s(f,c.min):CM(d)||s(f,0),c.max&&i(f,c.max),"stacked"in c&&r(f,c.stacked),c.colors&&(f.colors=c.colors),c.xtitle&&o(f,c.xtitle),c.ytitle&&a(f,c.ytitle),f=ee(f,c.library||{}),f}}function PM(n,t){return n[0].getTime()-t[0].getTime()}function Mf(n,t){return n[0]-t[0]}function ow(n,t){return n-t}function er(n,t){for(var e=0;e<n.length;e++)if(!t(n[e]))return!1;return!0}function RM(n){return n==="day"||n==="week"||n==="month"||n==="year"}function aw(n,t){if(t===void 0&&(t=!1),n.length===0)return null;var e=er(n,function(c){return c.getMilliseconds()===0&&c.getSeconds()===0});if(!e)return null;var s=er(n,function(c){return c.getMinutes()===0});if(!s)return"minute";var i=er(n,function(c){return c.getHours()===0});if(!i)return"hour";if(t)return"day";var r=er(n,function(c){return c.getDate()===1});if(!r){var o=n[0].getDay(),a=er(n,function(c){return c.getDay()===o});return a?"week":"day"}var l=er(n,function(c){return c.getMonth()===0});return l?"year":"month"}function nh(n){return!isNaN(Mn(n))&&vs(n).length>=6}function kM(n){return typeof n=="number"}var r_=["bytes","KB","MB","GB","TB","PB","EB"];function yn(n,t,e,s){n=n||"",e.prefix&&(t<0&&(t=t*-1,n+="-"),n+=e.prefix);var i=e.suffix||"",r=e.precision,o=e.round;if(e.byteScale){var a=t>=0;a||(t*=-1);var l=s?e.byteScale:t,c;l>=1152921504606847e3?(t/=1152921504606847e3,c=6):l>=0x4000000000000?(t/=0x4000000000000,c=5):l>=1099511627776?(t/=1099511627776,c=4):l>=1073741824?(t/=1073741824,c=3):l>=1048576?(t/=1048576,c=2):l>=1024?(t/=1024,c=1):c=0,r===void 0&&o===void 0&&(t>=1023.5&&c<r_.length-1&&(t=1,c+=1),r=t>=1e3?4:3),i=" "+r_[c],a||(t*=-1)}if(r!==void 0&&o!==void 0)throw Error("Use either round or precision, not both");if(!s&&(r!==void 0&&(t=t.toPrecision(r),e.zeros||(t=parseFloat(t))),o!==void 0))if(o<0){var h=Math.pow(10,-1*o);t=parseInt((1*t/h).toFixed(0))*h}else t=t.toFixed(o),e.zeros||(t=parseFloat(t));if(e.thousands||e.decimal){t=vs(t);var d=t.split(".");t=d[0],e.thousands&&(t=t.replace(/\B(?=(\d{3})+(?!\d))/g,e.thousands)),d.length>1&&(t+=(e.decimal||".")+d[1])}return n+t+i}function o_(n,t,e){return e in t?t[e]:e in n.options?n.options[e]:null}var Of={maintainAspectRatio:!1,animation:!1,plugins:{legend:{},tooltip:{displayColors:!1,callbacks:{}},title:{font:{size:20},color:"#333"}},interaction:{}},lw={scales:{y:{ticks:{maxTicksLimit:4},title:{font:{size:16},color:"#333"},grid:{}},x:{grid:{drawOnChartArea:!1},title:{font:{size:16},color:"#333"},time:{},ticks:{}}}},cw=["#3366CC","#DC3912","#FF9900","#109618","#990099","#3B3EAC","#0099C6","#DD4477","#66AA00","#B82E2E","#316395","#994499","#22AA99","#AAAA11","#6633CC","#E67300","#8B0707","#329262","#5574A6","#651067"];function Lf(n,t,e){t!==void 0?(n.plugins.legend.display=!!t,t&&t!==!0&&(n.plugins.legend.position=t)):e&&(n.plugins.legend.display=!1)}function Vf(n,t){n.plugins.title.display=!0,n.plugins.title.text=t}function DM(n,t){t!==null&&(n.scales.y.min=zn(t))}function MM(n,t){n.scales.y.max=zn(t)}function OM(n,t){t!==null&&(n.scales.x.min=zn(t))}function LM(n,t){n.scales.x.max=zn(t)}function uw(n,t){n.scales.x.stacked=!!t,n.scales.y.stacked=!!t}function hw(n,t){n.scales.x.title.display=!0,n.scales.x.title.text=t}function dw(n,t){n.scales.y.title.display=!0,n.scales.y.title.text=t}function a_(n,t){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n);return e?"rgba("+parseInt(e[1],16)+", "+parseInt(e[2],16)+", "+parseInt(e[3],16)+", "+t+")":n}function Rs(n){return n!=null}function VM(n,t,e){var s=Math.ceil(n.element.offsetWidth/4/t.labels.length);s>25?s=25:s<10&&(s=10),e.scales.x.ticks.callback||(e.scales.x.ticks.callback=function(i){return i=vs(this.getLabelForValue(i)),i.length>s?i.substring(0,s-2)+"...":i})}function NM(n){for(var t=1,e=FM(n);e>=1024;)t*=1024,e/=1024;return t}function cu(n,t,e){var s={thousands:n.options.thousands,decimal:n.options.decimal},i=ee({prefix:n.options.prefix,suffix:n.options.suffix,precision:n.options.precision,round:n.options.round,zeros:n.options.zeros},s);if(n.options.bytes){var r=n.data;e==="pie"&&(r=[{data:r}]),i.byteScale=NM(r)}if(e!=="pie"){var o=t.scales.y;e==="bar"&&(o=t.scales.x),i.byteScale&&(o.ticks.stepSize||(o.ticks.stepSize=i.byteScale/2),o.ticks.maxTicksLimit||(o.ticks.maxTicksLimit=4)),o.ticks.callback||(o.ticks.callback=function(l){return yn("",l,i,!0)}),(e==="scatter"||e==="bubble")&&!t.scales.x.ticks.callback&&(t.scales.x.ticks.callback=function(l){return yn("",l,s,!0)})}if(!t.plugins.tooltip.callbacks.label)if(e==="scatter")t.plugins.tooltip.callbacks.label=function(l){var c=l.dataset.label||"";c&&(c+=": ");var h=l.parsed;return c+"("+yn("",h.x,s)+", "+yn("",h.y,i)+")"};else if(e==="bubble")t.plugins.tooltip.callbacks.label=function(l){var c=l.dataset.label||"";c&&(c+=": ");var h=l.raw;return c+"("+yn("",h.x,s)+", "+yn("",h.y,i)+", "+yn("",h.v,s)+")"};else if(e==="pie")t.plugins.tooltip.callbacks.label=function(l){return yn("",l.parsed,i)};else{var a=e==="bar"?"x":"y";t.plugins.tooltip.callbacks.label=function(l){if(l.parsed[a]!==null){var c=l.dataset.label||"";return c&&(c+=": "),yn(c,l.parsed[a],i)}}}(e==="line"||e==="area")&&n.xtype==="number"&&(t.scales.x.ticks.callback||(t.scales.x.ticks.callback=function(l){return vs(l)}),t.plugins.tooltip.callbacks.title||(t.plugins.tooltip.callbacks.title=function(l){return vs(l[0].parsed.x)}))}function FM(n){for(var t=0,e=0;e<n.length;e++)for(var s=n[e].data,i=0;i<s.length;i++){var r=Math.abs(s[i][1]);r>t&&(t=r)}return t}function BM(n){for(var t=0,e=0;e<n.length;e++)for(var s=n[e].data,i=0;i<s.length;i++){var r=s[i][2];r>t&&(t=r)}return t}var Nf=Ca(ee(Of,lw),Lf,Vf,DM,MM,uw,hw,dw);function UM(n){for(var t=n.data,e={},s=[],i=[],r=[],o=0;o<t.length;o++)for(var a=t[o].data,l=0;l<a.length;l++){var c=a[l],h=n.xtype==="datetime"?c[0].getTime():c[0];e[h]||(e[h]=new Array(t.length),s.push(h)),e[h][o]=c[1]}(n.xtype==="datetime"||n.xtype==="number")&&s.sort(ow);for(var d=0;d<t.length;d++)r.push([]);for(var f=0;f<s.length;f++){var g=s[f],_=n.xtype==="datetime"?new Date(g):g;i.push(_);for(var b=e[g],v=0;v<t.length;v++){var A=b[v];r[v].push(A===void 0?null:A)}}return{labels:i,values:r}}function $M(n){for(var t=n.data,e=[],s=BM(t),i=0;i<t.length;i++){for(var r=t[i].data,o=[],a=0;a<r.length;a++){var l=r[a];o.push({x:l[0],y:l[1],r:l[2]*20/s,v:l[2]})}e.push(o)}return{labels:[],values:e}}function zM(n){for(var t=n.data,e=[],s=0;s<t.length;s++){var i=t[s].data;i.sort(Mf);for(var r=[],o=0;o<i.length;o++){var a=i[o];r.push({x:a[0],y:a[1]})}e.push(r)}return{labels:[],values:e}}function jM(n,t){return t==="bubble"?$M(n):n.xtype==="number"&&t!=="bar"&&t!=="column"?zM(n):UM(n)}function Ff(n,t,e){for(var s=jM(n,e),i=s.labels,r=s.values,o=n.data,a=[],l=n.options.colors||cw,c=0;c<o.length;c++){var h=o[c],d=void 0,f=void 0;if(n.options.colors&&n.singleSeriesFormat&&(e==="bar"||e==="column")&&!h.color&&Qs(n.options.colors)&&!Qs(n.options.colors[0])){d=l,f=[];for(var g=0;g<l.length;g++)f[g]=a_(d[g],.5)}else d=h.color||l[c],f=e!=="line"?a_(d,.5):d;var _={label:h.name||"",data:r[c],fill:e==="area",borderColor:d,backgroundColor:f,borderWidth:2},b=e==="line"||e==="area"||e==="scatter"||e==="bubble";b&&(_.pointBackgroundColor=d,_.pointHoverBackgroundColor=d,_.pointHitRadius=50),e==="bubble"&&(_.pointBackgroundColor=f,_.pointHoverBackgroundColor=f,_.pointHoverBorderWidth=2),h.stack&&(_.stack=h.stack);var v=o_(n,h,"curve");v===!1?_.tension=0:b&&(_.tension=.4);var A=o_(n,h,"points");A===!1&&(_.pointRadius=0,_.pointHoverRadius=0),_=ee(_,n.options.dataset||{}),_=ee(_,h.library||{}),_=ee(_,h.dataset||{}),a.push(_)}var C=n.options.xmin,O=n.options.xmax;if(n.xtype==="datetime"?(Rs(C)&&(t.scales.x.min=Mn(C).getTime()),Rs(O)&&(t.scales.x.max=Mn(O).getTime())):n.xtype==="number"&&(Rs(C)&&(t.scales.x.min=C),Rs(O)&&(t.scales.x.max=O)),n.xtype==="datetime"){var k=aw(i);if(i.length===0&&(Rs(C)&&i.push(Mn(C)),Rs(O)&&i.push(Mn(O))),i.length>0){for(var D=(Rs(C)?Mn(C):i[0]).getTime(),N=(Rs(O)?Mn(O):i[0]).getTime(),w=1;w<i.length;w++){var y=i[w].getTime();y<D&&(D=y),y>N&&(N=y)}var x=(N-D)/(86400*1e3);if(!t.scales.x.time.unit){var E;if(k==="year"||x>365*10?(t.scales.x.time.unit="year",E=365):k==="month"||x>300?(t.scales.x.time.unit="month",E=30):k==="week"||k==="day"||x>10?(t.scales.x.time.unit="day",E=1):k==="hour"||x>.5?(t.scales.x.time.displayFormats={hour:"MMM d, h a"},t.scales.x.time.unit="hour",E=1/24):k==="minute"&&(t.scales.x.time.displayFormats={minute:"h:mm a"},t.scales.x.time.unit="minute",E=1/24/60),E&&x>0){var I=n.element.offsetWidth;if(I>0){var P=Math.ceil(x/E/(I/100));k==="week"&&E===1&&(P=Math.ceil(P/7)*7),t.scales.x.ticks.stepSize=P}}}t.scales.x.time.tooltipFormat||(k==="year"?t.scales.x.time.tooltipFormat="yyyy":k==="month"?t.scales.x.time.tooltipFormat="MMM yyyy":k==="week"||k==="day"?t.scales.x.time.tooltipFormat="PP":k==="hour"?t.scales.x.time.tooltipFormat="MMM d, h a":k==="minute"&&(t.scales.x.time.tooltipFormat="h:mm a"))}}return{labels:i,datasets:a}}var Yn=function(t){this.name="chartjs",this.library=t};Yn.prototype.renderLineChart=function(t,e){e||(e="line");var s={},i=Nf(t,ee(s,t.options));cu(t,i,e);var r=Ff(t,i,e);t.xtype==="number"?(i.scales.x.type=i.scales.x.type||"linear",i.scales.x.position=i.scales.x.position||"bottom"):i.scales.x.type=t.xtype==="string"?"category":"time",this.drawChart(t,"line",r,i)};Yn.prototype.renderPieChart=function(t){var e=ee({},Of);t.options.donut&&(e.cutout="50%"),"legend"in t.options&&Lf(e,t.options.legend),t.options.title&&Vf(e,t.options.title),e=ee(e,t.options.library||{}),cu(t,e,"pie");for(var s=[],i=[],r=0;r<t.data.length;r++){var o=t.data[r];s.push(o[0]),i.push(o[1])}var a={data:i,backgroundColor:t.options.colors||cw};a=ee(a,t.options.dataset||{});var l={labels:s,datasets:[a]};this.drawChart(t,"pie",l,e)};Yn.prototype.renderColumnChart=function(t,e){var s;if(e==="bar"){var i=ee(Of,lw);i.indexAxis="y",i.scales.x.grid.drawOnChartArea=!0,i.scales.y.grid.drawOnChartArea=!1,delete i.scales.y.ticks.maxTicksLimit,s=Ca(i,Lf,Vf,OM,LM,uw,hw,dw)(t,t.options)}else s=Nf(t,t.options);cu(t,s,e);var r=Ff(t,s,"column");e!=="bar"&&VM(t,r,s),"mode"in s.interaction||(s.interaction.mode="index"),this.drawChart(t,"bar",r,s)};Yn.prototype.renderAreaChart=function(t){this.renderLineChart(t,"area")};Yn.prototype.renderBarChart=function(t){this.renderColumnChart(t,"bar")};Yn.prototype.renderScatterChart=function(t,e){e=e||"scatter";var s=Nf(t,t.options);cu(t,s,e),"showLine"in s||(s.showLine=!1);var i=Ff(t,s,e);s.scales.x.type=s.scales.x.type||"linear",s.scales.x.position=s.scales.x.position||"bottom","mode"in s.interaction||(s.interaction.mode="nearest"),this.drawChart(t,e,i,s)};Yn.prototype.renderBubbleChart=function(t){this.renderScatterChart(t,"bubble")};Yn.prototype.destroy=function(t){t.chart&&t.chart.destroy()};Yn.prototype.drawChart=function(t,e,s,i){if(this.destroy(t),!t.destroyed){var r={type:e,data:s,options:i};t.options.code&&window.console.log("new Chart(ctx, "+JSON.stringify(r)+");"),t.element.innerHTML="<canvas></canvas>";var o=t.element.getElementsByTagName("CANVAS")[0];t.chart=new this.library(o,r)}};var fw={chart:{},xAxis:{title:{text:null},labels:{style:{fontSize:"12px"}}},yAxis:{title:{text:null},labels:{style:{fontSize:"12px"}}},title:{text:null},credits:{enabled:!1},legend:{borderWidth:0},tooltip:{style:{fontSize:"12px"}},plotOptions:{areaspline:{},area:{},series:{marker:{}}},time:{useUTC:!1}};function pw(n,t,e){t!==void 0?(n.legend.enabled=!!t,t&&t!==!0&&(t==="top"||t==="bottom"?n.legend.verticalAlign=t:(n.legend.layout="vertical",n.legend.verticalAlign="middle",n.legend.align=t))):e&&(n.legend.enabled=!1)}function gw(n,t){n.title.text=t}function HM(n,t){n.yAxis.min=t}function WM(n,t){n.yAxis.max=t}function qM(n,t){var e=t?t===!0?"normal":t:null;n.plotOptions.series.stacking=e,n.plotOptions.area.stacking=e,n.plotOptions.areaspline.stacking=e}function GM(n,t){n.xAxis.title.text=t}function KM(n,t){n.yAxis.title.text=t}var Bf=Ca(fw,pw,gw,HM,WM,qM,GM,KM);function Uf(n,t,e){var s={prefix:n.options.prefix,suffix:n.options.suffix,thousands:n.options.thousands,decimal:n.options.decimal,precision:n.options.precision,round:n.options.round,zeros:n.options.zeros};e!=="pie"&&!Qs(t.yAxis)&&!t.yAxis.labels.formatter&&(t.yAxis.labels.formatter=function(){return yn("",this.value,s)}),!t.tooltip.pointFormatter&&!t.tooltip.pointFormat&&(t.tooltip.pointFormatter=function(){return'<span style="color:'+this.color+'"></span> '+yn(this.series.name+": <b>",this.y,s)+"</b><br/>"})}var Ts=function(t){this.name="highcharts",this.library=t};Ts.prototype.renderLineChart=function(t,e){e=e||"spline";var s={};e==="areaspline"&&(s={plotOptions:{areaspline:{stacking:"normal"},area:{stacking:"normal"},series:{marker:{enabled:!1}}}}),t.options.curve===!1&&(e==="areaspline"?e="area":e==="spline"&&(e="line"));var i=Bf(t,t.options,s);t.xtype==="number"?i.xAxis.type=i.xAxis.type||"linear":i.xAxis.type=t.xtype==="string"?"category":"datetime",i.chart.type||(i.chart.type=e),Uf(t,i,e);for(var r=t.data,o=0;o<r.length;o++){r[o].name=r[o].name||"Value";var a=r[o].data;if(t.xtype==="datetime")for(var l=0;l<a.length;l++)a[l][0]=a[l][0].getTime();else t.xtype==="number"&&a.sort(Mf);r[o].marker={symbol:"circle"},t.options.points===!1&&(r[o].marker.enabled=!1)}this.drawChart(t,r,i)};Ts.prototype.renderScatterChart=function(t){var e=Bf(t,t.options,{});e.chart.type="scatter",this.drawChart(t,t.data,e)};Ts.prototype.renderPieChart=function(t){var e=ee(fw,{});t.options.colors&&(e.colors=t.options.colors),t.options.donut&&(e.plotOptions={pie:{innerSize:"50%"}}),"legend"in t.options&&pw(e,t.options.legend),t.options.title&&gw(e,t.options.title);var s=ee(e,t.options.library||{});Uf(t,s,"pie");var i=[{type:"pie",name:t.options.label||"Value",data:t.data}];this.drawChart(t,i,s)};Ts.prototype.renderColumnChart=function(t,e){e=e||"column";var s=t.data,i=Bf(t,t.options),r=[],o=[];i.chart.type=e,Uf(t,i,e);for(var a=0;a<s.length;a++)for(var l=s[a],c=0;c<l.data.length;c++){var h=l.data[c];r[h[0]]||(r[h[0]]=new Array(s.length),o.push(h[0])),r[h[0]][a]=h[1]}t.xtype==="number"&&o.sort(ow),i.xAxis.categories=o;for(var d=[],f=0;f<s.length;f++){for(var g=[],_=0;_<o.length;_++)g.push(r[o[_]][f]||0);var b={name:s[f].name||"Value",data:g};s[f].stack&&(b.stack=s[f].stack),d.push(b)}this.drawChart(t,d,i)};Ts.prototype.renderBarChart=function(t){this.renderColumnChart(t,"bar")};Ts.prototype.renderAreaChart=function(t){this.renderLineChart(t,"areaspline")};Ts.prototype.destroy=function(t){t.chart&&t.chart.destroy()};Ts.prototype.drawChart=function(t,e,s){this.destroy(t),!t.destroyed&&(s.chart.renderTo=t.element.id,s.series=e,t.options.code&&window.console.log("new Highcharts.Chart("+JSON.stringify(s)+");"),t.chart=new this.library.Chart(s))};var l_={},Ol=[],Pa={chartArea:{},fontName:"'Lucida Grande', 'Lucida Sans Unicode', Verdana, Arial, Helvetica, sans-serif",pointSize:6,legend:{textStyle:{fontSize:12,color:"#444"},alignment:"center",position:"right"},curveType:"function",hAxis:{textStyle:{color:"#666",fontSize:12},titleTextStyle:{},gridlines:{color:"transparent"},baselineColor:"#ccc",viewWindow:{}},vAxis:{textStyle:{color:"#666",fontSize:12},titleTextStyle:{},baselineColor:"#ccc",viewWindow:{}},tooltip:{textStyle:{color:"#666",fontSize:12}}};function $f(n,t,e){if(t!==void 0){var s;t?t===!0?s="right":s=t:s="none",n.legend.position=s}else e&&(n.legend.position="none")}function zf(n,t){n.title=t,n.titleTextStyle={color:"#333",fontSize:"20px"}}function YM(n,t){n.vAxis.viewWindow.min=t}function XM(n,t){n.vAxis.viewWindow.max=t}function QM(n,t){n.hAxis.viewWindow.min=t}function JM(n,t){n.hAxis.viewWindow.max=t}function mw(n,t){n.isStacked=t||!1}function _w(n,t){n.hAxis.title=t,n.hAxis.titleTextStyle.italic=!1}function yw(n,t){n.vAxis.title=t,n.vAxis.titleTextStyle.italic=!1}var uu=Ca(Pa,$f,zf,YM,XM,mw,_w,yw);function ZM(n){window.attachEvent?window.attachEvent("onresize",n):window.addEventListener&&window.addEventListener("resize",n,!0),n()}var tn=function(t){this.name="google",this.library=t};tn.prototype.renderLineChart=function(t){var e=this;this.waitForLoaded(t,function(){var s={};t.options.curve===!1&&(s.curveType="none"),t.options.points===!1&&(s.pointSize=0);var i=uu(t,t.options,s),r=e.createDataTable(t.data,t.xtype);e.drawChart(t,"LineChart",r,i)})};tn.prototype.renderPieChart=function(t){var e=this;this.waitForLoaded(t,function(){var s={chartArea:{top:"10%",height:"80%"},legend:{}};t.options.colors&&(s.colors=t.options.colors),t.options.donut&&(s.pieHole=.5),"legend"in t.options&&$f(s,t.options.legend),t.options.title&&zf(s,t.options.title);var i=ee(ee(Pa,s),t.options.library||{}),r=new e.library.visualization.DataTable;r.addColumn("string",""),r.addColumn("number","Value"),r.addRows(t.data),e.drawChart(t,"PieChart",r,i)})};tn.prototype.renderColumnChart=function(t){var e=this;this.waitForLoaded(t,function(){var s=uu(t,t.options),i=e.createDataTable(t.data,t.xtype);e.drawChart(t,"ColumnChart",i,s)})};tn.prototype.renderBarChart=function(t){var e=this;this.waitForLoaded(t,function(){var s={hAxis:{gridlines:{color:"#ccc"}}},i=Ca(Pa,$f,zf,QM,JM,mw,_w,yw)(t,t.options,s),r=e.createDataTable(t.data,t.xtype);e.drawChart(t,"BarChart",r,i)})};tn.prototype.renderAreaChart=function(t){var e=this;this.waitForLoaded(t,function(){var s={isStacked:!0,pointSize:0,areaOpacity:.5},i=uu(t,t.options,s),r=e.createDataTable(t.data,t.xtype);e.drawChart(t,"AreaChart",r,i)})};tn.prototype.renderGeoChart=function(t){var e=this;this.waitForLoaded(t,"geochart",function(){var s={legend:"none",colorAxis:{colors:t.options.colors||["#f6c7b6","#ce502d"]}},i=ee(ee(Pa,s),t.options.library||{}),r=new e.library.visualization.DataTable;r.addColumn("string",""),r.addColumn("number",t.options.label||"Value"),r.addRows(t.data),e.drawChart(t,"GeoChart",r,i)})};tn.prototype.renderScatterChart=function(t){var e=this;this.waitForLoaded(t,function(){for(var s={},i=uu(t,t.options,s),r=t.data,o=[],a=0;a<r.length;a++){r[a].name=r[a].name||"Value";for(var l=r[a].data,c=0;c<l.length;c++){var h=new Array(r.length+1);h[0]=l[c][0],h[a+1]=l[c][1],o.push(h)}}var d=new e.library.visualization.DataTable;d.addColumn("number","");for(var f=0;f<r.length;f++)d.addColumn("number",r[f].name);d.addRows(o),e.drawChart(t,"ScatterChart",d,i)})};tn.prototype.renderTimeline=function(t){var e=this;this.waitForLoaded(t,"timeline",function(){var s={legend:"none"};t.options.colors&&(s.colors=t.options.colors);var i=ee(ee(Pa,s),t.options.library||{}),r=new e.library.visualization.DataTable;r.addColumn({type:"string",id:"Name"}),r.addColumn({type:"date",id:"Start"}),r.addColumn({type:"date",id:"End"}),r.addRows(t.data),t.element.style.lineHeight="normal",e.drawChart(t,"Timeline",r,i)})};tn.prototype.destroy=function(t){t.chart&&t.chart.clearChart()};tn.prototype.drawChart=function(t,e,s,i){this.destroy(t),!t.destroyed&&(t.options.code&&window.console.log("var data = new google.visualization.DataTable("+s.toJSON()+`);
var chart = new google.visualization.`+e+`(element);
chart.draw(data, `+JSON.stringify(i)+");"),t.chart=new this.library.visualization[e](t.element),ZM(function(){t.chart.draw(s,i)}))};tn.prototype.waitForLoaded=function(t,e,s){var i=this;if(s||(s=e,e="corechart"),Ol.push({pack:e,callback:s}),l_[e])this.runCallbacks();else{l_[e]=!0;var r={packages:[e],callback:function(){i.runCallbacks()}},o=t.__config();o.language&&(r.language=o.language),e==="geochart"&&o.mapsApiKey&&(r.mapsApiKey=o.mapsApiKey),this.library.charts.load("current",r)}};tn.prototype.runCallbacks=function(){for(var t=0;t<Ol.length;t++){var e=Ol[t],s=this.library.visualization&&(e.pack==="corechart"&&this.library.visualization.LineChart||e.pack==="timeline"&&this.library.visualization.Timeline||e.pack==="geochart"&&this.library.visualization.GeoChart);s&&(e.callback(),Ol.splice(t,1),t--)}};tn.prototype.createDataTable=function(t,e){for(var s=[],i=[],r=0;r<t.length;r++){var o=t[r];t[r].name=t[r].name||"Value";for(var a=0;a<o.data.length;a++){var l=o.data[a],c=e==="datetime"?l[0].getTime():l[0];s[c]||(s[c]=new Array(t.length),i.push(c)),s[c][r]=l[1]}}for(var h=[],d=[],f=0;f<i.length;f++){var g=i[f],_=void 0;e==="datetime"?(_=new Date(g),d.push(_)):_=g,h.push([_].concat(s[g]))}var b=!0;if(e==="datetime"){h.sort(PM);var v=aw(d,!0);b=RM(v)}else if(e==="number"){h.sort(Mf);for(var A=0;A<h.length;A++)h[A][0]=vs(h[A][0]);e="string"}var C=new this.library.visualization.DataTable;e=e==="datetime"&&b?"date":e,C.addColumn(e,"");for(var O=0;O<t.length;O++)C.addColumn("number",t[O].name);return C.addRows(h),C};var Mi=[];function t2(n){if(n){if(n.product==="Highcharts")return Ts;if(n.charts)return tn;if(kf(n))return Yn}throw new Error("Unknown adapter")}function No(n){for(var t=t2(n),e=0;e<Mi.length;e++)if(Mi[e].library===n)return;Mi.push(new t(n))}function e2(){"Chart"in window&&No(window.Chart),"Highcharts"in window&&No(window.Highcharts),window.google&&window.google.charts&&No(window.google)}function n2(n,t){var e="render"+n,s=t.options.adapter;e2();for(var i=0;i<Mi.length;i++){var r=Mi[i];if((!s||s===r.name)&&kf(r[e]))return t.adapter=r.name,t.__adapterObject=r,r[e](t)}throw Mi.length>0?new Error("No charting library found for "+n):new Error("No charting libraries found - be sure to include one before your charts")}var Et={charts:{},configure:function(n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(Et.config[t]=n[t])},setDefaultOptions:function(n){Et.options=n},eachChart:function(n){for(var t in Et.charts)Object.prototype.hasOwnProperty.call(Et.charts,t)&&n(Et.charts[t])},destroyAll:function(){for(var n in Et.charts)Object.prototype.hasOwnProperty.call(Et.charts,n)&&(Et.charts[n].destroy(),delete Et.charts[n])},config:{},options:{},adapters:Mi,addAdapter:No,use:function(n){return No(n),Et}};function s2(n){for(var t=[],e=0;e<n.length;e++)t.push([zn(n[e][0]),zn(n[e][1]),zn(n[e][2])]);return t}function i2(n,t){if(t==="bubble")return s2(n);var e;t==="number"?e=zn:t==="datetime"?e=Mn:e=vs;for(var s=[],i=0;i<n.length;i++)s.push([e(n[i][0]),zn(n[i][1])]);return s}function r2(n,t,e){return vw(n)?(e.xmin||e.xmax)&&(!e.xmin||nh(e.xmin))&&(!e.xmax||nh(e.xmax))?"datetime":"number":c_(n,kM)?"number":!t&&c_(n,nh)?"datetime":"string"}function c_(n,t){for(var e=0;e<n.length;e++)for(var s=Df(n[e].data),i=0;i<s.length;i++)if(!t(s[i][0]))return!1;return!0}function o2(n){for(var t=[],e=0;e<n.length;e++){var s={};for(var i in n[e])Object.prototype.hasOwnProperty.call(n[e],i)&&(s[i]=n[e][i]);t.push(s)}return t}function $r(n,t,e){var s=n.options,i=n.rawData;n.singleSeriesFormat=!Qs(i)||!Ml(i[0]),n.singleSeriesFormat&&(i=[{name:s.label,data:i}]),i=o2(i);for(var r=0;r<i.length;r++)i[r].data=Df(i[r].data);n.xtype=t||(s.discrete?"string":r2(i,e,s));for(var o=0;o<i.length;o++)i[o].data=i2(i[o].data,n.xtype);return i}function bw(n){for(var t=Df(n.rawData),e=0;e<t.length;e++)t[e]=[vs(t[e][0]),zn(t[e][1])];return t}function vw(n,t){if(t==="PieChart"||t==="GeoChart"||t==="Timeline")return n.length===0;for(var e=0;e<n.length;e++)if(n[e].data.length>0)return!1;return!0}function a2(n){var t=n.options.download;t===!0?t={}:typeof t=="string"&&(t={filename:t});var e=document.createElement("a");e.download=t.filename||"chart.png",e.style.position="absolute",e.style.top="20px",e.style.right="20px",e.style.zIndex=1e3,e.style.lineHeight="20px",e.target="_blank";var s=document.createElement("img"),i='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path fill="#CCCCCC" d="M344 240h-56L287.1 152c0-13.25-10.75-24-24-24h-16C234.7 128 223.1 138.8 223.1 152L224 240h-56c-9.531 0-18.16 5.656-22 14.38C142.2 263.1 143.9 273.3 150.4 280.3l88.75 96C243.7 381.2 250.1 384 256.8 384c7.781-.3125 13.25-2.875 17.75-7.844l87.25-96c6.406-7.031 8.031-17.19 4.188-25.88S353.5 240 344 240zM256 0C114.6 0 0 114.6 0 256s114.6 256 256 256s256-114.6 256-256S397.4 0 256 0zM256 464c-114.7 0-208-93.31-208-208S141.3 48 256 48s208 93.31 208 208S370.7 464 256 464z"/></svg>';s.src="data:image/svg+xml;utf8,"+encodeURIComponent(i),s.alt="Download",s.style.width="20px",s.style.height="20px",s.style.border="none",e.appendChild(s);var r=n.element;r.style.position="relative",n.__downloadAttached=!0,n.__enterEvent=r.addEventListener("mouseover",function(o){var a=o.relatedTarget;(!a||a!==this&&!this.contains(a))&&n.options.download&&(e.href=n.toImage(t),r.appendChild(e))}),n.__leaveEvent=r.addEventListener("mouseout",function(o){var a=o.relatedTarget;(!a||a!==this&&!this.contains(a))&&e.parentNode&&e.parentNode.removeChild(e)})}var ww=[],id=0,l2=4;function c2(n,t,e){ww.push([n,t,e]),jf()}function jf(){if(id<l2){var n=ww.shift();n&&(id++,h2(n[0],n[1],n[2]),jf())}}function u2(){id--,jf()}function h2(n,t,e){var s=new XMLHttpRequest;s.open("GET",n,!0),s.setRequestHeader("Content-Type","application/json"),s.onload=function(){u2(),s.status===200?t(JSON.parse(s.responseText)):e(s.statusText)},s.send()}function Hf(n,t){n.textContent=t}function Ll(n,t,e){e||(t="Error Loading Chart: "+t),Hf(n,t),n.style.color="#ff0000"}function sh(n){try{n.__render()}catch(t){throw Ll(n.element,t.message),t}}function ia(n,t,e){if(e&&n.options.loading&&(typeof t=="string"||typeof t=="function")&&Hf(n.element,n.options.loading),typeof t=="string")c2(t,function(s){n.rawData=s,sh(n)},function(s){Ll(n.element,s)});else if(typeof t=="function")try{t(function(s){n.rawData=s,sh(n)},function(s){Ll(n.element,s,!0)})}catch(s){Ll(n.element,s,!0)}else n.rawData=t,sh(n)}function d2(n,t){if(vw(t.data,n)){var e=t.options.empty||t.options.messages&&t.options.messages.empty||"No data";Hf(t.element,e)}else n2(n,t),t.options.download&&!t.__downloadAttached&&t.adapter==="chartjs"&&a2(t)}function f2(n){if(typeof n=="string"){var t=n;if(n=document.getElementById(n),!n)throw new Error("No element with id "+t)}return n}var Xt=function(t,e,s){this.element=f2(t),this.options=ee(Et.options,s||{}),this.dataSource=e,this.element.id&&(Et.charts[this.element.id]=this),ia(this,e,!0),this.options.refresh&&this.startRefresh()};Xt.prototype.getElement=function(){return this.element};Xt.prototype.getDataSource=function(){return this.dataSource};Xt.prototype.getData=function(){return this.data};Xt.prototype.getOptions=function(){return this.options};Xt.prototype.getChartObject=function(){return this.chart};Xt.prototype.getAdapter=function(){return this.adapter};Xt.prototype.updateData=function(t,e){this.dataSource=t,e&&this.__updateOptions(e),ia(this,t,!0)};Xt.prototype.setOptions=function(t){this.__updateOptions(t),this.redraw()};Xt.prototype.redraw=function(){ia(this,this.rawData)};Xt.prototype.refreshData=function(){if(typeof this.dataSource=="string"){var t=this.dataSource.indexOf("?")===-1?"?":"&",e=this.dataSource+t+"_="+new Date().getTime();ia(this,e)}else typeof this.dataSource=="function"&&ia(this,this.dataSource)};Xt.prototype.startRefresh=function(){var t=this,e=this.options.refresh;if(e&&typeof this.dataSource!="string"&&typeof this.dataSource!="function")throw new Error("Data source must be a URL or callback for refresh");if(!this.intervalId)if(e)this.intervalId=setInterval(function(){t.refreshData()},e*1e3);else throw new Error("No refresh interval")};Xt.prototype.stopRefresh=function(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null)};Xt.prototype.toImage=function(t){if(this.adapter==="chartjs")if(t&&t.background&&t.background!=="transparent"){var e=this.chart.canvas,s=this.chart.ctx,i=document.createElement("canvas"),r=i.getContext("2d");return i.width=s.canvas.width,i.height=s.canvas.height,r.fillStyle=t.background,r.fillRect(0,0,i.width,i.height),r.drawImage(e,0,0),i.toDataURL("image/png")}else return this.chart.toBase64Image();else throw new Error("Feature only available for Chart.js")};Xt.prototype.destroy=function(){this.destroyed=!0,this.stopRefresh(),this.__adapterObject&&this.__adapterObject.destroy(this),this.__enterEvent&&this.element.removeEventListener("mouseover",this.__enterEvent),this.__leaveEvent&&this.element.removeEventListener("mouseout",this.__leaveEvent)};Xt.prototype.__updateOptions=function(t){var e=t.refresh&&t.refresh!==this.options.refresh;this.options=ee(Et.options,t),e&&(this.stopRefresh(),this.startRefresh())};Xt.prototype.__render=function(){this.data=this.__processData(),d2(this.__chartName(),this)};Xt.prototype.__config=function(){return Et.config};var p2=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.__processData=function(){return $r(this)},t.prototype.__chartName=function(){return"LineChart"},t}(Xt),g2=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.__processData=function(){return bw(this)},t.prototype.__chartName=function(){return"PieChart"},t}(Xt),m2=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.__processData=function(){return $r(this,null,!0)},t.prototype.__chartName=function(){return"ColumnChart"},t}(Xt),_2=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.__processData=function(){return $r(this,null,!0)},t.prototype.__chartName=function(){return"BarChart"},t}(Xt),y2=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.__processData=function(){return $r(this)},t.prototype.__chartName=function(){return"AreaChart"},t}(Xt),b2=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.__processData=function(){return bw(this)},t.prototype.__chartName=function(){return"GeoChart"},t}(Xt),v2=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.__processData=function(){return $r(this,"number")},t.prototype.__chartName=function(){return"ScatterChart"},t}(Xt),w2=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.__processData=function(){return $r(this,"bubble")},t.prototype.__chartName=function(){return"BubbleChart"},t}(Xt),x2=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.__processData=function(){for(var s=this.rawData,i=0;i<s.length;i++)s[i][1]=Mn(s[i][1]),s[i][2]=Mn(s[i][2]);return s},t.prototype.__chartName=function(){return"Timeline"},t}(Xt);Et.LineChart=p2;Et.PieChart=g2;Et.ColumnChart=m2;Et.BarChart=_2;Et.AreaChart=y2;Et.GeoChart=b2;Et.ScatterChart=v2;Et.BubbleChart=w2;Et.Timeline=x2;typeof window<"u"&&!window.Chartkick&&(window.Chartkick=Et,document.addEventListener("turbolinks:before-render",function(){Et.config.autoDestroy!==!1&&Et.destroyAll()}),document.addEventListener("turbo:before-render",function(){Et.config.autoDestroy!==!1&&Et.destroyAll()}),setTimeout(function(){window.dispatchEvent(new Event("chartkick:load"))},0));Et.default=Et;/*!
 * Vue Chartkick
 * Create beautiful JavaScript charts with one line of Vue
 * https://github.com/ankane/vue-chartkick
 * v1.1.0
 * MIT License
 */var T2=1,ks=function(n,t,e){var s=["adapter","bytes","code","colors","curve","dataset","decimal","discrete","donut","download","empty","label","legend","library","loading","max","messages","min","points","precision","prefix","refresh","round","stacked","suffix","thousands","title","xmax","xmin","xtitle","ytitle","zeros"];n.component(t,{props:["data","id","width","height"].concat(s),render:function(){var i=this.chartOptions.loading!==void 0?this.chartOptions.loading:"Loading...";if(typeof i!="string")throw new Error("loading must be a string");return zE("div",{id:this.chartId,style:this.chartStyle},[i])},data:function(){return{chartId:null}},computed:{chartStyle:function(){return this.data,this.chartOptions,{height:this.height||"300px",lineHeight:this.height||"300px",width:this.width||"100%",textAlign:"center",color:"#999",fontSize:"14px",fontFamily:"'Lucida Grande', 'Lucida Sans Unicode', Verdana, Arial, Helvetica, sans-serif"}},chartOptions:function(){for(var i={},r=s,o=0;o<r.length;o++){var a=r[o];this[a]!==void 0&&(i[a]=this[a])}return i}},created:function(){this.chartId=this.chartId||this.id||"chart-"+T2++},mounted:function(){this.updateChart()},updated:function(){this.updateChart()},beforeUnmount:function(){this.chart&&this.chart.destroy()},methods:{updateChart:function(){this.data!==null?this.chart?this.chart.updateData(this.data,this.chartOptions):this.chart=new e(this.chartId,this.data,this.chartOptions):this.chart&&(this.chart.destroy(),this.chart=null,this.$el.innerText="Loading...")}}})};Et.install=function(n,t){t&&t.adapter&&Et.addAdapter(t.adapter),ks(n,"line-chart",Et.LineChart),ks(n,"pie-chart",Et.PieChart),ks(n,"column-chart",Et.ColumnChart),ks(n,"bar-chart",Et.BarChart),ks(n,"area-chart",Et.AreaChart),ks(n,"scatter-chart",Et.ScatterChart),ks(n,"geo-chart",Et.GeoChart),ks(n,"timeline",Et.Timeline)};/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function Ra(n){return n+.5|0}const Us=(n,t,e)=>Math.max(Math.min(n,e),t);function yo(n){return Us(Ra(n*2.55),0,255)}function Js(n){return Us(Ra(n*255),0,255)}function is(n){return Us(Ra(n/2.55)/100,0,1)}function u_(n){return Us(Ra(n*100),0,100)}const hn={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},rd=[..."0123456789ABCDEF"],E2=n=>rd[n&15],I2=n=>rd[(n&240)>>4]+rd[n&15],rl=n=>(n&240)>>4===(n&15),S2=n=>rl(n.r)&&rl(n.g)&&rl(n.b)&&rl(n.a);function A2(n){var t=n.length,e;return n[0]==="#"&&(t===4||t===5?e={r:255&hn[n[1]]*17,g:255&hn[n[2]]*17,b:255&hn[n[3]]*17,a:t===5?hn[n[4]]*17:255}:(t===7||t===9)&&(e={r:hn[n[1]]<<4|hn[n[2]],g:hn[n[3]]<<4|hn[n[4]],b:hn[n[5]]<<4|hn[n[6]],a:t===9?hn[n[7]]<<4|hn[n[8]]:255})),e}const C2=(n,t)=>n<255?t(n):"";function P2(n){var t=S2(n)?E2:I2;return n?"#"+t(n.r)+t(n.g)+t(n.b)+C2(n.a,t):void 0}const R2=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function xw(n,t,e){const s=t*Math.min(e,1-e),i=(r,o=(r+n/30)%12)=>e-s*Math.max(Math.min(o-3,9-o,1),-1);return[i(0),i(8),i(4)]}function k2(n,t,e){const s=(i,r=(i+n/60)%6)=>e-e*t*Math.max(Math.min(r,4-r,1),0);return[s(5),s(3),s(1)]}function D2(n,t,e){const s=xw(n,1,.5);let i;for(t+e>1&&(i=1/(t+e),t*=i,e*=i),i=0;i<3;i++)s[i]*=1-t-e,s[i]+=t;return s}function M2(n,t,e,s,i){return n===i?(t-e)/s+(t<e?6:0):t===i?(e-n)/s+2:(n-t)/s+4}function Wf(n){const e=n.r/255,s=n.g/255,i=n.b/255,r=Math.max(e,s,i),o=Math.min(e,s,i),a=(r+o)/2;let l,c,h;return r!==o&&(h=r-o,c=a>.5?h/(2-r-o):h/(r+o),l=M2(e,s,i,h,r),l=l*60+.5),[l|0,c||0,a]}function qf(n,t,e,s){return(Array.isArray(t)?n(t[0],t[1],t[2]):n(t,e,s)).map(Js)}function Gf(n,t,e){return qf(xw,n,t,e)}function O2(n,t,e){return qf(D2,n,t,e)}function L2(n,t,e){return qf(k2,n,t,e)}function Tw(n){return(n%360+360)%360}function V2(n){const t=R2.exec(n);let e=255,s;if(!t)return;t[5]!==s&&(e=t[6]?yo(+t[5]):Js(+t[5]));const i=Tw(+t[2]),r=+t[3]/100,o=+t[4]/100;return t[1]==="hwb"?s=O2(i,r,o):t[1]==="hsv"?s=L2(i,r,o):s=Gf(i,r,o),{r:s[0],g:s[1],b:s[2],a:e}}function N2(n,t){var e=Wf(n);e[0]=Tw(e[0]+t),e=Gf(e),n.r=e[0],n.g=e[1],n.b=e[2]}function F2(n){if(!n)return;const t=Wf(n),e=t[0],s=u_(t[1]),i=u_(t[2]);return n.a<255?`hsla(${e}, ${s}%, ${i}%, ${is(n.a)})`:`hsl(${e}, ${s}%, ${i}%)`}const h_={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},d_={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function B2(){const n={},t=Object.keys(d_),e=Object.keys(h_);let s,i,r,o,a;for(s=0;s<t.length;s++){for(o=a=t[s],i=0;i<e.length;i++)r=e[i],a=a.replace(r,h_[r]);r=parseInt(d_[o],16),n[a]=[r>>16&255,r>>8&255,r&255]}return n}let ol;function U2(n){ol||(ol=B2(),ol.transparent=[0,0,0,0]);const t=ol[n.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}const $2=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function z2(n){const t=$2.exec(n);let e=255,s,i,r;if(t){if(t[7]!==s){const o=+t[7];e=t[8]?yo(o):Us(o*255,0,255)}return s=+t[1],i=+t[3],r=+t[5],s=255&(t[2]?yo(s):Us(s,0,255)),i=255&(t[4]?yo(i):Us(i,0,255)),r=255&(t[6]?yo(r):Us(r,0,255)),{r:s,g:i,b:r,a:e}}}function j2(n){return n&&(n.a<255?`rgba(${n.r}, ${n.g}, ${n.b}, ${is(n.a)})`:`rgb(${n.r}, ${n.g}, ${n.b})`)}const ih=n=>n<=.0031308?n*12.92:Math.pow(n,1/2.4)*1.055-.055,nr=n=>n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4);function H2(n,t,e){const s=nr(is(n.r)),i=nr(is(n.g)),r=nr(is(n.b));return{r:Js(ih(s+e*(nr(is(t.r))-s))),g:Js(ih(i+e*(nr(is(t.g))-i))),b:Js(ih(r+e*(nr(is(t.b))-r))),a:n.a+e*(t.a-n.a)}}function al(n,t,e){if(n){let s=Wf(n);s[t]=Math.max(0,Math.min(s[t]+s[t]*e,t===0?360:1)),s=Gf(s),n.r=s[0],n.g=s[1],n.b=s[2]}}function Ew(n,t){return n&&Object.assign(t||{},n)}function f_(n){var t={r:0,g:0,b:0,a:255};return Array.isArray(n)?n.length>=3&&(t={r:n[0],g:n[1],b:n[2],a:255},n.length>3&&(t.a=Js(n[3]))):(t=Ew(n,{r:0,g:0,b:0,a:1}),t.a=Js(t.a)),t}function W2(n){return n.charAt(0)==="r"?z2(n):V2(n)}class ra{constructor(t){if(t instanceof ra)return t;const e=typeof t;let s;e==="object"?s=f_(t):e==="string"&&(s=A2(t)||U2(t)||W2(t)),this._rgb=s,this._valid=!!s}get valid(){return this._valid}get rgb(){var t=Ew(this._rgb);return t&&(t.a=is(t.a)),t}set rgb(t){this._rgb=f_(t)}rgbString(){return this._valid?j2(this._rgb):void 0}hexString(){return this._valid?P2(this._rgb):void 0}hslString(){return this._valid?F2(this._rgb):void 0}mix(t,e){if(t){const s=this.rgb,i=t.rgb;let r;const o=e===r?.5:e,a=2*o-1,l=s.a-i.a,c=((a*l===-1?a:(a+l)/(1+a*l))+1)/2;r=1-c,s.r=255&c*s.r+r*i.r+.5,s.g=255&c*s.g+r*i.g+.5,s.b=255&c*s.b+r*i.b+.5,s.a=o*s.a+(1-o)*i.a,this.rgb=s}return this}interpolate(t,e){return t&&(this._rgb=H2(this._rgb,t._rgb,e)),this}clone(){return new ra(this.rgb)}alpha(t){return this._rgb.a=Js(t),this}clearer(t){const e=this._rgb;return e.a*=1-t,this}greyscale(){const t=this._rgb,e=Ra(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=e,this}opaquer(t){const e=this._rgb;return e.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return al(this._rgb,2,t),this}darken(t){return al(this._rgb,2,-t),this}saturate(t){return al(this._rgb,1,t),this}desaturate(t){return al(this._rgb,1,-t),this}rotate(t){return N2(this._rgb,t),this}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function ts(){}const q2=(()=>{let n=0;return()=>n++})();function Ct(n){return n==null}function Zt(n){if(Array.isArray&&Array.isArray(n))return!0;const t=Object.prototype.toString.call(n);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function Dt(n){return n!==null&&Object.prototype.toString.call(n)==="[object Object]"}function re(n){return(typeof n=="number"||n instanceof Number)&&isFinite(+n)}function sn(n,t){return re(n)?n:t}function wt(n,t){return typeof n>"u"?t:n}const G2=(n,t)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100:+n/t,Iw=(n,t)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100*t:+n;function Kt(n,t,e){if(n&&typeof n.call=="function")return n.apply(e,t)}function zt(n,t,e,s){let i,r,o;if(Zt(n))for(r=n.length,i=0;i<r;i++)t.call(e,n[i],i);else if(Dt(n))for(o=Object.keys(n),r=o.length,i=0;i<r;i++)t.call(e,n[o[i]],o[i])}function mc(n,t){let e,s,i,r;if(!n||!t||n.length!==t.length)return!1;for(e=0,s=n.length;e<s;++e)if(i=n[e],r=t[e],i.datasetIndex!==r.datasetIndex||i.index!==r.index)return!1;return!0}function _c(n){if(Zt(n))return n.map(_c);if(Dt(n)){const t=Object.create(null),e=Object.keys(n),s=e.length;let i=0;for(;i<s;++i)t[e[i]]=_c(n[e[i]]);return t}return n}function Sw(n){return["__proto__","prototype","constructor"].indexOf(n)===-1}function K2(n,t,e,s){if(!Sw(n))return;const i=t[n],r=e[n];Dt(i)&&Dt(r)?oa(i,r,s):t[n]=_c(r)}function oa(n,t,e){const s=Zt(t)?t:[t],i=s.length;if(!Dt(n))return n;e=e||{};const r=e.merger||K2;let o;for(let a=0;a<i;++a){if(o=s[a],!Dt(o))continue;const l=Object.keys(o);for(let c=0,h=l.length;c<h;++c)r(l[c],n,o,e)}return n}function Fo(n,t){return oa(n,t,{merger:Y2})}function Y2(n,t,e){if(!Sw(n))return;const s=t[n],i=e[n];Dt(s)&&Dt(i)?Fo(s,i):Object.prototype.hasOwnProperty.call(t,n)||(t[n]=_c(i))}const p_={"":n=>n,x:n=>n.x,y:n=>n.y};function X2(n){const t=n.split("."),e=[];let s="";for(const i of t)s+=i,s.endsWith("\\")?s=s.slice(0,-1)+".":(e.push(s),s="");return e}function Q2(n){const t=X2(n);return e=>{for(const s of t){if(s==="")break;e=e&&e[s]}return e}}function ai(n,t){return(p_[t]||(p_[t]=Q2(t)))(n)}function Kf(n){return n.charAt(0).toUpperCase()+n.slice(1)}const aa=n=>typeof n<"u",li=n=>typeof n=="function",g_=(n,t)=>{if(n.size!==t.size)return!1;for(const e of n)if(!t.has(e))return!1;return!0};function J2(n){return n.type==="mouseup"||n.type==="click"||n.type==="contextmenu"}const Vt=Math.PI,Jt=2*Vt,Z2=Jt+Vt,yc=Number.POSITIVE_INFINITY,tO=Vt/180,le=Vt/2,vi=Vt/4,m_=Vt*2/3,$s=Math.log10,jn=Math.sign;function Bo(n,t,e){return Math.abs(n-t)<e}function __(n){const t=Math.round(n);n=Bo(n,t,n/1e3)?t:n;const e=Math.pow(10,Math.floor($s(n))),s=n/e;return(s<=1?1:s<=2?2:s<=5?5:10)*e}function eO(n){const t=[],e=Math.sqrt(n);let s;for(s=1;s<e;s++)n%s===0&&(t.push(s),t.push(n/s));return e===(e|0)&&t.push(e),t.sort((i,r)=>i-r).pop(),t}function nO(n){return typeof n=="symbol"||typeof n=="object"&&n!==null&&!(Symbol.toPrimitive in n||"toString"in n||"valueOf"in n)}function Cr(n){return!nO(n)&&!isNaN(parseFloat(n))&&isFinite(n)}function sO(n,t){const e=Math.round(n);return e-t<=n&&e+t>=n}function Aw(n,t,e){let s,i,r;for(s=0,i=n.length;s<i;s++)r=n[s][e],isNaN(r)||(t.min=Math.min(t.min,r),t.max=Math.max(t.max,r))}function xn(n){return n*(Vt/180)}function Yf(n){return n*(180/Vt)}function y_(n){if(!re(n))return;let t=1,e=0;for(;Math.round(n*t)/t!==n;)t*=10,e++;return e}function Cw(n,t){const e=t.x-n.x,s=t.y-n.y,i=Math.sqrt(e*e+s*s);let r=Math.atan2(s,e);return r<-.5*Vt&&(r+=Jt),{angle:r,distance:i}}function od(n,t){return Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2))}function iO(n,t){return(n-t+Z2)%Jt-Vt}function Oe(n){return(n%Jt+Jt)%Jt}function la(n,t,e,s){const i=Oe(n),r=Oe(t),o=Oe(e),a=Oe(r-i),l=Oe(o-i),c=Oe(i-r),h=Oe(i-o);return i===r||i===o||s&&r===o||a>l&&c<h}function _e(n,t,e){return Math.max(t,Math.min(e,n))}function rO(n){return _e(n,-32768,32767)}function cs(n,t,e,s=1e-6){return n>=Math.min(t,e)-s&&n<=Math.max(t,e)+s}function Xf(n,t,e){e=e||(o=>n[o]<t);let s=n.length-1,i=0,r;for(;s-i>1;)r=i+s>>1,e(r)?i=r:s=r;return{lo:i,hi:s}}const us=(n,t,e,s)=>Xf(n,e,s?i=>{const r=n[i][t];return r<e||r===e&&n[i+1][t]===e}:i=>n[i][t]<e),oO=(n,t,e)=>Xf(n,e,s=>n[s][t]>=e);function aO(n,t,e){let s=0,i=n.length;for(;s<i&&n[s]<t;)s++;for(;i>s&&n[i-1]>e;)i--;return s>0||i<n.length?n.slice(s,i):n}const Pw=["push","pop","shift","splice","unshift"];function lO(n,t){if(n._chartjs){n._chartjs.listeners.push(t);return}Object.defineProperty(n,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),Pw.forEach(e=>{const s="_onData"+Kf(e),i=n[e];Object.defineProperty(n,e,{configurable:!0,enumerable:!1,value(...r){const o=i.apply(this,r);return n._chartjs.listeners.forEach(a=>{typeof a[s]=="function"&&a[s](...r)}),o}})})}function b_(n,t){const e=n._chartjs;if(!e)return;const s=e.listeners,i=s.indexOf(t);i!==-1&&s.splice(i,1),!(s.length>0)&&(Pw.forEach(r=>{delete n[r]}),delete n._chartjs)}function Rw(n){const t=new Set(n);return t.size===n.length?n:Array.from(t)}const kw=function(){return typeof window>"u"?function(n){return n()}:window.requestAnimationFrame}();function Dw(n,t){let e=[],s=!1;return function(...i){e=i,s||(s=!0,kw.call(window,()=>{s=!1,n.apply(t,e)}))}}function cO(n,t){let e;return function(...s){return t?(clearTimeout(e),e=setTimeout(n,t,s)):n.apply(this,s),t}}const Qf=n=>n==="start"?"left":n==="end"?"right":"center",De=(n,t,e)=>n==="start"?t:n==="end"?e:(t+e)/2,uO=(n,t,e,s)=>n===(s?"left":"right")?e:n==="center"?(t+e)/2:t;function Mw(n,t,e){const s=t.length;let i=0,r=s;if(n._sorted){const{iScale:o,vScale:a,_parsed:l}=n,c=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null,h=o.axis,{min:d,max:f,minDefined:g,maxDefined:_}=o.getUserBounds();if(g){if(i=Math.min(us(l,h,d).lo,e?s:us(t,h,o.getPixelForValue(d)).lo),c){const b=l.slice(0,i+1).reverse().findIndex(v=>!Ct(v[a.axis]));i-=Math.max(0,b)}i=_e(i,0,s-1)}if(_){let b=Math.max(us(l,o.axis,f,!0).hi+1,e?0:us(t,h,o.getPixelForValue(f),!0).hi+1);if(c){const v=l.slice(b-1).findIndex(A=>!Ct(A[a.axis]));b+=Math.max(0,v)}r=_e(b,i,s)-i}else r=s-i}return{start:i,count:r}}function Ow(n){const{xScale:t,yScale:e,_scaleRanges:s}=n,i={xmin:t.min,xmax:t.max,ymin:e.min,ymax:e.max};if(!s)return n._scaleRanges=i,!0;const r=s.xmin!==t.min||s.xmax!==t.max||s.ymin!==e.min||s.ymax!==e.max;return Object.assign(s,i),r}const ll=n=>n===0||n===1,v_=(n,t,e)=>-(Math.pow(2,10*(n-=1))*Math.sin((n-t)*Jt/e)),w_=(n,t,e)=>Math.pow(2,-10*n)*Math.sin((n-t)*Jt/e)+1,Uo={linear:n=>n,easeInQuad:n=>n*n,easeOutQuad:n=>-n*(n-2),easeInOutQuad:n=>(n/=.5)<1?.5*n*n:-.5*(--n*(n-2)-1),easeInCubic:n=>n*n*n,easeOutCubic:n=>(n-=1)*n*n+1,easeInOutCubic:n=>(n/=.5)<1?.5*n*n*n:.5*((n-=2)*n*n+2),easeInQuart:n=>n*n*n*n,easeOutQuart:n=>-((n-=1)*n*n*n-1),easeInOutQuart:n=>(n/=.5)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2),easeInQuint:n=>n*n*n*n*n,easeOutQuint:n=>(n-=1)*n*n*n*n+1,easeInOutQuint:n=>(n/=.5)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2),easeInSine:n=>-Math.cos(n*le)+1,easeOutSine:n=>Math.sin(n*le),easeInOutSine:n=>-.5*(Math.cos(Vt*n)-1),easeInExpo:n=>n===0?0:Math.pow(2,10*(n-1)),easeOutExpo:n=>n===1?1:-Math.pow(2,-10*n)+1,easeInOutExpo:n=>ll(n)?n:n<.5?.5*Math.pow(2,10*(n*2-1)):.5*(-Math.pow(2,-10*(n*2-1))+2),easeInCirc:n=>n>=1?n:-(Math.sqrt(1-n*n)-1),easeOutCirc:n=>Math.sqrt(1-(n-=1)*n),easeInOutCirc:n=>(n/=.5)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1),easeInElastic:n=>ll(n)?n:v_(n,.075,.3),easeOutElastic:n=>ll(n)?n:w_(n,.075,.3),easeInOutElastic(n){return ll(n)?n:n<.5?.5*v_(n*2,.1125,.45):.5+.5*w_(n*2-1,.1125,.45)},easeInBack(n){return n*n*((1.70158+1)*n-1.70158)},easeOutBack(n){return(n-=1)*n*((1.70158+1)*n+1.70158)+1},easeInOutBack(n){let t=1.70158;return(n/=.5)<1?.5*(n*n*(((t*=1.525)+1)*n-t)):.5*((n-=2)*n*(((t*=1.525)+1)*n+t)+2)},easeInBounce:n=>1-Uo.easeOutBounce(1-n),easeOutBounce(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},easeInOutBounce:n=>n<.5?Uo.easeInBounce(n*2)*.5:Uo.easeOutBounce(n*2-1)*.5+.5};function Jf(n){if(n&&typeof n=="object"){const t=n.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function x_(n){return Jf(n)?n:new ra(n)}function rh(n){return Jf(n)?n:new ra(n).saturate(.5).darken(.1).hexString()}const hO=["x","y","borderWidth","radius","tension"],dO=["color","borderColor","backgroundColor"];function fO(n){n.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),n.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>t!=="onProgress"&&t!=="onComplete"&&t!=="fn"}),n.set("animations",{colors:{type:"color",properties:dO},numbers:{type:"number",properties:hO}}),n.describe("animations",{_fallback:"animation"}),n.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>t|0}}}})}function pO(n){n.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const T_=new Map;function gO(n,t){t=t||{};const e=n+JSON.stringify(t);let s=T_.get(e);return s||(s=new Intl.NumberFormat(n,t),T_.set(e,s)),s}function ka(n,t,e){return gO(t,e).format(n)}const Lw={values(n){return Zt(n)?n:""+n},numeric(n,t,e){if(n===0)return"0";const s=this.chart.options.locale;let i,r=n;if(e.length>1){const c=Math.max(Math.abs(e[0].value),Math.abs(e[e.length-1].value));(c<1e-4||c>1e15)&&(i="scientific"),r=mO(n,e)}const o=$s(Math.abs(r)),a=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),l={notation:i,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(l,this.options.ticks.format),ka(n,s,l)},logarithmic(n,t,e){if(n===0)return"0";const s=e[t].significand||n/Math.pow(10,Math.floor($s(n)));return[1,2,3,5,10,15].includes(s)||t>.8*e.length?Lw.numeric.call(this,n,t,e):""}};function mO(n,t){let e=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(e)>=1&&n!==Math.floor(n)&&(e=n-Math.floor(n)),e}var hu={formatters:Lw};function _O(n){n.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,e)=>e.lineWidth,tickColor:(t,e)=>e.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:hu.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),n.route("scale.ticks","color","","color"),n.route("scale.grid","color","","borderColor"),n.route("scale.border","color","","borderColor"),n.route("scale.title","color","","color"),n.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&t!=="callback"&&t!=="parser",_indexable:t=>t!=="borderDash"&&t!=="tickBorderDash"&&t!=="dash"}),n.describe("scales",{_fallback:"scale"}),n.describe("scale.ticks",{_scriptable:t=>t!=="backdropPadding"&&t!=="callback",_indexable:t=>t!=="backdropPadding"})}const zi=Object.create(null),ad=Object.create(null);function $o(n,t){if(!t)return n;const e=t.split(".");for(let s=0,i=e.length;s<i;++s){const r=e[s];n=n[r]||(n[r]=Object.create(null))}return n}function oh(n,t,e){return typeof t=="string"?oa($o(n,t),e):oa($o(n,""),t)}class yO{constructor(t,e){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=s=>s.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(s,i)=>rh(i.backgroundColor),this.hoverBorderColor=(s,i)=>rh(i.borderColor),this.hoverColor=(s,i)=>rh(i.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(e)}set(t,e){return oh(this,t,e)}get(t){return $o(this,t)}describe(t,e){return oh(ad,t,e)}override(t,e){return oh(zi,t,e)}route(t,e,s,i){const r=$o(this,t),o=$o(this,s),a="_"+e;Object.defineProperties(r,{[a]:{value:r[e],writable:!0},[e]:{enumerable:!0,get(){const l=this[a],c=o[i];return Dt(l)?Object.assign({},c,l):wt(l,c)},set(l){this[a]=l}}})}apply(t){t.forEach(e=>e(this))}}var te=new yO({_scriptable:n=>!n.startsWith("on"),_indexable:n=>n!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[fO,pO,_O]);function bO(n){return!n||Ct(n.size)||Ct(n.family)?null:(n.style?n.style+" ":"")+(n.weight?n.weight+" ":"")+n.size+"px "+n.family}function bc(n,t,e,s,i){let r=t[i];return r||(r=t[i]=n.measureText(i).width,e.push(i)),r>s&&(s=r),s}function vO(n,t,e,s){s=s||{};let i=s.data=s.data||{},r=s.garbageCollect=s.garbageCollect||[];s.font!==t&&(i=s.data={},r=s.garbageCollect=[],s.font=t),n.save(),n.font=t;let o=0;const a=e.length;let l,c,h,d,f;for(l=0;l<a;l++)if(d=e[l],d!=null&&!Zt(d))o=bc(n,i,r,o,d);else if(Zt(d))for(c=0,h=d.length;c<h;c++)f=d[c],f!=null&&!Zt(f)&&(o=bc(n,i,r,o,f));n.restore();const g=r.length/2;if(g>e.length){for(l=0;l<g;l++)delete i[r[l]];r.splice(0,g)}return o}function wi(n,t,e){const s=n.currentDevicePixelRatio,i=e!==0?Math.max(e/2,.5):0;return Math.round((t-i)*s)/s+i}function E_(n,t){!t&&!n||(t=t||n.getContext("2d"),t.save(),t.resetTransform(),t.clearRect(0,0,n.width,n.height),t.restore())}function ld(n,t,e,s){Vw(n,t,e,s,null)}function Vw(n,t,e,s,i){let r,o,a,l,c,h,d,f;const g=t.pointStyle,_=t.rotation,b=t.radius;let v=(_||0)*tO;if(g&&typeof g=="object"&&(r=g.toString(),r==="[object HTMLImageElement]"||r==="[object HTMLCanvasElement]")){n.save(),n.translate(e,s),n.rotate(v),n.drawImage(g,-g.width/2,-g.height/2,g.width,g.height),n.restore();return}if(!(isNaN(b)||b<=0)){switch(n.beginPath(),g){default:i?n.ellipse(e,s,i/2,b,0,0,Jt):n.arc(e,s,b,0,Jt),n.closePath();break;case"triangle":h=i?i/2:b,n.moveTo(e+Math.sin(v)*h,s-Math.cos(v)*b),v+=m_,n.lineTo(e+Math.sin(v)*h,s-Math.cos(v)*b),v+=m_,n.lineTo(e+Math.sin(v)*h,s-Math.cos(v)*b),n.closePath();break;case"rectRounded":c=b*.516,l=b-c,o=Math.cos(v+vi)*l,d=Math.cos(v+vi)*(i?i/2-c:l),a=Math.sin(v+vi)*l,f=Math.sin(v+vi)*(i?i/2-c:l),n.arc(e-d,s-a,c,v-Vt,v-le),n.arc(e+f,s-o,c,v-le,v),n.arc(e+d,s+a,c,v,v+le),n.arc(e-f,s+o,c,v+le,v+Vt),n.closePath();break;case"rect":if(!_){l=Math.SQRT1_2*b,h=i?i/2:l,n.rect(e-h,s-l,2*h,2*l);break}v+=vi;case"rectRot":d=Math.cos(v)*(i?i/2:b),o=Math.cos(v)*b,a=Math.sin(v)*b,f=Math.sin(v)*(i?i/2:b),n.moveTo(e-d,s-a),n.lineTo(e+f,s-o),n.lineTo(e+d,s+a),n.lineTo(e-f,s+o),n.closePath();break;case"crossRot":v+=vi;case"cross":d=Math.cos(v)*(i?i/2:b),o=Math.cos(v)*b,a=Math.sin(v)*b,f=Math.sin(v)*(i?i/2:b),n.moveTo(e-d,s-a),n.lineTo(e+d,s+a),n.moveTo(e+f,s-o),n.lineTo(e-f,s+o);break;case"star":d=Math.cos(v)*(i?i/2:b),o=Math.cos(v)*b,a=Math.sin(v)*b,f=Math.sin(v)*(i?i/2:b),n.moveTo(e-d,s-a),n.lineTo(e+d,s+a),n.moveTo(e+f,s-o),n.lineTo(e-f,s+o),v+=vi,d=Math.cos(v)*(i?i/2:b),o=Math.cos(v)*b,a=Math.sin(v)*b,f=Math.sin(v)*(i?i/2:b),n.moveTo(e-d,s-a),n.lineTo(e+d,s+a),n.moveTo(e+f,s-o),n.lineTo(e-f,s+o);break;case"line":o=i?i/2:Math.cos(v)*b,a=Math.sin(v)*b,n.moveTo(e-o,s-a),n.lineTo(e+o,s+a);break;case"dash":n.moveTo(e,s),n.lineTo(e+Math.cos(v)*(i?i/2:b),s+Math.sin(v)*b);break;case!1:n.closePath();break}n.fill(),t.borderWidth>0&&n.stroke()}}function hs(n,t,e){return e=e||.5,!t||n&&n.x>t.left-e&&n.x<t.right+e&&n.y>t.top-e&&n.y<t.bottom+e}function du(n,t){n.save(),n.beginPath(),n.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),n.clip()}function fu(n){n.restore()}function wO(n,t,e,s,i){if(!t)return n.lineTo(e.x,e.y);if(i==="middle"){const r=(t.x+e.x)/2;n.lineTo(r,t.y),n.lineTo(r,e.y)}else i==="after"!=!!s?n.lineTo(t.x,e.y):n.lineTo(e.x,t.y);n.lineTo(e.x,e.y)}function xO(n,t,e,s){if(!t)return n.lineTo(e.x,e.y);n.bezierCurveTo(s?t.cp1x:t.cp2x,s?t.cp1y:t.cp2y,s?e.cp2x:e.cp1x,s?e.cp2y:e.cp1y,e.x,e.y)}function TO(n,t){t.translation&&n.translate(t.translation[0],t.translation[1]),Ct(t.rotation)||n.rotate(t.rotation),t.color&&(n.fillStyle=t.color),t.textAlign&&(n.textAlign=t.textAlign),t.textBaseline&&(n.textBaseline=t.textBaseline)}function EO(n,t,e,s,i){if(i.strikethrough||i.underline){const r=n.measureText(s),o=t-r.actualBoundingBoxLeft,a=t+r.actualBoundingBoxRight,l=e-r.actualBoundingBoxAscent,c=e+r.actualBoundingBoxDescent,h=i.strikethrough?(l+c)/2:c;n.strokeStyle=n.fillStyle,n.beginPath(),n.lineWidth=i.decorationWidth||2,n.moveTo(o,h),n.lineTo(a,h),n.stroke()}}function IO(n,t){const e=n.fillStyle;n.fillStyle=t.color,n.fillRect(t.left,t.top,t.width,t.height),n.fillStyle=e}function ji(n,t,e,s,i,r={}){const o=Zt(t)?t:[t],a=r.strokeWidth>0&&r.strokeColor!=="";let l,c;for(n.save(),n.font=i.string,TO(n,r),l=0;l<o.length;++l)c=o[l],r.backdrop&&IO(n,r.backdrop),a&&(r.strokeColor&&(n.strokeStyle=r.strokeColor),Ct(r.strokeWidth)||(n.lineWidth=r.strokeWidth),n.strokeText(c,e,s,r.maxWidth)),n.fillText(c,e,s,r.maxWidth),EO(n,e,s,c,r),s+=Number(i.lineHeight);n.restore()}function ca(n,t){const{x:e,y:s,w:i,h:r,radius:o}=t;n.arc(e+o.topLeft,s+o.topLeft,o.topLeft,1.5*Vt,Vt,!0),n.lineTo(e,s+r-o.bottomLeft),n.arc(e+o.bottomLeft,s+r-o.bottomLeft,o.bottomLeft,Vt,le,!0),n.lineTo(e+i-o.bottomRight,s+r),n.arc(e+i-o.bottomRight,s+r-o.bottomRight,o.bottomRight,le,0,!0),n.lineTo(e+i,s+o.topRight),n.arc(e+i-o.topRight,s+o.topRight,o.topRight,0,-le,!0),n.lineTo(e+o.topLeft,s)}const SO=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,AO=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function CO(n,t){const e=(""+n).match(SO);if(!e||e[1]==="normal")return t*1.2;switch(n=+e[2],e[3]){case"px":return n;case"%":n/=100;break}return t*n}const PO=n=>+n||0;function Zf(n,t){const e={},s=Dt(t),i=s?Object.keys(t):t,r=Dt(n)?s?o=>wt(n[o],n[t[o]]):o=>n[o]:()=>n;for(const o of i)e[o]=PO(r(o));return e}function Nw(n){return Zf(n,{top:"y",right:"x",bottom:"y",left:"x"})}function Oi(n){return Zf(n,["topLeft","topRight","bottomLeft","bottomRight"])}function ze(n){const t=Nw(n);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function pe(n,t){n=n||{},t=t||te.font;let e=wt(n.size,t.size);typeof e=="string"&&(e=parseInt(e,10));let s=wt(n.style,t.style);s&&!(""+s).match(AO)&&(console.warn('Invalid font style specified: "'+s+'"'),s=void 0);const i={family:wt(n.family,t.family),lineHeight:CO(wt(n.lineHeight,t.lineHeight),e),size:e,style:s,weight:wt(n.weight,t.weight),string:""};return i.string=bO(i),i}function bo(n,t,e,s){let i,r,o;for(i=0,r=n.length;i<r;++i)if(o=n[i],o!==void 0&&o!==void 0)return o}function RO(n,t,e){const{min:s,max:i}=n,r=Iw(t,(i-s)/2),o=(a,l)=>e&&a===0?0:a+l;return{min:o(s,-Math.abs(r)),max:o(i,r)}}function di(n,t){return Object.assign(Object.create(n),t)}function tp(n,t=[""],e,s,i=()=>n[0]){const r=e||n;typeof s>"u"&&(s=$w("_fallback",n));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:n,_rootScopes:r,_fallback:s,_getTarget:i,override:a=>tp([a,...n],t,r,s)};return new Proxy(o,{deleteProperty(a,l){return delete a[l],delete a._keys,delete n[0][l],!0},get(a,l){return Bw(a,l,()=>FO(l,t,n,a))},getOwnPropertyDescriptor(a,l){return Reflect.getOwnPropertyDescriptor(a._scopes[0],l)},getPrototypeOf(){return Reflect.getPrototypeOf(n[0])},has(a,l){return S_(a).includes(l)},ownKeys(a){return S_(a)},set(a,l,c){const h=a._storage||(a._storage=i());return a[l]=h[l]=c,delete a._keys,!0}})}function Pr(n,t,e,s){const i={_cacheable:!1,_proxy:n,_context:t,_subProxy:e,_stack:new Set,_descriptors:Fw(n,s),setContext:r=>Pr(n,r,e,s),override:r=>Pr(n.override(r),t,e,s)};return new Proxy(i,{deleteProperty(r,o){return delete r[o],delete n[o],!0},get(r,o,a){return Bw(r,o,()=>DO(r,o,a))},getOwnPropertyDescriptor(r,o){return r._descriptors.allKeys?Reflect.has(n,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(n,o)},getPrototypeOf(){return Reflect.getPrototypeOf(n)},has(r,o){return Reflect.has(n,o)},ownKeys(){return Reflect.ownKeys(n)},set(r,o,a){return n[o]=a,delete r[o],!0}})}function Fw(n,t={scriptable:!0,indexable:!0}){const{_scriptable:e=t.scriptable,_indexable:s=t.indexable,_allKeys:i=t.allKeys}=n;return{allKeys:i,scriptable:e,indexable:s,isScriptable:li(e)?e:()=>e,isIndexable:li(s)?s:()=>s}}const kO=(n,t)=>n?n+Kf(t):t,ep=(n,t)=>Dt(t)&&n!=="adapters"&&(Object.getPrototypeOf(t)===null||t.constructor===Object);function Bw(n,t,e){if(Object.prototype.hasOwnProperty.call(n,t)||t==="constructor")return n[t];const s=e();return n[t]=s,s}function DO(n,t,e){const{_proxy:s,_context:i,_subProxy:r,_descriptors:o}=n;let a=s[t];return li(a)&&o.isScriptable(t)&&(a=MO(t,a,n,e)),Zt(a)&&a.length&&(a=OO(t,a,n,o.isIndexable)),ep(t,a)&&(a=Pr(a,i,r&&r[t],o)),a}function MO(n,t,e,s){const{_proxy:i,_context:r,_subProxy:o,_stack:a}=e;if(a.has(n))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+n);a.add(n);let l=t(r,o||s);return a.delete(n),ep(n,l)&&(l=np(i._scopes,i,n,l)),l}function OO(n,t,e,s){const{_proxy:i,_context:r,_subProxy:o,_descriptors:a}=e;if(typeof r.index<"u"&&s(n))return t[r.index%t.length];if(Dt(t[0])){const l=t,c=i._scopes.filter(h=>h!==l);t=[];for(const h of l){const d=np(c,i,n,h);t.push(Pr(d,r,o&&o[n],a))}}return t}function Uw(n,t,e){return li(n)?n(t,e):n}const LO=(n,t)=>n===!0?t:typeof n=="string"?ai(t,n):void 0;function VO(n,t,e,s,i){for(const r of t){const o=LO(e,r);if(o){n.add(o);const a=Uw(o._fallback,e,i);if(typeof a<"u"&&a!==e&&a!==s)return a}else if(o===!1&&typeof s<"u"&&e!==s)return null}return!1}function np(n,t,e,s){const i=t._rootScopes,r=Uw(t._fallback,e,s),o=[...n,...i],a=new Set;a.add(s);let l=I_(a,o,e,r||e,s);return l===null||typeof r<"u"&&r!==e&&(l=I_(a,o,r,l,s),l===null)?!1:tp(Array.from(a),[""],i,r,()=>NO(t,e,s))}function I_(n,t,e,s,i){for(;e;)e=VO(n,t,e,s,i);return e}function NO(n,t,e){const s=n._getTarget();t in s||(s[t]={});const i=s[t];return Zt(i)&&Dt(e)?e:i||{}}function FO(n,t,e,s){let i;for(const r of t)if(i=$w(kO(r,n),e),typeof i<"u")return ep(n,i)?np(e,s,n,i):i}function $w(n,t){for(const e of t){if(!e)continue;const s=e[n];if(typeof s<"u")return s}}function S_(n){let t=n._keys;return t||(t=n._keys=BO(n._scopes)),t}function BO(n){const t=new Set;for(const e of n)for(const s of Object.keys(e).filter(i=>!i.startsWith("_")))t.add(s);return Array.from(t)}function zw(n,t,e,s){const{iScale:i}=n,{key:r="r"}=this._parsing,o=new Array(s);let a,l,c,h;for(a=0,l=s;a<l;++a)c=a+e,h=t[c],o[a]={r:i.parse(ai(h,r),c)};return o}const UO=Number.EPSILON||1e-14,Rr=(n,t)=>t<n.length&&!n[t].skip&&n[t],jw=n=>n==="x"?"y":"x";function $O(n,t,e,s){const i=n.skip?t:n,r=t,o=e.skip?t:e,a=od(r,i),l=od(o,r);let c=a/(a+l),h=l/(a+l);c=isNaN(c)?0:c,h=isNaN(h)?0:h;const d=s*c,f=s*h;return{previous:{x:r.x-d*(o.x-i.x),y:r.y-d*(o.y-i.y)},next:{x:r.x+f*(o.x-i.x),y:r.y+f*(o.y-i.y)}}}function zO(n,t,e){const s=n.length;let i,r,o,a,l,c=Rr(n,0);for(let h=0;h<s-1;++h)if(l=c,c=Rr(n,h+1),!(!l||!c)){if(Bo(t[h],0,UO)){e[h]=e[h+1]=0;continue}i=e[h]/t[h],r=e[h+1]/t[h],a=Math.pow(i,2)+Math.pow(r,2),!(a<=9)&&(o=3/Math.sqrt(a),e[h]=i*o*t[h],e[h+1]=r*o*t[h])}}function jO(n,t,e="x"){const s=jw(e),i=n.length;let r,o,a,l=Rr(n,0);for(let c=0;c<i;++c){if(o=a,a=l,l=Rr(n,c+1),!a)continue;const h=a[e],d=a[s];o&&(r=(h-o[e])/3,a[`cp1${e}`]=h-r,a[`cp1${s}`]=d-r*t[c]),l&&(r=(l[e]-h)/3,a[`cp2${e}`]=h+r,a[`cp2${s}`]=d+r*t[c])}}function HO(n,t="x"){const e=jw(t),s=n.length,i=Array(s).fill(0),r=Array(s);let o,a,l,c=Rr(n,0);for(o=0;o<s;++o)if(a=l,l=c,c=Rr(n,o+1),!!l){if(c){const h=c[t]-l[t];i[o]=h!==0?(c[e]-l[e])/h:0}r[o]=a?c?jn(i[o-1])!==jn(i[o])?0:(i[o-1]+i[o])/2:i[o-1]:i[o]}zO(n,i,r),jO(n,r,t)}function cl(n,t,e){return Math.max(Math.min(n,e),t)}function WO(n,t){let e,s,i,r,o,a=hs(n[0],t);for(e=0,s=n.length;e<s;++e)o=r,r=a,a=e<s-1&&hs(n[e+1],t),r&&(i=n[e],o&&(i.cp1x=cl(i.cp1x,t.left,t.right),i.cp1y=cl(i.cp1y,t.top,t.bottom)),a&&(i.cp2x=cl(i.cp2x,t.left,t.right),i.cp2y=cl(i.cp2y,t.top,t.bottom)))}function qO(n,t,e,s,i){let r,o,a,l;if(t.spanGaps&&(n=n.filter(c=>!c.skip)),t.cubicInterpolationMode==="monotone")HO(n,i);else{let c=s?n[n.length-1]:n[0];for(r=0,o=n.length;r<o;++r)a=n[r],l=$O(c,a,n[Math.min(r+1,o-(s?0:1))%o],t.tension),a.cp1x=l.previous.x,a.cp1y=l.previous.y,a.cp2x=l.next.x,a.cp2y=l.next.y,c=a}t.capBezierPoints&&WO(n,e)}function sp(){return typeof window<"u"&&typeof document<"u"}function ip(n){let t=n.parentNode;return t&&t.toString()==="[object ShadowRoot]"&&(t=t.host),t}function vc(n,t,e){let s;return typeof n=="string"?(s=parseInt(n,10),n.indexOf("%")!==-1&&(s=s/100*t.parentNode[e])):s=n,s}const pu=n=>n.ownerDocument.defaultView.getComputedStyle(n,null);function GO(n,t){return pu(n).getPropertyValue(t)}const KO=["top","right","bottom","left"];function Li(n,t,e){const s={};e=e?"-"+e:"";for(let i=0;i<4;i++){const r=KO[i];s[r]=parseFloat(n[t+"-"+r+e])||0}return s.width=s.left+s.right,s.height=s.top+s.bottom,s}const YO=(n,t,e)=>(n>0||t>0)&&(!e||!e.shadowRoot);function XO(n,t){const e=n.touches,s=e&&e.length?e[0]:n,{offsetX:i,offsetY:r}=s;let o=!1,a,l;if(YO(i,r,n.target))a=i,l=r;else{const c=t.getBoundingClientRect();a=s.clientX-c.left,l=s.clientY-c.top,o=!0}return{x:a,y:l,box:o}}function Si(n,t){if("native"in n)return n;const{canvas:e,currentDevicePixelRatio:s}=t,i=pu(e),r=i.boxSizing==="border-box",o=Li(i,"padding"),a=Li(i,"border","width"),{x:l,y:c,box:h}=XO(n,e),d=o.left+(h&&a.left),f=o.top+(h&&a.top);let{width:g,height:_}=t;return r&&(g-=o.width+a.width,_-=o.height+a.height),{x:Math.round((l-d)/g*e.width/s),y:Math.round((c-f)/_*e.height/s)}}function QO(n,t,e){let s,i;if(t===void 0||e===void 0){const r=n&&ip(n);if(!r)t=n.clientWidth,e=n.clientHeight;else{const o=r.getBoundingClientRect(),a=pu(r),l=Li(a,"border","width"),c=Li(a,"padding");t=o.width-c.width-l.width,e=o.height-c.height-l.height,s=vc(a.maxWidth,r,"clientWidth"),i=vc(a.maxHeight,r,"clientHeight")}}return{width:t,height:e,maxWidth:s||yc,maxHeight:i||yc}}const zs=n=>Math.round(n*10)/10;function JO(n,t,e,s){const i=pu(n),r=Li(i,"margin"),o=vc(i.maxWidth,n,"clientWidth")||yc,a=vc(i.maxHeight,n,"clientHeight")||yc,l=QO(n,t,e);let{width:c,height:h}=l;if(i.boxSizing==="content-box"){const f=Li(i,"border","width"),g=Li(i,"padding");c-=g.width+f.width,h-=g.height+f.height}return c=Math.max(0,c-r.width),h=Math.max(0,s?c/s:h-r.height),c=zs(Math.min(c,o,l.maxWidth)),h=zs(Math.min(h,a,l.maxHeight)),c&&!h&&(h=zs(c/2)),(t!==void 0||e!==void 0)&&s&&l.height&&h>l.height&&(h=l.height,c=zs(Math.floor(h*s))),{width:c,height:h}}function A_(n,t,e){const s=t||1,i=zs(n.height*s),r=zs(n.width*s);n.height=zs(n.height),n.width=zs(n.width);const o=n.canvas;return o.style&&(e||!o.style.height&&!o.style.width)&&(o.style.height=`${n.height}px`,o.style.width=`${n.width}px`),n.currentDevicePixelRatio!==s||o.height!==i||o.width!==r?(n.currentDevicePixelRatio=s,o.height=i,o.width=r,n.ctx.setTransform(s,0,0,s,0,0),!0):!1}const ZO=function(){let n=!1;try{const t={get passive(){return n=!0,!1}};sp()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch{}return n}();function C_(n,t){const e=GO(n,t),s=e&&e.match(/^(\d+)(\.\d+)?px$/);return s?+s[1]:void 0}function Ai(n,t,e,s){return{x:n.x+e*(t.x-n.x),y:n.y+e*(t.y-n.y)}}function tL(n,t,e,s){return{x:n.x+e*(t.x-n.x),y:s==="middle"?e<.5?n.y:t.y:s==="after"?e<1?n.y:t.y:e>0?t.y:n.y}}function eL(n,t,e,s){const i={x:n.cp2x,y:n.cp2y},r={x:t.cp1x,y:t.cp1y},o=Ai(n,i,e),a=Ai(i,r,e),l=Ai(r,t,e),c=Ai(o,a,e),h=Ai(a,l,e);return Ai(c,h,e)}const nL=function(n,t){return{x(e){return n+n+t-e},setWidth(e){t=e},textAlign(e){return e==="center"?e:e==="right"?"left":"right"},xPlus(e,s){return e-s},leftForLtr(e,s){return e-s}}},sL=function(){return{x(n){return n},setWidth(n){},textAlign(n){return n},xPlus(n,t){return n+t},leftForLtr(n,t){return n}}};function br(n,t,e){return n?nL(t,e):sL()}function Hw(n,t){let e,s;(t==="ltr"||t==="rtl")&&(e=n.canvas.style,s=[e.getPropertyValue("direction"),e.getPropertyPriority("direction")],e.setProperty("direction",t,"important"),n.prevTextDirection=s)}function Ww(n,t){t!==void 0&&(delete n.prevTextDirection,n.canvas.style.setProperty("direction",t[0],t[1]))}function qw(n){return n==="angle"?{between:la,compare:iO,normalize:Oe}:{between:cs,compare:(t,e)=>t-e,normalize:t=>t}}function P_({start:n,end:t,count:e,loop:s,style:i}){return{start:n%e,end:t%e,loop:s&&(t-n+1)%e===0,style:i}}function iL(n,t,e){const{property:s,start:i,end:r}=e,{between:o,normalize:a}=qw(s),l=t.length;let{start:c,end:h,loop:d}=n,f,g;if(d){for(c+=l,h+=l,f=0,g=l;f<g&&o(a(t[c%l][s]),i,r);++f)c--,h--;c%=l,h%=l}return h<c&&(h+=l),{start:c,end:h,loop:d,style:n.style}}function Gw(n,t,e){if(!e)return[n];const{property:s,start:i,end:r}=e,o=t.length,{compare:a,between:l,normalize:c}=qw(s),{start:h,end:d,loop:f,style:g}=iL(n,t,e),_=[];let b=!1,v=null,A,C,O;const k=()=>l(i,O,A)&&a(i,O)!==0,D=()=>a(r,A)===0||l(r,O,A),N=()=>b||k(),w=()=>!b||D();for(let y=h,x=h;y<=d;++y)C=t[y%o],!C.skip&&(A=c(C[s]),A!==O&&(b=l(A,i,r),v===null&&N()&&(v=a(A,i)===0?y:x),v!==null&&w()&&(_.push(P_({start:v,end:y,loop:f,count:o,style:g})),v=null),x=y,O=A));return v!==null&&_.push(P_({start:v,end:d,loop:f,count:o,style:g})),_}function Kw(n,t){const e=[],s=n.segments;for(let i=0;i<s.length;i++){const r=Gw(s[i],n.points,t);r.length&&e.push(...r)}return e}function rL(n,t,e,s){let i=0,r=t-1;if(e&&!s)for(;i<t&&!n[i].skip;)i++;for(;i<t&&n[i].skip;)i++;for(i%=t,e&&(r+=i);r>i&&n[r%t].skip;)r--;return r%=t,{start:i,end:r}}function oL(n,t,e,s){const i=n.length,r=[];let o=t,a=n[t],l;for(l=t+1;l<=e;++l){const c=n[l%i];c.skip||c.stop?a.skip||(s=!1,r.push({start:t%i,end:(l-1)%i,loop:s}),t=o=c.stop?l:null):(o=l,a.skip&&(t=l)),a=c}return o!==null&&r.push({start:t%i,end:o%i,loop:s}),r}function aL(n,t){const e=n.points,s=n.options.spanGaps,i=e.length;if(!i)return[];const r=!!n._loop,{start:o,end:a}=rL(e,i,r,s);if(s===!0)return R_(n,[{start:o,end:a,loop:r}],e,t);const l=a<o?a+i:a,c=!!n._fullLoop&&o===0&&a===i-1;return R_(n,oL(e,o,l,c),e,t)}function R_(n,t,e,s){return!s||!s.setContext||!e?t:lL(n,t,e,s)}function lL(n,t,e,s){const i=n._chart.getContext(),r=k_(n.options),{_datasetIndex:o,options:{spanGaps:a}}=n,l=e.length,c=[];let h=r,d=t[0].start,f=d;function g(_,b,v,A){const C=a?-1:1;if(_!==b){for(_+=l;e[_%l].skip;)_-=C;for(;e[b%l].skip;)b+=C;_%l!==b%l&&(c.push({start:_%l,end:b%l,loop:v,style:A}),h=A,d=b%l)}}for(const _ of t){d=a?d:_.start;let b=e[d%l],v;for(f=d+1;f<=_.end;f++){const A=e[f%l];v=k_(s.setContext(di(i,{type:"segment",p0:b,p1:A,p0DataIndex:(f-1)%l,p1DataIndex:f%l,datasetIndex:o}))),cL(v,h)&&g(d,f-1,_.loop,h),b=A,h=v}d<f-1&&g(d,f-1,_.loop,h)}return c}function k_(n){return{backgroundColor:n.backgroundColor,borderCapStyle:n.borderCapStyle,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderJoinStyle:n.borderJoinStyle,borderWidth:n.borderWidth,borderColor:n.borderColor}}function cL(n,t){if(!t)return!1;const e=[],s=function(i,r){return Jf(r)?(e.includes(r)||e.push(r),e.indexOf(r)):r};return JSON.stringify(n,s)!==JSON.stringify(t,s)}function ul(n,t,e){return n.options.clip?n[e]:t[e]}function uL(n,t){const{xScale:e,yScale:s}=n;return e&&s?{left:ul(e,t,"left"),right:ul(e,t,"right"),top:ul(s,t,"top"),bottom:ul(s,t,"bottom")}:t}function Yw(n,t){const e=t._clip;if(e.disabled)return!1;const s=uL(t,n.chartArea);return{left:e.left===!1?0:s.left-(e.left===!0?0:e.left),right:e.right===!1?n.width:s.right+(e.right===!0?0:e.right),top:e.top===!1?0:s.top-(e.top===!0?0:e.top),bottom:e.bottom===!1?n.height:s.bottom+(e.bottom===!0?0:e.bottom)}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class hL{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,e,s,i){const r=e.listeners[i],o=e.duration;r.forEach(a=>a({chart:t,initial:e.initial,numSteps:o,currentStep:Math.min(s-e.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=kw.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(t=Date.now()){let e=0;this._charts.forEach((s,i)=>{if(!s.running||!s.items.length)return;const r=s.items;let o=r.length-1,a=!1,l;for(;o>=0;--o)l=r[o],l._active?(l._total>s.duration&&(s.duration=l._total),l.tick(t),a=!0):(r[o]=r[r.length-1],r.pop());a&&(i.draw(),this._notify(i,s,t,"progress")),r.length||(s.running=!1,this._notify(i,s,t,"complete"),s.initial=!1),e+=r.length}),this._lastDate=t,e===0&&(this._running=!1)}_getAnims(t){const e=this._charts;let s=e.get(t);return s||(s={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},e.set(t,s)),s}listen(t,e,s){this._getAnims(t).listeners[e].push(s)}add(t,e){!e||!e.length||this._getAnims(t).items.push(...e)}has(t){return this._getAnims(t).items.length>0}start(t){const e=this._charts.get(t);e&&(e.running=!0,e.start=Date.now(),e.duration=e.items.reduce((s,i)=>Math.max(s,i._duration),0),this._refresh())}running(t){if(!this._running)return!1;const e=this._charts.get(t);return!(!e||!e.running||!e.items.length)}stop(t){const e=this._charts.get(t);if(!e||!e.items.length)return;const s=e.items;let i=s.length-1;for(;i>=0;--i)s[i].cancel();e.items=[],this._notify(t,e,Date.now(),"complete")}remove(t){return this._charts.delete(t)}}var es=new hL;const D_="transparent",dL={boolean(n,t,e){return e>.5?t:n},color(n,t,e){const s=x_(n||D_),i=s.valid&&x_(t||D_);return i&&i.valid?i.mix(s,e).hexString():t},number(n,t,e){return n+(t-n)*e}};class fL{constructor(t,e,s,i){const r=e[s];i=bo([t.to,i,r,t.from]);const o=bo([t.from,r,i]);this._active=!0,this._fn=t.fn||dL[t.type||typeof o],this._easing=Uo[t.easing]||Uo.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=e,this._prop=s,this._from=o,this._to=i,this._promises=void 0}active(){return this._active}update(t,e,s){if(this._active){this._notify(!1);const i=this._target[this._prop],r=s-this._start,o=this._duration-r;this._start=s,this._duration=Math.floor(Math.max(o,t.duration)),this._total+=r,this._loop=!!t.loop,this._to=bo([t.to,e,i,t.from]),this._from=bo([t.from,i,e])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const e=t-this._start,s=this._duration,i=this._prop,r=this._from,o=this._loop,a=this._to;let l;if(this._active=r!==a&&(o||e<s),!this._active){this._target[i]=a,this._notify(!0);return}if(e<0){this._target[i]=r;return}l=e/s%2,l=o&&l>1?2-l:l,l=this._easing(Math.min(1,Math.max(0,l))),this._target[i]=this._fn(r,a,l)}wait(){const t=this._promises||(this._promises=[]);return new Promise((e,s)=>{t.push({res:e,rej:s})})}_notify(t){const e=t?"res":"rej",s=this._promises||[];for(let i=0;i<s.length;i++)s[i][e]()}}class Xw{constructor(t,e){this._chart=t,this._properties=new Map,this.configure(e)}configure(t){if(!Dt(t))return;const e=Object.keys(te.animation),s=this._properties;Object.getOwnPropertyNames(t).forEach(i=>{const r=t[i];if(!Dt(r))return;const o={};for(const a of e)o[a]=r[a];(Zt(r.properties)&&r.properties||[i]).forEach(a=>{(a===i||!s.has(a))&&s.set(a,o)})})}_animateOptions(t,e){const s=e.options,i=gL(t,s);if(!i)return[];const r=this._createAnimations(i,s);return s.$shared&&pL(t.options.$animations,s).then(()=>{t.options=s},()=>{}),r}_createAnimations(t,e){const s=this._properties,i=[],r=t.$animations||(t.$animations={}),o=Object.keys(e),a=Date.now();let l;for(l=o.length-1;l>=0;--l){const c=o[l];if(c.charAt(0)==="$")continue;if(c==="options"){i.push(...this._animateOptions(t,e));continue}const h=e[c];let d=r[c];const f=s.get(c);if(d)if(f&&d.active()){d.update(f,h,a);continue}else d.cancel();if(!f||!f.duration){t[c]=h;continue}r[c]=d=new fL(f,t,c,h),i.push(d)}return i}update(t,e){if(this._properties.size===0){Object.assign(t,e);return}const s=this._createAnimations(t,e);if(s.length)return es.add(this._chart,s),!0}}function pL(n,t){const e=[],s=Object.keys(t);for(let i=0;i<s.length;i++){const r=n[s[i]];r&&r.active()&&e.push(r.wait())}return Promise.all(e)}function gL(n,t){if(!t)return;let e=n.options;if(!e){n.options=t;return}return e.$shared&&(n.options=e=Object.assign({},e,{$shared:!1,$animations:{}})),e}function M_(n,t){const e=n&&n.options||{},s=e.reverse,i=e.min===void 0?t:0,r=e.max===void 0?t:0;return{start:s?r:i,end:s?i:r}}function mL(n,t,e){if(e===!1)return!1;const s=M_(n,e),i=M_(t,e);return{top:i.end,right:s.end,bottom:i.start,left:s.start}}function _L(n){let t,e,s,i;return Dt(n)?(t=n.top,e=n.right,s=n.bottom,i=n.left):t=e=s=i=n,{top:t,right:e,bottom:s,left:i,disabled:n===!1}}function Qw(n,t){const e=[],s=n._getSortedDatasetMetas(t);let i,r;for(i=0,r=s.length;i<r;++i)e.push(s[i].index);return e}function O_(n,t,e,s={}){const i=n.keys,r=s.mode==="single";let o,a,l,c;if(t===null)return;let h=!1;for(o=0,a=i.length;o<a;++o){if(l=+i[o],l===e){if(h=!0,s.all)continue;break}c=n.values[l],re(c)&&(r||t===0||jn(t)===jn(c))&&(t+=c)}return!h&&!s.all?0:t}function yL(n,t){const{iScale:e,vScale:s}=t,i=e.axis==="x"?"x":"y",r=s.axis==="x"?"x":"y",o=Object.keys(n),a=new Array(o.length);let l,c,h;for(l=0,c=o.length;l<c;++l)h=o[l],a[l]={[i]:h,[r]:n[h]};return a}function ah(n,t){const e=n&&n.options.stacked;return e||e===void 0&&t.stack!==void 0}function bL(n,t,e){return`${n.id}.${t.id}.${e.stack||e.type}`}function vL(n){const{min:t,max:e,minDefined:s,maxDefined:i}=n.getUserBounds();return{min:s?t:Number.NEGATIVE_INFINITY,max:i?e:Number.POSITIVE_INFINITY}}function wL(n,t,e){const s=n[t]||(n[t]={});return s[e]||(s[e]={})}function L_(n,t,e,s){for(const i of t.getMatchingVisibleMetas(s).reverse()){const r=n[i.index];if(e&&r>0||!e&&r<0)return i.index}return null}function V_(n,t){const{chart:e,_cachedMeta:s}=n,i=e._stacks||(e._stacks={}),{iScale:r,vScale:o,index:a}=s,l=r.axis,c=o.axis,h=bL(r,o,s),d=t.length;let f;for(let g=0;g<d;++g){const _=t[g],{[l]:b,[c]:v}=_,A=_._stacks||(_._stacks={});f=A[c]=wL(i,h,b),f[a]=v,f._top=L_(f,o,!0,s.type),f._bottom=L_(f,o,!1,s.type);const C=f._visualValues||(f._visualValues={});C[a]=v}}function lh(n,t){const e=n.scales;return Object.keys(e).filter(s=>e[s].axis===t).shift()}function xL(n,t){return di(n,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}function TL(n,t,e){return di(n,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:e,index:t,mode:"default",type:"data"})}function ao(n,t){const e=n.controller.index,s=n.vScale&&n.vScale.axis;if(s){t=t||n._parsed;for(const i of t){const r=i._stacks;if(!r||r[s]===void 0||r[s][e]===void 0)return;delete r[s][e],r[s]._visualValues!==void 0&&r[s]._visualValues[e]!==void 0&&delete r[s]._visualValues[e]}}}const ch=n=>n==="reset"||n==="none",N_=(n,t)=>t?n:Object.assign({},n),EL=(n,t,e)=>n&&!t.hidden&&t._stacked&&{keys:Qw(e,!0),values:null};class fi{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(t,e){this.chart=t,this._ctx=t.ctx,this.index=e,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=ah(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&ao(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,e=this._cachedMeta,s=this.getDataset(),i=(d,f,g,_)=>d==="x"?f:d==="r"?_:g,r=e.xAxisID=wt(s.xAxisID,lh(t,"x")),o=e.yAxisID=wt(s.yAxisID,lh(t,"y")),a=e.rAxisID=wt(s.rAxisID,lh(t,"r")),l=e.indexAxis,c=e.iAxisID=i(l,r,o,a),h=e.vAxisID=i(l,o,r,a);e.xScale=this.getScaleForId(r),e.yScale=this.getScaleForId(o),e.rScale=this.getScaleForId(a),e.iScale=this.getScaleForId(c),e.vScale=this.getScaleForId(h)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const e=this._cachedMeta;return t===e.iScale?e.vScale:e.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&b_(this._data,this),t._stacked&&ao(t)}_dataCheck(){const t=this.getDataset(),e=t.data||(t.data=[]),s=this._data;if(Dt(e)){const i=this._cachedMeta;this._data=yL(e,i)}else if(s!==e){if(s){b_(s,this);const i=this._cachedMeta;ao(i),i._parsed=[]}e&&Object.isExtensible(e)&&lO(e,this),this._syncList=[],this._data=e}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const e=this._cachedMeta,s=this.getDataset();let i=!1;this._dataCheck();const r=e._stacked;e._stacked=ah(e.vScale,e),e.stack!==s.stack&&(i=!0,ao(e),e.stack=s.stack),this._resyncElements(t),(i||r!==e._stacked)&&(V_(this,e._parsed),e._stacked=ah(e.vScale,e))}configure(){const t=this.chart.config,e=t.datasetScopeKeys(this._type),s=t.getOptionScopes(this.getDataset(),e,!0);this.options=t.createResolver(s,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,e){const{_cachedMeta:s,_data:i}=this,{iScale:r,_stacked:o}=s,a=r.axis;let l=t===0&&e===i.length?!0:s._sorted,c=t>0&&s._parsed[t-1],h,d,f;if(this._parsing===!1)s._parsed=i,s._sorted=!0,f=i;else{Zt(i[t])?f=this.parseArrayData(s,i,t,e):Dt(i[t])?f=this.parseObjectData(s,i,t,e):f=this.parsePrimitiveData(s,i,t,e);const g=()=>d[a]===null||c&&d[a]<c[a];for(h=0;h<e;++h)s._parsed[h+t]=d=f[h],l&&(g()&&(l=!1),c=d);s._sorted=l}o&&V_(this,f)}parsePrimitiveData(t,e,s,i){const{iScale:r,vScale:o}=t,a=r.axis,l=o.axis,c=r.getLabels(),h=r===o,d=new Array(i);let f,g,_;for(f=0,g=i;f<g;++f)_=f+s,d[f]={[a]:h||r.parse(c[_],_),[l]:o.parse(e[_],_)};return d}parseArrayData(t,e,s,i){const{xScale:r,yScale:o}=t,a=new Array(i);let l,c,h,d;for(l=0,c=i;l<c;++l)h=l+s,d=e[h],a[l]={x:r.parse(d[0],h),y:o.parse(d[1],h)};return a}parseObjectData(t,e,s,i){const{xScale:r,yScale:o}=t,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,c=new Array(i);let h,d,f,g;for(h=0,d=i;h<d;++h)f=h+s,g=e[f],c[h]={x:r.parse(ai(g,a),f),y:o.parse(ai(g,l),f)};return c}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,e,s){const i=this.chart,r=this._cachedMeta,o=e[t.axis],a={keys:Qw(i,!0),values:e._stacks[t.axis]._visualValues};return O_(a,o,r.index,{mode:s})}updateRangeFromParsed(t,e,s,i){const r=s[e.axis];let o=r===null?NaN:r;const a=i&&s._stacks[e.axis];i&&a&&(i.values=a,o=O_(i,r,this._cachedMeta.index)),t.min=Math.min(t.min,o),t.max=Math.max(t.max,o)}getMinMax(t,e){const s=this._cachedMeta,i=s._parsed,r=s._sorted&&t===s.iScale,o=i.length,a=this._getOtherScale(t),l=EL(e,s,this.chart),c={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:h,max:d}=vL(a);let f,g;function _(){g=i[f];const b=g[a.axis];return!re(g[t.axis])||h>b||d<b}for(f=0;f<o&&!(!_()&&(this.updateRangeFromParsed(c,t,g,l),r));++f);if(r){for(f=o-1;f>=0;--f)if(!_()){this.updateRangeFromParsed(c,t,g,l);break}}return c}getAllParsedValues(t){const e=this._cachedMeta._parsed,s=[];let i,r,o;for(i=0,r=e.length;i<r;++i)o=e[i][t.axis],re(o)&&s.push(o);return s}getMaxOverflow(){return!1}getLabelAndValue(t){const e=this._cachedMeta,s=e.iScale,i=e.vScale,r=this.getParsed(t);return{label:s?""+s.getLabelForValue(r[s.axis]):"",value:i?""+i.getLabelForValue(r[i.axis]):""}}_update(t){const e=this._cachedMeta;this.update(t||"default"),e._clip=_L(wt(this.options.clip,mL(e.xScale,e.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,e=this.chart,s=this._cachedMeta,i=s.data||[],r=e.chartArea,o=[],a=this._drawStart||0,l=this._drawCount||i.length-a,c=this.options.drawActiveElementsOnTop;let h;for(s.dataset&&s.dataset.draw(t,r,a,l),h=a;h<a+l;++h){const d=i[h];d.hidden||(d.active&&c?o.push(d):d.draw(t,r))}for(h=0;h<o.length;++h)o[h].draw(t,r)}getStyle(t,e){const s=e?"active":"default";return t===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(s):this.resolveDataElementOptions(t||0,s)}getContext(t,e,s){const i=this.getDataset();let r;if(t>=0&&t<this._cachedMeta.data.length){const o=this._cachedMeta.data[t];r=o.$context||(o.$context=TL(this.getContext(),t,o)),r.parsed=this.getParsed(t),r.raw=i.data[t],r.index=r.dataIndex=t}else r=this.$context||(this.$context=xL(this.chart.getContext(),this.index)),r.dataset=i,r.index=r.datasetIndex=this.index;return r.active=!!e,r.mode=s,r}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,e){return this._resolveElementOptions(this.dataElementType.id,e,t)}_resolveElementOptions(t,e="default",s){const i=e==="active",r=this._cachedDataOpts,o=t+"-"+e,a=r[o],l=this.enableOptionSharing&&aa(s);if(a)return N_(a,l);const c=this.chart.config,h=c.datasetElementScopeKeys(this._type,t),d=i?[`${t}Hover`,"hover",t,""]:[t,""],f=c.getOptionScopes(this.getDataset(),h),g=Object.keys(te.elements[t]),_=()=>this.getContext(s,i,e),b=c.resolveNamedOptions(f,g,_,d);return b.$shared&&(b.$shared=l,r[o]=Object.freeze(N_(b,l))),b}_resolveAnimations(t,e,s){const i=this.chart,r=this._cachedDataOpts,o=`animation-${e}`,a=r[o];if(a)return a;let l;if(i.options.animation!==!1){const h=this.chart.config,d=h.datasetAnimationScopeKeys(this._type,e),f=h.getOptionScopes(this.getDataset(),d);l=h.createResolver(f,this.getContext(t,s,e))}const c=new Xw(i,l&&l.animations);return l&&l._cacheable&&(r[o]=Object.freeze(c)),c}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,e){return!e||ch(t)||this.chart._animationsDisabled}_getSharedOptions(t,e){const s=this.resolveDataElementOptions(t,e),i=this._sharedOptions,r=this.getSharedOptions(s),o=this.includeOptions(e,r)||r!==i;return this.updateSharedOptions(r,e,s),{sharedOptions:r,includeOptions:o}}updateElement(t,e,s,i){ch(i)?Object.assign(t,s):this._resolveAnimations(e,i).update(t,s)}updateSharedOptions(t,e,s){t&&!ch(e)&&this._resolveAnimations(void 0,e).update(t,s)}_setStyle(t,e,s,i){t.active=i;const r=this.getStyle(e,i);this._resolveAnimations(e,s,i).update(t,{options:!i&&this.getSharedOptions(r)||r})}removeHoverStyle(t,e,s){this._setStyle(t,s,"active",!1)}setHoverStyle(t,e,s){this._setStyle(t,s,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const e=this._data,s=this._cachedMeta.data;for(const[a,l,c]of this._syncList)this[a](l,c);this._syncList=[];const i=s.length,r=e.length,o=Math.min(r,i);o&&this.parse(0,o),r>i?this._insertElements(i,r-i,t):r<i&&this._removeElements(r,i-r)}_insertElements(t,e,s=!0){const i=this._cachedMeta,r=i.data,o=t+e;let a;const l=c=>{for(c.length+=e,a=c.length-1;a>=o;a--)c[a]=c[a-e]};for(l(r),a=t;a<o;++a)r[a]=new this.dataElementType;this._parsing&&l(i._parsed),this.parse(t,e),s&&this.updateElements(r,t,e,"reset")}updateElements(t,e,s,i){}_removeElements(t,e){const s=this._cachedMeta;if(this._parsing){const i=s._parsed.splice(t,e);s._stacked&&ao(s,i)}s.data.splice(t,e)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[e,s,i]=t;this[e](s,i)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,e){e&&this._sync(["_removeElements",t,e]);const s=arguments.length-2;s&&this._sync(["_insertElements",t,s])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function IL(n,t){if(!n._cache.$bar){const e=n.getMatchingVisibleMetas(t);let s=[];for(let i=0,r=e.length;i<r;i++)s=s.concat(e[i].controller.getAllParsedValues(n));n._cache.$bar=Rw(s.sort((i,r)=>i-r))}return n._cache.$bar}function SL(n){const t=n.iScale,e=IL(t,n.type);let s=t._length,i,r,o,a;const l=()=>{o===32767||o===-32768||(aa(a)&&(s=Math.min(s,Math.abs(o-a)||s)),a=o)};for(i=0,r=e.length;i<r;++i)o=t.getPixelForValue(e[i]),l();for(a=void 0,i=0,r=t.ticks.length;i<r;++i)o=t.getPixelForTick(i),l();return s}function AL(n,t,e,s){const i=e.barThickness;let r,o;return Ct(i)?(r=t.min*e.categoryPercentage,o=e.barPercentage):(r=i*s,o=1),{chunk:r/s,ratio:o,start:t.pixels[n]-r/2}}function CL(n,t,e,s){const i=t.pixels,r=i[n];let o=n>0?i[n-1]:null,a=n<i.length-1?i[n+1]:null;const l=e.categoryPercentage;o===null&&(o=r-(a===null?t.end-t.start:a-r)),a===null&&(a=r+r-o);const c=r-(r-Math.min(o,a))/2*l;return{chunk:Math.abs(a-o)/2*l/s,ratio:e.barPercentage,start:c}}function PL(n,t,e,s){const i=e.parse(n[0],s),r=e.parse(n[1],s),o=Math.min(i,r),a=Math.max(i,r);let l=o,c=a;Math.abs(o)>Math.abs(a)&&(l=a,c=o),t[e.axis]=c,t._custom={barStart:l,barEnd:c,start:i,end:r,min:o,max:a}}function Jw(n,t,e,s){return Zt(n)?PL(n,t,e,s):t[e.axis]=e.parse(n,s),t}function F_(n,t,e,s){const i=n.iScale,r=n.vScale,o=i.getLabels(),a=i===r,l=[];let c,h,d,f;for(c=e,h=e+s;c<h;++c)f=t[c],d={},d[i.axis]=a||i.parse(o[c],c),l.push(Jw(f,d,r,c));return l}function uh(n){return n&&n.barStart!==void 0&&n.barEnd!==void 0}function RL(n,t,e){return n!==0?jn(n):(t.isHorizontal()?1:-1)*(t.min>=e?1:-1)}function kL(n){let t,e,s,i,r;return n.horizontal?(t=n.base>n.x,e="left",s="right"):(t=n.base<n.y,e="bottom",s="top"),t?(i="end",r="start"):(i="start",r="end"),{start:e,end:s,reverse:t,top:i,bottom:r}}function DL(n,t,e,s){let i=t.borderSkipped;const r={};if(!i){n.borderSkipped=r;return}if(i===!0){n.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:a,reverse:l,top:c,bottom:h}=kL(n);i==="middle"&&e&&(n.enableBorderRadius=!0,(e._top||0)===s?i=c:(e._bottom||0)===s?i=h:(r[B_(h,o,a,l)]=!0,i=c)),r[B_(i,o,a,l)]=!0,n.borderSkipped=r}function B_(n,t,e,s){return s?(n=ML(n,t,e),n=U_(n,e,t)):n=U_(n,t,e),n}function ML(n,t,e){return n===t?e:n===e?t:n}function U_(n,t,e){return n==="start"?t:n==="end"?e:n}function OL(n,{inflateAmount:t},e){n.inflateAmount=t==="auto"?e===1?.33:0:t}class LL extends fi{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(t,e,s,i){return F_(t,e,s,i)}parseArrayData(t,e,s,i){return F_(t,e,s,i)}parseObjectData(t,e,s,i){const{iScale:r,vScale:o}=t,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,c=r.axis==="x"?a:l,h=o.axis==="x"?a:l,d=[];let f,g,_,b;for(f=s,g=s+i;f<g;++f)b=e[f],_={},_[r.axis]=r.parse(ai(b,c),f),d.push(Jw(ai(b,h),_,o,f));return d}updateRangeFromParsed(t,e,s,i){super.updateRangeFromParsed(t,e,s,i);const r=s._custom;r&&e===this._cachedMeta.vScale&&(t.min=Math.min(t.min,r.min),t.max=Math.max(t.max,r.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const e=this._cachedMeta,{iScale:s,vScale:i}=e,r=this.getParsed(t),o=r._custom,a=uh(o)?"["+o.start+", "+o.end+"]":""+i.getLabelForValue(r[i.axis]);return{label:""+s.getLabelForValue(r[s.axis]),value:a}}initialize(){this.enableOptionSharing=!0,super.initialize();const t=this._cachedMeta;t.stack=this.getDataset().stack}update(t){const e=this._cachedMeta;this.updateElements(e.data,0,e.data.length,t)}updateElements(t,e,s,i){const r=i==="reset",{index:o,_cachedMeta:{vScale:a}}=this,l=a.getBasePixel(),c=a.isHorizontal(),h=this._getRuler(),{sharedOptions:d,includeOptions:f}=this._getSharedOptions(e,i);for(let g=e;g<e+s;g++){const _=this.getParsed(g),b=r||Ct(_[a.axis])?{base:l,head:l}:this._calculateBarValuePixels(g),v=this._calculateBarIndexPixels(g,h),A=(_._stacks||{})[a.axis],C={horizontal:c,base:b.base,enableBorderRadius:!A||uh(_._custom)||o===A._top||o===A._bottom,x:c?b.head:v.center,y:c?v.center:b.head,height:c?v.size:Math.abs(b.size),width:c?Math.abs(b.size):v.size};f&&(C.options=d||this.resolveDataElementOptions(g,t[g].active?"active":i));const O=C.options||t[g].options;DL(C,O,A,o),OL(C,O,h.ratio),this.updateElement(t[g],g,C,i)}}_getStacks(t,e){const{iScale:s}=this._cachedMeta,i=s.getMatchingVisibleMetas(this._type).filter(h=>h.controller.options.grouped),r=s.options.stacked,o=[],a=this._cachedMeta.controller.getParsed(e),l=a&&a[s.axis],c=h=>{const d=h._parsed.find(g=>g[s.axis]===l),f=d&&d[h.vScale.axis];if(Ct(f)||isNaN(f))return!0};for(const h of i)if(!(e!==void 0&&c(h))&&((r===!1||o.indexOf(h.stack)===-1||r===void 0&&h.stack===void 0)&&o.push(h.stack),h.index===t))break;return o.length||o.push(void 0),o}_getStackCount(t){return this._getStacks(void 0,t).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const t=this.chart.scales,e=this.chart.options.indexAxis;return Object.keys(t).filter(s=>t[s].axis===e).shift()}_getAxis(){const t={},e=this.getFirstScaleIdForIndexAxis();for(const s of this.chart.data.datasets)t[wt(this.chart.options.indexAxis==="x"?s.xAxisID:s.yAxisID,e)]=!0;return Object.keys(t)}_getStackIndex(t,e,s){const i=this._getStacks(t,s),r=e!==void 0?i.indexOf(e):-1;return r===-1?i.length-1:r}_getRuler(){const t=this.options,e=this._cachedMeta,s=e.iScale,i=[];let r,o;for(r=0,o=e.data.length;r<o;++r)i.push(s.getPixelForValue(this.getParsed(r)[s.axis],r));const a=t.barThickness;return{min:a||SL(e),pixels:i,start:s._startPixel,end:s._endPixel,stackCount:this._getStackCount(),scale:s,grouped:t.grouped,ratio:a?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:e,_stacked:s,index:i},options:{base:r,minBarLength:o}}=this,a=r||0,l=this.getParsed(t),c=l._custom,h=uh(c);let d=l[e.axis],f=0,g=s?this.applyStack(e,l,s):d,_,b;g!==d&&(f=g-d,g=d),h&&(d=c.barStart,g=c.barEnd-c.barStart,d!==0&&jn(d)!==jn(c.barEnd)&&(f=0),f+=d);const v=!Ct(r)&&!h?r:f;let A=e.getPixelForValue(v);if(this.chart.getDataVisibility(t)?_=e.getPixelForValue(f+g):_=A,b=_-A,Math.abs(b)<o){b=RL(b,e,a)*o,d===a&&(A-=b/2);const C=e.getPixelForDecimal(0),O=e.getPixelForDecimal(1),k=Math.min(C,O),D=Math.max(C,O);A=Math.max(Math.min(A,D),k),_=A+b,s&&!h&&(l._stacks[e.axis]._visualValues[i]=e.getValueForPixel(_)-e.getValueForPixel(A))}if(A===e.getPixelForValue(a)){const C=jn(b)*e.getLineWidthForValue(a)/2;A+=C,b-=C}return{size:b,base:A,head:_,center:_+b/2}}_calculateBarIndexPixels(t,e){const s=e.scale,i=this.options,r=i.skipNull,o=wt(i.maxBarThickness,1/0);let a,l;const c=this._getAxisCount();if(e.grouped){const h=r?this._getStackCount(t):e.stackCount,d=i.barThickness==="flex"?CL(t,e,i,h*c):AL(t,e,i,h*c),f=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,g=this._getAxis().indexOf(wt(f,this.getFirstScaleIdForIndexAxis())),_=this._getStackIndex(this.index,this._cachedMeta.stack,r?t:void 0)+g;a=d.start+d.chunk*_+d.chunk/2,l=Math.min(o,d.chunk*d.ratio)}else a=s.getPixelForValue(this.getParsed(t)[s.axis],t),l=Math.min(o,e.min*e.ratio);return{base:a-l/2,head:a+l/2,center:a,size:l}}draw(){const t=this._cachedMeta,e=t.vScale,s=t.data,i=s.length;let r=0;for(;r<i;++r)this.getParsed(r)[e.axis]!==null&&!s[r].hidden&&s[r].draw(this._ctx)}}class VL extends fi{static id="bubble";static defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}};static overrides={scales:{x:{type:"linear"},y:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(t,e,s,i){const r=super.parsePrimitiveData(t,e,s,i);for(let o=0;o<r.length;o++)r[o]._custom=this.resolveDataElementOptions(o+s).radius;return r}parseArrayData(t,e,s,i){const r=super.parseArrayData(t,e,s,i);for(let o=0;o<r.length;o++){const a=e[s+o];r[o]._custom=wt(a[2],this.resolveDataElementOptions(o+s).radius)}return r}parseObjectData(t,e,s,i){const r=super.parseObjectData(t,e,s,i);for(let o=0;o<r.length;o++){const a=e[s+o];r[o]._custom=wt(a&&a.r&&+a.r,this.resolveDataElementOptions(o+s).radius)}return r}getMaxOverflow(){const t=this._cachedMeta.data;let e=0;for(let s=t.length-1;s>=0;--s)e=Math.max(e,t[s].size(this.resolveDataElementOptions(s))/2);return e>0&&e}getLabelAndValue(t){const e=this._cachedMeta,s=this.chart.data.labels||[],{xScale:i,yScale:r}=e,o=this.getParsed(t),a=i.getLabelForValue(o.x),l=r.getLabelForValue(o.y),c=o._custom;return{label:s[t]||"",value:"("+a+", "+l+(c?", "+c:"")+")"}}update(t){const e=this._cachedMeta.data;this.updateElements(e,0,e.length,t)}updateElements(t,e,s,i){const r=i==="reset",{iScale:o,vScale:a}=this._cachedMeta,{sharedOptions:l,includeOptions:c}=this._getSharedOptions(e,i),h=o.axis,d=a.axis;for(let f=e;f<e+s;f++){const g=t[f],_=!r&&this.getParsed(f),b={},v=b[h]=r?o.getPixelForDecimal(.5):o.getPixelForValue(_[h]),A=b[d]=r?a.getBasePixel():a.getPixelForValue(_[d]);b.skip=isNaN(v)||isNaN(A),c&&(b.options=l||this.resolveDataElementOptions(f,g.active?"active":i),r&&(b.options.radius=0)),this.updateElement(g,f,b,i)}}resolveDataElementOptions(t,e){const s=this.getParsed(t);let i=super.resolveDataElementOptions(t,e);i.$shared&&(i=Object.assign({},i,{$shared:!1}));const r=i.radius;return e!=="active"&&(i.radius=0),i.radius+=wt(s&&s._custom,r),i}}function NL(n,t,e){let s=1,i=1,r=0,o=0;if(t<Jt){const a=n,l=a+t,c=Math.cos(a),h=Math.sin(a),d=Math.cos(l),f=Math.sin(l),g=(O,k,D)=>la(O,a,l,!0)?1:Math.max(k,k*e,D,D*e),_=(O,k,D)=>la(O,a,l,!0)?-1:Math.min(k,k*e,D,D*e),b=g(0,c,d),v=g(le,h,f),A=_(Vt,c,d),C=_(Vt+le,h,f);s=(b-A)/2,i=(v-C)/2,r=-(b+A)/2,o=-(v+C)/2}return{ratioX:s,ratioY:i,offsetX:r,offsetY:o}}class rp extends fi{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:t=>t!=="spacing",_indexable:t=>t!=="spacing"&&!t.startsWith("borderDash")&&!t.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data,{labels:{pointStyle:s,textAlign:i,color:r,useBorderRadius:o,borderRadius:a}}=t.legend.options;return e.labels.length&&e.datasets.length?e.labels.map((l,c)=>{const d=t.getDatasetMeta(0).controller.getStyle(c);return{text:l,fillStyle:d.backgroundColor,fontColor:r,hidden:!t.getDataVisibility(c),lineDash:d.borderDash,lineDashOffset:d.borderDashOffset,lineJoin:d.borderJoinStyle,lineWidth:d.borderWidth,strokeStyle:d.borderColor,textAlign:i,pointStyle:s,borderRadius:o&&(a||d.borderRadius),index:c}}):[]}},onClick(t,e,s){s.chart.toggleDataVisibility(e.index),s.chart.update()}}}};constructor(t,e){super(t,e),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,e){const s=this.getDataset().data,i=this._cachedMeta;if(this._parsing===!1)i._parsed=s;else{let r=l=>+s[l];if(Dt(s[t])){const{key:l="value"}=this._parsing;r=c=>+ai(s[c],l)}let o,a;for(o=t,a=t+e;o<a;++o)i._parsed[o]=r(o)}}_getRotation(){return xn(this.options.rotation-90)}_getCircumference(){return xn(this.options.circumference)}_getRotationExtents(){let t=Jt,e=-Jt;for(let s=0;s<this.chart.data.datasets.length;++s)if(this.chart.isDatasetVisible(s)&&this.chart.getDatasetMeta(s).type===this._type){const i=this.chart.getDatasetMeta(s).controller,r=i._getRotation(),o=i._getCircumference();t=Math.min(t,r),e=Math.max(e,r+o)}return{rotation:t,circumference:e-t}}update(t){const e=this.chart,{chartArea:s}=e,i=this._cachedMeta,r=i.data,o=this.getMaxBorderWidth()+this.getMaxOffset(r)+this.options.spacing,a=Math.max((Math.min(s.width,s.height)-o)/2,0),l=Math.min(G2(this.options.cutout,a),1),c=this._getRingWeight(this.index),{circumference:h,rotation:d}=this._getRotationExtents(),{ratioX:f,ratioY:g,offsetX:_,offsetY:b}=NL(d,h,l),v=(s.width-o)/f,A=(s.height-o)/g,C=Math.max(Math.min(v,A)/2,0),O=Iw(this.options.radius,C),k=Math.max(O*l,0),D=(O-k)/this._getVisibleDatasetWeightTotal();this.offsetX=_*O,this.offsetY=b*O,i.total=this.calculateTotal(),this.outerRadius=O-D*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-D*c,0),this.updateElements(r,0,r.length,t)}_circumference(t,e){const s=this.options,i=this._cachedMeta,r=this._getCircumference();return e&&s.animation.animateRotate||!this.chart.getDataVisibility(t)||i._parsed[t]===null||i.data[t].hidden?0:this.calculateCircumference(i._parsed[t]*r/Jt)}updateElements(t,e,s,i){const r=i==="reset",o=this.chart,a=o.chartArea,c=o.options.animation,h=(a.left+a.right)/2,d=(a.top+a.bottom)/2,f=r&&c.animateScale,g=f?0:this.innerRadius,_=f?0:this.outerRadius,{sharedOptions:b,includeOptions:v}=this._getSharedOptions(e,i);let A=this._getRotation(),C;for(C=0;C<e;++C)A+=this._circumference(C,r);for(C=e;C<e+s;++C){const O=this._circumference(C,r),k=t[C],D={x:h+this.offsetX,y:d+this.offsetY,startAngle:A,endAngle:A+O,circumference:O,outerRadius:_,innerRadius:g};v&&(D.options=b||this.resolveDataElementOptions(C,k.active?"active":i)),A+=O,this.updateElement(k,C,D,i)}}calculateTotal(){const t=this._cachedMeta,e=t.data;let s=0,i;for(i=0;i<e.length;i++){const r=t._parsed[i];r!==null&&!isNaN(r)&&this.chart.getDataVisibility(i)&&!e[i].hidden&&(s+=Math.abs(r))}return s}calculateCircumference(t){const e=this._cachedMeta.total;return e>0&&!isNaN(t)?Jt*(Math.abs(t)/e):0}getLabelAndValue(t){const e=this._cachedMeta,s=this.chart,i=s.data.labels||[],r=ka(e._parsed[t],s.options.locale);return{label:i[t]||"",value:r}}getMaxBorderWidth(t){let e=0;const s=this.chart;let i,r,o,a,l;if(!t){for(i=0,r=s.data.datasets.length;i<r;++i)if(s.isDatasetVisible(i)){o=s.getDatasetMeta(i),t=o.data,a=o.controller;break}}if(!t)return 0;for(i=0,r=t.length;i<r;++i)l=a.resolveDataElementOptions(i),l.borderAlign!=="inner"&&(e=Math.max(e,l.borderWidth||0,l.hoverBorderWidth||0));return e}getMaxOffset(t){let e=0;for(let s=0,i=t.length;s<i;++s){const r=this.resolveDataElementOptions(s);e=Math.max(e,r.offset||0,r.hoverOffset||0)}return e}_getRingWeightOffset(t){let e=0;for(let s=0;s<t;++s)this.chart.isDatasetVisible(s)&&(e+=this._getRingWeight(s));return e}_getRingWeight(t){return Math.max(wt(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}class FL extends fi{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(t){const e=this._cachedMeta,{dataset:s,data:i=[],_dataset:r}=e,o=this.chart._animationsDisabled;let{start:a,count:l}=Mw(e,i,o);this._drawStart=a,this._drawCount=l,Ow(e)&&(a=0,l=i.length),s._chart=this.chart,s._datasetIndex=this.index,s._decimated=!!r._decimated,s.points=i;const c=this.resolveDatasetElementOptions(t);this.options.showLine||(c.borderWidth=0),c.segment=this.options.segment,this.updateElement(s,void 0,{animated:!o,options:c},t),this.updateElements(i,a,l,t)}updateElements(t,e,s,i){const r=i==="reset",{iScale:o,vScale:a,_stacked:l,_dataset:c}=this._cachedMeta,{sharedOptions:h,includeOptions:d}=this._getSharedOptions(e,i),f=o.axis,g=a.axis,{spanGaps:_,segment:b}=this.options,v=Cr(_)?_:Number.POSITIVE_INFINITY,A=this.chart._animationsDisabled||r||i==="none",C=e+s,O=t.length;let k=e>0&&this.getParsed(e-1);for(let D=0;D<O;++D){const N=t[D],w=A?N:{};if(D<e||D>=C){w.skip=!0;continue}const y=this.getParsed(D),x=Ct(y[g]),E=w[f]=o.getPixelForValue(y[f],D),I=w[g]=r||x?a.getBasePixel():a.getPixelForValue(l?this.applyStack(a,y,l):y[g],D);w.skip=isNaN(E)||isNaN(I)||x,w.stop=D>0&&Math.abs(y[f]-k[f])>v,b&&(w.parsed=y,w.raw=c.data[D]),d&&(w.options=h||this.resolveDataElementOptions(D,N.active?"active":i)),A||this.updateElement(N,D,w,i),k=y}}getMaxOverflow(){const t=this._cachedMeta,e=t.dataset,s=e.options&&e.options.borderWidth||0,i=t.data||[];if(!i.length)return s;const r=i[0].size(this.resolveDataElementOptions(0)),o=i[i.length-1].size(this.resolveDataElementOptions(i.length-1));return Math.max(s,r,o)/2}draw(){const t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}}class Zw extends fi{static id="polarArea";static defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:s,color:i}}=t.legend.options;return e.labels.map((r,o)=>{const l=t.getDatasetMeta(0).controller.getStyle(o);return{text:r,fillStyle:l.backgroundColor,strokeStyle:l.borderColor,fontColor:i,lineWidth:l.borderWidth,pointStyle:s,hidden:!t.getDataVisibility(o),index:o}})}return[]}},onClick(t,e,s){s.chart.toggleDataVisibility(e.index),s.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};constructor(t,e){super(t,e),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(t){const e=this._cachedMeta,s=this.chart,i=s.data.labels||[],r=ka(e._parsed[t].r,s.options.locale);return{label:i[t]||"",value:r}}parseObjectData(t,e,s,i){return zw.bind(this)(t,e,s,i)}update(t){const e=this._cachedMeta.data;this._updateRadius(),this.updateElements(e,0,e.length,t)}getMinMax(){const t=this._cachedMeta,e={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return t.data.forEach((s,i)=>{const r=this.getParsed(i).r;!isNaN(r)&&this.chart.getDataVisibility(i)&&(r<e.min&&(e.min=r),r>e.max&&(e.max=r))}),e}_updateRadius(){const t=this.chart,e=t.chartArea,s=t.options,i=Math.min(e.right-e.left,e.bottom-e.top),r=Math.max(i/2,0),o=Math.max(s.cutoutPercentage?r/100*s.cutoutPercentage:1,0),a=(r-o)/t.getVisibleDatasetCount();this.outerRadius=r-a*this.index,this.innerRadius=this.outerRadius-a}updateElements(t,e,s,i){const r=i==="reset",o=this.chart,l=o.options.animation,c=this._cachedMeta.rScale,h=c.xCenter,d=c.yCenter,f=c.getIndexAngle(0)-.5*Vt;let g=f,_;const b=360/this.countVisibleElements();for(_=0;_<e;++_)g+=this._computeAngle(_,i,b);for(_=e;_<e+s;_++){const v=t[_];let A=g,C=g+this._computeAngle(_,i,b),O=o.getDataVisibility(_)?c.getDistanceFromCenterForValue(this.getParsed(_).r):0;g=C,r&&(l.animateScale&&(O=0),l.animateRotate&&(A=C=f));const k={x:h,y:d,innerRadius:0,outerRadius:O,startAngle:A,endAngle:C,options:this.resolveDataElementOptions(_,v.active?"active":i)};this.updateElement(v,_,k,i)}}countVisibleElements(){const t=this._cachedMeta;let e=0;return t.data.forEach((s,i)=>{!isNaN(this.getParsed(i).r)&&this.chart.getDataVisibility(i)&&e++}),e}_computeAngle(t,e,s){return this.chart.getDataVisibility(t)?xn(this.resolveDataElementOptions(t,e).angle||s):0}}class BL extends rp{static id="pie";static defaults={cutout:0,rotation:0,circumference:360,radius:"100%"}}class UL extends fi{static id="radar";static defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}};static overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};getLabelAndValue(t){const e=this._cachedMeta.vScale,s=this.getParsed(t);return{label:e.getLabels()[t],value:""+e.getLabelForValue(s[e.axis])}}parseObjectData(t,e,s,i){return zw.bind(this)(t,e,s,i)}update(t){const e=this._cachedMeta,s=e.dataset,i=e.data||[],r=e.iScale.getLabels();if(s.points=i,t!=="resize"){const o=this.resolveDatasetElementOptions(t);this.options.showLine||(o.borderWidth=0);const a={_loop:!0,_fullLoop:r.length===i.length,options:o};this.updateElement(s,void 0,a,t)}this.updateElements(i,0,i.length,t)}updateElements(t,e,s,i){const r=this._cachedMeta.rScale,o=i==="reset";for(let a=e;a<e+s;a++){const l=t[a],c=this.resolveDataElementOptions(a,l.active?"active":i),h=r.getPointPositionForValue(a,this.getParsed(a).r),d=o?r.xCenter:h.x,f=o?r.yCenter:h.y,g={x:d,y:f,angle:h.angle,skip:isNaN(d)||isNaN(f),options:c};this.updateElement(l,a,g,i)}}}class $L extends fi{static id="scatter";static defaults={datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1};static overrides={interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}};getLabelAndValue(t){const e=this._cachedMeta,s=this.chart.data.labels||[],{xScale:i,yScale:r}=e,o=this.getParsed(t),a=i.getLabelForValue(o.x),l=r.getLabelForValue(o.y);return{label:s[t]||"",value:"("+a+", "+l+")"}}update(t){const e=this._cachedMeta,{data:s=[]}=e,i=this.chart._animationsDisabled;let{start:r,count:o}=Mw(e,s,i);if(this._drawStart=r,this._drawCount=o,Ow(e)&&(r=0,o=s.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:a,_dataset:l}=e;a._chart=this.chart,a._datasetIndex=this.index,a._decimated=!!l._decimated,a.points=s;const c=this.resolveDatasetElementOptions(t);c.segment=this.options.segment,this.updateElement(a,void 0,{animated:!i,options:c},t)}else this.datasetElementType&&(delete e.dataset,this.datasetElementType=!1);this.updateElements(s,r,o,t)}addElements(){const{showLine:t}=this.options;!this.datasetElementType&&t&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(t,e,s,i){const r=i==="reset",{iScale:o,vScale:a,_stacked:l,_dataset:c}=this._cachedMeta,h=this.resolveDataElementOptions(e,i),d=this.getSharedOptions(h),f=this.includeOptions(i,d),g=o.axis,_=a.axis,{spanGaps:b,segment:v}=this.options,A=Cr(b)?b:Number.POSITIVE_INFINITY,C=this.chart._animationsDisabled||r||i==="none";let O=e>0&&this.getParsed(e-1);for(let k=e;k<e+s;++k){const D=t[k],N=this.getParsed(k),w=C?D:{},y=Ct(N[_]),x=w[g]=o.getPixelForValue(N[g],k),E=w[_]=r||y?a.getBasePixel():a.getPixelForValue(l?this.applyStack(a,N,l):N[_],k);w.skip=isNaN(x)||isNaN(E)||y,w.stop=k>0&&Math.abs(N[g]-O[g])>A,v&&(w.parsed=N,w.raw=c.data[k]),f&&(w.options=d||this.resolveDataElementOptions(k,D.active?"active":i)),C||this.updateElement(D,k,w,i),O=N}this.updateSharedOptions(d,i,h)}getMaxOverflow(){const t=this._cachedMeta,e=t.data||[];if(!this.options.showLine){let a=0;for(let l=e.length-1;l>=0;--l)a=Math.max(a,e[l].size(this.resolveDataElementOptions(l))/2);return a>0&&a}const s=t.dataset,i=s.options&&s.options.borderWidth||0;if(!e.length)return i;const r=e[0].size(this.resolveDataElementOptions(0)),o=e[e.length-1].size(this.resolveDataElementOptions(e.length-1));return Math.max(i,r,o)/2}}var zL=Object.freeze({__proto__:null,BarController:LL,BubbleController:VL,DoughnutController:rp,LineController:FL,PieController:BL,PolarAreaController:Zw,RadarController:UL,ScatterController:$L});function xi(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class op{static override(t){Object.assign(op.prototype,t)}options;constructor(t){this.options=t||{}}init(){}formats(){return xi()}parse(){return xi()}format(){return xi()}add(){return xi()}diff(){return xi()}startOf(){return xi()}endOf(){return xi()}}var jL={_date:op};function HL(n,t,e,s){const{controller:i,data:r,_sorted:o}=n,a=i._cachedMeta.iScale,l=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null;if(a&&t===a.axis&&t!=="r"&&o&&r.length){const c=a._reversePixels?oO:us;if(s){if(i._sharedOptions){const h=r[0],d=typeof h.getRange=="function"&&h.getRange(t);if(d){const f=c(r,t,e-d),g=c(r,t,e+d);return{lo:f.lo,hi:g.hi}}}}else{const h=c(r,t,e);if(l){const{vScale:d}=i._cachedMeta,{_parsed:f}=n,g=f.slice(0,h.lo+1).reverse().findIndex(b=>!Ct(b[d.axis]));h.lo-=Math.max(0,g);const _=f.slice(h.hi).findIndex(b=>!Ct(b[d.axis]));h.hi+=Math.max(0,_)}return h}}return{lo:0,hi:r.length-1}}function gu(n,t,e,s,i){const r=n.getSortedVisibleDatasetMetas(),o=e[t];for(let a=0,l=r.length;a<l;++a){const{index:c,data:h}=r[a],{lo:d,hi:f}=HL(r[a],t,o,i);for(let g=d;g<=f;++g){const _=h[g];_.skip||s(_,c,g)}}}function WL(n){const t=n.indexOf("x")!==-1,e=n.indexOf("y")!==-1;return function(s,i){const r=t?Math.abs(s.x-i.x):0,o=e?Math.abs(s.y-i.y):0;return Math.sqrt(Math.pow(r,2)+Math.pow(o,2))}}function hh(n,t,e,s,i){const r=[];return!i&&!n.isPointInArea(t)||gu(n,e,t,function(a,l,c){!i&&!hs(a,n.chartArea,0)||a.inRange(t.x,t.y,s)&&r.push({element:a,datasetIndex:l,index:c})},!0),r}function qL(n,t,e,s){let i=[];function r(o,a,l){const{startAngle:c,endAngle:h}=o.getProps(["startAngle","endAngle"],s),{angle:d}=Cw(o,{x:t.x,y:t.y});la(d,c,h)&&i.push({element:o,datasetIndex:a,index:l})}return gu(n,e,t,r),i}function GL(n,t,e,s,i,r){let o=[];const a=WL(e);let l=Number.POSITIVE_INFINITY;function c(h,d,f){const g=h.inRange(t.x,t.y,i);if(s&&!g)return;const _=h.getCenterPoint(i);if(!(!!r||n.isPointInArea(_))&&!g)return;const v=a(t,_);v<l?(o=[{element:h,datasetIndex:d,index:f}],l=v):v===l&&o.push({element:h,datasetIndex:d,index:f})}return gu(n,e,t,c),o}function dh(n,t,e,s,i,r){return!r&&!n.isPointInArea(t)?[]:e==="r"&&!s?qL(n,t,e,i):GL(n,t,e,s,i,r)}function $_(n,t,e,s,i){const r=[],o=e==="x"?"inXRange":"inYRange";let a=!1;return gu(n,e,t,(l,c,h)=>{l[o]&&l[o](t[e],i)&&(r.push({element:l,datasetIndex:c,index:h}),a=a||l.inRange(t.x,t.y,i))}),s&&!a?[]:r}var KL={modes:{index(n,t,e,s){const i=Si(t,n),r=e.axis||"x",o=e.includeInvisible||!1,a=e.intersect?hh(n,i,r,s,o):dh(n,i,r,!1,s,o),l=[];return a.length?(n.getSortedVisibleDatasetMetas().forEach(c=>{const h=a[0].index,d=c.data[h];d&&!d.skip&&l.push({element:d,datasetIndex:c.index,index:h})}),l):[]},dataset(n,t,e,s){const i=Si(t,n),r=e.axis||"xy",o=e.includeInvisible||!1;let a=e.intersect?hh(n,i,r,s,o):dh(n,i,r,!1,s,o);if(a.length>0){const l=a[0].datasetIndex,c=n.getDatasetMeta(l).data;a=[];for(let h=0;h<c.length;++h)a.push({element:c[h],datasetIndex:l,index:h})}return a},point(n,t,e,s){const i=Si(t,n),r=e.axis||"xy",o=e.includeInvisible||!1;return hh(n,i,r,s,o)},nearest(n,t,e,s){const i=Si(t,n),r=e.axis||"xy",o=e.includeInvisible||!1;return dh(n,i,r,e.intersect,s,o)},x(n,t,e,s){const i=Si(t,n);return $_(n,i,"x",e.intersect,s)},y(n,t,e,s){const i=Si(t,n);return $_(n,i,"y",e.intersect,s)}}};const tx=["left","top","right","bottom"];function lo(n,t){return n.filter(e=>e.pos===t)}function z_(n,t){return n.filter(e=>tx.indexOf(e.pos)===-1&&e.box.axis===t)}function co(n,t){return n.sort((e,s)=>{const i=t?s:e,r=t?e:s;return i.weight===r.weight?i.index-r.index:i.weight-r.weight})}function YL(n){const t=[];let e,s,i,r,o,a;for(e=0,s=(n||[]).length;e<s;++e)i=n[e],{position:r,options:{stack:o,stackWeight:a=1}}=i,t.push({index:e,box:i,pos:r,horizontal:i.isHorizontal(),weight:i.weight,stack:o&&r+o,stackWeight:a});return t}function XL(n){const t={};for(const e of n){const{stack:s,pos:i,stackWeight:r}=e;if(!s||!tx.includes(i))continue;const o=t[s]||(t[s]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=r}return t}function QL(n,t){const e=XL(n),{vBoxMaxWidth:s,hBoxMaxHeight:i}=t;let r,o,a;for(r=0,o=n.length;r<o;++r){a=n[r];const{fullSize:l}=a.box,c=e[a.stack],h=c&&a.stackWeight/c.weight;a.horizontal?(a.width=h?h*s:l&&t.availableWidth,a.height=i):(a.width=s,a.height=h?h*i:l&&t.availableHeight)}return e}function JL(n){const t=YL(n),e=co(t.filter(c=>c.box.fullSize),!0),s=co(lo(t,"left"),!0),i=co(lo(t,"right")),r=co(lo(t,"top"),!0),o=co(lo(t,"bottom")),a=z_(t,"x"),l=z_(t,"y");return{fullSize:e,leftAndTop:s.concat(r),rightAndBottom:i.concat(l).concat(o).concat(a),chartArea:lo(t,"chartArea"),vertical:s.concat(i).concat(l),horizontal:r.concat(o).concat(a)}}function j_(n,t,e,s){return Math.max(n[e],t[e])+Math.max(n[s],t[s])}function ex(n,t){n.top=Math.max(n.top,t.top),n.left=Math.max(n.left,t.left),n.bottom=Math.max(n.bottom,t.bottom),n.right=Math.max(n.right,t.right)}function ZL(n,t,e,s){const{pos:i,box:r}=e,o=n.maxPadding;if(!Dt(i)){e.size&&(n[i]-=e.size);const d=s[e.stack]||{size:0,count:1};d.size=Math.max(d.size,e.horizontal?r.height:r.width),e.size=d.size/d.count,n[i]+=e.size}r.getPadding&&ex(o,r.getPadding());const a=Math.max(0,t.outerWidth-j_(o,n,"left","right")),l=Math.max(0,t.outerHeight-j_(o,n,"top","bottom")),c=a!==n.w,h=l!==n.h;return n.w=a,n.h=l,e.horizontal?{same:c,other:h}:{same:h,other:c}}function tV(n){const t=n.maxPadding;function e(s){const i=Math.max(t[s]-n[s],0);return n[s]+=i,i}n.y+=e("top"),n.x+=e("left"),e("right"),e("bottom")}function eV(n,t){const e=t.maxPadding;function s(i){const r={left:0,top:0,right:0,bottom:0};return i.forEach(o=>{r[o]=Math.max(t[o],e[o])}),r}return s(n?["left","right"]:["top","bottom"])}function vo(n,t,e,s){const i=[];let r,o,a,l,c,h;for(r=0,o=n.length,c=0;r<o;++r){a=n[r],l=a.box,l.update(a.width||t.w,a.height||t.h,eV(a.horizontal,t));const{same:d,other:f}=ZL(t,e,a,s);c|=d&&i.length,h=h||f,l.fullSize||i.push(a)}return c&&vo(i,t,e,s)||h}function hl(n,t,e,s,i){n.top=e,n.left=t,n.right=t+s,n.bottom=e+i,n.width=s,n.height=i}function H_(n,t,e,s){const i=e.padding;let{x:r,y:o}=t;for(const a of n){const l=a.box,c=s[a.stack]||{placed:0,weight:1},h=a.stackWeight/c.weight||1;if(a.horizontal){const d=t.w*h,f=c.size||l.height;aa(c.start)&&(o=c.start),l.fullSize?hl(l,i.left,o,e.outerWidth-i.right-i.left,f):hl(l,t.left+c.placed,o,d,f),c.start=o,c.placed+=d,o=l.bottom}else{const d=t.h*h,f=c.size||l.width;aa(c.start)&&(r=c.start),l.fullSize?hl(l,r,i.top,f,e.outerHeight-i.bottom-i.top):hl(l,r,t.top+c.placed,f,d),c.start=r,c.placed+=d,r=l.right}}t.x=r,t.y=o}var Be={addBox(n,t){n.boxes||(n.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(e){t.draw(e)}}]},n.boxes.push(t)},removeBox(n,t){const e=n.boxes?n.boxes.indexOf(t):-1;e!==-1&&n.boxes.splice(e,1)},configure(n,t,e){t.fullSize=e.fullSize,t.position=e.position,t.weight=e.weight},update(n,t,e,s){if(!n)return;const i=ze(n.options.layout.padding),r=Math.max(t-i.width,0),o=Math.max(e-i.height,0),a=JL(n.boxes),l=a.vertical,c=a.horizontal;zt(n.boxes,b=>{typeof b.beforeLayout=="function"&&b.beforeLayout()});const h=l.reduce((b,v)=>v.box.options&&v.box.options.display===!1?b:b+1,0)||1,d=Object.freeze({outerWidth:t,outerHeight:e,padding:i,availableWidth:r,availableHeight:o,vBoxMaxWidth:r/2/h,hBoxMaxHeight:o/2}),f=Object.assign({},i);ex(f,ze(s));const g=Object.assign({maxPadding:f,w:r,h:o,x:i.left,y:i.top},i),_=QL(l.concat(c),d);vo(a.fullSize,g,d,_),vo(l,g,d,_),vo(c,g,d,_)&&vo(l,g,d,_),tV(g),H_(a.leftAndTop,g,d,_),g.x+=g.w,g.y+=g.h,H_(a.rightAndBottom,g,d,_),n.chartArea={left:g.left,top:g.top,right:g.left+g.w,bottom:g.top+g.h,height:g.h,width:g.w},zt(a.chartArea,b=>{const v=b.box;Object.assign(v,n.chartArea),v.update(g.w,g.h,{left:0,top:0,right:0,bottom:0})})}};class nx{acquireContext(t,e){}releaseContext(t){return!1}addEventListener(t,e,s){}removeEventListener(t,e,s){}getDevicePixelRatio(){return 1}getMaximumSize(t,e,s,i){return e=Math.max(0,e||t.width),s=s||t.height,{width:e,height:Math.max(0,i?Math.floor(e/i):s)}}isAttached(t){return!0}updateConfig(t){}}class nV extends nx{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const Vl="$chartjs",sV={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},W_=n=>n===null||n==="";function iV(n,t){const e=n.style,s=n.getAttribute("height"),i=n.getAttribute("width");if(n[Vl]={initial:{height:s,width:i,style:{display:e.display,height:e.height,width:e.width}}},e.display=e.display||"block",e.boxSizing=e.boxSizing||"border-box",W_(i)){const r=C_(n,"width");r!==void 0&&(n.width=r)}if(W_(s))if(n.style.height==="")n.height=n.width/(t||2);else{const r=C_(n,"height");r!==void 0&&(n.height=r)}return n}const sx=ZO?{passive:!0}:!1;function rV(n,t,e){n&&n.addEventListener(t,e,sx)}function oV(n,t,e){n&&n.canvas&&n.canvas.removeEventListener(t,e,sx)}function aV(n,t){const e=sV[n.type]||n.type,{x:s,y:i}=Si(n,t);return{type:e,chart:t,native:n,x:s!==void 0?s:null,y:i!==void 0?i:null}}function wc(n,t){for(const e of n)if(e===t||e.contains(t))return!0}function lV(n,t,e){const s=n.canvas,i=new MutationObserver(r=>{let o=!1;for(const a of r)o=o||wc(a.addedNodes,s),o=o&&!wc(a.removedNodes,s);o&&e()});return i.observe(document,{childList:!0,subtree:!0}),i}function cV(n,t,e){const s=n.canvas,i=new MutationObserver(r=>{let o=!1;for(const a of r)o=o||wc(a.removedNodes,s),o=o&&!wc(a.addedNodes,s);o&&e()});return i.observe(document,{childList:!0,subtree:!0}),i}const ua=new Map;let q_=0;function ix(){const n=window.devicePixelRatio;n!==q_&&(q_=n,ua.forEach((t,e)=>{e.currentDevicePixelRatio!==n&&t()}))}function uV(n,t){ua.size||window.addEventListener("resize",ix),ua.set(n,t)}function hV(n){ua.delete(n),ua.size||window.removeEventListener("resize",ix)}function dV(n,t,e){const s=n.canvas,i=s&&ip(s);if(!i)return;const r=Dw((a,l)=>{const c=i.clientWidth;e(a,l),c<i.clientWidth&&e()},window),o=new ResizeObserver(a=>{const l=a[0],c=l.contentRect.width,h=l.contentRect.height;c===0&&h===0||r(c,h)});return o.observe(i),uV(n,r),o}function fh(n,t,e){e&&e.disconnect(),t==="resize"&&hV(n)}function fV(n,t,e){const s=n.canvas,i=Dw(r=>{n.ctx!==null&&e(aV(r,n))},n);return rV(s,t,i),i}class pV extends nx{acquireContext(t,e){const s=t&&t.getContext&&t.getContext("2d");return s&&s.canvas===t?(iV(t,e),s):null}releaseContext(t){const e=t.canvas;if(!e[Vl])return!1;const s=e[Vl].initial;["height","width"].forEach(r=>{const o=s[r];Ct(o)?e.removeAttribute(r):e.setAttribute(r,o)});const i=s.style||{};return Object.keys(i).forEach(r=>{e.style[r]=i[r]}),e.width=e.width,delete e[Vl],!0}addEventListener(t,e,s){this.removeEventListener(t,e);const i=t.$proxies||(t.$proxies={}),o={attach:lV,detach:cV,resize:dV}[e]||fV;i[e]=o(t,e,s)}removeEventListener(t,e){const s=t.$proxies||(t.$proxies={}),i=s[e];if(!i)return;({attach:fh,detach:fh,resize:fh}[e]||oV)(t,e,i),s[e]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,e,s,i){return JO(t,e,s,i)}isAttached(t){const e=t&&ip(t);return!!(e&&e.isConnected)}}function gV(n){return!sp()||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas?nV:pV}let Es=class{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(t){const{x:e,y:s}=this.getProps(["x","y"],t);return{x:e,y:s}}hasValue(){return Cr(this.x)&&Cr(this.y)}getProps(t,e){const s=this.$animations;if(!e||!s)return this;const i={};return t.forEach(r=>{i[r]=s[r]&&s[r].active()?s[r]._to:this[r]}),i}};function mV(n,t){const e=n.options.ticks,s=_V(n),i=Math.min(e.maxTicksLimit||s,s),r=e.major.enabled?bV(t):[],o=r.length,a=r[0],l=r[o-1],c=[];if(o>i)return vV(t,c,r,o/i),c;const h=yV(r,t,i);if(o>0){let d,f;const g=o>1?Math.round((l-a)/(o-1)):null;for(dl(t,c,h,Ct(g)?0:a-g,a),d=0,f=o-1;d<f;d++)dl(t,c,h,r[d],r[d+1]);return dl(t,c,h,l,Ct(g)?t.length:l+g),c}return dl(t,c,h),c}function _V(n){const t=n.options.offset,e=n._tickSize(),s=n._length/e+(t?0:1),i=n._maxLength/e;return Math.floor(Math.min(s,i))}function yV(n,t,e){const s=wV(n),i=t.length/e;if(!s)return Math.max(i,1);const r=eO(s);for(let o=0,a=r.length-1;o<a;o++){const l=r[o];if(l>i)return l}return Math.max(i,1)}function bV(n){const t=[];let e,s;for(e=0,s=n.length;e<s;e++)n[e].major&&t.push(e);return t}function vV(n,t,e,s){let i=0,r=e[0],o;for(s=Math.ceil(s),o=0;o<n.length;o++)o===r&&(t.push(n[o]),i++,r=e[i*s])}function dl(n,t,e,s,i){const r=wt(s,0),o=Math.min(wt(i,n.length),n.length);let a=0,l,c,h;for(e=Math.ceil(e),i&&(l=i-s,e=l/Math.floor(l/e)),h=r;h<0;)a++,h=Math.round(r+a*e);for(c=Math.max(r,0);c<o;c++)c===h&&(t.push(n[c]),a++,h=Math.round(r+a*e))}function wV(n){const t=n.length;let e,s;if(t<2)return!1;for(s=n[0],e=1;e<t;++e)if(n[e]-n[e-1]!==s)return!1;return s}const xV=n=>n==="left"?"right":n==="right"?"left":n,G_=(n,t,e)=>t==="top"||t==="left"?n[t]+e:n[t]-e,K_=(n,t)=>Math.min(t||n,n);function Y_(n,t){const e=[],s=n.length/t,i=n.length;let r=0;for(;r<i;r+=s)e.push(n[Math.floor(r)]);return e}function TV(n,t,e){const s=n.ticks.length,i=Math.min(t,s-1),r=n._startPixel,o=n._endPixel,a=1e-6;let l=n.getPixelForTick(i),c;if(!(e&&(s===1?c=Math.max(l-r,o-l):t===0?c=(n.getPixelForTick(1)-l)/2:c=(l-n.getPixelForTick(i-1))/2,l+=i<t?c:-c,l<r-a||l>o+a)))return l}function EV(n,t){zt(n,e=>{const s=e.gc,i=s.length/2;let r;if(i>t){for(r=0;r<i;++r)delete e.data[s[r]];s.splice(0,i)}})}function uo(n){return n.drawTicks?n.tickLength:0}function X_(n,t){if(!n.display)return 0;const e=pe(n.font,t),s=ze(n.padding);return(Zt(n.text)?n.text.length:1)*e.lineHeight+s.height}function IV(n,t){return di(n,{scale:t,type:"scale"})}function SV(n,t,e){return di(n,{tick:e,index:t,type:"tick"})}function AV(n,t,e){let s=Qf(n);return(e&&t!=="right"||!e&&t==="right")&&(s=xV(s)),s}function CV(n,t,e,s){const{top:i,left:r,bottom:o,right:a,chart:l}=n,{chartArea:c,scales:h}=l;let d=0,f,g,_;const b=o-i,v=a-r;if(n.isHorizontal()){if(g=De(s,r,a),Dt(e)){const A=Object.keys(e)[0],C=e[A];_=h[A].getPixelForValue(C)+b-t}else e==="center"?_=(c.bottom+c.top)/2+b-t:_=G_(n,e,t);f=a-r}else{if(Dt(e)){const A=Object.keys(e)[0],C=e[A];g=h[A].getPixelForValue(C)-v+t}else e==="center"?g=(c.left+c.right)/2-v+t:g=G_(n,e,t);_=De(s,o,i),d=e==="left"?-le:le}return{titleX:g,titleY:_,maxWidth:f,rotation:d}}class Ki extends Es{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,e){return t}getUserBounds(){let{_userMin:t,_userMax:e,_suggestedMin:s,_suggestedMax:i}=this;return t=sn(t,Number.POSITIVE_INFINITY),e=sn(e,Number.NEGATIVE_INFINITY),s=sn(s,Number.POSITIVE_INFINITY),i=sn(i,Number.NEGATIVE_INFINITY),{min:sn(t,s),max:sn(e,i),minDefined:re(t),maxDefined:re(e)}}getMinMax(t){let{min:e,max:s,minDefined:i,maxDefined:r}=this.getUserBounds(),o;if(i&&r)return{min:e,max:s};const a=this.getMatchingVisibleMetas();for(let l=0,c=a.length;l<c;++l)o=a[l].controller.getMinMax(this,t),i||(e=Math.min(e,o.min)),r||(s=Math.max(s,o.max));return e=r&&e>s?s:e,s=i&&e>s?e:s,{min:sn(e,sn(s,e)),max:sn(s,sn(e,s))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Kt(this.options.beforeUpdate,[this])}update(t,e,s){const{beginAtZero:i,grace:r,ticks:o}=this.options,a=o.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=e,this._margins=s=Object.assign({left:0,right:0,top:0,bottom:0},s),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+s.left+s.right:this.height+s.top+s.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=RO(this,r,i),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const l=a<this.ticks.length;this._convertTicksToLabels(l?Y_(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=mV(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t=this.options.reverse,e,s;this.isHorizontal()?(e=this.left,s=this.right):(e=this.top,s=this.bottom,t=!t),this._startPixel=e,this._endPixel=s,this._reversePixels=t,this._length=s-e,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Kt(this.options.afterUpdate,[this])}beforeSetDimensions(){Kt(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Kt(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),Kt(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Kt(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const e=this.options.ticks;let s,i,r;for(s=0,i=t.length;s<i;s++)r=t[s],r.label=Kt(e.callback,[r.value,s,t],this)}afterTickToLabelConversion(){Kt(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Kt(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,e=t.ticks,s=K_(this.ticks.length,t.ticks.maxTicksLimit),i=e.minRotation||0,r=e.maxRotation;let o=i,a,l,c;if(!this._isVisible()||!e.display||i>=r||s<=1||!this.isHorizontal()){this.labelRotation=i;return}const h=this._getLabelSizes(),d=h.widest.width,f=h.highest.height,g=_e(this.chart.width-d,0,this.maxWidth);a=t.offset?this.maxWidth/s:g/(s-1),d+6>a&&(a=g/(s-(t.offset?.5:1)),l=this.maxHeight-uo(t.grid)-e.padding-X_(t.title,this.chart.options.font),c=Math.sqrt(d*d+f*f),o=Yf(Math.min(Math.asin(_e((h.highest.height+6)/a,-1,1)),Math.asin(_e(l/c,-1,1))-Math.asin(_e(f/c,-1,1)))),o=Math.max(i,Math.min(r,o))),this.labelRotation=o}afterCalculateLabelRotation(){Kt(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Kt(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:e,options:{ticks:s,title:i,grid:r}}=this,o=this._isVisible(),a=this.isHorizontal();if(o){const l=X_(i,e.options.font);if(a?(t.width=this.maxWidth,t.height=uo(r)+l):(t.height=this.maxHeight,t.width=uo(r)+l),s.display&&this.ticks.length){const{first:c,last:h,widest:d,highest:f}=this._getLabelSizes(),g=s.padding*2,_=xn(this.labelRotation),b=Math.cos(_),v=Math.sin(_);if(a){const A=s.mirror?0:v*d.width+b*f.height;t.height=Math.min(this.maxHeight,t.height+A+g)}else{const A=s.mirror?0:b*d.width+v*f.height;t.width=Math.min(this.maxWidth,t.width+A+g)}this._calculatePadding(c,h,v,b)}}this._handleMargins(),a?(this.width=this._length=e.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=e.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,e,s,i){const{ticks:{align:r,padding:o},position:a}=this.options,l=this.labelRotation!==0,c=a!=="top"&&this.axis==="x";if(this.isHorizontal()){const h=this.getPixelForTick(0)-this.left,d=this.right-this.getPixelForTick(this.ticks.length-1);let f=0,g=0;l?c?(f=i*t.width,g=s*e.height):(f=s*t.height,g=i*e.width):r==="start"?g=e.width:r==="end"?f=t.width:r!=="inner"&&(f=t.width/2,g=e.width/2),this.paddingLeft=Math.max((f-h+o)*this.width/(this.width-h),0),this.paddingRight=Math.max((g-d+o)*this.width/(this.width-d),0)}else{let h=e.height/2,d=t.height/2;r==="start"?(h=0,d=t.height):r==="end"&&(h=e.height,d=0),this.paddingTop=h+o,this.paddingBottom=d+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Kt(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:e}=this.options;return e==="top"||e==="bottom"||t==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){this.beforeTickToLabelConversion(),this.generateTickLabels(t);let e,s;for(e=0,s=t.length;e<s;e++)Ct(t[e].label)&&(t.splice(e,1),s--,e--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const e=this.options.ticks.sampleSize;let s=this.ticks;e<s.length&&(s=Y_(s,e)),this._labelSizes=t=this._computeLabelSizes(s,s.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,e,s){const{ctx:i,_longestTextCache:r}=this,o=[],a=[],l=Math.floor(e/K_(e,s));let c=0,h=0,d,f,g,_,b,v,A,C,O,k,D;for(d=0;d<e;d+=l){if(_=t[d].label,b=this._resolveTickFontOptions(d),i.font=v=b.string,A=r[v]=r[v]||{data:{},gc:[]},C=b.lineHeight,O=k=0,!Ct(_)&&!Zt(_))O=bc(i,A.data,A.gc,O,_),k=C;else if(Zt(_))for(f=0,g=_.length;f<g;++f)D=_[f],!Ct(D)&&!Zt(D)&&(O=bc(i,A.data,A.gc,O,D),k+=C);o.push(O),a.push(k),c=Math.max(O,c),h=Math.max(k,h)}EV(r,e);const N=o.indexOf(c),w=a.indexOf(h),y=x=>({width:o[x]||0,height:a[x]||0});return{first:y(0),last:y(e-1),widest:y(N),highest:y(w),widths:o,heights:a}}getLabelForValue(t){return t}getPixelForValue(t,e){return NaN}getValueForPixel(t){}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const e=this._startPixel+t*this._length;return rO(this._alignToPixels?wi(this.chart,e,0):e)}getDecimalForPixel(t){const e=(t-this._startPixel)/this._length;return this._reversePixels?1-e:e}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:e}=this;return t<0&&e<0?e:t>0&&e>0?t:0}getContext(t){const e=this.ticks||[];if(t>=0&&t<e.length){const s=e[t];return s.$context||(s.$context=SV(this.getContext(),t,s))}return this.$context||(this.$context=IV(this.chart.getContext(),this))}_tickSize(){const t=this.options.ticks,e=xn(this.labelRotation),s=Math.abs(Math.cos(e)),i=Math.abs(Math.sin(e)),r=this._getLabelSizes(),o=t.autoSkipPadding||0,a=r?r.widest.width+o:0,l=r?r.highest.height+o:0;return this.isHorizontal()?l*s>a*i?a/s:l/i:l*i<a*s?l/s:a/i}_isVisible(){const t=this.options.display;return t!=="auto"?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const e=this.axis,s=this.chart,i=this.options,{grid:r,position:o,border:a}=i,l=r.offset,c=this.isHorizontal(),d=this.ticks.length+(l?1:0),f=uo(r),g=[],_=a.setContext(this.getContext()),b=_.display?_.width:0,v=b/2,A=function(dt){return wi(s,dt,b)};let C,O,k,D,N,w,y,x,E,I,P,S;if(o==="top")C=A(this.bottom),w=this.bottom-f,x=C-v,I=A(t.top)+v,S=t.bottom;else if(o==="bottom")C=A(this.top),I=t.top,S=A(t.bottom)-v,w=C+v,x=this.top+f;else if(o==="left")C=A(this.right),N=this.right-f,y=C-v,E=A(t.left)+v,P=t.right;else if(o==="right")C=A(this.left),E=t.left,P=A(t.right)-v,N=C+v,y=this.left+f;else if(e==="x"){if(o==="center")C=A((t.top+t.bottom)/2+.5);else if(Dt(o)){const dt=Object.keys(o)[0],ot=o[dt];C=A(this.chart.scales[dt].getPixelForValue(ot))}I=t.top,S=t.bottom,w=C+v,x=w+f}else if(e==="y"){if(o==="center")C=A((t.left+t.right)/2);else if(Dt(o)){const dt=Object.keys(o)[0],ot=o[dt];C=A(this.chart.scales[dt].getPixelForValue(ot))}N=C-v,y=N-f,E=t.left,P=t.right}const rt=wt(i.ticks.maxTicksLimit,d),it=Math.max(1,Math.ceil(d/rt));for(O=0;O<d;O+=it){const dt=this.getContext(O),ot=r.setContext(dt),H=a.setContext(dt),K=ot.lineWidth,X=ot.color,ht=H.dash||[],St=H.dashOffset,bt=ot.tickWidth,Nt=ot.tickColor,be=ot.tickBorderDash||[],oe=ot.tickBorderDashOffset;k=TV(this,O,l),k!==void 0&&(D=wi(s,k,K),c?N=y=E=P=D:w=x=I=S=D,g.push({tx1:N,ty1:w,tx2:y,ty2:x,x1:E,y1:I,x2:P,y2:S,width:K,color:X,borderDash:ht,borderDashOffset:St,tickWidth:bt,tickColor:Nt,tickBorderDash:be,tickBorderDashOffset:oe}))}return this._ticksLength=d,this._borderValue=C,g}_computeLabelItems(t){const e=this.axis,s=this.options,{position:i,ticks:r}=s,o=this.isHorizontal(),a=this.ticks,{align:l,crossAlign:c,padding:h,mirror:d}=r,f=uo(s.grid),g=f+h,_=d?-h:g,b=-xn(this.labelRotation),v=[];let A,C,O,k,D,N,w,y,x,E,I,P,S="middle";if(i==="top")N=this.bottom-_,w=this._getXAxisLabelAlignment();else if(i==="bottom")N=this.top+_,w=this._getXAxisLabelAlignment();else if(i==="left"){const it=this._getYAxisLabelAlignment(f);w=it.textAlign,D=it.x}else if(i==="right"){const it=this._getYAxisLabelAlignment(f);w=it.textAlign,D=it.x}else if(e==="x"){if(i==="center")N=(t.top+t.bottom)/2+g;else if(Dt(i)){const it=Object.keys(i)[0],dt=i[it];N=this.chart.scales[it].getPixelForValue(dt)+g}w=this._getXAxisLabelAlignment()}else if(e==="y"){if(i==="center")D=(t.left+t.right)/2-g;else if(Dt(i)){const it=Object.keys(i)[0],dt=i[it];D=this.chart.scales[it].getPixelForValue(dt)}w=this._getYAxisLabelAlignment(f).textAlign}e==="y"&&(l==="start"?S="top":l==="end"&&(S="bottom"));const rt=this._getLabelSizes();for(A=0,C=a.length;A<C;++A){O=a[A],k=O.label;const it=r.setContext(this.getContext(A));y=this.getPixelForTick(A)+r.labelOffset,x=this._resolveTickFontOptions(A),E=x.lineHeight,I=Zt(k)?k.length:1;const dt=I/2,ot=it.color,H=it.textStrokeColor,K=it.textStrokeWidth;let X=w;o?(D=y,w==="inner"&&(A===C-1?X=this.options.reverse?"left":"right":A===0?X=this.options.reverse?"right":"left":X="center"),i==="top"?c==="near"||b!==0?P=-I*E+E/2:c==="center"?P=-rt.highest.height/2-dt*E+E:P=-rt.highest.height+E/2:c==="near"||b!==0?P=E/2:c==="center"?P=rt.highest.height/2-dt*E:P=rt.highest.height-I*E,d&&(P*=-1),b!==0&&!it.showLabelBackdrop&&(D+=E/2*Math.sin(b))):(N=y,P=(1-I)*E/2);let ht;if(it.showLabelBackdrop){const St=ze(it.backdropPadding),bt=rt.heights[A],Nt=rt.widths[A];let be=P-St.top,oe=0-St.left;switch(S){case"middle":be-=bt/2;break;case"bottom":be-=bt;break}switch(w){case"center":oe-=Nt/2;break;case"right":oe-=Nt;break;case"inner":A===C-1?oe-=Nt:A>0&&(oe-=Nt/2);break}ht={left:oe,top:be,width:Nt+St.width,height:bt+St.height,color:it.backdropColor}}v.push({label:k,font:x,textOffset:P,options:{rotation:b,color:ot,strokeColor:H,strokeWidth:K,textAlign:X,textBaseline:S,translation:[D,N],backdrop:ht}})}return v}_getXAxisLabelAlignment(){const{position:t,ticks:e}=this.options;if(-xn(this.labelRotation))return t==="top"?"left":"right";let i="center";return e.align==="start"?i="left":e.align==="end"?i="right":e.align==="inner"&&(i="inner"),i}_getYAxisLabelAlignment(t){const{position:e,ticks:{crossAlign:s,mirror:i,padding:r}}=this.options,o=this._getLabelSizes(),a=t+r,l=o.widest.width;let c,h;return e==="left"?i?(h=this.right+r,s==="near"?c="left":s==="center"?(c="center",h+=l/2):(c="right",h+=l)):(h=this.right-a,s==="near"?c="right":s==="center"?(c="center",h-=l/2):(c="left",h=this.left)):e==="right"?i?(h=this.left+r,s==="near"?c="right":s==="center"?(c="center",h-=l/2):(c="left",h-=l)):(h=this.left+a,s==="near"?c="left":s==="center"?(c="center",h+=l/2):(c="right",h=this.right)):c="right",{textAlign:c,x:h}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,e=this.options.position;if(e==="left"||e==="right")return{top:0,left:this.left,bottom:t.height,right:this.right};if(e==="top"||e==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:t.width}}drawBackground(){const{ctx:t,options:{backgroundColor:e},left:s,top:i,width:r,height:o}=this;e&&(t.save(),t.fillStyle=e,t.fillRect(s,i,r,o),t.restore())}getLineWidthForValue(t){const e=this.options.grid;if(!this._isVisible()||!e.display)return 0;const i=this.ticks.findIndex(r=>r.value===t);return i>=0?e.setContext(this.getContext(i)).lineWidth:0}drawGrid(t){const e=this.options.grid,s=this.ctx,i=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let r,o;const a=(l,c,h)=>{!h.width||!h.color||(s.save(),s.lineWidth=h.width,s.strokeStyle=h.color,s.setLineDash(h.borderDash||[]),s.lineDashOffset=h.borderDashOffset,s.beginPath(),s.moveTo(l.x,l.y),s.lineTo(c.x,c.y),s.stroke(),s.restore())};if(e.display)for(r=0,o=i.length;r<o;++r){const l=i[r];e.drawOnChartArea&&a({x:l.x1,y:l.y1},{x:l.x2,y:l.y2},l),e.drawTicks&&a({x:l.tx1,y:l.ty1},{x:l.tx2,y:l.ty2},{color:l.tickColor,width:l.tickWidth,borderDash:l.tickBorderDash,borderDashOffset:l.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:e,options:{border:s,grid:i}}=this,r=s.setContext(this.getContext()),o=s.display?r.width:0;if(!o)return;const a=i.setContext(this.getContext(0)).lineWidth,l=this._borderValue;let c,h,d,f;this.isHorizontal()?(c=wi(t,this.left,o)-o/2,h=wi(t,this.right,a)+a/2,d=f=l):(d=wi(t,this.top,o)-o/2,f=wi(t,this.bottom,a)+a/2,c=h=l),e.save(),e.lineWidth=r.width,e.strokeStyle=r.color,e.beginPath(),e.moveTo(c,d),e.lineTo(h,f),e.stroke(),e.restore()}drawLabels(t){if(!this.options.ticks.display)return;const s=this.ctx,i=this._computeLabelArea();i&&du(s,i);const r=this.getLabelItems(t);for(const o of r){const a=o.options,l=o.font,c=o.label,h=o.textOffset;ji(s,c,0,h,l,a)}i&&fu(s)}drawTitle(){const{ctx:t,options:{position:e,title:s,reverse:i}}=this;if(!s.display)return;const r=pe(s.font),o=ze(s.padding),a=s.align;let l=r.lineHeight/2;e==="bottom"||e==="center"||Dt(e)?(l+=o.bottom,Zt(s.text)&&(l+=r.lineHeight*(s.text.length-1))):l+=o.top;const{titleX:c,titleY:h,maxWidth:d,rotation:f}=CV(this,l,e,a);ji(t,s.text,0,0,r,{color:s.color,maxWidth:d,rotation:f,textAlign:AV(a,e,i),textBaseline:"middle",translation:[c,h]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,e=t.ticks&&t.ticks.z||0,s=wt(t.grid&&t.grid.z,-1),i=wt(t.border&&t.border.z,0);return!this._isVisible()||this.draw!==Ki.prototype.draw?[{z:e,draw:r=>{this.draw(r)}}]:[{z:s,draw:r=>{this.drawBackground(),this.drawGrid(r),this.drawTitle()}},{z:i,draw:()=>{this.drawBorder()}},{z:e,draw:r=>{this.drawLabels(r)}}]}getMatchingVisibleMetas(t){const e=this.chart.getSortedVisibleDatasetMetas(),s=this.axis+"AxisID",i=[];let r,o;for(r=0,o=e.length;r<o;++r){const a=e[r];a[s]===this.id&&(!t||a.type===t)&&i.push(a)}return i}_resolveTickFontOptions(t){const e=this.options.ticks.setContext(this.getContext(t));return pe(e.font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class fl{constructor(t,e,s){this.type=t,this.scope=e,this.override=s,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const e=Object.getPrototypeOf(t);let s;kV(e)&&(s=this.register(e));const i=this.items,r=t.id,o=this.scope+"."+r;if(!r)throw new Error("class does not have id: "+t);return r in i||(i[r]=t,PV(t,o,s),this.override&&te.override(t.id,t.overrides)),o}get(t){return this.items[t]}unregister(t){const e=this.items,s=t.id,i=this.scope;s in e&&delete e[s],i&&s in te[i]&&(delete te[i][s],this.override&&delete zi[s])}}function PV(n,t,e){const s=oa(Object.create(null),[e?te.get(e):{},te.get(t),n.defaults]);te.set(t,s),n.defaultRoutes&&RV(t,n.defaultRoutes),n.descriptors&&te.describe(t,n.descriptors)}function RV(n,t){Object.keys(t).forEach(e=>{const s=e.split("."),i=s.pop(),r=[n].concat(s).join("."),o=t[e].split("."),a=o.pop(),l=o.join(".");te.route(r,i,l,a)})}function kV(n){return"id"in n&&"defaults"in n}class DV{constructor(){this.controllers=new fl(fi,"datasets",!0),this.elements=new fl(Es,"elements"),this.plugins=new fl(Object,"plugins"),this.scales=new fl(Ki,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,e,s){[...e].forEach(i=>{const r=s||this._getRegistryForType(i);s||r.isForType(i)||r===this.plugins&&i.id?this._exec(t,r,i):zt(i,o=>{const a=s||this._getRegistryForType(o);this._exec(t,a,o)})})}_exec(t,e,s){const i=Kf(t);Kt(s["before"+i],[],s),e[t](s),Kt(s["after"+i],[],s)}_getRegistryForType(t){for(let e=0;e<this._typedRegistries.length;e++){const s=this._typedRegistries[e];if(s.isForType(t))return s}return this.plugins}_get(t,e,s){const i=e.get(t);if(i===void 0)throw new Error('"'+t+'" is not a registered '+s+".");return i}}var Rn=new DV;class MV{constructor(){this._init=void 0}notify(t,e,s,i){if(e==="beforeInit"&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install")),this._init===void 0)return;const r=i?this._descriptors(t).filter(i):this._descriptors(t),o=this._notify(r,t,e,s);return e==="afterDestroy"&&(this._notify(r,t,"stop"),this._notify(this._init,t,"uninstall"),this._init=void 0),o}_notify(t,e,s,i){i=i||{};for(const r of t){const o=r.plugin,a=o[s],l=[e,i,r.options];if(Kt(a,l,o)===!1&&i.cancelable)return!1}return!0}invalidate(){Ct(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const e=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),e}_createDescriptors(t,e){const s=t&&t.config,i=wt(s.options&&s.options.plugins,{}),r=OV(s);return i===!1&&!e?[]:VV(t,r,i,e)}_notifyStateChanges(t){const e=this._oldCache||[],s=this._cache,i=(r,o)=>r.filter(a=>!o.some(l=>a.plugin.id===l.plugin.id));this._notify(i(e,s),t,"stop"),this._notify(i(s,e),t,"start")}}function OV(n){const t={},e=[],s=Object.keys(Rn.plugins.items);for(let r=0;r<s.length;r++)e.push(Rn.getPlugin(s[r]));const i=n.plugins||[];for(let r=0;r<i.length;r++){const o=i[r];e.indexOf(o)===-1&&(e.push(o),t[o.id]=!0)}return{plugins:e,localIds:t}}function LV(n,t){return!t&&n===!1?null:n===!0?{}:n}function VV(n,{plugins:t,localIds:e},s,i){const r=[],o=n.getContext();for(const a of t){const l=a.id,c=LV(s[l],i);c!==null&&r.push({plugin:a,options:NV(n.config,{plugin:a,local:e[l]},c,o)})}return r}function NV(n,{plugin:t,local:e},s,i){const r=n.pluginScopeKeys(t),o=n.getOptionScopes(s,r);return e&&t.defaults&&o.push(t.defaults),n.createResolver(o,i,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function cd(n,t){const e=te.datasets[n]||{};return((t.datasets||{})[n]||{}).indexAxis||t.indexAxis||e.indexAxis||"x"}function FV(n,t){let e=n;return n==="_index_"?e=t:n==="_value_"&&(e=t==="x"?"y":"x"),e}function BV(n,t){return n===t?"_index_":"_value_"}function Q_(n){if(n==="x"||n==="y"||n==="r")return n}function UV(n){if(n==="top"||n==="bottom")return"x";if(n==="left"||n==="right")return"y"}function ud(n,...t){if(Q_(n))return n;for(const e of t){const s=e.axis||UV(e.position)||n.length>1&&Q_(n[0].toLowerCase());if(s)return s}throw new Error(`Cannot determine type of '${n}' axis. Please provide 'axis' or 'position' option.`)}function J_(n,t,e){if(e[t+"AxisID"]===n)return{axis:t}}function $V(n,t){if(t.data&&t.data.datasets){const e=t.data.datasets.filter(s=>s.xAxisID===n||s.yAxisID===n);if(e.length)return J_(n,"x",e[0])||J_(n,"y",e[0])}return{}}function zV(n,t){const e=zi[n.type]||{scales:{}},s=t.scales||{},i=cd(n.type,t),r=Object.create(null);return Object.keys(s).forEach(o=>{const a=s[o];if(!Dt(a))return console.error(`Invalid scale configuration for scale: ${o}`);if(a._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const l=ud(o,a,$V(o,n),te.scales[a.type]),c=BV(l,i),h=e.scales||{};r[o]=Fo(Object.create(null),[{axis:l},a,h[l],h[c]])}),n.data.datasets.forEach(o=>{const a=o.type||n.type,l=o.indexAxis||cd(a,t),h=(zi[a]||{}).scales||{};Object.keys(h).forEach(d=>{const f=FV(d,l),g=o[f+"AxisID"]||f;r[g]=r[g]||Object.create(null),Fo(r[g],[{axis:f},s[g],h[d]])})}),Object.keys(r).forEach(o=>{const a=r[o];Fo(a,[te.scales[a.type],te.scale])}),r}function rx(n){const t=n.options||(n.options={});t.plugins=wt(t.plugins,{}),t.scales=zV(n,t)}function ox(n){return n=n||{},n.datasets=n.datasets||[],n.labels=n.labels||[],n}function jV(n){return n=n||{},n.data=ox(n.data),rx(n),n}const Z_=new Map,ax=new Set;function pl(n,t){let e=Z_.get(n);return e||(e=t(),Z_.set(n,e),ax.add(e)),e}const ho=(n,t,e)=>{const s=ai(t,e);s!==void 0&&n.add(s)};class HV{constructor(t){this._config=jV(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=ox(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),rx(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return pl(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,e){return pl(`${t}.transition.${e}`,()=>[[`datasets.${t}.transitions.${e}`,`transitions.${e}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,e){return pl(`${t}-${e}`,()=>[[`datasets.${t}.elements.${e}`,`datasets.${t}`,`elements.${e}`,""]])}pluginScopeKeys(t){const e=t.id,s=this.type;return pl(`${s}-plugin-${e}`,()=>[[`plugins.${e}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,e){const s=this._scopeCache;let i=s.get(t);return(!i||e)&&(i=new Map,s.set(t,i)),i}getOptionScopes(t,e,s){const{options:i,type:r}=this,o=this._cachedScopes(t,s),a=o.get(e);if(a)return a;const l=new Set;e.forEach(h=>{t&&(l.add(t),h.forEach(d=>ho(l,t,d))),h.forEach(d=>ho(l,i,d)),h.forEach(d=>ho(l,zi[r]||{},d)),h.forEach(d=>ho(l,te,d)),h.forEach(d=>ho(l,ad,d))});const c=Array.from(l);return c.length===0&&c.push(Object.create(null)),ax.has(e)&&o.set(e,c),c}chartOptionScopes(){const{options:t,type:e}=this;return[t,zi[e]||{},te.datasets[e]||{},{type:e},te,ad]}resolveNamedOptions(t,e,s,i=[""]){const r={$shared:!0},{resolver:o,subPrefixes:a}=ty(this._resolverCache,t,i);let l=o;if(qV(o,e)){r.$shared=!1,s=li(s)?s():s;const c=this.createResolver(t,s,a);l=Pr(o,s,c)}for(const c of e)r[c]=l[c];return r}createResolver(t,e,s=[""],i){const{resolver:r}=ty(this._resolverCache,t,s);return Dt(e)?Pr(r,e,void 0,i):r}}function ty(n,t,e){let s=n.get(t);s||(s=new Map,n.set(t,s));const i=e.join();let r=s.get(i);return r||(r={resolver:tp(t,e),subPrefixes:e.filter(a=>!a.toLowerCase().includes("hover"))},s.set(i,r)),r}const WV=n=>Dt(n)&&Object.getOwnPropertyNames(n).some(t=>li(n[t]));function qV(n,t){const{isScriptable:e,isIndexable:s}=Fw(n);for(const i of t){const r=e(i),o=s(i),a=(o||r)&&n[i];if(r&&(li(a)||WV(a))||o&&Zt(a))return!0}return!1}var GV="4.5.1";const KV=["top","bottom","left","right","chartArea"];function ey(n,t){return n==="top"||n==="bottom"||KV.indexOf(n)===-1&&t==="x"}function ny(n,t){return function(e,s){return e[n]===s[n]?e[t]-s[t]:e[n]-s[n]}}function sy(n){const t=n.chart,e=t.options.animation;t.notifyPlugins("afterRender"),Kt(e&&e.onComplete,[n],t)}function YV(n){const t=n.chart,e=t.options.animation;Kt(e&&e.onProgress,[n],t)}function lx(n){return sp()&&typeof n=="string"?n=document.getElementById(n):n&&n.length&&(n=n[0]),n&&n.canvas&&(n=n.canvas),n}const Nl={},iy=n=>{const t=lx(n);return Object.values(Nl).filter(e=>e.canvas===t).pop()};function XV(n,t,e){const s=Object.keys(n);for(const i of s){const r=+i;if(r>=t){const o=n[i];delete n[i],(e>0||r>t)&&(n[r+e]=o)}}}function QV(n,t,e,s){return!e||n.type==="mouseout"?null:s?t:n}class ap{static defaults=te;static instances=Nl;static overrides=zi;static registry=Rn;static version=GV;static getChart=iy;static register(...t){Rn.add(...t),ry()}static unregister(...t){Rn.remove(...t),ry()}constructor(t,e){const s=this.config=new HV(e),i=lx(t),r=iy(i);if(r)throw new Error("Canvas is already in use. Chart with ID '"+r.id+"' must be destroyed before the canvas with ID '"+r.canvas.id+"' can be reused.");const o=s.createResolver(s.chartOptionScopes(),this.getContext());this.platform=new(s.platform||gV(i)),this.platform.updateConfig(s);const a=this.platform.acquireContext(i,o.aspectRatio),l=a&&a.canvas,c=l&&l.height,h=l&&l.width;if(this.id=q2(),this.ctx=a,this.canvas=l,this.width=h,this.height=c,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new MV,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=cO(d=>this.update(d),o.resizeDelay||0),this._dataChanges=[],Nl[this.id]=this,!a||!l){console.error("Failed to create chart: can't acquire context from the given item");return}es.listen(this,"complete",sy),es.listen(this,"progress",YV),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:e},width:s,height:i,_aspectRatio:r}=this;return Ct(t)?e&&r?r:i?s/i:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return Rn}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():A_(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return E_(this.canvas,this.ctx),this}stop(){return es.stop(this),this}resize(t,e){es.running(this)?this._resizeBeforeDraw={width:t,height:e}:this._resize(t,e)}_resize(t,e){const s=this.options,i=this.canvas,r=s.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(i,t,e,r),a=s.devicePixelRatio||this.platform.getDevicePixelRatio(),l=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,A_(this,a,!0)&&(this.notifyPlugins("resize",{size:o}),Kt(s.onResize,[this,o],this),this.attached&&this._doResize(l)&&this.render())}ensureScalesHaveIDs(){const e=this.options.scales||{};zt(e,(s,i)=>{s.id=i})}buildOrUpdateScales(){const t=this.options,e=t.scales,s=this.scales,i=Object.keys(s).reduce((o,a)=>(o[a]=!1,o),{});let r=[];e&&(r=r.concat(Object.keys(e).map(o=>{const a=e[o],l=ud(o,a),c=l==="r",h=l==="x";return{options:a,dposition:c?"chartArea":h?"bottom":"left",dtype:c?"radialLinear":h?"category":"linear"}}))),zt(r,o=>{const a=o.options,l=a.id,c=ud(l,a),h=wt(a.type,o.dtype);(a.position===void 0||ey(a.position,c)!==ey(o.dposition))&&(a.position=o.dposition),i[l]=!0;let d=null;if(l in s&&s[l].type===h)d=s[l];else{const f=Rn.getScale(h);d=new f({id:l,type:h,ctx:this.ctx,chart:this}),s[d.id]=d}d.init(a,t)}),zt(i,(o,a)=>{o||delete s[a]}),zt(s,o=>{Be.configure(this,o,o.options),Be.addBox(this,o)})}_updateMetasets(){const t=this._metasets,e=this.data.datasets.length,s=t.length;if(t.sort((i,r)=>i.index-r.index),s>e){for(let i=e;i<s;++i)this._destroyDatasetMeta(i);t.splice(e,s-e)}this._sortedMetasets=t.slice(0).sort(ny("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:e}}=this;t.length>e.length&&delete this._stacks,t.forEach((s,i)=>{e.filter(r=>r===s._dataset).length===0&&this._destroyDatasetMeta(i)})}buildOrUpdateControllers(){const t=[],e=this.data.datasets;let s,i;for(this._removeUnreferencedMetasets(),s=0,i=e.length;s<i;s++){const r=e[s];let o=this.getDatasetMeta(s);const a=r.type||this.config.type;if(o.type&&o.type!==a&&(this._destroyDatasetMeta(s),o=this.getDatasetMeta(s)),o.type=a,o.indexAxis=r.indexAxis||cd(a,this.options),o.order=r.order||0,o.index=s,o.label=""+r.label,o.visible=this.isDatasetVisible(s),o.controller)o.controller.updateIndex(s),o.controller.linkScales();else{const l=Rn.getController(a),{datasetElementType:c,dataElementType:h}=te.datasets[a];Object.assign(l,{dataElementType:Rn.getElement(h),datasetElementType:c&&Rn.getElement(c)}),o.controller=new l(this,s),t.push(o.controller)}}return this._updateMetasets(),t}_resetElements(){zt(this.data.datasets,(t,e)=>{this.getDatasetMeta(e).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const e=this.config;e.update();const s=this._options=e.createResolver(e.chartOptionScopes(),this.getContext()),i=this._animationsDisabled=!s.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0})===!1)return;const r=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let c=0,h=this.data.datasets.length;c<h;c++){const{controller:d}=this.getDatasetMeta(c),f=!i&&r.indexOf(d)===-1;d.buildOrUpdateElements(f),o=Math.max(+d.getMaxOverflow(),o)}o=this._minPadding=s.layout.autoPadding?o:0,this._updateLayout(o),i||zt(r,c=>{c.reset()}),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(ny("z","_idx"));const{_active:a,_lastEvent:l}=this;l?this._eventHandler(l,!0):a.length&&this._updateHoverStyles(a,a,!0),this.render()}_updateScales(){zt(this.scales,t=>{Be.removeBox(this,t)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,e=new Set(Object.keys(this._listeners)),s=new Set(t.events);(!g_(e,s)||!!this._responsiveListeners!==t.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,e=this._getUniformDataChanges()||[];for(const{method:s,start:i,count:r}of e){const o=s==="_removeElements"?-r:r;XV(t,i,o)}}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const e=this.data.datasets.length,s=r=>new Set(t.filter(o=>o[0]===r).map((o,a)=>a+","+o.splice(1).join(","))),i=s(0);for(let r=1;r<e;r++)if(!g_(i,s(r)))return;return Array.from(i).map(r=>r.split(",")).map(r=>({method:r[1],start:+r[2],count:+r[3]}))}_updateLayout(t){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Be.update(this,this.width,this.height,t);const e=this.chartArea,s=e.width<=0||e.height<=0;this._layers=[],zt(this.boxes,i=>{s&&i.position==="chartArea"||(i.configure&&i.configure(),this._layers.push(...i._layers()))},this),this._layers.forEach((i,r)=>{i._idx=r}),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})!==!1){for(let e=0,s=this.data.datasets.length;e<s;++e)this.getDatasetMeta(e).controller.configure();for(let e=0,s=this.data.datasets.length;e<s;++e)this._updateDataset(e,li(t)?t({datasetIndex:e}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,e){const s=this.getDatasetMeta(t),i={meta:s,index:t,mode:e,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",i)!==!1&&(s.controller._update(e),i.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",i))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(es.has(this)?this.attached&&!es.running(this)&&es.start(this):(this.draw(),sy({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:s,height:i}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(s,i)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const e=this._layers;for(t=0;t<e.length&&e[t].z<=0;++t)e[t].draw(this.chartArea);for(this._drawDatasets();t<e.length;++t)e[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const e=this._sortedMetasets,s=[];let i,r;for(i=0,r=e.length;i<r;++i){const o=e[i];(!t||o.visible)&&s.push(o)}return s}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const t=this.getSortedVisibleDatasetMetas();for(let e=t.length-1;e>=0;--e)this._drawDataset(t[e]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const e=this.ctx,s={meta:t,index:t.index,cancelable:!0},i=Yw(this,t);this.notifyPlugins("beforeDatasetDraw",s)!==!1&&(i&&du(e,i),t.controller.draw(),i&&fu(e),s.cancelable=!1,this.notifyPlugins("afterDatasetDraw",s))}isPointInArea(t){return hs(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,e,s,i){const r=KL.modes[e];return typeof r=="function"?r(this,t,s,i):[]}getDatasetMeta(t){const e=this.data.datasets[t],s=this._metasets;let i=s.filter(r=>r&&r._dataset===e).pop();return i||(i={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:e&&e.order||0,index:t,_dataset:e,_parsed:[],_sorted:!1},s.push(i)),i}getContext(){return this.$context||(this.$context=di(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const e=this.data.datasets[t];if(!e)return!1;const s=this.getDatasetMeta(t);return typeof s.hidden=="boolean"?!s.hidden:!e.hidden}setDatasetVisibility(t,e){const s=this.getDatasetMeta(t);s.hidden=!e}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,e,s){const i=s?"show":"hide",r=this.getDatasetMeta(t),o=r.controller._resolveAnimations(void 0,i);aa(e)?(r.data[e].hidden=!s,this.update()):(this.setDatasetVisibility(t,s),o.update(r,{visible:s}),this.update(a=>a.datasetIndex===t?i:void 0))}hide(t,e){this._updateVisibility(t,e,!1)}show(t,e){this._updateVisibility(t,e,!0)}_destroyDatasetMeta(t){const e=this._metasets[t];e&&e.controller&&e.controller._destroy(),delete this._metasets[t]}_stop(){let t,e;for(this.stop(),es.remove(this),t=0,e=this.data.datasets.length;t<e;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:e}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),E_(t,e),this.platform.releaseContext(e),this.canvas=null,this.ctx=null),delete Nl[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,e=this.platform,s=(r,o)=>{e.addEventListener(this,r,o),t[r]=o},i=(r,o,a)=>{r.offsetX=o,r.offsetY=a,this._eventHandler(r)};zt(this.options.events,r=>s(r,i))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,e=this.platform,s=(l,c)=>{e.addEventListener(this,l,c),t[l]=c},i=(l,c)=>{t[l]&&(e.removeEventListener(this,l,c),delete t[l])},r=(l,c)=>{this.canvas&&this.resize(l,c)};let o;const a=()=>{i("attach",a),this.attached=!0,this.resize(),s("resize",r),s("detach",o)};o=()=>{this.attached=!1,i("resize",r),this._stop(),this._resize(0,0),s("attach",a)},e.isAttached(this.canvas)?a():o()}unbindEvents(){zt(this._listeners,(t,e)=>{this.platform.removeEventListener(this,e,t)}),this._listeners={},zt(this._responsiveListeners,(t,e)=>{this.platform.removeEventListener(this,e,t)}),this._responsiveListeners=void 0}updateHoverStyle(t,e,s){const i=s?"set":"remove";let r,o,a,l;for(e==="dataset"&&(r=this.getDatasetMeta(t[0].datasetIndex),r.controller["_"+i+"DatasetHoverStyle"]()),a=0,l=t.length;a<l;++a){o=t[a];const c=o&&this.getDatasetMeta(o.datasetIndex).controller;c&&c[i+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const e=this._active||[],s=t.map(({datasetIndex:r,index:o})=>{const a=this.getDatasetMeta(r);if(!a)throw new Error("No dataset found at index "+r);return{datasetIndex:r,element:a.data[o],index:o}});!mc(s,e)&&(this._active=s,this._lastEvent=null,this._updateHoverStyles(s,e))}notifyPlugins(t,e,s){return this._plugins.notify(this,t,e,s)}isPluginEnabled(t){return this._plugins._cache.filter(e=>e.plugin.id===t).length===1}_updateHoverStyles(t,e,s){const i=this.options.hover,r=(l,c)=>l.filter(h=>!c.some(d=>h.datasetIndex===d.datasetIndex&&h.index===d.index)),o=r(e,t),a=s?t:r(t,e);o.length&&this.updateHoverStyle(o,i.mode,!1),a.length&&i.mode&&this.updateHoverStyle(a,i.mode,!0)}_eventHandler(t,e){const s={event:t,replay:e,cancelable:!0,inChartArea:this.isPointInArea(t)},i=o=>(o.options.events||this.options.events).includes(t.native.type);if(this.notifyPlugins("beforeEvent",s,i)===!1)return;const r=this._handleEvent(t,e,s.inChartArea);return s.cancelable=!1,this.notifyPlugins("afterEvent",s,i),(r||s.changed)&&this.render(),this}_handleEvent(t,e,s){const{_active:i=[],options:r}=this,o=e,a=this._getActiveElements(t,i,s,o),l=J2(t),c=QV(t,this._lastEvent,s,l);s&&(this._lastEvent=null,Kt(r.onHover,[t,a,this],this),l&&Kt(r.onClick,[t,a,this],this));const h=!mc(a,i);return(h||e)&&(this._active=a,this._updateHoverStyles(a,i,e)),this._lastEvent=c,h}_getActiveElements(t,e,s,i){if(t.type==="mouseout")return[];if(!s)return e;const r=this.options.hover;return this.getElementsAtEventForMode(t,r.mode,r,i)}}function ry(){return zt(ap.instances,n=>n._plugins.invalidate())}function JV(n,t,e){const{startAngle:s,x:i,y:r,outerRadius:o,innerRadius:a,options:l}=t,{borderWidth:c,borderJoinStyle:h}=l,d=Math.min(c/o,Oe(s-e));if(n.beginPath(),n.arc(i,r,o-c/2,s+d/2,e-d/2),a>0){const f=Math.min(c/a,Oe(s-e));n.arc(i,r,a+c/2,e-f/2,s+f/2,!0)}else{const f=Math.min(c/2,o*Oe(s-e));if(h==="round")n.arc(i,r,f,e-Vt/2,s+Vt/2,!0);else if(h==="bevel"){const g=2*f*f,_=-g*Math.cos(e+Vt/2)+i,b=-g*Math.sin(e+Vt/2)+r,v=g*Math.cos(s+Vt/2)+i,A=g*Math.sin(s+Vt/2)+r;n.lineTo(_,b),n.lineTo(v,A)}}n.closePath(),n.moveTo(0,0),n.rect(0,0,n.canvas.width,n.canvas.height),n.clip("evenodd")}function ZV(n,t,e){const{startAngle:s,pixelMargin:i,x:r,y:o,outerRadius:a,innerRadius:l}=t;let c=i/a;n.beginPath(),n.arc(r,o,a,s-c,e+c),l>i?(c=i/l,n.arc(r,o,l,e+c,s-c,!0)):n.arc(r,o,i,e+le,s-le),n.closePath(),n.clip()}function tN(n){return Zf(n,["outerStart","outerEnd","innerStart","innerEnd"])}function eN(n,t,e,s){const i=tN(n.options.borderRadius),r=(e-t)/2,o=Math.min(r,s*t/2),a=l=>{const c=(e-Math.min(r,l))*s/2;return _e(l,0,Math.min(r,c))};return{outerStart:a(i.outerStart),outerEnd:a(i.outerEnd),innerStart:_e(i.innerStart,0,o),innerEnd:_e(i.innerEnd,0,o)}}function sr(n,t,e,s){return{x:e+n*Math.cos(t),y:s+n*Math.sin(t)}}function xc(n,t,e,s,i,r){const{x:o,y:a,startAngle:l,pixelMargin:c,innerRadius:h}=t,d=Math.max(t.outerRadius+s+e-c,0),f=h>0?h+s+e+c:0;let g=0;const _=i-l;if(s){const it=h>0?h-s:0,dt=d>0?d-s:0,ot=(it+dt)/2,H=ot!==0?_*ot/(ot+s):_;g=(_-H)/2}const b=Math.max(.001,_*d-e/Vt)/d,v=(_-b)/2,A=l+v+g,C=i-v-g,{outerStart:O,outerEnd:k,innerStart:D,innerEnd:N}=eN(t,f,d,C-A),w=d-O,y=d-k,x=A+O/w,E=C-k/y,I=f+D,P=f+N,S=A+D/I,rt=C-N/P;if(n.beginPath(),r){const it=(x+E)/2;if(n.arc(o,a,d,x,it),n.arc(o,a,d,it,E),k>0){const K=sr(y,E,o,a);n.arc(K.x,K.y,k,E,C+le)}const dt=sr(P,C,o,a);if(n.lineTo(dt.x,dt.y),N>0){const K=sr(P,rt,o,a);n.arc(K.x,K.y,N,C+le,rt+Math.PI)}const ot=(C-N/f+(A+D/f))/2;if(n.arc(o,a,f,C-N/f,ot,!0),n.arc(o,a,f,ot,A+D/f,!0),D>0){const K=sr(I,S,o,a);n.arc(K.x,K.y,D,S+Math.PI,A-le)}const H=sr(w,A,o,a);if(n.lineTo(H.x,H.y),O>0){const K=sr(w,x,o,a);n.arc(K.x,K.y,O,A-le,x)}}else{n.moveTo(o,a);const it=Math.cos(x)*d+o,dt=Math.sin(x)*d+a;n.lineTo(it,dt);const ot=Math.cos(E)*d+o,H=Math.sin(E)*d+a;n.lineTo(ot,H)}n.closePath()}function nN(n,t,e,s,i){const{fullCircles:r,startAngle:o,circumference:a}=t;let l=t.endAngle;if(r){xc(n,t,e,s,l,i);for(let c=0;c<r;++c)n.fill();isNaN(a)||(l=o+(a%Jt||Jt))}return xc(n,t,e,s,l,i),n.fill(),l}function sN(n,t,e,s,i){const{fullCircles:r,startAngle:o,circumference:a,options:l}=t,{borderWidth:c,borderJoinStyle:h,borderDash:d,borderDashOffset:f,borderRadius:g}=l,_=l.borderAlign==="inner";if(!c)return;n.setLineDash(d||[]),n.lineDashOffset=f,_?(n.lineWidth=c*2,n.lineJoin=h||"round"):(n.lineWidth=c,n.lineJoin=h||"bevel");let b=t.endAngle;if(r){xc(n,t,e,s,b,i);for(let v=0;v<r;++v)n.stroke();isNaN(a)||(b=o+(a%Jt||Jt))}_&&ZV(n,t,b),l.selfJoin&&b-o>=Vt&&g===0&&h!=="miter"&&JV(n,t,b),r||(xc(n,t,e,s,b,i),n.stroke())}class iN extends Es{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:t=>t!=="borderDash"};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(t){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,t&&Object.assign(this,t)}inRange(t,e,s){const i=this.getProps(["x","y"],s),{angle:r,distance:o}=Cw(i,{x:t,y:e}),{startAngle:a,endAngle:l,innerRadius:c,outerRadius:h,circumference:d}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],s),f=(this.options.spacing+this.options.borderWidth)/2,g=wt(d,l-a),_=la(r,a,l)&&a!==l,b=g>=Jt||_,v=cs(o,c+f,h+f);return b&&v}getCenterPoint(t){const{x:e,y:s,startAngle:i,endAngle:r,innerRadius:o,outerRadius:a}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],t),{offset:l,spacing:c}=this.options,h=(i+r)/2,d=(o+a+c+l)/2;return{x:e+Math.cos(h)*d,y:s+Math.sin(h)*d}}tooltipPosition(t){return this.getCenterPoint(t)}draw(t){const{options:e,circumference:s}=this,i=(e.offset||0)/4,r=(e.spacing||0)/2,o=e.circular;if(this.pixelMargin=e.borderAlign==="inner"?.33:0,this.fullCircles=s>Jt?Math.floor(s/Jt):0,s===0||this.innerRadius<0||this.outerRadius<0)return;t.save();const a=(this.startAngle+this.endAngle)/2;t.translate(Math.cos(a)*i,Math.sin(a)*i);const l=1-Math.sin(Math.min(Vt,s||0)),c=i*l;t.fillStyle=e.backgroundColor,t.strokeStyle=e.borderColor,nN(t,this,c,r,o),sN(t,this,c,r,o),t.restore()}}function cx(n,t,e=t){n.lineCap=wt(e.borderCapStyle,t.borderCapStyle),n.setLineDash(wt(e.borderDash,t.borderDash)),n.lineDashOffset=wt(e.borderDashOffset,t.borderDashOffset),n.lineJoin=wt(e.borderJoinStyle,t.borderJoinStyle),n.lineWidth=wt(e.borderWidth,t.borderWidth),n.strokeStyle=wt(e.borderColor,t.borderColor)}function rN(n,t,e){n.lineTo(e.x,e.y)}function oN(n){return n.stepped?wO:n.tension||n.cubicInterpolationMode==="monotone"?xO:rN}function ux(n,t,e={}){const s=n.length,{start:i=0,end:r=s-1}=e,{start:o,end:a}=t,l=Math.max(i,o),c=Math.min(r,a),h=i<o&&r<o||i>a&&r>a;return{count:s,start:l,loop:t.loop,ilen:c<l&&!h?s+c-l:c-l}}function aN(n,t,e,s){const{points:i,options:r}=t,{count:o,start:a,loop:l,ilen:c}=ux(i,e,s),h=oN(r);let{move:d=!0,reverse:f}=s||{},g,_,b;for(g=0;g<=c;++g)_=i[(a+(f?c-g:g))%o],!_.skip&&(d?(n.moveTo(_.x,_.y),d=!1):h(n,b,_,f,r.stepped),b=_);return l&&(_=i[(a+(f?c:0))%o],h(n,b,_,f,r.stepped)),!!l}function lN(n,t,e,s){const i=t.points,{count:r,start:o,ilen:a}=ux(i,e,s),{move:l=!0,reverse:c}=s||{};let h=0,d=0,f,g,_,b,v,A;const C=k=>(o+(c?a-k:k))%r,O=()=>{b!==v&&(n.lineTo(h,v),n.lineTo(h,b),n.lineTo(h,A))};for(l&&(g=i[C(0)],n.moveTo(g.x,g.y)),f=0;f<=a;++f){if(g=i[C(f)],g.skip)continue;const k=g.x,D=g.y,N=k|0;N===_?(D<b?b=D:D>v&&(v=D),h=(d*h+k)/++d):(O(),n.lineTo(k,D),_=N,d=0,b=v=D),A=D}O()}function hd(n){const t=n.options,e=t.borderDash&&t.borderDash.length;return!n._decimated&&!n._loop&&!t.tension&&t.cubicInterpolationMode!=="monotone"&&!t.stepped&&!e?lN:aN}function cN(n){return n.stepped?tL:n.tension||n.cubicInterpolationMode==="monotone"?eL:Ai}function uN(n,t,e,s){let i=t._path;i||(i=t._path=new Path2D,t.path(i,e,s)&&i.closePath()),cx(n,t.options),n.stroke(i)}function hN(n,t,e,s){const{segments:i,options:r}=t,o=hd(t);for(const a of i)cx(n,r,a.style),n.beginPath(),o(n,t,a,{start:e,end:e+s-1})&&n.closePath(),n.stroke()}const dN=typeof Path2D=="function";function fN(n,t,e,s){dN&&!t.options.segment?uN(n,t,e,s):hN(n,t,e,s)}class mu extends Es{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:t=>t!=="borderDash"&&t!=="fill"};constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,e){const s=this.options;if((s.tension||s.cubicInterpolationMode==="monotone")&&!s.stepped&&!this._pointsUpdated){const i=s.spanGaps?this._loop:this._fullLoop;qO(this._points,s,t,i,e),this._pointsUpdated=!0}}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=aL(this,this.options.segment))}first(){const t=this.segments,e=this.points;return t.length&&e[t[0].start]}last(){const t=this.segments,e=this.points,s=t.length;return s&&e[t[s-1].end]}interpolate(t,e){const s=this.options,i=t[e],r=this.points,o=Kw(this,{property:e,start:i,end:i});if(!o.length)return;const a=[],l=cN(s);let c,h;for(c=0,h=o.length;c<h;++c){const{start:d,end:f}=o[c],g=r[d],_=r[f];if(g===_){a.push(g);continue}const b=Math.abs((i-g[e])/(_[e]-g[e])),v=l(g,_,b,s.stepped);v[e]=t[e],a.push(v)}return a.length===1?a[0]:a}pathSegment(t,e,s){return hd(this)(t,this,e,s)}path(t,e,s){const i=this.segments,r=hd(this);let o=this._loop;e=e||0,s=s||this.points.length-e;for(const a of i)o&=r(t,this,a,{start:e,end:e+s-1});return!!o}draw(t,e,s,i){const r=this.options||{};(this.points||[]).length&&r.borderWidth&&(t.save(),fN(t,this,s,i),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function oy(n,t,e,s){const i=n.options,{[e]:r}=n.getProps([e],s);return Math.abs(t-r)<i.radius+i.hitRadius}class pN extends Es{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(t){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,t&&Object.assign(this,t)}inRange(t,e,s){const i=this.options,{x:r,y:o}=this.getProps(["x","y"],s);return Math.pow(t-r,2)+Math.pow(e-o,2)<Math.pow(i.hitRadius+i.radius,2)}inXRange(t,e){return oy(this,t,"x",e)}inYRange(t,e){return oy(this,t,"y",e)}getCenterPoint(t){const{x:e,y:s}=this.getProps(["x","y"],t);return{x:e,y:s}}size(t){t=t||this.options||{};let e=t.radius||0;e=Math.max(e,e&&t.hoverRadius||0);const s=e&&t.borderWidth||0;return(e+s)*2}draw(t,e){const s=this.options;this.skip||s.radius<.1||!hs(this,e,this.size(s)/2)||(t.strokeStyle=s.borderColor,t.lineWidth=s.borderWidth,t.fillStyle=s.backgroundColor,ld(t,s,this.x,this.y))}getRange(){const t=this.options||{};return t.radius+t.hitRadius}}function hx(n,t){const{x:e,y:s,base:i,width:r,height:o}=n.getProps(["x","y","base","width","height"],t);let a,l,c,h,d;return n.horizontal?(d=o/2,a=Math.min(e,i),l=Math.max(e,i),c=s-d,h=s+d):(d=r/2,a=e-d,l=e+d,c=Math.min(s,i),h=Math.max(s,i)),{left:a,top:c,right:l,bottom:h}}function js(n,t,e,s){return n?0:_e(t,e,s)}function gN(n,t,e){const s=n.options.borderWidth,i=n.borderSkipped,r=Nw(s);return{t:js(i.top,r.top,0,e),r:js(i.right,r.right,0,t),b:js(i.bottom,r.bottom,0,e),l:js(i.left,r.left,0,t)}}function mN(n,t,e){const{enableBorderRadius:s}=n.getProps(["enableBorderRadius"]),i=n.options.borderRadius,r=Oi(i),o=Math.min(t,e),a=n.borderSkipped,l=s||Dt(i);return{topLeft:js(!l||a.top||a.left,r.topLeft,0,o),topRight:js(!l||a.top||a.right,r.topRight,0,o),bottomLeft:js(!l||a.bottom||a.left,r.bottomLeft,0,o),bottomRight:js(!l||a.bottom||a.right,r.bottomRight,0,o)}}function _N(n){const t=hx(n),e=t.right-t.left,s=t.bottom-t.top,i=gN(n,e/2,s/2),r=mN(n,e/2,s/2);return{outer:{x:t.left,y:t.top,w:e,h:s,radius:r},inner:{x:t.left+i.l,y:t.top+i.t,w:e-i.l-i.r,h:s-i.t-i.b,radius:{topLeft:Math.max(0,r.topLeft-Math.max(i.t,i.l)),topRight:Math.max(0,r.topRight-Math.max(i.t,i.r)),bottomLeft:Math.max(0,r.bottomLeft-Math.max(i.b,i.l)),bottomRight:Math.max(0,r.bottomRight-Math.max(i.b,i.r))}}}}function ph(n,t,e,s){const i=t===null,r=e===null,a=n&&!(i&&r)&&hx(n,s);return a&&(i||cs(t,a.left,a.right))&&(r||cs(e,a.top,a.bottom))}function yN(n){return n.topLeft||n.topRight||n.bottomLeft||n.bottomRight}function bN(n,t){n.rect(t.x,t.y,t.w,t.h)}function gh(n,t,e={}){const s=n.x!==e.x?-t:0,i=n.y!==e.y?-t:0,r=(n.x+n.w!==e.x+e.w?t:0)-s,o=(n.y+n.h!==e.y+e.h?t:0)-i;return{x:n.x+s,y:n.y+i,w:n.w+r,h:n.h+o,radius:n.radius}}class vN extends Es{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:e,options:{borderColor:s,backgroundColor:i}}=this,{inner:r,outer:o}=_N(this),a=yN(o.radius)?ca:bN;t.save(),(o.w!==r.w||o.h!==r.h)&&(t.beginPath(),a(t,gh(o,e,r)),t.clip(),a(t,gh(r,-e,o)),t.fillStyle=s,t.fill("evenodd")),t.beginPath(),a(t,gh(r,e)),t.fillStyle=i,t.fill(),t.restore()}inRange(t,e,s){return ph(this,t,e,s)}inXRange(t,e){return ph(this,t,null,e)}inYRange(t,e){return ph(this,null,t,e)}getCenterPoint(t){const{x:e,y:s,base:i,horizontal:r}=this.getProps(["x","y","base","horizontal"],t);return{x:r?(e+i)/2:e,y:r?s:(s+i)/2}}getRange(t){return t==="x"?this.width/2:this.height/2}}var wN=Object.freeze({__proto__:null,ArcElement:iN,BarElement:vN,LineElement:mu,PointElement:pN});const dd=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],ay=dd.map(n=>n.replace("rgb(","rgba(").replace(")",", 0.5)"));function dx(n){return dd[n%dd.length]}function fx(n){return ay[n%ay.length]}function xN(n,t){return n.borderColor=dx(t),n.backgroundColor=fx(t),++t}function TN(n,t){return n.backgroundColor=n.data.map(()=>dx(t++)),t}function EN(n,t){return n.backgroundColor=n.data.map(()=>fx(t++)),t}function IN(n){let t=0;return(e,s)=>{const i=n.getDatasetMeta(s).controller;i instanceof rp?t=TN(e,t):i instanceof Zw?t=EN(e,t):i&&(t=xN(e,t))}}function ly(n){let t;for(t in n)if(n[t].borderColor||n[t].backgroundColor)return!0;return!1}function SN(n){return n&&(n.borderColor||n.backgroundColor)}function AN(){return te.borderColor!=="rgba(0,0,0,0.1)"||te.backgroundColor!=="rgba(0,0,0,0.1)"}var CN={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(n,t,e){if(!e.enabled)return;const{data:{datasets:s},options:i}=n.config,{elements:r}=i,o=ly(s)||SN(i)||r&&ly(r)||AN();if(!e.forceOverride&&o)return;const a=IN(n);s.forEach(a)}};function PN(n,t,e,s,i){const r=i.samples||s;if(r>=e)return n.slice(t,t+e);const o=[],a=(e-2)/(r-2);let l=0;const c=t+e-1;let h=t,d,f,g,_,b;for(o[l++]=n[h],d=0;d<r-2;d++){let v=0,A=0,C;const O=Math.floor((d+1)*a)+1+t,k=Math.min(Math.floor((d+2)*a)+1,e)+t,D=k-O;for(C=O;C<k;C++)v+=n[C].x,A+=n[C].y;v/=D,A/=D;const N=Math.floor(d*a)+1+t,w=Math.min(Math.floor((d+1)*a)+1,e)+t,{x:y,y:x}=n[h];for(g=_=-1,C=N;C<w;C++)_=.5*Math.abs((y-v)*(n[C].y-x)-(y-n[C].x)*(A-x)),_>g&&(g=_,f=n[C],b=C);o[l++]=f,h=b}return o[l++]=n[c],o}function RN(n,t,e,s){let i=0,r=0,o,a,l,c,h,d,f,g,_,b;const v=[],A=t+e-1,C=n[t].x,k=n[A].x-C;for(o=t;o<t+e;++o){a=n[o],l=(a.x-C)/k*s,c=a.y;const D=l|0;if(D===h)c<_?(_=c,d=o):c>b&&(b=c,f=o),i=(r*i+a.x)/++r;else{const N=o-1;if(!Ct(d)&&!Ct(f)){const w=Math.min(d,f),y=Math.max(d,f);w!==g&&w!==N&&v.push({...n[w],x:i}),y!==g&&y!==N&&v.push({...n[y],x:i})}o>0&&N!==g&&v.push(n[N]),v.push(a),h=D,r=0,_=b=c,d=f=g=o}}return v}function px(n){if(n._decimated){const t=n._data;delete n._decimated,delete n._data,Object.defineProperty(n,"data",{configurable:!0,enumerable:!0,writable:!0,value:t})}}function cy(n){n.data.datasets.forEach(t=>{px(t)})}function kN(n,t){const e=t.length;let s=0,i;const{iScale:r}=n,{min:o,max:a,minDefined:l,maxDefined:c}=r.getUserBounds();return l&&(s=_e(us(t,r.axis,o).lo,0,e-1)),c?i=_e(us(t,r.axis,a).hi+1,s,e)-s:i=e-s,{start:s,count:i}}var DN={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(n,t,e)=>{if(!e.enabled){cy(n);return}const s=n.width;n.data.datasets.forEach((i,r)=>{const{_data:o,indexAxis:a}=i,l=n.getDatasetMeta(r),c=o||i.data;if(bo([a,n.options.indexAxis])==="y"||!l.controller.supportsDecimation)return;const h=n.scales[l.xAxisID];if(h.type!=="linear"&&h.type!=="time"||n.options.parsing)return;let{start:d,count:f}=kN(l,c);const g=e.threshold||4*s;if(f<=g){px(i);return}Ct(o)&&(i._data=c,delete i.data,Object.defineProperty(i,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(b){this._data=b}}));let _;switch(e.algorithm){case"lttb":_=PN(c,d,f,s,e);break;case"min-max":_=RN(c,d,f,s);break;default:throw new Error(`Unsupported decimation algorithm '${e.algorithm}'`)}i._decimated=_})},destroy(n){cy(n)}};function MN(n,t,e){const s=n.segments,i=n.points,r=t.points,o=[];for(const a of s){let{start:l,end:c}=a;c=_u(l,c,i);const h=fd(e,i[l],i[c],a.loop);if(!t.segments){o.push({source:a,target:h,start:i[l],end:i[c]});continue}const d=Kw(t,h);for(const f of d){const g=fd(e,r[f.start],r[f.end],f.loop),_=Gw(a,i,g);for(const b of _)o.push({source:b,target:f,start:{[e]:uy(h,g,"start",Math.max)},end:{[e]:uy(h,g,"end",Math.min)}})}}return o}function fd(n,t,e,s){if(s)return;let i=t[n],r=e[n];return n==="angle"&&(i=Oe(i),r=Oe(r)),{property:n,start:i,end:r}}function ON(n,t){const{x:e=null,y:s=null}=n||{},i=t.points,r=[];return t.segments.forEach(({start:o,end:a})=>{a=_u(o,a,i);const l=i[o],c=i[a];s!==null?(r.push({x:l.x,y:s}),r.push({x:c.x,y:s})):e!==null&&(r.push({x:e,y:l.y}),r.push({x:e,y:c.y}))}),r}function _u(n,t,e){for(;t>n;t--){const s=e[t];if(!isNaN(s.x)&&!isNaN(s.y))break}return t}function uy(n,t,e,s){return n&&t?s(n[e],t[e]):n?n[e]:t?t[e]:0}function gx(n,t){let e=[],s=!1;return Zt(n)?(s=!0,e=n):e=ON(n,t),e.length?new mu({points:e,options:{tension:0},_loop:s,_fullLoop:s}):null}function hy(n){return n&&n.fill!==!1}function LN(n,t,e){let i=n[t].fill;const r=[t];let o;if(!e)return i;for(;i!==!1&&r.indexOf(i)===-1;){if(!re(i))return i;if(o=n[i],!o)return!1;if(o.visible)return i;r.push(i),i=o.fill}return!1}function VN(n,t,e){const s=UN(n);if(Dt(s))return isNaN(s.value)?!1:s;let i=parseFloat(s);return re(i)&&Math.floor(i)===i?NN(s[0],t,i,e):["origin","start","end","stack","shape"].indexOf(s)>=0&&s}function NN(n,t,e,s){return(n==="-"||n==="+")&&(e=t+e),e===t||e<0||e>=s?!1:e}function FN(n,t){let e=null;return n==="start"?e=t.bottom:n==="end"?e=t.top:Dt(n)?e=t.getPixelForValue(n.value):t.getBasePixel&&(e=t.getBasePixel()),e}function BN(n,t,e){let s;return n==="start"?s=e:n==="end"?s=t.options.reverse?t.min:t.max:Dt(n)?s=n.value:s=t.getBaseValue(),s}function UN(n){const t=n.options,e=t.fill;let s=wt(e&&e.target,e);return s===void 0&&(s=!!t.backgroundColor),s===!1||s===null?!1:s===!0?"origin":s}function $N(n){const{scale:t,index:e,line:s}=n,i=[],r=s.segments,o=s.points,a=zN(t,e);a.push(gx({x:null,y:t.bottom},s));for(let l=0;l<r.length;l++){const c=r[l];for(let h=c.start;h<=c.end;h++)jN(i,o[h],a)}return new mu({points:i,options:{}})}function zN(n,t){const e=[],s=n.getMatchingVisibleMetas("line");for(let i=0;i<s.length;i++){const r=s[i];if(r.index===t)break;r.hidden||e.unshift(r.dataset)}return e}function jN(n,t,e){const s=[];for(let i=0;i<e.length;i++){const r=e[i],{first:o,last:a,point:l}=HN(r,t,"x");if(!(!l||o&&a)){if(o)s.unshift(l);else if(n.push(l),!a)break}}n.push(...s)}function HN(n,t,e){const s=n.interpolate(t,e);if(!s)return{};const i=s[e],r=n.segments,o=n.points;let a=!1,l=!1;for(let c=0;c<r.length;c++){const h=r[c],d=o[h.start][e],f=o[h.end][e];if(cs(i,d,f)){a=i===d,l=i===f;break}}return{first:a,last:l,point:s}}class mx{constructor(t){this.x=t.x,this.y=t.y,this.radius=t.radius}pathSegment(t,e,s){const{x:i,y:r,radius:o}=this;return e=e||{start:0,end:Jt},t.arc(i,r,o,e.end,e.start,!0),!s.bounds}interpolate(t){const{x:e,y:s,radius:i}=this,r=t.angle;return{x:e+Math.cos(r)*i,y:s+Math.sin(r)*i,angle:r}}}function WN(n){const{chart:t,fill:e,line:s}=n;if(re(e))return qN(t,e);if(e==="stack")return $N(n);if(e==="shape")return!0;const i=GN(n);return i instanceof mx?i:gx(i,s)}function qN(n,t){const e=n.getDatasetMeta(t);return e&&n.isDatasetVisible(t)?e.dataset:null}function GN(n){return(n.scale||{}).getPointPositionForValue?YN(n):KN(n)}function KN(n){const{scale:t={},fill:e}=n,s=FN(e,t);if(re(s)){const i=t.isHorizontal();return{x:i?s:null,y:i?null:s}}return null}function YN(n){const{scale:t,fill:e}=n,s=t.options,i=t.getLabels().length,r=s.reverse?t.max:t.min,o=BN(e,t,r),a=[];if(s.grid.circular){const l=t.getPointPositionForValue(0,r);return new mx({x:l.x,y:l.y,radius:t.getDistanceFromCenterForValue(o)})}for(let l=0;l<i;++l)a.push(t.getPointPositionForValue(l,o));return a}function mh(n,t,e){const s=WN(t),{chart:i,index:r,line:o,scale:a,axis:l}=t,c=o.options,h=c.fill,d=c.backgroundColor,{above:f=d,below:g=d}=h||{},_=i.getDatasetMeta(r),b=Yw(i,_);s&&o.points.length&&(du(n,e),XN(n,{line:o,target:s,above:f,below:g,area:e,scale:a,axis:l,clip:b}),fu(n))}function XN(n,t){const{line:e,target:s,above:i,below:r,area:o,scale:a,clip:l}=t,c=e._loop?"angle":t.axis;n.save();let h=r;r!==i&&(c==="x"?(dy(n,s,o.top),_h(n,{line:e,target:s,color:i,scale:a,property:c,clip:l}),n.restore(),n.save(),dy(n,s,o.bottom)):c==="y"&&(fy(n,s,o.left),_h(n,{line:e,target:s,color:r,scale:a,property:c,clip:l}),n.restore(),n.save(),fy(n,s,o.right),h=i)),_h(n,{line:e,target:s,color:h,scale:a,property:c,clip:l}),n.restore()}function dy(n,t,e){const{segments:s,points:i}=t;let r=!0,o=!1;n.beginPath();for(const a of s){const{start:l,end:c}=a,h=i[l],d=i[_u(l,c,i)];r?(n.moveTo(h.x,h.y),r=!1):(n.lineTo(h.x,e),n.lineTo(h.x,h.y)),o=!!t.pathSegment(n,a,{move:o}),o?n.closePath():n.lineTo(d.x,e)}n.lineTo(t.first().x,e),n.closePath(),n.clip()}function fy(n,t,e){const{segments:s,points:i}=t;let r=!0,o=!1;n.beginPath();for(const a of s){const{start:l,end:c}=a,h=i[l],d=i[_u(l,c,i)];r?(n.moveTo(h.x,h.y),r=!1):(n.lineTo(e,h.y),n.lineTo(h.x,h.y)),o=!!t.pathSegment(n,a,{move:o}),o?n.closePath():n.lineTo(e,d.y)}n.lineTo(e,t.first().y),n.closePath(),n.clip()}function _h(n,t){const{line:e,target:s,property:i,color:r,scale:o,clip:a}=t,l=MN(e,s,i);for(const{source:c,target:h,start:d,end:f}of l){const{style:{backgroundColor:g=r}={}}=c,_=s!==!0;n.save(),n.fillStyle=g,QN(n,o,a,_&&fd(i,d,f)),n.beginPath();const b=!!e.pathSegment(n,c);let v;if(_){b?n.closePath():py(n,s,f,i);const A=!!s.pathSegment(n,h,{move:b,reverse:!0});v=b&&A,v||py(n,s,d,i)}n.closePath(),n.fill(v?"evenodd":"nonzero"),n.restore()}}function QN(n,t,e,s){const i=t.chart.chartArea,{property:r,start:o,end:a}=s||{};if(r==="x"||r==="y"){let l,c,h,d;r==="x"?(l=o,c=i.top,h=a,d=i.bottom):(l=i.left,c=o,h=i.right,d=a),n.beginPath(),e&&(l=Math.max(l,e.left),h=Math.min(h,e.right),c=Math.max(c,e.top),d=Math.min(d,e.bottom)),n.rect(l,c,h-l,d-c),n.clip()}}function py(n,t,e,s){const i=t.interpolate(e,s);i&&n.lineTo(i.x,i.y)}var JN={id:"filler",afterDatasetsUpdate(n,t,e){const s=(n.data.datasets||[]).length,i=[];let r,o,a,l;for(o=0;o<s;++o)r=n.getDatasetMeta(o),a=r.dataset,l=null,a&&a.options&&a instanceof mu&&(l={visible:n.isDatasetVisible(o),index:o,fill:VN(a,o,s),chart:n,axis:r.controller.options.indexAxis,scale:r.vScale,line:a}),r.$filler=l,i.push(l);for(o=0;o<s;++o)l=i[o],!(!l||l.fill===!1)&&(l.fill=LN(i,o,e.propagate))},beforeDraw(n,t,e){const s=e.drawTime==="beforeDraw",i=n.getSortedVisibleDatasetMetas(),r=n.chartArea;for(let o=i.length-1;o>=0;--o){const a=i[o].$filler;a&&(a.line.updateControlPoints(r,a.axis),s&&a.fill&&mh(n.ctx,a,r))}},beforeDatasetsDraw(n,t,e){if(e.drawTime!=="beforeDatasetsDraw")return;const s=n.getSortedVisibleDatasetMetas();for(let i=s.length-1;i>=0;--i){const r=s[i].$filler;hy(r)&&mh(n.ctx,r,n.chartArea)}},beforeDatasetDraw(n,t,e){const s=t.meta.$filler;!hy(s)||e.drawTime!=="beforeDatasetDraw"||mh(n.ctx,s,n.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const gy=(n,t)=>{let{boxHeight:e=t,boxWidth:s=t}=n;return n.usePointStyle&&(e=Math.min(e,t),s=n.pointStyleWidth||Math.min(s,t)),{boxWidth:s,boxHeight:e,itemHeight:Math.max(t,e)}},ZN=(n,t)=>n!==null&&t!==null&&n.datasetIndex===t.datasetIndex&&n.index===t.index;class my extends Es{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e,s){this.maxWidth=t,this.maxHeight=e,this._margins=s,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let e=Kt(t.generateLabels,[this.chart],this)||[];t.filter&&(e=e.filter(s=>t.filter(s,this.chart.data))),t.sort&&(e=e.sort((s,i)=>t.sort(s,i,this.chart.data))),this.options.reverse&&e.reverse(),this.legendItems=e}fit(){const{options:t,ctx:e}=this;if(!t.display){this.width=this.height=0;return}const s=t.labels,i=pe(s.font),r=i.size,o=this._computeTitleHeight(),{boxWidth:a,itemHeight:l}=gy(s,r);let c,h;e.font=i.string,this.isHorizontal()?(c=this.maxWidth,h=this._fitRows(o,r,a,l)+10):(h=this.maxHeight,c=this._fitCols(o,i,a,l)+10),this.width=Math.min(c,t.maxWidth||this.maxWidth),this.height=Math.min(h,t.maxHeight||this.maxHeight)}_fitRows(t,e,s,i){const{ctx:r,maxWidth:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.lineWidths=[0],h=i+a;let d=t;r.textAlign="left",r.textBaseline="middle";let f=-1,g=-h;return this.legendItems.forEach((_,b)=>{const v=s+e/2+r.measureText(_.text).width;(b===0||c[c.length-1]+v+2*a>o)&&(d+=h,c[c.length-(b>0?0:1)]=0,g+=h,f++),l[b]={left:0,top:g,row:f,width:v,height:i},c[c.length-1]+=v+a}),d}_fitCols(t,e,s,i){const{ctx:r,maxHeight:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.columnSizes=[],h=o-t;let d=a,f=0,g=0,_=0,b=0;return this.legendItems.forEach((v,A)=>{const{itemWidth:C,itemHeight:O}=tF(s,e,r,v,i);A>0&&g+O+2*a>h&&(d+=f+a,c.push({width:f,height:g}),_+=f+a,b++,f=g=0),l[A]={left:_,top:g,col:b,width:C,height:O},f=Math.max(f,C),g+=O+a}),d+=f,c.push({width:f,height:g}),d}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:e,options:{align:s,labels:{padding:i},rtl:r}}=this,o=br(r,this.left,this.width);if(this.isHorizontal()){let a=0,l=De(s,this.left+i,this.right-this.lineWidths[a]);for(const c of e)a!==c.row&&(a=c.row,l=De(s,this.left+i,this.right-this.lineWidths[a])),c.top+=this.top+t+i,c.left=o.leftForLtr(o.x(l),c.width),l+=c.width+i}else{let a=0,l=De(s,this.top+t+i,this.bottom-this.columnSizes[a].height);for(const c of e)c.col!==a&&(a=c.col,l=De(s,this.top+t+i,this.bottom-this.columnSizes[a].height)),c.top=l,c.left+=this.left+i,c.left=o.leftForLtr(o.x(c.left),c.width),l+=c.height+i}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const t=this.ctx;du(t,this),this._draw(),fu(t)}}_draw(){const{options:t,columnSizes:e,lineWidths:s,ctx:i}=this,{align:r,labels:o}=t,a=te.color,l=br(t.rtl,this.left,this.width),c=pe(o.font),{padding:h}=o,d=c.size,f=d/2;let g;this.drawTitle(),i.textAlign=l.textAlign("left"),i.textBaseline="middle",i.lineWidth=.5,i.font=c.string;const{boxWidth:_,boxHeight:b,itemHeight:v}=gy(o,d),A=function(N,w,y){if(isNaN(_)||_<=0||isNaN(b)||b<0)return;i.save();const x=wt(y.lineWidth,1);if(i.fillStyle=wt(y.fillStyle,a),i.lineCap=wt(y.lineCap,"butt"),i.lineDashOffset=wt(y.lineDashOffset,0),i.lineJoin=wt(y.lineJoin,"miter"),i.lineWidth=x,i.strokeStyle=wt(y.strokeStyle,a),i.setLineDash(wt(y.lineDash,[])),o.usePointStyle){const E={radius:b*Math.SQRT2/2,pointStyle:y.pointStyle,rotation:y.rotation,borderWidth:x},I=l.xPlus(N,_/2),P=w+f;Vw(i,E,I,P,o.pointStyleWidth&&_)}else{const E=w+Math.max((d-b)/2,0),I=l.leftForLtr(N,_),P=Oi(y.borderRadius);i.beginPath(),Object.values(P).some(S=>S!==0)?ca(i,{x:I,y:E,w:_,h:b,radius:P}):i.rect(I,E,_,b),i.fill(),x!==0&&i.stroke()}i.restore()},C=function(N,w,y){ji(i,y.text,N,w+v/2,c,{strikethrough:y.hidden,textAlign:l.textAlign(y.textAlign)})},O=this.isHorizontal(),k=this._computeTitleHeight();O?g={x:De(r,this.left+h,this.right-s[0]),y:this.top+h+k,line:0}:g={x:this.left+h,y:De(r,this.top+k+h,this.bottom-e[0].height),line:0},Hw(this.ctx,t.textDirection);const D=v+h;this.legendItems.forEach((N,w)=>{i.strokeStyle=N.fontColor,i.fillStyle=N.fontColor;const y=i.measureText(N.text).width,x=l.textAlign(N.textAlign||(N.textAlign=o.textAlign)),E=_+f+y;let I=g.x,P=g.y;l.setWidth(this.width),O?w>0&&I+E+h>this.right&&(P=g.y+=D,g.line++,I=g.x=De(r,this.left+h,this.right-s[g.line])):w>0&&P+D>this.bottom&&(I=g.x=I+e[g.line].width+h,g.line++,P=g.y=De(r,this.top+k+h,this.bottom-e[g.line].height));const S=l.x(I);if(A(S,P,N),I=uO(x,I+_+f,O?I+E:this.right,t.rtl),C(l.x(I),P,N),O)g.x+=E+h;else if(typeof N.text!="string"){const rt=c.lineHeight;g.y+=_x(N,rt)+h}else g.y+=D}),Ww(this.ctx,t.textDirection)}drawTitle(){const t=this.options,e=t.title,s=pe(e.font),i=ze(e.padding);if(!e.display)return;const r=br(t.rtl,this.left,this.width),o=this.ctx,a=e.position,l=s.size/2,c=i.top+l;let h,d=this.left,f=this.width;if(this.isHorizontal())f=Math.max(...this.lineWidths),h=this.top+c,d=De(t.align,d,this.right-f);else{const _=this.columnSizes.reduce((b,v)=>Math.max(b,v.height),0);h=c+De(t.align,this.top,this.bottom-_-t.labels.padding-this._computeTitleHeight())}const g=De(a,d,d+f);o.textAlign=r.textAlign(Qf(a)),o.textBaseline="middle",o.strokeStyle=e.color,o.fillStyle=e.color,o.font=s.string,ji(o,e.text,g,h,s)}_computeTitleHeight(){const t=this.options.title,e=pe(t.font),s=ze(t.padding);return t.display?e.lineHeight+s.height:0}_getLegendItemAt(t,e){let s,i,r;if(cs(t,this.left,this.right)&&cs(e,this.top,this.bottom)){for(r=this.legendHitBoxes,s=0;s<r.length;++s)if(i=r[s],cs(t,i.left,i.left+i.width)&&cs(e,i.top,i.top+i.height))return this.legendItems[s]}return null}handleEvent(t){const e=this.options;if(!sF(t.type,e))return;const s=this._getLegendItemAt(t.x,t.y);if(t.type==="mousemove"||t.type==="mouseout"){const i=this._hoveredItem,r=ZN(i,s);i&&!r&&Kt(e.onLeave,[t,i,this],this),this._hoveredItem=s,s&&!r&&Kt(e.onHover,[t,s,this],this)}else s&&Kt(e.onClick,[t,s,this],this)}}function tF(n,t,e,s,i){const r=eF(s,n,t,e),o=nF(i,s,t.lineHeight);return{itemWidth:r,itemHeight:o}}function eF(n,t,e,s){let i=n.text;return i&&typeof i!="string"&&(i=i.reduce((r,o)=>r.length>o.length?r:o)),t+e.size/2+s.measureText(i).width}function nF(n,t,e){let s=n;return typeof t.text!="string"&&(s=_x(t,e)),s}function _x(n,t){const e=n.text?n.text.length:0;return t*e}function sF(n,t){return!!((n==="mousemove"||n==="mouseout")&&(t.onHover||t.onLeave)||t.onClick&&(n==="click"||n==="mouseup"))}var iF={id:"legend",_element:my,start(n,t,e){const s=n.legend=new my({ctx:n.ctx,options:e,chart:n});Be.configure(n,s,e),Be.addBox(n,s)},stop(n){Be.removeBox(n,n.legend),delete n.legend},beforeUpdate(n,t,e){const s=n.legend;Be.configure(n,s,e),s.options=e},afterUpdate(n){const t=n.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(n,t){t.replay||n.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(n,t,e){const s=t.datasetIndex,i=e.chart;i.isDatasetVisible(s)?(i.hide(s),t.hidden=!0):(i.show(s),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:n=>n.chart.options.color,boxWidth:40,padding:10,generateLabels(n){const t=n.data.datasets,{labels:{usePointStyle:e,pointStyle:s,textAlign:i,color:r,useBorderRadius:o,borderRadius:a}}=n.legend.options;return n._getSortedDatasetMetas().map(l=>{const c=l.controller.getStyle(e?0:void 0),h=ze(c.borderWidth);return{text:t[l.index].label,fillStyle:c.backgroundColor,fontColor:r,hidden:!l.visible,lineCap:c.borderCapStyle,lineDash:c.borderDash,lineDashOffset:c.borderDashOffset,lineJoin:c.borderJoinStyle,lineWidth:(h.width+h.height)/4,strokeStyle:c.borderColor,pointStyle:s||c.pointStyle,rotation:c.rotation,textAlign:i||c.textAlign,borderRadius:o&&(a||c.borderRadius),datasetIndex:l.index}},this)}},title:{color:n=>n.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:n=>!n.startsWith("on"),labels:{_scriptable:n=>!["generateLabels","filter","sort"].includes(n)}}};class lp extends Es{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e){const s=this.options;if(this.left=0,this.top=0,!s.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=t,this.height=this.bottom=e;const i=Zt(s.text)?s.text.length:1;this._padding=ze(s.padding);const r=i*pe(s.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=r:this.width=r}isHorizontal(){const t=this.options.position;return t==="top"||t==="bottom"}_drawArgs(t){const{top:e,left:s,bottom:i,right:r,options:o}=this,a=o.align;let l=0,c,h,d;return this.isHorizontal()?(h=De(a,s,r),d=e+t,c=r-s):(o.position==="left"?(h=s+t,d=De(a,i,e),l=Vt*-.5):(h=r-t,d=De(a,e,i),l=Vt*.5),c=i-e),{titleX:h,titleY:d,maxWidth:c,rotation:l}}draw(){const t=this.ctx,e=this.options;if(!e.display)return;const s=pe(e.font),r=s.lineHeight/2+this._padding.top,{titleX:o,titleY:a,maxWidth:l,rotation:c}=this._drawArgs(r);ji(t,e.text,0,0,s,{color:e.color,maxWidth:l,rotation:c,textAlign:Qf(e.align),textBaseline:"middle",translation:[o,a]})}}function rF(n,t){const e=new lp({ctx:n.ctx,options:t,chart:n});Be.configure(n,e,t),Be.addBox(n,e),n.titleBlock=e}var oF={id:"title",_element:lp,start(n,t,e){rF(n,e)},stop(n){const t=n.titleBlock;Be.removeBox(n,t),delete n.titleBlock},beforeUpdate(n,t,e){const s=n.titleBlock;Be.configure(n,s,e),s.options=e},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const gl=new WeakMap;var aF={id:"subtitle",start(n,t,e){const s=new lp({ctx:n.ctx,options:e,chart:n});Be.configure(n,s,e),Be.addBox(n,s),gl.set(n,s)},stop(n){Be.removeBox(n,gl.get(n)),gl.delete(n)},beforeUpdate(n,t,e){const s=gl.get(n);Be.configure(n,s,e),s.options=e},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const wo={average(n){if(!n.length)return!1;let t,e,s=new Set,i=0,r=0;for(t=0,e=n.length;t<e;++t){const a=n[t].element;if(a&&a.hasValue()){const l=a.tooltipPosition();s.add(l.x),i+=l.y,++r}}return r===0||s.size===0?!1:{x:[...s].reduce((a,l)=>a+l)/s.size,y:i/r}},nearest(n,t){if(!n.length)return!1;let e=t.x,s=t.y,i=Number.POSITIVE_INFINITY,r,o,a;for(r=0,o=n.length;r<o;++r){const l=n[r].element;if(l&&l.hasValue()){const c=l.getCenterPoint(),h=od(t,c);h<i&&(i=h,a=l)}}if(a){const l=a.tooltipPosition();e=l.x,s=l.y}return{x:e,y:s}}};function Cn(n,t){return t&&(Zt(t)?Array.prototype.push.apply(n,t):n.push(t)),n}function ns(n){return(typeof n=="string"||n instanceof String)&&n.indexOf(`
`)>-1?n.split(`
`):n}function lF(n,t){const{element:e,datasetIndex:s,index:i}=t,r=n.getDatasetMeta(s).controller,{label:o,value:a}=r.getLabelAndValue(i);return{chart:n,label:o,parsed:r.getParsed(i),raw:n.data.datasets[s].data[i],formattedValue:a,dataset:r.getDataset(),dataIndex:i,datasetIndex:s,element:e}}function _y(n,t){const e=n.chart.ctx,{body:s,footer:i,title:r}=n,{boxWidth:o,boxHeight:a}=t,l=pe(t.bodyFont),c=pe(t.titleFont),h=pe(t.footerFont),d=r.length,f=i.length,g=s.length,_=ze(t.padding);let b=_.height,v=0,A=s.reduce((k,D)=>k+D.before.length+D.lines.length+D.after.length,0);if(A+=n.beforeBody.length+n.afterBody.length,d&&(b+=d*c.lineHeight+(d-1)*t.titleSpacing+t.titleMarginBottom),A){const k=t.displayColors?Math.max(a,l.lineHeight):l.lineHeight;b+=g*k+(A-g)*l.lineHeight+(A-1)*t.bodySpacing}f&&(b+=t.footerMarginTop+f*h.lineHeight+(f-1)*t.footerSpacing);let C=0;const O=function(k){v=Math.max(v,e.measureText(k).width+C)};return e.save(),e.font=c.string,zt(n.title,O),e.font=l.string,zt(n.beforeBody.concat(n.afterBody),O),C=t.displayColors?o+2+t.boxPadding:0,zt(s,k=>{zt(k.before,O),zt(k.lines,O),zt(k.after,O)}),C=0,e.font=h.string,zt(n.footer,O),e.restore(),v+=_.width,{width:v,height:b}}function cF(n,t){const{y:e,height:s}=t;return e<s/2?"top":e>n.height-s/2?"bottom":"center"}function uF(n,t,e,s){const{x:i,width:r}=s,o=e.caretSize+e.caretPadding;if(n==="left"&&i+r+o>t.width||n==="right"&&i-r-o<0)return!0}function hF(n,t,e,s){const{x:i,width:r}=e,{width:o,chartArea:{left:a,right:l}}=n;let c="center";return s==="center"?c=i<=(a+l)/2?"left":"right":i<=r/2?c="left":i>=o-r/2&&(c="right"),uF(c,n,t,e)&&(c="center"),c}function yy(n,t,e){const s=e.yAlign||t.yAlign||cF(n,e);return{xAlign:e.xAlign||t.xAlign||hF(n,t,e,s),yAlign:s}}function dF(n,t){let{x:e,width:s}=n;return t==="right"?e-=s:t==="center"&&(e-=s/2),e}function fF(n,t,e){let{y:s,height:i}=n;return t==="top"?s+=e:t==="bottom"?s-=i+e:s-=i/2,s}function by(n,t,e,s){const{caretSize:i,caretPadding:r,cornerRadius:o}=n,{xAlign:a,yAlign:l}=e,c=i+r,{topLeft:h,topRight:d,bottomLeft:f,bottomRight:g}=Oi(o);let _=dF(t,a);const b=fF(t,l,c);return l==="center"?a==="left"?_+=c:a==="right"&&(_-=c):a==="left"?_-=Math.max(h,f)+i:a==="right"&&(_+=Math.max(d,g)+i),{x:_e(_,0,s.width-t.width),y:_e(b,0,s.height-t.height)}}function ml(n,t,e){const s=ze(e.padding);return t==="center"?n.x+n.width/2:t==="right"?n.x+n.width-s.right:n.x+s.left}function vy(n){return Cn([],ns(n))}function pF(n,t,e){return di(n,{tooltip:t,tooltipItems:e,type:"tooltip"})}function wy(n,t){const e=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return e?n.override(e):n}const yx={beforeTitle:ts,title(n){if(n.length>0){const t=n[0],e=t.chart.data.labels,s=e?e.length:0;if(this&&this.options&&this.options.mode==="dataset")return t.dataset.label||"";if(t.label)return t.label;if(s>0&&t.dataIndex<s)return e[t.dataIndex]}return""},afterTitle:ts,beforeBody:ts,beforeLabel:ts,label(n){if(this&&this.options&&this.options.mode==="dataset")return n.label+": "+n.formattedValue||n.formattedValue;let t=n.dataset.label||"";t&&(t+=": ");const e=n.formattedValue;return Ct(e)||(t+=e),t},labelColor(n){const e=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{borderColor:e.borderColor,backgroundColor:e.backgroundColor,borderWidth:e.borderWidth,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(n){const e=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{pointStyle:e.pointStyle,rotation:e.rotation}},afterLabel:ts,afterBody:ts,beforeFooter:ts,footer:ts,afterFooter:ts};function Ke(n,t,e,s){const i=n[t].call(e,s);return typeof i>"u"?yx[t].call(e,s):i}class xy extends Es{static positioners=wo;constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const e=this.chart,s=this.options.setContext(this.getContext()),i=s.enabled&&e.options.animation&&s.animations,r=new Xw(this.chart,i);return i._cacheable&&(this._cachedAnimations=Object.freeze(r)),r}getContext(){return this.$context||(this.$context=pF(this.chart.getContext(),this,this._tooltipItems))}getTitle(t,e){const{callbacks:s}=e,i=Ke(s,"beforeTitle",this,t),r=Ke(s,"title",this,t),o=Ke(s,"afterTitle",this,t);let a=[];return a=Cn(a,ns(i)),a=Cn(a,ns(r)),a=Cn(a,ns(o)),a}getBeforeBody(t,e){return vy(Ke(e.callbacks,"beforeBody",this,t))}getBody(t,e){const{callbacks:s}=e,i=[];return zt(t,r=>{const o={before:[],lines:[],after:[]},a=wy(s,r);Cn(o.before,ns(Ke(a,"beforeLabel",this,r))),Cn(o.lines,Ke(a,"label",this,r)),Cn(o.after,ns(Ke(a,"afterLabel",this,r))),i.push(o)}),i}getAfterBody(t,e){return vy(Ke(e.callbacks,"afterBody",this,t))}getFooter(t,e){const{callbacks:s}=e,i=Ke(s,"beforeFooter",this,t),r=Ke(s,"footer",this,t),o=Ke(s,"afterFooter",this,t);let a=[];return a=Cn(a,ns(i)),a=Cn(a,ns(r)),a=Cn(a,ns(o)),a}_createItems(t){const e=this._active,s=this.chart.data,i=[],r=[],o=[];let a=[],l,c;for(l=0,c=e.length;l<c;++l)a.push(lF(this.chart,e[l]));return t.filter&&(a=a.filter((h,d,f)=>t.filter(h,d,f,s))),t.itemSort&&(a=a.sort((h,d)=>t.itemSort(h,d,s))),zt(a,h=>{const d=wy(t.callbacks,h);i.push(Ke(d,"labelColor",this,h)),r.push(Ke(d,"labelPointStyle",this,h)),o.push(Ke(d,"labelTextColor",this,h))}),this.labelColors=i,this.labelPointStyles=r,this.labelTextColors=o,this.dataPoints=a,a}update(t,e){const s=this.options.setContext(this.getContext()),i=this._active;let r,o=[];if(!i.length)this.opacity!==0&&(r={opacity:0});else{const a=wo[s.position].call(this,i,this._eventPosition);o=this._createItems(s),this.title=this.getTitle(o,s),this.beforeBody=this.getBeforeBody(o,s),this.body=this.getBody(o,s),this.afterBody=this.getAfterBody(o,s),this.footer=this.getFooter(o,s);const l=this._size=_y(this,s),c=Object.assign({},a,l),h=yy(this.chart,s,c),d=by(s,c,h,this.chart);this.xAlign=h.xAlign,this.yAlign=h.yAlign,r={opacity:1,x:d.x,y:d.y,width:l.width,height:l.height,caretX:a.x,caretY:a.y}}this._tooltipItems=o,this.$context=void 0,r&&this._resolveAnimations().update(this,r),t&&s.external&&s.external.call(this,{chart:this.chart,tooltip:this,replay:e})}drawCaret(t,e,s,i){const r=this.getCaretPosition(t,s,i);e.lineTo(r.x1,r.y1),e.lineTo(r.x2,r.y2),e.lineTo(r.x3,r.y3)}getCaretPosition(t,e,s){const{xAlign:i,yAlign:r}=this,{caretSize:o,cornerRadius:a}=s,{topLeft:l,topRight:c,bottomLeft:h,bottomRight:d}=Oi(a),{x:f,y:g}=t,{width:_,height:b}=e;let v,A,C,O,k,D;return r==="center"?(k=g+b/2,i==="left"?(v=f,A=v-o,O=k+o,D=k-o):(v=f+_,A=v+o,O=k-o,D=k+o),C=v):(i==="left"?A=f+Math.max(l,h)+o:i==="right"?A=f+_-Math.max(c,d)-o:A=this.caretX,r==="top"?(O=g,k=O-o,v=A-o,C=A+o):(O=g+b,k=O+o,v=A+o,C=A-o),D=O),{x1:v,x2:A,x3:C,y1:O,y2:k,y3:D}}drawTitle(t,e,s){const i=this.title,r=i.length;let o,a,l;if(r){const c=br(s.rtl,this.x,this.width);for(t.x=ml(this,s.titleAlign,s),e.textAlign=c.textAlign(s.titleAlign),e.textBaseline="middle",o=pe(s.titleFont),a=s.titleSpacing,e.fillStyle=s.titleColor,e.font=o.string,l=0;l<r;++l)e.fillText(i[l],c.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+a,l+1===r&&(t.y+=s.titleMarginBottom-a)}}_drawColorBox(t,e,s,i,r){const o=this.labelColors[s],a=this.labelPointStyles[s],{boxHeight:l,boxWidth:c}=r,h=pe(r.bodyFont),d=ml(this,"left",r),f=i.x(d),g=l<h.lineHeight?(h.lineHeight-l)/2:0,_=e.y+g;if(r.usePointStyle){const b={radius:Math.min(c,l)/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:1},v=i.leftForLtr(f,c)+c/2,A=_+l/2;t.strokeStyle=r.multiKeyBackground,t.fillStyle=r.multiKeyBackground,ld(t,b,v,A),t.strokeStyle=o.borderColor,t.fillStyle=o.backgroundColor,ld(t,b,v,A)}else{t.lineWidth=Dt(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,t.strokeStyle=o.borderColor,t.setLineDash(o.borderDash||[]),t.lineDashOffset=o.borderDashOffset||0;const b=i.leftForLtr(f,c),v=i.leftForLtr(i.xPlus(f,1),c-2),A=Oi(o.borderRadius);Object.values(A).some(C=>C!==0)?(t.beginPath(),t.fillStyle=r.multiKeyBackground,ca(t,{x:b,y:_,w:c,h:l,radius:A}),t.fill(),t.stroke(),t.fillStyle=o.backgroundColor,t.beginPath(),ca(t,{x:v,y:_+1,w:c-2,h:l-2,radius:A}),t.fill()):(t.fillStyle=r.multiKeyBackground,t.fillRect(b,_,c,l),t.strokeRect(b,_,c,l),t.fillStyle=o.backgroundColor,t.fillRect(v,_+1,c-2,l-2))}t.fillStyle=this.labelTextColors[s]}drawBody(t,e,s){const{body:i}=this,{bodySpacing:r,bodyAlign:o,displayColors:a,boxHeight:l,boxWidth:c,boxPadding:h}=s,d=pe(s.bodyFont);let f=d.lineHeight,g=0;const _=br(s.rtl,this.x,this.width),b=function(y){e.fillText(y,_.x(t.x+g),t.y+f/2),t.y+=f+r},v=_.textAlign(o);let A,C,O,k,D,N,w;for(e.textAlign=o,e.textBaseline="middle",e.font=d.string,t.x=ml(this,v,s),e.fillStyle=s.bodyColor,zt(this.beforeBody,b),g=a&&v!=="right"?o==="center"?c/2+h:c+2+h:0,k=0,N=i.length;k<N;++k){for(A=i[k],C=this.labelTextColors[k],e.fillStyle=C,zt(A.before,b),O=A.lines,a&&O.length&&(this._drawColorBox(e,t,k,_,s),f=Math.max(d.lineHeight,l)),D=0,w=O.length;D<w;++D)b(O[D]),f=d.lineHeight;zt(A.after,b)}g=0,f=d.lineHeight,zt(this.afterBody,b),t.y-=r}drawFooter(t,e,s){const i=this.footer,r=i.length;let o,a;if(r){const l=br(s.rtl,this.x,this.width);for(t.x=ml(this,s.footerAlign,s),t.y+=s.footerMarginTop,e.textAlign=l.textAlign(s.footerAlign),e.textBaseline="middle",o=pe(s.footerFont),e.fillStyle=s.footerColor,e.font=o.string,a=0;a<r;++a)e.fillText(i[a],l.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+s.footerSpacing}}drawBackground(t,e,s,i){const{xAlign:r,yAlign:o}=this,{x:a,y:l}=t,{width:c,height:h}=s,{topLeft:d,topRight:f,bottomLeft:g,bottomRight:_}=Oi(i.cornerRadius);e.fillStyle=i.backgroundColor,e.strokeStyle=i.borderColor,e.lineWidth=i.borderWidth,e.beginPath(),e.moveTo(a+d,l),o==="top"&&this.drawCaret(t,e,s,i),e.lineTo(a+c-f,l),e.quadraticCurveTo(a+c,l,a+c,l+f),o==="center"&&r==="right"&&this.drawCaret(t,e,s,i),e.lineTo(a+c,l+h-_),e.quadraticCurveTo(a+c,l+h,a+c-_,l+h),o==="bottom"&&this.drawCaret(t,e,s,i),e.lineTo(a+g,l+h),e.quadraticCurveTo(a,l+h,a,l+h-g),o==="center"&&r==="left"&&this.drawCaret(t,e,s,i),e.lineTo(a,l+d),e.quadraticCurveTo(a,l,a+d,l),e.closePath(),e.fill(),i.borderWidth>0&&e.stroke()}_updateAnimationTarget(t){const e=this.chart,s=this.$animations,i=s&&s.x,r=s&&s.y;if(i||r){const o=wo[t.position].call(this,this._active,this._eventPosition);if(!o)return;const a=this._size=_y(this,t),l=Object.assign({},o,this._size),c=yy(e,t,l),h=by(t,l,c,e);(i._to!==h.x||r._to!==h.y)&&(this.xAlign=c.xAlign,this.yAlign=c.yAlign,this.width=a.width,this.height=a.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,h))}}_willRender(){return!!this.opacity}draw(t){const e=this.options.setContext(this.getContext());let s=this.opacity;if(!s)return;this._updateAnimationTarget(e);const i={width:this.width,height:this.height},r={x:this.x,y:this.y};s=Math.abs(s)<.001?0:s;const o=ze(e.padding),a=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;e.enabled&&a&&(t.save(),t.globalAlpha=s,this.drawBackground(r,t,i,e),Hw(t,e.textDirection),r.y+=o.top,this.drawTitle(r,t,e),this.drawBody(r,t,e),this.drawFooter(r,t,e),Ww(t,e.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,e){const s=this._active,i=t.map(({datasetIndex:a,index:l})=>{const c=this.chart.getDatasetMeta(a);if(!c)throw new Error("Cannot find a dataset at index "+a);return{datasetIndex:a,element:c.data[l],index:l}}),r=!mc(s,i),o=this._positionChanged(i,e);(r||o)&&(this._active=i,this._eventPosition=e,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,e,s=!0){if(e&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const i=this.options,r=this._active||[],o=this._getActiveElements(t,r,e,s),a=this._positionChanged(o,t),l=e||!mc(o,r)||a;return l&&(this._active=o,(i.enabled||i.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,e))),l}_getActiveElements(t,e,s,i){const r=this.options;if(t.type==="mouseout")return[];if(!i)return e.filter(a=>this.chart.data.datasets[a.datasetIndex]&&this.chart.getDatasetMeta(a.datasetIndex).controller.getParsed(a.index)!==void 0);const o=this.chart.getElementsAtEventForMode(t,r.mode,r,s);return r.reverse&&o.reverse(),o}_positionChanged(t,e){const{caretX:s,caretY:i,options:r}=this,o=wo[r.position].call(this,t,e);return o!==!1&&(s!==o.x||i!==o.y)}}var gF={id:"tooltip",_element:xy,positioners:wo,afterInit(n,t,e){e&&(n.tooltip=new xy({chart:n,options:e}))},beforeUpdate(n,t,e){n.tooltip&&n.tooltip.initialize(e)},reset(n,t,e){n.tooltip&&n.tooltip.initialize(e)},afterDraw(n){const t=n.tooltip;if(t&&t._willRender()){const e={tooltip:t};if(n.notifyPlugins("beforeTooltipDraw",{...e,cancelable:!0})===!1)return;t.draw(n.ctx),n.notifyPlugins("afterTooltipDraw",e)}},afterEvent(n,t){if(n.tooltip){const e=t.replay;n.tooltip.handleEvent(t.event,e,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(n,t)=>t.bodyFont.size,boxWidth:(n,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:yx},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:n=>n!=="filter"&&n!=="itemSort"&&n!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},mF=Object.freeze({__proto__:null,Colors:CN,Decimation:DN,Filler:JN,Legend:iF,SubTitle:aF,Title:oF,Tooltip:gF});const _F=(n,t,e,s)=>(typeof t=="string"?(e=n.push(t)-1,s.unshift({index:e,label:t})):isNaN(t)&&(e=null),e);function yF(n,t,e,s){const i=n.indexOf(t);if(i===-1)return _F(n,t,e,s);const r=n.lastIndexOf(t);return i!==r?e:i}const bF=(n,t)=>n===null?null:_e(Math.round(n),0,t);function Ty(n){const t=this.getLabels();return n>=0&&n<t.length?t[n]:n}class vF extends Ki{static id="category";static defaults={ticks:{callback:Ty}};constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const e=this._addedLabels;if(e.length){const s=this.getLabels();for(const{index:i,label:r}of e)s[i]===r&&s.splice(i,1);this._addedLabels=[]}super.init(t)}parse(t,e){if(Ct(t))return null;const s=this.getLabels();return e=isFinite(e)&&s[e]===t?e:yF(s,t,wt(e,t),this._addedLabels),bF(e,s.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let{min:s,max:i}=this.getMinMax(!0);this.options.bounds==="ticks"&&(t||(s=0),e||(i=this.getLabels().length-1)),this.min=s,this.max=i}buildTicks(){const t=this.min,e=this.max,s=this.options.offset,i=[];let r=this.getLabels();r=t===0&&e===r.length-1?r:r.slice(t,e+1),this._valueRange=Math.max(r.length-(s?0:1),1),this._startValue=this.min-(s?.5:0);for(let o=t;o<=e;o++)i.push({value:o});return i}getLabelForValue(t){return Ty.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return typeof t!="number"&&(t=this.parse(t)),t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}function wF(n,t){const e=[],{bounds:i,step:r,min:o,max:a,precision:l,count:c,maxTicks:h,maxDigits:d,includeBounds:f}=n,g=r||1,_=h-1,{min:b,max:v}=t,A=!Ct(o),C=!Ct(a),O=!Ct(c),k=(v-b)/(d+1);let D=__((v-b)/_/g)*g,N,w,y,x;if(D<1e-14&&!A&&!C)return[{value:b},{value:v}];x=Math.ceil(v/D)-Math.floor(b/D),x>_&&(D=__(x*D/_/g)*g),Ct(l)||(N=Math.pow(10,l),D=Math.ceil(D*N)/N),i==="ticks"?(w=Math.floor(b/D)*D,y=Math.ceil(v/D)*D):(w=b,y=v),A&&C&&r&&sO((a-o)/r,D/1e3)?(x=Math.round(Math.min((a-o)/D,h)),D=(a-o)/x,w=o,y=a):O?(w=A?o:w,y=C?a:y,x=c-1,D=(y-w)/x):(x=(y-w)/D,Bo(x,Math.round(x),D/1e3)?x=Math.round(x):x=Math.ceil(x));const E=Math.max(y_(D),y_(w));N=Math.pow(10,Ct(l)?E:l),w=Math.round(w*N)/N,y=Math.round(y*N)/N;let I=0;for(A&&(f&&w!==o?(e.push({value:o}),w<o&&I++,Bo(Math.round((w+I*D)*N)/N,o,Ey(o,k,n))&&I++):w<o&&I++);I<x;++I){const P=Math.round((w+I*D)*N)/N;if(C&&P>a)break;e.push({value:P})}return C&&f&&y!==a?e.length&&Bo(e[e.length-1].value,a,Ey(a,k,n))?e[e.length-1].value=a:e.push({value:a}):(!C||y===a)&&e.push({value:y}),e}function Ey(n,t,{horizontal:e,minRotation:s}){const i=xn(s),r=(e?Math.sin(i):Math.cos(i))||.001,o=.75*t*(""+n).length;return Math.min(t/r,o)}class Tc extends Ki{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,e){return Ct(t)||(typeof t=="number"||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:e,maxDefined:s}=this.getUserBounds();let{min:i,max:r}=this;const o=l=>i=e?i:l,a=l=>r=s?r:l;if(t){const l=jn(i),c=jn(r);l<0&&c<0?a(0):l>0&&c>0&&o(0)}if(i===r){let l=r===0?1:Math.abs(r*.05);a(r+l),t||o(i-l)}this.min=i,this.max=r}getTickLimit(){const t=this.options.ticks;let{maxTicksLimit:e,stepSize:s}=t,i;return s?(i=Math.ceil(this.max/s)-Math.floor(this.min/s)+1,i>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${s} would result generating up to ${i} ticks. Limiting to 1000.`),i=1e3)):(i=this.computeTickLimit(),e=e||11),e&&(i=Math.min(e,i)),i}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,e=t.ticks;let s=this.getTickLimit();s=Math.max(2,s);const i={maxTicks:s,bounds:t.bounds,min:t.min,max:t.max,precision:e.precision,step:e.stepSize,count:e.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:e.minRotation||0,includeBounds:e.includeBounds!==!1},r=this._range||this,o=wF(i,r);return t.bounds==="ticks"&&Aw(o,this,"value"),t.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const t=this.ticks;let e=this.min,s=this.max;if(super.configure(),this.options.offset&&t.length){const i=(s-e)/Math.max(t.length-1,1)/2;e-=i,s+=i}this._startValue=e,this._endValue=s,this._valueRange=s-e}getLabelForValue(t){return ka(t,this.chart.options.locale,this.options.ticks.format)}}class xF extends Tc{static id="linear";static defaults={ticks:{callback:hu.formatters.numeric}};determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=re(t)?t:0,this.max=re(e)?e:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),e=t?this.width:this.height,s=xn(this.options.ticks.minRotation),i=(t?Math.sin(s):Math.cos(s))||.001,r=this._resolveTickFontOptions(0);return Math.ceil(e/Math.min(40,r.lineHeight/i))}getPixelForValue(t){return t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}const ha=n=>Math.floor($s(n)),Ti=(n,t)=>Math.pow(10,ha(n)+t);function Iy(n){return n/Math.pow(10,ha(n))===1}function Sy(n,t,e){const s=Math.pow(10,e),i=Math.floor(n/s);return Math.ceil(t/s)-i}function TF(n,t){const e=t-n;let s=ha(e);for(;Sy(n,t,s)>10;)s++;for(;Sy(n,t,s)<10;)s--;return Math.min(s,ha(n))}function EF(n,{min:t,max:e}){t=sn(n.min,t);const s=[],i=ha(t);let r=TF(t,e),o=r<0?Math.pow(10,Math.abs(r)):1;const a=Math.pow(10,r),l=i>r?Math.pow(10,i):0,c=Math.round((t-l)*o)/o,h=Math.floor((t-l)/a/10)*a*10;let d=Math.floor((c-h)/Math.pow(10,r)),f=sn(n.min,Math.round((l+h+d*Math.pow(10,r))*o)/o);for(;f<e;)s.push({value:f,major:Iy(f),significand:d}),d>=10?d=d<15?15:20:d++,d>=20&&(r++,d=2,o=r>=0?1:o),f=Math.round((l+h+d*Math.pow(10,r))*o)/o;const g=sn(n.max,f);return s.push({value:g,major:Iy(g),significand:d}),s}class IF extends Ki{static id="logarithmic";static defaults={ticks:{callback:hu.formatters.logarithmic,major:{enabled:!0}}};constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(t,e){const s=Tc.prototype.parse.apply(this,[t,e]);if(s===0){this._zero=!0;return}return re(s)&&s>0?s:null}determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=re(t)?Math.max(0,t):null,this.max=re(e)?Math.max(0,e):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!re(this._userMin)&&(this.min=t===Ti(this.min,0)?Ti(this.min,-1):Ti(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let s=this.min,i=this.max;const r=a=>s=t?s:a,o=a=>i=e?i:a;s===i&&(s<=0?(r(1),o(10)):(r(Ti(s,-1)),o(Ti(i,1)))),s<=0&&r(Ti(i,-1)),i<=0&&o(Ti(s,1)),this.min=s,this.max=i}buildTicks(){const t=this.options,e={min:this._userMin,max:this._userMax},s=EF(e,this);return t.bounds==="ticks"&&Aw(s,this,"value"),t.reverse?(s.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),s}getLabelForValue(t){return t===void 0?"0":ka(t,this.chart.options.locale,this.options.ticks.format)}configure(){const t=this.min;super.configure(),this._startValue=$s(t),this._valueRange=$s(this.max)-$s(t)}getPixelForValue(t){return(t===void 0||t===0)&&(t=this.min),t===null||isNaN(t)?NaN:this.getPixelForDecimal(t===this.min?0:($s(t)-this._startValue)/this._valueRange)}getValueForPixel(t){const e=this.getDecimalForPixel(t);return Math.pow(10,this._startValue+e*this._valueRange)}}function pd(n){const t=n.ticks;if(t.display&&n.display){const e=ze(t.backdropPadding);return wt(t.font&&t.font.size,te.font.size)+e.height}return 0}function SF(n,t,e){return e=Zt(e)?e:[e],{w:vO(n,t.string,e),h:e.length*t.lineHeight}}function Ay(n,t,e,s,i){return n===s||n===i?{start:t-e/2,end:t+e/2}:n<s||n>i?{start:t-e,end:t}:{start:t,end:t+e}}function AF(n){const t={l:n.left+n._padding.left,r:n.right-n._padding.right,t:n.top+n._padding.top,b:n.bottom-n._padding.bottom},e=Object.assign({},t),s=[],i=[],r=n._pointLabels.length,o=n.options.pointLabels,a=o.centerPointLabels?Vt/r:0;for(let l=0;l<r;l++){const c=o.setContext(n.getPointLabelContext(l));i[l]=c.padding;const h=n.getPointPosition(l,n.drawingArea+i[l],a),d=pe(c.font),f=SF(n.ctx,d,n._pointLabels[l]);s[l]=f;const g=Oe(n.getIndexAngle(l)+a),_=Math.round(Yf(g)),b=Ay(_,h.x,f.w,0,180),v=Ay(_,h.y,f.h,90,270);CF(e,t,g,b,v)}n.setCenterPoint(t.l-e.l,e.r-t.r,t.t-e.t,e.b-t.b),n._pointLabelItems=kF(n,s,i)}function CF(n,t,e,s,i){const r=Math.abs(Math.sin(e)),o=Math.abs(Math.cos(e));let a=0,l=0;s.start<t.l?(a=(t.l-s.start)/r,n.l=Math.min(n.l,t.l-a)):s.end>t.r&&(a=(s.end-t.r)/r,n.r=Math.max(n.r,t.r+a)),i.start<t.t?(l=(t.t-i.start)/o,n.t=Math.min(n.t,t.t-l)):i.end>t.b&&(l=(i.end-t.b)/o,n.b=Math.max(n.b,t.b+l))}function PF(n,t,e){const s=n.drawingArea,{extra:i,additionalAngle:r,padding:o,size:a}=e,l=n.getPointPosition(t,s+i+o,r),c=Math.round(Yf(Oe(l.angle+le))),h=OF(l.y,a.h,c),d=DF(c),f=MF(l.x,a.w,d);return{visible:!0,x:l.x,y:h,textAlign:d,left:f,top:h,right:f+a.w,bottom:h+a.h}}function RF(n,t){if(!t)return!0;const{left:e,top:s,right:i,bottom:r}=n;return!(hs({x:e,y:s},t)||hs({x:e,y:r},t)||hs({x:i,y:s},t)||hs({x:i,y:r},t))}function kF(n,t,e){const s=[],i=n._pointLabels.length,r=n.options,{centerPointLabels:o,display:a}=r.pointLabels,l={extra:pd(r)/2,additionalAngle:o?Vt/i:0};let c;for(let h=0;h<i;h++){l.padding=e[h],l.size=t[h];const d=PF(n,h,l);s.push(d),a==="auto"&&(d.visible=RF(d,c),d.visible&&(c=d))}return s}function DF(n){return n===0||n===180?"center":n<180?"left":"right"}function MF(n,t,e){return e==="right"?n-=t:e==="center"&&(n-=t/2),n}function OF(n,t,e){return e===90||e===270?n-=t/2:(e>270||e<90)&&(n-=t),n}function LF(n,t,e){const{left:s,top:i,right:r,bottom:o}=e,{backdropColor:a}=t;if(!Ct(a)){const l=Oi(t.borderRadius),c=ze(t.backdropPadding);n.fillStyle=a;const h=s-c.left,d=i-c.top,f=r-s+c.width,g=o-i+c.height;Object.values(l).some(_=>_!==0)?(n.beginPath(),ca(n,{x:h,y:d,w:f,h:g,radius:l}),n.fill()):n.fillRect(h,d,f,g)}}function VF(n,t){const{ctx:e,options:{pointLabels:s}}=n;for(let i=t-1;i>=0;i--){const r=n._pointLabelItems[i];if(!r.visible)continue;const o=s.setContext(n.getPointLabelContext(i));LF(e,o,r);const a=pe(o.font),{x:l,y:c,textAlign:h}=r;ji(e,n._pointLabels[i],l,c+a.lineHeight/2,a,{color:o.color,textAlign:h,textBaseline:"middle"})}}function bx(n,t,e,s){const{ctx:i}=n;if(e)i.arc(n.xCenter,n.yCenter,t,0,Jt);else{let r=n.getPointPosition(0,t);i.moveTo(r.x,r.y);for(let o=1;o<s;o++)r=n.getPointPosition(o,t),i.lineTo(r.x,r.y)}}function NF(n,t,e,s,i){const r=n.ctx,o=t.circular,{color:a,lineWidth:l}=t;!o&&!s||!a||!l||e<0||(r.save(),r.strokeStyle=a,r.lineWidth=l,r.setLineDash(i.dash||[]),r.lineDashOffset=i.dashOffset,r.beginPath(),bx(n,e,o,s),r.closePath(),r.stroke(),r.restore())}function FF(n,t,e){return di(n,{label:e,index:t,type:"pointLabel"})}class BF extends Tc{static id="radialLinear";static defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:hu.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(t){return t},padding:5,centerPointLabels:!1}};static defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"};static descriptors={angleLines:{_fallback:"grid"}};constructor(t){super(t),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const t=this._padding=ze(pd(this.options)/2),e=this.width=this.maxWidth-t.width,s=this.height=this.maxHeight-t.height;this.xCenter=Math.floor(this.left+e/2+t.left),this.yCenter=Math.floor(this.top+s/2+t.top),this.drawingArea=Math.floor(Math.min(e,s)/2)}determineDataLimits(){const{min:t,max:e}=this.getMinMax(!1);this.min=re(t)&&!isNaN(t)?t:0,this.max=re(e)&&!isNaN(e)?e:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/pd(this.options))}generateTickLabels(t){Tc.prototype.generateTickLabels.call(this,t),this._pointLabels=this.getLabels().map((e,s)=>{const i=Kt(this.options.pointLabels.callback,[e,s],this);return i||i===0?i:""}).filter((e,s)=>this.chart.getDataVisibility(s))}fit(){const t=this.options;t.display&&t.pointLabels.display?AF(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(t,e,s,i){this.xCenter+=Math.floor((t-e)/2),this.yCenter+=Math.floor((s-i)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(t,e,s,i))}getIndexAngle(t){const e=Jt/(this._pointLabels.length||1),s=this.options.startAngle||0;return Oe(t*e+xn(s))}getDistanceFromCenterForValue(t){if(Ct(t))return NaN;const e=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-t)*e:(t-this.min)*e}getValueForDistanceFromCenter(t){if(Ct(t))return NaN;const e=t/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-e:this.min+e}getPointLabelContext(t){const e=this._pointLabels||[];if(t>=0&&t<e.length){const s=e[t];return FF(this.getContext(),t,s)}}getPointPosition(t,e,s=0){const i=this.getIndexAngle(t)-le+s;return{x:Math.cos(i)*e+this.xCenter,y:Math.sin(i)*e+this.yCenter,angle:i}}getPointPositionForValue(t,e){return this.getPointPosition(t,this.getDistanceFromCenterForValue(e))}getBasePosition(t){return this.getPointPositionForValue(t||0,this.getBaseValue())}getPointLabelPosition(t){const{left:e,top:s,right:i,bottom:r}=this._pointLabelItems[t];return{left:e,top:s,right:i,bottom:r}}drawBackground(){const{backgroundColor:t,grid:{circular:e}}=this.options;if(t){const s=this.ctx;s.save(),s.beginPath(),bx(this,this.getDistanceFromCenterForValue(this._endValue),e,this._pointLabels.length),s.closePath(),s.fillStyle=t,s.fill(),s.restore()}}drawGrid(){const t=this.ctx,e=this.options,{angleLines:s,grid:i,border:r}=e,o=this._pointLabels.length;let a,l,c;if(e.pointLabels.display&&VF(this,o),i.display&&this.ticks.forEach((h,d)=>{if(d!==0||d===0&&this.min<0){l=this.getDistanceFromCenterForValue(h.value);const f=this.getContext(d),g=i.setContext(f),_=r.setContext(f);NF(this,g,l,o,_)}}),s.display){for(t.save(),a=o-1;a>=0;a--){const h=s.setContext(this.getPointLabelContext(a)),{color:d,lineWidth:f}=h;!f||!d||(t.lineWidth=f,t.strokeStyle=d,t.setLineDash(h.borderDash),t.lineDashOffset=h.borderDashOffset,l=this.getDistanceFromCenterForValue(e.reverse?this.min:this.max),c=this.getPointPosition(a,l),t.beginPath(),t.moveTo(this.xCenter,this.yCenter),t.lineTo(c.x,c.y),t.stroke())}t.restore()}}drawBorder(){}drawLabels(){const t=this.ctx,e=this.options,s=e.ticks;if(!s.display)return;const i=this.getIndexAngle(0);let r,o;t.save(),t.translate(this.xCenter,this.yCenter),t.rotate(i),t.textAlign="center",t.textBaseline="middle",this.ticks.forEach((a,l)=>{if(l===0&&this.min>=0&&!e.reverse)return;const c=s.setContext(this.getContext(l)),h=pe(c.font);if(r=this.getDistanceFromCenterForValue(this.ticks[l].value),c.showLabelBackdrop){t.font=h.string,o=t.measureText(a.label).width,t.fillStyle=c.backdropColor;const d=ze(c.backdropPadding);t.fillRect(-o/2-d.left,-r-h.size/2-d.top,o+d.width,h.size+d.height)}ji(t,a.label,0,-r,h,{color:c.color,strokeColor:c.textStrokeColor,strokeWidth:c.textStrokeWidth})}),t.restore()}drawTitle(){}}const yu={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Ze=Object.keys(yu);function Cy(n,t){return n-t}function Py(n,t){if(Ct(t))return null;const e=n._adapter,{parser:s,round:i,isoWeekday:r}=n._parseOpts;let o=t;return typeof s=="function"&&(o=s(o)),re(o)||(o=typeof s=="string"?e.parse(o,s):e.parse(o)),o===null?null:(i&&(o=i==="week"&&(Cr(r)||r===!0)?e.startOf(o,"isoWeek",r):e.startOf(o,i)),+o)}function Ry(n,t,e,s){const i=Ze.length;for(let r=Ze.indexOf(n);r<i-1;++r){const o=yu[Ze[r]],a=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((e-t)/(a*o.size))<=s)return Ze[r]}return Ze[i-1]}function UF(n,t,e,s,i){for(let r=Ze.length-1;r>=Ze.indexOf(e);r--){const o=Ze[r];if(yu[o].common&&n._adapter.diff(i,s,o)>=t-1)return o}return Ze[e?Ze.indexOf(e):0]}function $F(n){for(let t=Ze.indexOf(n)+1,e=Ze.length;t<e;++t)if(yu[Ze[t]].common)return Ze[t]}function ky(n,t,e){if(!e)n[t]=!0;else if(e.length){const{lo:s,hi:i}=Xf(e,t),r=e[s]>=t?e[s]:e[i];n[r]=!0}}function zF(n,t,e,s){const i=n._adapter,r=+i.startOf(t[0].value,s),o=t[t.length-1].value;let a,l;for(a=r;a<=o;a=+i.add(a,1,s))l=e[a],l>=0&&(t[l].major=!0);return t}function Dy(n,t,e){const s=[],i={},r=t.length;let o,a;for(o=0;o<r;++o)a=t[o],i[a]=o,s.push({value:a,major:!1});return r===0||!e?s:zF(n,s,i,e)}class gd extends Ki{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,e={}){const s=t.time||(t.time={}),i=this._adapter=new jL._date(t.adapters.date);i.init(e),Fo(s.displayFormats,i.formats()),this._parseOpts={parser:s.parser,round:s.round,isoWeekday:s.isoWeekday},super.init(t),this._normalized=e.normalized}parse(t,e){return t===void 0?null:Py(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,e=this._adapter,s=t.time.unit||"day";let{min:i,max:r,minDefined:o,maxDefined:a}=this.getUserBounds();function l(c){!o&&!isNaN(c.min)&&(i=Math.min(i,c.min)),!a&&!isNaN(c.max)&&(r=Math.max(r,c.max))}(!o||!a)&&(l(this._getLabelBounds()),(t.bounds!=="ticks"||t.ticks.source!=="labels")&&l(this.getMinMax(!1))),i=re(i)&&!isNaN(i)?i:+e.startOf(Date.now(),s),r=re(r)&&!isNaN(r)?r:+e.endOf(Date.now(),s)+1,this.min=Math.min(i,r-1),this.max=Math.max(i+1,r)}_getLabelBounds(){const t=this.getLabelTimestamps();let e=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;return t.length&&(e=t[0],s=t[t.length-1]),{min:e,max:s}}buildTicks(){const t=this.options,e=t.time,s=t.ticks,i=s.source==="labels"?this.getLabelTimestamps():this._generate();t.bounds==="ticks"&&i.length&&(this.min=this._userMin||i[0],this.max=this._userMax||i[i.length-1]);const r=this.min,o=this.max,a=aO(i,r,o);return this._unit=e.unit||(s.autoSkip?Ry(e.minUnit,this.min,this.max,this._getLabelCapacity(r)):UF(this,a.length,e.minUnit,this.min,this.max)),this._majorUnit=!s.major.enabled||this._unit==="year"?void 0:$F(this._unit),this.initOffsets(i),t.reverse&&a.reverse(),Dy(this,a,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(t=>+t.value))}initOffsets(t=[]){let e=0,s=0,i,r;this.options.offset&&t.length&&(i=this.getDecimalForValue(t[0]),t.length===1?e=1-i:e=(this.getDecimalForValue(t[1])-i)/2,r=this.getDecimalForValue(t[t.length-1]),t.length===1?s=r:s=(r-this.getDecimalForValue(t[t.length-2]))/2);const o=t.length<3?.5:.25;e=_e(e,0,o),s=_e(s,0,o),this._offsets={start:e,end:s,factor:1/(e+1+s)}}_generate(){const t=this._adapter,e=this.min,s=this.max,i=this.options,r=i.time,o=r.unit||Ry(r.minUnit,e,s,this._getLabelCapacity(e)),a=wt(i.ticks.stepSize,1),l=o==="week"?r.isoWeekday:!1,c=Cr(l)||l===!0,h={};let d=e,f,g;if(c&&(d=+t.startOf(d,"isoWeek",l)),d=+t.startOf(d,c?"day":o),t.diff(s,e,o)>1e5*a)throw new Error(e+" and "+s+" are too far apart with stepSize of "+a+" "+o);const _=i.ticks.source==="data"&&this.getDataTimestamps();for(f=d,g=0;f<s;f=+t.add(f,a,o),g++)ky(h,f,_);return(f===s||i.bounds==="ticks"||g===1)&&ky(h,f,_),Object.keys(h).sort(Cy).map(b=>+b)}getLabelForValue(t){const e=this._adapter,s=this.options.time;return s.tooltipFormat?e.format(t,s.tooltipFormat):e.format(t,s.displayFormats.datetime)}format(t,e){const i=this.options.time.displayFormats,r=this._unit,o=e||i[r];return this._adapter.format(t,o)}_tickFormatFunction(t,e,s,i){const r=this.options,o=r.ticks.callback;if(o)return Kt(o,[t,e,s],this);const a=r.time.displayFormats,l=this._unit,c=this._majorUnit,h=l&&a[l],d=c&&a[c],f=s[e],g=c&&d&&f&&f.major;return this._adapter.format(t,i||(g?d:h))}generateTickLabels(t){let e,s,i;for(e=0,s=t.length;e<s;++e)i=t[e],i.label=this._tickFormatFunction(i.value,e,t)}getDecimalForValue(t){return t===null?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const e=this._offsets,s=this.getDecimalForValue(t);return this.getPixelForDecimal((e.start+s)*e.factor)}getValueForPixel(t){const e=this._offsets,s=this.getDecimalForPixel(t)/e.factor-e.end;return this.min+s*(this.max-this.min)}_getLabelSize(t){const e=this.options.ticks,s=this.ctx.measureText(t).width,i=xn(this.isHorizontal()?e.maxRotation:e.minRotation),r=Math.cos(i),o=Math.sin(i),a=this._resolveTickFontOptions(0).size;return{w:s*r+a*o,h:s*o+a*r}}_getLabelCapacity(t){const e=this.options.time,s=e.displayFormats,i=s[e.unit]||s.millisecond,r=this._tickFormatFunction(t,0,Dy(this,[t],this._majorUnit),i),o=this._getLabelSize(r),a=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return a>0?a:1}getDataTimestamps(){let t=this._cache.data||[],e,s;if(t.length)return t;const i=this.getMatchingVisibleMetas();if(this._normalized&&i.length)return this._cache.data=i[0].controller.getAllParsedValues(this);for(e=0,s=i.length;e<s;++e)t=t.concat(i[e].controller.getAllParsedValues(this));return this._cache.data=this.normalize(t)}getLabelTimestamps(){const t=this._cache.labels||[];let e,s;if(t.length)return t;const i=this.getLabels();for(e=0,s=i.length;e<s;++e)t.push(Py(this,i[e]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return Rw(t.sort(Cy))}}function _l(n,t,e){let s=0,i=n.length-1,r,o,a,l;e?(t>=n[s].pos&&t<=n[i].pos&&({lo:s,hi:i}=us(n,"pos",t)),{pos:r,time:a}=n[s],{pos:o,time:l}=n[i]):(t>=n[s].time&&t<=n[i].time&&({lo:s,hi:i}=us(n,"time",t)),{time:r,pos:a}=n[s],{time:o,pos:l}=n[i]);const c=o-r;return c?a+(l-a)*(t-r)/c:a}class jF extends gd{static id="timeseries";static defaults=gd.defaults;constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),e=this._table=this.buildLookupTable(t);this._minPos=_l(e,this.min),this._tableRange=_l(e,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:e,max:s}=this,i=[],r=[];let o,a,l,c,h;for(o=0,a=t.length;o<a;++o)c=t[o],c>=e&&c<=s&&i.push(c);if(i.length<2)return[{time:e,pos:0},{time:s,pos:1}];for(o=0,a=i.length;o<a;++o)h=i[o+1],l=i[o-1],c=i[o],Math.round((h+l)/2)!==c&&r.push({time:c,pos:o/(a-1)});return r}_generate(){const t=this.min,e=this.max;let s=super.getDataTimestamps();return(!s.includes(t)||!s.length)&&s.splice(0,0,t),(!s.includes(e)||s.length===1)&&s.push(e),s.sort((i,r)=>i-r)}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const e=this.getDataTimestamps(),s=this.getLabelTimestamps();return e.length&&s.length?t=this.normalize(e.concat(s)):t=e.length?e:s,t=this._cache.all=t,t}getDecimalForValue(t){return(_l(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const e=this._offsets,s=this.getDecimalForPixel(t)/e.factor-e.end;return _l(this._table,s*this._tableRange+this._minPos,!0)}}var HF=Object.freeze({__proto__:null,CategoryScale:vF,LinearScale:xF,LogarithmicScale:IF,RadialLinearScale:BF,TimeScale:gd,TimeSeriesScale:jF});const WF=[zL,wN,mF,HF];ap.register(...WF);var qF="firebase",GF="12.0.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Gs(qF,GF,"app");Et.addAdapter(ap);const KF={apiKey:"AIzaSyARajg1PBZ0n8gyWrrpWynr8298-pmm0l4",authDomain:"arcane-scholars-legacy.firebaseapp.com",projectId:"arcane-scholars-legacy",storageBucket:"arcane-scholars-legacy.firebasestorage.app",messagingSenderId:"976593685731",appId:"1:976593685731:web:bfa95e8221f0b76f27c9d6",measurementId:"G-W3VDVWF7LF"},xo=typeof __firebase_config<"u"&&Object.keys(JSON.parse(__firebase_config)).length>0?JSON.parse(__firebase_config):KF;const My=typeof __initial_auth_token<"u"?__initial_auth_token:null;let yh,Ec,vx;console.log("main.js: Starting Firebase initialization process...");console.log("main.js: Using firebaseConfig:",xo);if(xo&&Object.keys(xo).length>0&&xo.apiKey!=="YOUR_FIREBASE_API_KEY")try{yh=Wb(xo),Ec=Wi(yh),vx=Ur(yh),console.log("Firebase initialized successfully.")}catch(n){console.error("Failed to initialize Firebase:",n)}else console.warn("Firebase configuration is missing or placeholder. Firebase will not be fully initialized."),console.warn('Please replace "YOUR_FIREBASE_API_KEY", "YOUR_PROJECT_ID", etc., with your actual Firebase project credentials for local development.');async function YF(){if(!Ec){console.warn("Firebase Auth not initialized, skipping authentication.");return}try{My&&(await FA(Ec,My),console.log("Signed in with custom token."))}catch(n){console.error("Firebase authentication error:",n)}}const bu=pI(SM);bu.use(Et);bu.config.globalProperties.$auth=Ec;bu.config.globalProperties.$db=vx;YF().then(()=>{bu.mount("#app")});
